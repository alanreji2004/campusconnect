var nU=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Ipe=nU((Dpe,u$)=>{function aU(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var _h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wy={exports:{}},vc={},_y={exports:{}},at={};var fA;function iU(){if(fA)return at;fA=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;function p(L){return L===null||typeof L!="object"?null:(L=d&&L[d]||L["@@iterator"],typeof L=="function"?L:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,b={};function y(L,K,oe){this.props=L,this.context=K,this.refs=b,this.updater=oe||v}y.prototype.isReactComponent={},y.prototype.setState=function(L,K){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,K,"setState")},y.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function x(){}x.prototype=y.prototype;function S(L,K,oe){this.props=L,this.context=K,this.refs=b,this.updater=oe||v}var E=S.prototype=new x;E.constructor=S,g(E,y.prototype),E.isPureReactComponent=!0;var C=Array.isArray,k=Object.prototype.hasOwnProperty,A={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function N(L,K,oe){var he,ge={},xe=null,ke=null;if(K!=null)for(he in K.ref!==void 0&&(ke=K.ref),K.key!==void 0&&(xe=""+K.key),K)k.call(K,he)&&!T.hasOwnProperty(he)&&(ge[he]=K[he]);var we=arguments.length-2;if(we===1)ge.children=oe;else if(1<we){for(var ue=Array(we),Se=0;Se<we;Se++)ue[Se]=arguments[Se+2];ge.children=ue}if(L&&L.defaultProps)for(he in we=L.defaultProps,we)ge[he]===void 0&&(ge[he]=we[he]);return{$$typeof:t,type:L,key:xe,ref:ke,props:ge,_owner:A.current}}function R(L,K){return{$$typeof:t,type:L.type,key:K,ref:L.ref,props:L.props,_owner:L._owner}}function I(L){return typeof L=="object"&&L!==null&&L.$$typeof===t}function D(L){var K={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(oe){return K[oe]})}var j=/\/+/g;function $(L,K){return typeof L=="object"&&L!==null&&L.key!=null?D(""+L.key):K.toString(36)}function W(L,K,oe,he,ge){var xe=typeof L;(xe==="undefined"||xe==="boolean")&&(L=null);var ke=!1;if(L===null)ke=!0;else switch(xe){case"string":case"number":ke=!0;break;case"object":switch(L.$$typeof){case t:case e:ke=!0}}if(ke)return ke=L,ge=ge(ke),L=he===""?"."+$(ke,0):he,C(ge)?(oe="",L!=null&&(oe=L.replace(j,"$&/")+"/"),W(ge,K,oe,"",function(Se){return Se})):ge!=null&&(I(ge)&&(ge=R(ge,oe+(!ge.key||ke&&ke.key===ge.key?"":(""+ge.key).replace(j,"$&/")+"/")+L)),K.push(ge)),1;if(ke=0,he=he===""?".":he+":",C(L))for(var we=0;we<L.length;we++){xe=L[we];var ue=he+$(xe,we);ke+=W(xe,K,oe,ue,ge)}else if(ue=p(L),typeof ue=="function")for(L=ue.call(L),we=0;!(xe=L.next()).done;)xe=xe.value,ue=he+$(xe,we++),ke+=W(xe,K,oe,ue,ge);else if(xe==="object")throw K=String(L),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return ke}function q(L,K,oe){if(L==null)return L;var he=[],ge=0;return W(L,he,"","",function(xe){return K.call(oe,xe,ge++)}),he}function X(L){if(L._status===-1){var K=L._result;K=K(),K.then(function(oe){(L._status===0||L._status===-1)&&(L._status=1,L._result=oe)},function(oe){(L._status===0||L._status===-1)&&(L._status=2,L._result=oe)}),L._status===-1&&(L._status=0,L._result=K)}if(L._status===1)return L._result.default;throw L._result}var Y={current:null},z={transition:null},B={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:z,ReactCurrentOwner:A};function G(){throw Error("act(...) is not supported in production builds of React.")}return at.Children={map:q,forEach:function(L,K,oe){q(L,function(){K.apply(this,arguments)},oe)},count:function(L){var K=0;return q(L,function(){K++}),K},toArray:function(L){return q(L,function(K){return K})||[]},only:function(L){if(!I(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},at.Component=y,at.Fragment=r,at.Profiler=a,at.PureComponent=S,at.StrictMode=n,at.Suspense=u,at.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,at.act=G,at.cloneElement=function(L,K,oe){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var he=g({},L.props),ge=L.key,xe=L.ref,ke=L._owner;if(K!=null){if(K.ref!==void 0&&(xe=K.ref,ke=A.current),K.key!==void 0&&(ge=""+K.key),L.type&&L.type.defaultProps)var we=L.type.defaultProps;for(ue in K)k.call(K,ue)&&!T.hasOwnProperty(ue)&&(he[ue]=K[ue]===void 0&&we!==void 0?we[ue]:K[ue])}var ue=arguments.length-2;if(ue===1)he.children=oe;else if(1<ue){we=Array(ue);for(var Se=0;Se<ue;Se++)we[Se]=arguments[Se+2];he.children=we}return{$$typeof:t,type:L.type,key:ge,ref:xe,props:he,_owner:ke}},at.createContext=function(L){return L={$$typeof:o,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:i,_context:L},L.Consumer=L},at.createElement=N,at.createFactory=function(L){var K=N.bind(null,L);return K.type=L,K},at.createRef=function(){return{current:null}},at.forwardRef=function(L){return{$$typeof:s,render:L}},at.isValidElement=I,at.lazy=function(L){return{$$typeof:f,_payload:{_status:-1,_result:L},_init:X}},at.memo=function(L,K){return{$$typeof:l,type:L,compare:K===void 0?null:K}},at.startTransition=function(L){var K=z.transition;z.transition={};try{L()}finally{z.transition=K}},at.unstable_act=G,at.useCallback=function(L,K){return Y.current.useCallback(L,K)},at.useContext=function(L){return Y.current.useContext(L)},at.useDebugValue=function(){},at.useDeferredValue=function(L){return Y.current.useDeferredValue(L)},at.useEffect=function(L,K){return Y.current.useEffect(L,K)},at.useId=function(){return Y.current.useId()},at.useImperativeHandle=function(L,K,oe){return Y.current.useImperativeHandle(L,K,oe)},at.useInsertionEffect=function(L,K){return Y.current.useInsertionEffect(L,K)},at.useLayoutEffect=function(L,K){return Y.current.useLayoutEffect(L,K)},at.useMemo=function(L,K){return Y.current.useMemo(L,K)},at.useReducer=function(L,K,oe){return Y.current.useReducer(L,K,oe)},at.useRef=function(L){return Y.current.useRef(L)},at.useState=function(L){return Y.current.useState(L)},at.useSyncExternalStore=function(L,K,oe){return Y.current.useSyncExternalStore(L,K,oe)},at.useTransition=function(){return Y.current.useTransition()},at.version="18.3.1",at}var dA;function Iv(){return dA||(dA=1,_y.exports=iU()),_y.exports}var hA;function oU(){if(hA)return vc;hA=1;var t=Iv(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(s,u,l){var f,d={},p=null,v=null;l!==void 0&&(p=""+l),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(v=u.ref);for(f in u)n.call(u,f)&&!i.hasOwnProperty(f)&&(d[f]=u[f]);if(s&&s.defaultProps)for(f in u=s.defaultProps,u)d[f]===void 0&&(d[f]=u[f]);return{$$typeof:e,type:s,key:p,ref:v,props:d,_owner:a.current}}return vc.Fragment=r,vc.jsx=o,vc.jsxs=o,vc}var pA;function sU(){return pA||(pA=1,wy.exports=oU()),wy.exports}var w=sU(),V=Iv();const Z=yt(V),uU=aU({__proto__:null,default:Z},[V]);var Sh={},Sy={exports:{}},sn={},Ey={exports:{}},Cy={};var vA;function lU(){return vA||(vA=1,(function(t){function e(z,B){var G=z.length;z.push(B);e:for(;0<G;){var L=G-1>>>1,K=z[L];if(0<a(K,B))z[L]=B,z[G]=K,G=L;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var B=z[0],G=z.pop();if(G!==B){z[0]=G;e:for(var L=0,K=z.length,oe=K>>>1;L<oe;){var he=2*(L+1)-1,ge=z[he],xe=he+1,ke=z[xe];if(0>a(ge,G))xe<K&&0>a(ke,ge)?(z[L]=ke,z[xe]=G,L=xe):(z[L]=ge,z[he]=G,L=he);else if(xe<K&&0>a(ke,G))z[L]=ke,z[xe]=G,L=xe;else break e}}return B}function a(z,B){var G=z.sortIndex-B.sortIndex;return G!==0?G:z.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var u=[],l=[],f=1,d=null,p=3,v=!1,g=!1,b=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(z){for(var B=r(l);B!==null;){if(B.callback===null)n(l);else if(B.startTime<=z)n(l),B.sortIndex=B.expirationTime,e(u,B);else break;B=r(l)}}function C(z){if(b=!1,E(z),!g)if(r(u)!==null)g=!0,X(k);else{var B=r(l);B!==null&&Y(C,B.startTime-z)}}function k(z,B){g=!1,b&&(b=!1,x(N),N=-1),v=!0;var G=p;try{for(E(B),d=r(u);d!==null&&(!(d.expirationTime>B)||z&&!D());){var L=d.callback;if(typeof L=="function"){d.callback=null,p=d.priorityLevel;var K=L(d.expirationTime<=B);B=t.unstable_now(),typeof K=="function"?d.callback=K:d===r(u)&&n(u),E(B)}else n(u);d=r(u)}if(d!==null)var oe=!0;else{var he=r(l);he!==null&&Y(C,he.startTime-B),oe=!1}return oe}finally{d=null,p=G,v=!1}}var A=!1,T=null,N=-1,R=5,I=-1;function D(){return!(t.unstable_now()-I<R)}function j(){if(T!==null){var z=t.unstable_now();I=z;var B=!0;try{B=T(!0,z)}finally{B?$():(A=!1,T=null)}}else A=!1}var $;if(typeof S=="function")$=function(){S(j)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,q=W.port2;W.port1.onmessage=j,$=function(){q.postMessage(null)}}else $=function(){y(j,0)};function X(z){T=z,A||(A=!0,$())}function Y(z,B){N=y(function(){z(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){g||v||(g=!0,X(k))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(z){switch(p){case 1:case 2:case 3:var B=3;break;default:B=p}var G=p;p=B;try{return z()}finally{p=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,B){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var G=p;p=z;try{return B()}finally{p=G}},t.unstable_scheduleCallback=function(z,B,G){var L=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?L+G:L):G=L,z){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=G+K,z={id:f++,callback:B,priorityLevel:z,startTime:G,expirationTime:K,sortIndex:-1},G>L?(z.sortIndex=G,e(l,z),r(u)===null&&z===r(l)&&(b?(x(N),N=-1):b=!0,Y(C,G-L))):(z.sortIndex=K,e(u,z),g||v||(g=!0,X(k))),z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(z){var B=p;return function(){var G=p;p=B;try{return z.apply(this,arguments)}finally{p=G}}}})(Cy)),Cy}var mA;function cU(){return mA||(mA=1,Ey.exports=lU()),Ey.exports}var gA;function fU(){if(gA)return sn;gA=1;var t=Iv(),e=cU();function r(c){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+c,m=1;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(c,h){o(c,h),o(c+"Capture",h)}function o(c,h){for(a[c]=h,c=0;c<h.length;c++)n.add(h[c])}var s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,l=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},d={};function p(c){return u.call(d,c)?!0:u.call(f,c)?!1:l.test(c)?d[c]=!0:(f[c]=!0,!1)}function v(c,h,m,_){if(m!==null&&m.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return _?!1:m!==null?!m.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function g(c,h,m,_){if(h===null||typeof h>"u"||v(c,h,m,_))return!0;if(_)return!1;if(m!==null)switch(m.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function b(c,h,m,_,O,P,M){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=_,this.attributeNamespace=O,this.mustUseProperty=m,this.propertyName=c,this.type=h,this.sanitizeURL=P,this.removeEmptyString=M}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){y[c]=new b(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var h=c[0];y[h]=new b(h,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){y[c]=new b(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){y[c]=new b(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){y[c]=new b(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){y[c]=new b(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){y[c]=new b(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){y[c]=new b(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){y[c]=new b(c,5,!1,c.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function S(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var h=c.replace(x,S);y[h]=new b(h,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var h=c.replace(x,S);y[h]=new b(h,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var h=c.replace(x,S);y[h]=new b(h,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){y[c]=new b(c,1,!1,c.toLowerCase(),null,!1,!1)}),y.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){y[c]=new b(c,1,!1,c.toLowerCase(),null,!0,!0)});function E(c,h,m,_){var O=y.hasOwnProperty(h)?y[h]:null;(O!==null?O.type!==0:_||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(g(h,m,O,_)&&(m=null),_||O===null?p(h)&&(m===null?c.removeAttribute(h):c.setAttribute(h,""+m)):O.mustUseProperty?c[O.propertyName]=m===null?O.type===3?!1:"":m:(h=O.attributeName,_=O.attributeNamespace,m===null?c.removeAttribute(h):(O=O.type,m=O===3||O===4&&m===!0?"":""+m,_?c.setAttributeNS(_,h,m):c.setAttribute(h,m))))}var C=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),A=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),D=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),q=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),Y=Symbol.for("react.offscreen"),z=Symbol.iterator;function B(c){return c===null||typeof c!="object"?null:(c=z&&c[z]||c["@@iterator"],typeof c=="function"?c:null)}var G=Object.assign,L;function K(c){if(L===void 0)try{throw Error()}catch(m){var h=m.stack.trim().match(/\n( *(at )?)/);L=h&&h[1]||""}return`
`+L+c}var oe=!1;function he(c,h){if(!c||oe)return"";oe=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(ie){var _=ie}Reflect.construct(c,[],h)}else{try{h.call()}catch(ie){_=ie}c.call(h.prototype)}else{try{throw Error()}catch(ie){_=ie}c()}}catch(ie){if(ie&&_&&typeof ie.stack=="string"){for(var O=ie.stack.split(`
`),P=_.stack.split(`
`),M=O.length-1,H=P.length-1;1<=M&&0<=H&&O[M]!==P[H];)H--;for(;1<=M&&0<=H;M--,H--)if(O[M]!==P[H]){if(M!==1||H!==1)do if(M--,H--,0>H||O[M]!==P[H]){var Q=`
`+O[M].replace(" at new "," at ");return c.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",c.displayName)),Q}while(1<=M&&0<=H);break}}}finally{oe=!1,Error.prepareStackTrace=m}return(c=c?c.displayName||c.name:"")?K(c):""}function ge(c){switch(c.tag){case 5:return K(c.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return c=he(c.type,!1),c;case 11:return c=he(c.type.render,!1),c;case 1:return c=he(c.type,!0),c;default:return""}}function xe(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case T:return"Fragment";case A:return"Portal";case R:return"Profiler";case N:return"StrictMode";case $:return"Suspense";case W:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case D:return(c.displayName||"Context")+".Consumer";case I:return(c._context.displayName||"Context")+".Provider";case j:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case q:return h=c.displayName||null,h!==null?h:xe(c.type)||"Memo";case X:h=c._payload,c=c._init;try{return xe(c(h))}catch{}}return null}function ke(c){var h=c.type;switch(c.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=h.render,c=c.displayName||c.name||"",h.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xe(h);case 8:return h===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function we(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function ue(c){var h=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Se(c){var h=ue(c)?"checked":"value",m=Object.getOwnPropertyDescriptor(c.constructor.prototype,h),_=""+c[h];if(!c.hasOwnProperty(h)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var O=m.get,P=m.set;return Object.defineProperty(c,h,{configurable:!0,get:function(){return O.call(this)},set:function(M){_=""+M,P.call(this,M)}}),Object.defineProperty(c,h,{enumerable:m.enumerable}),{getValue:function(){return _},setValue:function(M){_=""+M},stopTracking:function(){c._valueTracker=null,delete c[h]}}}}function _e(c){c._valueTracker||(c._valueTracker=Se(c))}function le(c){if(!c)return!1;var h=c._valueTracker;if(!h)return!0;var m=h.getValue(),_="";return c&&(_=ue(c)?c.checked?"true":"false":c.value),c=_,c!==m?(h.setValue(c),!0):!1}function $e(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Fe(c,h){var m=h.checked;return G({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??c._wrapperState.initialChecked})}function Xe(c,h){var m=h.defaultValue==null?"":h.defaultValue,_=h.checked!=null?h.checked:h.defaultChecked;m=we(h.value!=null?h.value:m),c._wrapperState={initialChecked:_,initialValue:m,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function Ye(c,h){h=h.checked,h!=null&&E(c,"checked",h,!1)}function mt(c,h){Ye(c,h);var m=we(h.value),_=h.type;if(m!=null)_==="number"?(m===0&&c.value===""||c.value!=m)&&(c.value=""+m):c.value!==""+m&&(c.value=""+m);else if(_==="submit"||_==="reset"){c.removeAttribute("value");return}h.hasOwnProperty("value")?Pt(c,h.type,m):h.hasOwnProperty("defaultValue")&&Pt(c,h.type,we(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(c.defaultChecked=!!h.defaultChecked)}function Ut(c,h,m){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var _=h.type;if(!(_!=="submit"&&_!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+c._wrapperState.initialValue,m||h===c.value||(c.value=h),c.defaultValue=h}m=c.name,m!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,m!==""&&(c.name=m)}function Pt(c,h,m){(h!=="number"||$e(c.ownerDocument)!==c)&&(m==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+m&&(c.defaultValue=""+m))}var Er=Array.isArray;function Nt(c,h,m,_){if(c=c.options,h){h={};for(var O=0;O<m.length;O++)h["$"+m[O]]=!0;for(m=0;m<c.length;m++)O=h.hasOwnProperty("$"+c[m].value),c[m].selected!==O&&(c[m].selected=O),O&&_&&(c[m].defaultSelected=!0)}else{for(m=""+we(m),h=null,O=0;O<c.length;O++){if(c[O].value===m){c[O].selected=!0,_&&(c[O].defaultSelected=!0);return}h!==null||c[O].disabled||(h=c[O])}h!==null&&(h.selected=!0)}}function Yt(c,h){if(h.dangerouslySetInnerHTML!=null)throw Error(r(91));return G({},h,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function Mr(c,h){var m=h.value;if(m==null){if(m=h.children,h=h.defaultValue,m!=null){if(h!=null)throw Error(r(92));if(Er(m)){if(1<m.length)throw Error(r(93));m=m[0]}h=m}h==null&&(h=""),m=h}c._wrapperState={initialValue:we(m)}}function Pn(c,h){var m=we(h.value),_=we(h.defaultValue);m!=null&&(m=""+m,m!==c.value&&(c.value=m),h.defaultValue==null&&c.defaultValue!==m&&(c.defaultValue=m)),_!=null&&(c.defaultValue=""+_)}function Xr(c){var h=c.textContent;h===c._wrapperState.initialValue&&h!==""&&h!==null&&(c.value=h)}function Cs(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ga(c,h){return c==null||c==="http://www.w3.org/1999/xhtml"?Cs(h):c==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var Yr,ks=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,m,_,O){MSApp.execUnsafeLocalFunction(function(){return c(h,m,_,O)})}:c})(function(c,h){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=h;else{for(Yr=Yr||document.createElement("div"),Yr.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=Yr.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;h.firstChild;)c.appendChild(h.firstChild)}});function _o(c,h){if(h){var m=c.firstChild;if(m&&m===c.lastChild&&m.nodeType===3){m.nodeValue=h;return}}c.textContent=h}var So={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Rm=["Webkit","ms","Moz","O"];Object.keys(So).forEach(function(c){Rm.forEach(function(h){h=h+c.charAt(0).toUpperCase()+c.substring(1),So[h]=So[c]})});function As(c,h,m){return h==null||typeof h=="boolean"||h===""?"":m||typeof h!="number"||h===0||So.hasOwnProperty(c)&&So[c]?(""+h).trim():h+"px"}function Os(c,h){c=c.style;for(var m in h)if(h.hasOwnProperty(m)){var _=m.indexOf("--")===0,O=As(m,h[m],_);m==="float"&&(m="cssFloat"),_?c.setProperty(m,O):c[m]=O}}var Rl=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Im(c,h){if(h){if(Rl[c]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(r(137,c));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(r(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(r(61))}if(h.style!=null&&typeof h.style!="object")throw Error(r(62))}}function jm(c,h){if(c.indexOf("-")===-1)return typeof h.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dm=null;function Mm(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Fm=null,Ts=null,Ps=null;function OE(c){if(c=ec(c)){if(typeof Fm!="function")throw Error(r(280));var h=c.stateNode;h&&(h=Fd(h),Fm(c.stateNode,c.type,h))}}function TE(c){Ts?Ps?Ps.push(c):Ps=[c]:Ts=c}function PE(){if(Ts){var c=Ts,h=Ps;if(Ps=Ts=null,OE(c),h)for(c=0;c<h.length;c++)OE(h[c])}}function NE(c,h){return c(h)}function RE(){}var Lm=!1;function IE(c,h,m){if(Lm)return c(h,m);Lm=!0;try{return NE(c,h,m)}finally{Lm=!1,(Ts!==null||Ps!==null)&&(RE(),PE())}}function Il(c,h){var m=c.stateNode;if(m===null)return null;var _=Fd(m);if(_===null)return null;m=_[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(c=c.type,_=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!_;break e;default:c=!1}if(c)return null;if(m&&typeof m!="function")throw Error(r(231,h,typeof m));return m}var Bm=!1;if(s)try{var jl={};Object.defineProperty(jl,"passive",{get:function(){Bm=!0}}),window.addEventListener("test",jl,jl),window.removeEventListener("test",jl,jl)}catch{Bm=!1}function l$(c,h,m,_,O,P,M,H,Q){var ie=Array.prototype.slice.call(arguments,3);try{h.apply(m,ie)}catch(ve){this.onError(ve)}}var Dl=!1,vd=null,md=!1,$m=null,c$={onError:function(c){Dl=!0,vd=c}};function f$(c,h,m,_,O,P,M,H,Q){Dl=!1,vd=null,l$.apply(c$,arguments)}function d$(c,h,m,_,O,P,M,H,Q){if(f$.apply(this,arguments),Dl){if(Dl){var ie=vd;Dl=!1,vd=null}else throw Error(r(198));md||(md=!0,$m=ie)}}function Eo(c){var h=c,m=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,(h.flags&4098)!==0&&(m=h.return),c=h.return;while(c)}return h.tag===3?m:null}function jE(c){if(c.tag===13){var h=c.memoizedState;if(h===null&&(c=c.alternate,c!==null&&(h=c.memoizedState)),h!==null)return h.dehydrated}return null}function DE(c){if(Eo(c)!==c)throw Error(r(188))}function h$(c){var h=c.alternate;if(!h){if(h=Eo(c),h===null)throw Error(r(188));return h!==c?null:c}for(var m=c,_=h;;){var O=m.return;if(O===null)break;var P=O.alternate;if(P===null){if(_=O.return,_!==null){m=_;continue}break}if(O.child===P.child){for(P=O.child;P;){if(P===m)return DE(O),c;if(P===_)return DE(O),h;P=P.sibling}throw Error(r(188))}if(m.return!==_.return)m=O,_=P;else{for(var M=!1,H=O.child;H;){if(H===m){M=!0,m=O,_=P;break}if(H===_){M=!0,_=O,m=P;break}H=H.sibling}if(!M){for(H=P.child;H;){if(H===m){M=!0,m=P,_=O;break}if(H===_){M=!0,_=P,m=O;break}H=H.sibling}if(!M)throw Error(r(189))}}if(m.alternate!==_)throw Error(r(190))}if(m.tag!==3)throw Error(r(188));return m.stateNode.current===m?c:h}function ME(c){return c=h$(c),c!==null?FE(c):null}function FE(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var h=FE(c);if(h!==null)return h;c=c.sibling}return null}var LE=e.unstable_scheduleCallback,BE=e.unstable_cancelCallback,p$=e.unstable_shouldYield,v$=e.unstable_requestPaint,Gt=e.unstable_now,m$=e.unstable_getCurrentPriorityLevel,Um=e.unstable_ImmediatePriority,$E=e.unstable_UserBlockingPriority,gd=e.unstable_NormalPriority,g$=e.unstable_LowPriority,UE=e.unstable_IdlePriority,yd=null,ya=null;function y$(c){if(ya&&typeof ya.onCommitFiberRoot=="function")try{ya.onCommitFiberRoot(yd,c,void 0,(c.current.flags&128)===128)}catch{}}var Xn=Math.clz32?Math.clz32:w$,b$=Math.log,x$=Math.LN2;function w$(c){return c>>>=0,c===0?32:31-(b$(c)/x$|0)|0}var bd=64,xd=4194304;function Ml(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function wd(c,h){var m=c.pendingLanes;if(m===0)return 0;var _=0,O=c.suspendedLanes,P=c.pingedLanes,M=m&268435455;if(M!==0){var H=M&~O;H!==0?_=Ml(H):(P&=M,P!==0&&(_=Ml(P)))}else M=m&~O,M!==0?_=Ml(M):P!==0&&(_=Ml(P));if(_===0)return 0;if(h!==0&&h!==_&&(h&O)===0&&(O=_&-_,P=h&-h,O>=P||O===16&&(P&4194240)!==0))return h;if((_&4)!==0&&(_|=m&16),h=c.entangledLanes,h!==0)for(c=c.entanglements,h&=_;0<h;)m=31-Xn(h),O=1<<m,_|=c[m],h&=~O;return _}function _$(c,h){switch(c){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S$(c,h){for(var m=c.suspendedLanes,_=c.pingedLanes,O=c.expirationTimes,P=c.pendingLanes;0<P;){var M=31-Xn(P),H=1<<M,Q=O[M];Q===-1?((H&m)===0||(H&_)!==0)&&(O[M]=_$(H,h)):Q<=h&&(c.expiredLanes|=H),P&=~H}}function Wm(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function WE(){var c=bd;return bd<<=1,(bd&4194240)===0&&(bd=64),c}function zm(c){for(var h=[],m=0;31>m;m++)h.push(c);return h}function Fl(c,h,m){c.pendingLanes|=h,h!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,h=31-Xn(h),c[h]=m}function E$(c,h){var m=c.pendingLanes&~h;c.pendingLanes=h,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=h,c.mutableReadLanes&=h,c.entangledLanes&=h,h=c.entanglements;var _=c.eventTimes;for(c=c.expirationTimes;0<m;){var O=31-Xn(m),P=1<<O;h[O]=0,_[O]=-1,c[O]=-1,m&=~P}}function qm(c,h){var m=c.entangledLanes|=h;for(c=c.entanglements;m;){var _=31-Xn(m),O=1<<_;O&h|c[_]&h&&(c[_]|=h),m&=~O}}var gt=0;function zE(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var qE,Vm,VE,HE,GE,Hm=!1,_d=[],Ci=null,ki=null,Ai=null,Ll=new Map,Bl=new Map,Oi=[],C$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function KE(c,h){switch(c){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":ki=null;break;case"mouseover":case"mouseout":Ai=null;break;case"pointerover":case"pointerout":Ll.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bl.delete(h.pointerId)}}function $l(c,h,m,_,O,P){return c===null||c.nativeEvent!==P?(c={blockedOn:h,domEventName:m,eventSystemFlags:_,nativeEvent:P,targetContainers:[O]},h!==null&&(h=ec(h),h!==null&&Vm(h)),c):(c.eventSystemFlags|=_,h=c.targetContainers,O!==null&&h.indexOf(O)===-1&&h.push(O),c)}function k$(c,h,m,_,O){switch(h){case"focusin":return Ci=$l(Ci,c,h,m,_,O),!0;case"dragenter":return ki=$l(ki,c,h,m,_,O),!0;case"mouseover":return Ai=$l(Ai,c,h,m,_,O),!0;case"pointerover":var P=O.pointerId;return Ll.set(P,$l(Ll.get(P)||null,c,h,m,_,O)),!0;case"gotpointercapture":return P=O.pointerId,Bl.set(P,$l(Bl.get(P)||null,c,h,m,_,O)),!0}return!1}function XE(c){var h=Co(c.target);if(h!==null){var m=Eo(h);if(m!==null){if(h=m.tag,h===13){if(h=jE(m),h!==null){c.blockedOn=h,GE(c.priority,function(){VE(m)});return}}else if(h===3&&m.stateNode.current.memoizedState.isDehydrated){c.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Sd(c){if(c.blockedOn!==null)return!1;for(var h=c.targetContainers;0<h.length;){var m=Km(c.domEventName,c.eventSystemFlags,h[0],c.nativeEvent);if(m===null){m=c.nativeEvent;var _=new m.constructor(m.type,m);Dm=_,m.target.dispatchEvent(_),Dm=null}else return h=ec(m),h!==null&&Vm(h),c.blockedOn=m,!1;h.shift()}return!0}function YE(c,h,m){Sd(c)&&m.delete(h)}function A$(){Hm=!1,Ci!==null&&Sd(Ci)&&(Ci=null),ki!==null&&Sd(ki)&&(ki=null),Ai!==null&&Sd(Ai)&&(Ai=null),Ll.forEach(YE),Bl.forEach(YE)}function Ul(c,h){c.blockedOn===h&&(c.blockedOn=null,Hm||(Hm=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,A$)))}function Wl(c){function h(O){return Ul(O,c)}if(0<_d.length){Ul(_d[0],c);for(var m=1;m<_d.length;m++){var _=_d[m];_.blockedOn===c&&(_.blockedOn=null)}}for(Ci!==null&&Ul(Ci,c),ki!==null&&Ul(ki,c),Ai!==null&&Ul(Ai,c),Ll.forEach(h),Bl.forEach(h),m=0;m<Oi.length;m++)_=Oi[m],_.blockedOn===c&&(_.blockedOn=null);for(;0<Oi.length&&(m=Oi[0],m.blockedOn===null);)XE(m),m.blockedOn===null&&Oi.shift()}var Ns=C.ReactCurrentBatchConfig,Ed=!0;function O$(c,h,m,_){var O=gt,P=Ns.transition;Ns.transition=null;try{gt=1,Gm(c,h,m,_)}finally{gt=O,Ns.transition=P}}function T$(c,h,m,_){var O=gt,P=Ns.transition;Ns.transition=null;try{gt=4,Gm(c,h,m,_)}finally{gt=O,Ns.transition=P}}function Gm(c,h,m,_){if(Ed){var O=Km(c,h,m,_);if(O===null)fg(c,h,_,Cd,m),KE(c,_);else if(k$(O,c,h,m,_))_.stopPropagation();else if(KE(c,_),h&4&&-1<C$.indexOf(c)){for(;O!==null;){var P=ec(O);if(P!==null&&qE(P),P=Km(c,h,m,_),P===null&&fg(c,h,_,Cd,m),P===O)break;O=P}O!==null&&_.stopPropagation()}else fg(c,h,_,null,m)}}var Cd=null;function Km(c,h,m,_){if(Cd=null,c=Mm(_),c=Co(c),c!==null)if(h=Eo(c),h===null)c=null;else if(m=h.tag,m===13){if(c=jE(h),c!==null)return c;c=null}else if(m===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;c=null}else h!==c&&(c=null);return Cd=c,null}function JE(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(m$()){case Um:return 1;case $E:return 4;case gd:case g$:return 16;case UE:return 536870912;default:return 16}default:return 16}}var Ti=null,Xm=null,kd=null;function QE(){if(kd)return kd;var c,h=Xm,m=h.length,_,O="value"in Ti?Ti.value:Ti.textContent,P=O.length;for(c=0;c<m&&h[c]===O[c];c++);var M=m-c;for(_=1;_<=M&&h[m-_]===O[P-_];_++);return kd=O.slice(c,1<_?1-_:void 0)}function Ad(c){var h=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&h===13&&(c=13)):c=h,c===10&&(c=13),32<=c||c===13?c:0}function Od(){return!0}function ZE(){return!1}function vn(c){function h(m,_,O,P,M){this._reactName=m,this._targetInst=O,this.type=_,this.nativeEvent=P,this.target=M,this.currentTarget=null;for(var H in c)c.hasOwnProperty(H)&&(m=c[H],this[H]=m?m(P):P[H]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Od:ZE,this.isPropagationStopped=ZE,this}return G(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Od)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Od)},persist:function(){},isPersistent:Od}),h}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ym=vn(Rs),zl=G({},Rs,{view:0,detail:0}),P$=vn(zl),Jm,Qm,ql,Td=G({},zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eg,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==ql&&(ql&&c.type==="mousemove"?(Jm=c.screenX-ql.screenX,Qm=c.screenY-ql.screenY):Qm=Jm=0,ql=c),Jm)},movementY:function(c){return"movementY"in c?c.movementY:Qm}}),eC=vn(Td),N$=G({},Td,{dataTransfer:0}),R$=vn(N$),I$=G({},zl,{relatedTarget:0}),Zm=vn(I$),j$=G({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),D$=vn(j$),M$=G({},Rs,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),F$=vn(M$),L$=G({},Rs,{data:0}),tC=vn(L$),B$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W$(c){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(c):(c=U$[c])?!!h[c]:!1}function eg(){return W$}var z$=G({},zl,{key:function(c){if(c.key){var h=B$[c.key]||c.key;if(h!=="Unidentified")return h}return c.type==="keypress"?(c=Ad(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?$$[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eg,charCode:function(c){return c.type==="keypress"?Ad(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Ad(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),q$=vn(z$),V$=G({},Td,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rC=vn(V$),H$=G({},zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eg}),G$=vn(H$),K$=G({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),X$=vn(K$),Y$=G({},Td,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),J$=vn(Y$),Q$=[9,13,27,32],tg=s&&"CompositionEvent"in window,Vl=null;s&&"documentMode"in document&&(Vl=document.documentMode);var Z$=s&&"TextEvent"in window&&!Vl,nC=s&&(!tg||Vl&&8<Vl&&11>=Vl),aC=" ",iC=!1;function oC(c,h){switch(c){case"keyup":return Q$.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sC(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Is=!1;function e5(c,h){switch(c){case"compositionend":return sC(h);case"keypress":return h.which!==32?null:(iC=!0,aC);case"textInput":return c=h.data,c===aC&&iC?null:c;default:return null}}function t5(c,h){if(Is)return c==="compositionend"||!tg&&oC(c,h)?(c=QE(),kd=Xm=Ti=null,Is=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return nC&&h.locale!=="ko"?null:h.data;default:return null}}var r5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uC(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h==="input"?!!r5[c.type]:h==="textarea"}function lC(c,h,m,_){TE(_),h=jd(h,"onChange"),0<h.length&&(m=new Ym("onChange","change",null,m,_),c.push({event:m,listeners:h}))}var Hl=null,Gl=null;function n5(c){AC(c,0)}function Pd(c){var h=Ls(c);if(le(h))return c}function a5(c,h){if(c==="change")return h}var cC=!1;if(s){var rg;if(s){var ng="oninput"in document;if(!ng){var fC=document.createElement("div");fC.setAttribute("oninput","return;"),ng=typeof fC.oninput=="function"}rg=ng}else rg=!1;cC=rg&&(!document.documentMode||9<document.documentMode)}function dC(){Hl&&(Hl.detachEvent("onpropertychange",hC),Gl=Hl=null)}function hC(c){if(c.propertyName==="value"&&Pd(Gl)){var h=[];lC(h,Gl,c,Mm(c)),IE(n5,h)}}function i5(c,h,m){c==="focusin"?(dC(),Hl=h,Gl=m,Hl.attachEvent("onpropertychange",hC)):c==="focusout"&&dC()}function o5(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Pd(Gl)}function s5(c,h){if(c==="click")return Pd(h)}function u5(c,h){if(c==="input"||c==="change")return Pd(h)}function l5(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var Yn=typeof Object.is=="function"?Object.is:l5;function Kl(c,h){if(Yn(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var m=Object.keys(c),_=Object.keys(h);if(m.length!==_.length)return!1;for(_=0;_<m.length;_++){var O=m[_];if(!u.call(h,O)||!Yn(c[O],h[O]))return!1}return!0}function pC(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function vC(c,h){var m=pC(c);c=0;for(var _;m;){if(m.nodeType===3){if(_=c+m.textContent.length,c<=h&&_>=h)return{node:m,offset:h-c};c=_}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=pC(m)}}function mC(c,h){return c&&h?c===h?!0:c&&c.nodeType===3?!1:h&&h.nodeType===3?mC(c,h.parentNode):"contains"in c?c.contains(h):c.compareDocumentPosition?!!(c.compareDocumentPosition(h)&16):!1:!1}function gC(){for(var c=window,h=$e();h instanceof c.HTMLIFrameElement;){try{var m=typeof h.contentWindow.location.href=="string"}catch{m=!1}if(m)c=h.contentWindow;else break;h=$e(c.document)}return h}function ag(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h&&(h==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||h==="textarea"||c.contentEditable==="true")}function c5(c){var h=gC(),m=c.focusedElem,_=c.selectionRange;if(h!==m&&m&&m.ownerDocument&&mC(m.ownerDocument.documentElement,m)){if(_!==null&&ag(m)){if(h=_.start,c=_.end,c===void 0&&(c=h),"selectionStart"in m)m.selectionStart=h,m.selectionEnd=Math.min(c,m.value.length);else if(c=(h=m.ownerDocument||document)&&h.defaultView||window,c.getSelection){c=c.getSelection();var O=m.textContent.length,P=Math.min(_.start,O);_=_.end===void 0?P:Math.min(_.end,O),!c.extend&&P>_&&(O=_,_=P,P=O),O=vC(m,P);var M=vC(m,_);O&&M&&(c.rangeCount!==1||c.anchorNode!==O.node||c.anchorOffset!==O.offset||c.focusNode!==M.node||c.focusOffset!==M.offset)&&(h=h.createRange(),h.setStart(O.node,O.offset),c.removeAllRanges(),P>_?(c.addRange(h),c.extend(M.node,M.offset)):(h.setEnd(M.node,M.offset),c.addRange(h)))}}for(h=[],c=m;c=c.parentNode;)c.nodeType===1&&h.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<h.length;m++)c=h[m],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var f5=s&&"documentMode"in document&&11>=document.documentMode,js=null,ig=null,Xl=null,og=!1;function yC(c,h,m){var _=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;og||js==null||js!==$e(_)||(_=js,"selectionStart"in _&&ag(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Xl&&Kl(Xl,_)||(Xl=_,_=jd(ig,"onSelect"),0<_.length&&(h=new Ym("onSelect","select",null,h,m),c.push({event:h,listeners:_}),h.target=js)))}function Nd(c,h){var m={};return m[c.toLowerCase()]=h.toLowerCase(),m["Webkit"+c]="webkit"+h,m["Moz"+c]="moz"+h,m}var Ds={animationend:Nd("Animation","AnimationEnd"),animationiteration:Nd("Animation","AnimationIteration"),animationstart:Nd("Animation","AnimationStart"),transitionend:Nd("Transition","TransitionEnd")},sg={},bC={};s&&(bC=document.createElement("div").style,"AnimationEvent"in window||(delete Ds.animationend.animation,delete Ds.animationiteration.animation,delete Ds.animationstart.animation),"TransitionEvent"in window||delete Ds.transitionend.transition);function Rd(c){if(sg[c])return sg[c];if(!Ds[c])return c;var h=Ds[c],m;for(m in h)if(h.hasOwnProperty(m)&&m in bC)return sg[c]=h[m];return c}var xC=Rd("animationend"),wC=Rd("animationiteration"),_C=Rd("animationstart"),SC=Rd("transitionend"),EC=new Map,CC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(c,h){EC.set(c,h),i(h,[c])}for(var ug=0;ug<CC.length;ug++){var lg=CC[ug],d5=lg.toLowerCase(),h5=lg[0].toUpperCase()+lg.slice(1);Pi(d5,"on"+h5)}Pi(xC,"onAnimationEnd"),Pi(wC,"onAnimationIteration"),Pi(_C,"onAnimationStart"),Pi("dblclick","onDoubleClick"),Pi("focusin","onFocus"),Pi("focusout","onBlur"),Pi(SC,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yl));function kC(c,h,m){var _=c.type||"unknown-event";c.currentTarget=m,d$(_,h,void 0,c),c.currentTarget=null}function AC(c,h){h=(h&4)!==0;for(var m=0;m<c.length;m++){var _=c[m],O=_.event;_=_.listeners;e:{var P=void 0;if(h)for(var M=_.length-1;0<=M;M--){var H=_[M],Q=H.instance,ie=H.currentTarget;if(H=H.listener,Q!==P&&O.isPropagationStopped())break e;kC(O,H,ie),P=Q}else for(M=0;M<_.length;M++){if(H=_[M],Q=H.instance,ie=H.currentTarget,H=H.listener,Q!==P&&O.isPropagationStopped())break e;kC(O,H,ie),P=Q}}}if(md)throw c=$m,md=!1,$m=null,c}function kt(c,h){var m=h[gg];m===void 0&&(m=h[gg]=new Set);var _=c+"__bubble";m.has(_)||(OC(h,c,2,!1),m.add(_))}function cg(c,h,m){var _=0;h&&(_|=4),OC(m,c,_,h)}var Id="_reactListening"+Math.random().toString(36).slice(2);function Jl(c){if(!c[Id]){c[Id]=!0,n.forEach(function(m){m!=="selectionchange"&&(p5.has(m)||cg(m,!1,c),cg(m,!0,c))});var h=c.nodeType===9?c:c.ownerDocument;h===null||h[Id]||(h[Id]=!0,cg("selectionchange",!1,h))}}function OC(c,h,m,_){switch(JE(h)){case 1:var O=O$;break;case 4:O=T$;break;default:O=Gm}m=O.bind(null,h,m,c),O=void 0,!Bm||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(O=!0),_?O!==void 0?c.addEventListener(h,m,{capture:!0,passive:O}):c.addEventListener(h,m,!0):O!==void 0?c.addEventListener(h,m,{passive:O}):c.addEventListener(h,m,!1)}function fg(c,h,m,_,O){var P=_;if((h&1)===0&&(h&2)===0&&_!==null)e:for(;;){if(_===null)return;var M=_.tag;if(M===3||M===4){var H=_.stateNode.containerInfo;if(H===O||H.nodeType===8&&H.parentNode===O)break;if(M===4)for(M=_.return;M!==null;){var Q=M.tag;if((Q===3||Q===4)&&(Q=M.stateNode.containerInfo,Q===O||Q.nodeType===8&&Q.parentNode===O))return;M=M.return}for(;H!==null;){if(M=Co(H),M===null)return;if(Q=M.tag,Q===5||Q===6){_=P=M;continue e}H=H.parentNode}}_=_.return}IE(function(){var ie=P,ve=Mm(m),me=[];e:{var pe=EC.get(c);if(pe!==void 0){var Ce=Ym,Pe=c;switch(c){case"keypress":if(Ad(m)===0)break e;case"keydown":case"keyup":Ce=q$;break;case"focusin":Pe="focus",Ce=Zm;break;case"focusout":Pe="blur",Ce=Zm;break;case"beforeblur":case"afterblur":Ce=Zm;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=eC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=R$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=G$;break;case xC:case wC:case _C:Ce=D$;break;case SC:Ce=X$;break;case"scroll":Ce=P$;break;case"wheel":Ce=J$;break;case"copy":case"cut":case"paste":Ce=F$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=rC}var Ie=(h&4)!==0,Kt=!Ie&&c==="scroll",re=Ie?pe!==null?pe+"Capture":null:pe;Ie=[];for(var te=ie,ne;te!==null;){ne=te;var ye=ne.stateNode;if(ne.tag===5&&ye!==null&&(ne=ye,re!==null&&(ye=Il(te,re),ye!=null&&Ie.push(Ql(te,ye,ne)))),Kt)break;te=te.return}0<Ie.length&&(pe=new Ce(pe,Pe,null,m,ve),me.push({event:pe,listeners:Ie}))}}if((h&7)===0){e:{if(pe=c==="mouseover"||c==="pointerover",Ce=c==="mouseout"||c==="pointerout",pe&&m!==Dm&&(Pe=m.relatedTarget||m.fromElement)&&(Co(Pe)||Pe[Va]))break e;if((Ce||pe)&&(pe=ve.window===ve?ve:(pe=ve.ownerDocument)?pe.defaultView||pe.parentWindow:window,Ce?(Pe=m.relatedTarget||m.toElement,Ce=ie,Pe=Pe?Co(Pe):null,Pe!==null&&(Kt=Eo(Pe),Pe!==Kt||Pe.tag!==5&&Pe.tag!==6)&&(Pe=null)):(Ce=null,Pe=ie),Ce!==Pe)){if(Ie=eC,ye="onMouseLeave",re="onMouseEnter",te="mouse",(c==="pointerout"||c==="pointerover")&&(Ie=rC,ye="onPointerLeave",re="onPointerEnter",te="pointer"),Kt=Ce==null?pe:Ls(Ce),ne=Pe==null?pe:Ls(Pe),pe=new Ie(ye,te+"leave",Ce,m,ve),pe.target=Kt,pe.relatedTarget=ne,ye=null,Co(ve)===ie&&(Ie=new Ie(re,te+"enter",Pe,m,ve),Ie.target=ne,Ie.relatedTarget=Kt,ye=Ie),Kt=ye,Ce&&Pe)t:{for(Ie=Ce,re=Pe,te=0,ne=Ie;ne;ne=Ms(ne))te++;for(ne=0,ye=re;ye;ye=Ms(ye))ne++;for(;0<te-ne;)Ie=Ms(Ie),te--;for(;0<ne-te;)re=Ms(re),ne--;for(;te--;){if(Ie===re||re!==null&&Ie===re.alternate)break t;Ie=Ms(Ie),re=Ms(re)}Ie=null}else Ie=null;Ce!==null&&TC(me,pe,Ce,Ie,!1),Pe!==null&&Kt!==null&&TC(me,Kt,Pe,Ie,!0)}}e:{if(pe=ie?Ls(ie):window,Ce=pe.nodeName&&pe.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&pe.type==="file")var Le=a5;else if(uC(pe))if(cC)Le=u5;else{Le=o5;var We=i5}else(Ce=pe.nodeName)&&Ce.toLowerCase()==="input"&&(pe.type==="checkbox"||pe.type==="radio")&&(Le=s5);if(Le&&(Le=Le(c,ie))){lC(me,Le,m,ve);break e}We&&We(c,pe,ie),c==="focusout"&&(We=pe._wrapperState)&&We.controlled&&pe.type==="number"&&Pt(pe,"number",pe.value)}switch(We=ie?Ls(ie):window,c){case"focusin":(uC(We)||We.contentEditable==="true")&&(js=We,ig=ie,Xl=null);break;case"focusout":Xl=ig=js=null;break;case"mousedown":og=!0;break;case"contextmenu":case"mouseup":case"dragend":og=!1,yC(me,m,ve);break;case"selectionchange":if(f5)break;case"keydown":case"keyup":yC(me,m,ve)}var ze;if(tg)e:{switch(c){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Is?oC(c,m)&&(Ge="onCompositionEnd"):c==="keydown"&&m.keyCode===229&&(Ge="onCompositionStart");Ge&&(nC&&m.locale!=="ko"&&(Is||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Is&&(ze=QE()):(Ti=ve,Xm="value"in Ti?Ti.value:Ti.textContent,Is=!0)),We=jd(ie,Ge),0<We.length&&(Ge=new tC(Ge,c,null,m,ve),me.push({event:Ge,listeners:We}),ze?Ge.data=ze:(ze=sC(m),ze!==null&&(Ge.data=ze)))),(ze=Z$?e5(c,m):t5(c,m))&&(ie=jd(ie,"onBeforeInput"),0<ie.length&&(ve=new tC("onBeforeInput","beforeinput",null,m,ve),me.push({event:ve,listeners:ie}),ve.data=ze))}AC(me,h)})}function Ql(c,h,m){return{instance:c,listener:h,currentTarget:m}}function jd(c,h){for(var m=h+"Capture",_=[];c!==null;){var O=c,P=O.stateNode;O.tag===5&&P!==null&&(O=P,P=Il(c,m),P!=null&&_.unshift(Ql(c,P,O)),P=Il(c,h),P!=null&&_.push(Ql(c,P,O))),c=c.return}return _}function Ms(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function TC(c,h,m,_,O){for(var P=h._reactName,M=[];m!==null&&m!==_;){var H=m,Q=H.alternate,ie=H.stateNode;if(Q!==null&&Q===_)break;H.tag===5&&ie!==null&&(H=ie,O?(Q=Il(m,P),Q!=null&&M.unshift(Ql(m,Q,H))):O||(Q=Il(m,P),Q!=null&&M.push(Ql(m,Q,H)))),m=m.return}M.length!==0&&c.push({event:h,listeners:M})}var v5=/\r\n?/g,m5=/\u0000|\uFFFD/g;function PC(c){return(typeof c=="string"?c:""+c).replace(v5,`
`).replace(m5,"")}function Dd(c,h,m){if(h=PC(h),PC(c)!==h&&m)throw Error(r(425))}function Md(){}var dg=null,hg=null;function pg(c,h){return c==="textarea"||c==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var vg=typeof setTimeout=="function"?setTimeout:void 0,g5=typeof clearTimeout=="function"?clearTimeout:void 0,NC=typeof Promise=="function"?Promise:void 0,y5=typeof queueMicrotask=="function"?queueMicrotask:typeof NC<"u"?function(c){return NC.resolve(null).then(c).catch(b5)}:vg;function b5(c){setTimeout(function(){throw c})}function mg(c,h){var m=h,_=0;do{var O=m.nextSibling;if(c.removeChild(m),O&&O.nodeType===8)if(m=O.data,m==="/$"){if(_===0){c.removeChild(O),Wl(h);return}_--}else m!=="$"&&m!=="$?"&&m!=="$!"||_++;m=O}while(m);Wl(h)}function Ni(c){for(;c!=null;c=c.nextSibling){var h=c.nodeType;if(h===1||h===3)break;if(h===8){if(h=c.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return c}function RC(c){c=c.previousSibling;for(var h=0;c;){if(c.nodeType===8){var m=c.data;if(m==="$"||m==="$!"||m==="$?"){if(h===0)return c;h--}else m==="/$"&&h++}c=c.previousSibling}return null}var Fs=Math.random().toString(36).slice(2),ba="__reactFiber$"+Fs,Zl="__reactProps$"+Fs,Va="__reactContainer$"+Fs,gg="__reactEvents$"+Fs,x5="__reactListeners$"+Fs,w5="__reactHandles$"+Fs;function Co(c){var h=c[ba];if(h)return h;for(var m=c.parentNode;m;){if(h=m[Va]||m[ba]){if(m=h.alternate,h.child!==null||m!==null&&m.child!==null)for(c=RC(c);c!==null;){if(m=c[ba])return m;c=RC(c)}return h}c=m,m=c.parentNode}return null}function ec(c){return c=c[ba]||c[Va],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Ls(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(r(33))}function Fd(c){return c[Zl]||null}var yg=[],Bs=-1;function Ri(c){return{current:c}}function At(c){0>Bs||(c.current=yg[Bs],yg[Bs]=null,Bs--)}function wt(c,h){Bs++,yg[Bs]=c.current,c.current=h}var Ii={},Fr=Ri(Ii),tn=Ri(!1),ko=Ii;function $s(c,h){var m=c.type.contextTypes;if(!m)return Ii;var _=c.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===h)return _.__reactInternalMemoizedMaskedChildContext;var O={},P;for(P in m)O[P]=h[P];return _&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=h,c.__reactInternalMemoizedMaskedChildContext=O),O}function rn(c){return c=c.childContextTypes,c!=null}function Ld(){At(tn),At(Fr)}function IC(c,h,m){if(Fr.current!==Ii)throw Error(r(168));wt(Fr,h),wt(tn,m)}function jC(c,h,m){var _=c.stateNode;if(h=h.childContextTypes,typeof _.getChildContext!="function")return m;_=_.getChildContext();for(var O in _)if(!(O in h))throw Error(r(108,ke(c)||"Unknown",O));return G({},m,_)}function Bd(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||Ii,ko=Fr.current,wt(Fr,c),wt(tn,tn.current),!0}function DC(c,h,m){var _=c.stateNode;if(!_)throw Error(r(169));m?(c=jC(c,h,ko),_.__reactInternalMemoizedMergedChildContext=c,At(tn),At(Fr),wt(Fr,c)):At(tn),wt(tn,m)}var Ha=null,$d=!1,bg=!1;function MC(c){Ha===null?Ha=[c]:Ha.push(c)}function _5(c){$d=!0,MC(c)}function ji(){if(!bg&&Ha!==null){bg=!0;var c=0,h=gt;try{var m=Ha;for(gt=1;c<m.length;c++){var _=m[c];do _=_(!0);while(_!==null)}Ha=null,$d=!1}catch(O){throw Ha!==null&&(Ha=Ha.slice(c+1)),LE(Um,ji),O}finally{gt=h,bg=!1}}return null}var Us=[],Ws=0,Ud=null,Wd=0,Nn=[],Rn=0,Ao=null,Ga=1,Ka="";function Oo(c,h){Us[Ws++]=Wd,Us[Ws++]=Ud,Ud=c,Wd=h}function FC(c,h,m){Nn[Rn++]=Ga,Nn[Rn++]=Ka,Nn[Rn++]=Ao,Ao=c;var _=Ga;c=Ka;var O=32-Xn(_)-1;_&=~(1<<O),m+=1;var P=32-Xn(h)+O;if(30<P){var M=O-O%5;P=(_&(1<<M)-1).toString(32),_>>=M,O-=M,Ga=1<<32-Xn(h)+O|m<<O|_,Ka=P+c}else Ga=1<<P|m<<O|_,Ka=c}function xg(c){c.return!==null&&(Oo(c,1),FC(c,1,0))}function wg(c){for(;c===Ud;)Ud=Us[--Ws],Us[Ws]=null,Wd=Us[--Ws],Us[Ws]=null;for(;c===Ao;)Ao=Nn[--Rn],Nn[Rn]=null,Ka=Nn[--Rn],Nn[Rn]=null,Ga=Nn[--Rn],Nn[Rn]=null}var mn=null,gn=null,Rt=!1,Jn=null;function LC(c,h){var m=Mn(5,null,null,0);m.elementType="DELETED",m.stateNode=h,m.return=c,h=c.deletions,h===null?(c.deletions=[m],c.flags|=16):h.push(m)}function BC(c,h){switch(c.tag){case 5:var m=c.type;return h=h.nodeType!==1||m.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(c.stateNode=h,mn=c,gn=Ni(h.firstChild),!0):!1;case 6:return h=c.pendingProps===""||h.nodeType!==3?null:h,h!==null?(c.stateNode=h,mn=c,gn=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(m=Ao!==null?{id:Ga,overflow:Ka}:null,c.memoizedState={dehydrated:h,treeContext:m,retryLane:1073741824},m=Mn(18,null,null,0),m.stateNode=h,m.return=c,c.child=m,mn=c,gn=null,!0):!1;default:return!1}}function _g(c){return(c.mode&1)!==0&&(c.flags&128)===0}function Sg(c){if(Rt){var h=gn;if(h){var m=h;if(!BC(c,h)){if(_g(c))throw Error(r(418));h=Ni(m.nextSibling);var _=mn;h&&BC(c,h)?LC(_,m):(c.flags=c.flags&-4097|2,Rt=!1,mn=c)}}else{if(_g(c))throw Error(r(418));c.flags=c.flags&-4097|2,Rt=!1,mn=c}}}function $C(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;mn=c}function zd(c){if(c!==mn)return!1;if(!Rt)return $C(c),Rt=!0,!1;var h;if((h=c.tag!==3)&&!(h=c.tag!==5)&&(h=c.type,h=h!=="head"&&h!=="body"&&!pg(c.type,c.memoizedProps)),h&&(h=gn)){if(_g(c))throw UC(),Error(r(418));for(;h;)LC(c,h),h=Ni(h.nextSibling)}if($C(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));e:{for(c=c.nextSibling,h=0;c;){if(c.nodeType===8){var m=c.data;if(m==="/$"){if(h===0){gn=Ni(c.nextSibling);break e}h--}else m!=="$"&&m!=="$!"&&m!=="$?"||h++}c=c.nextSibling}gn=null}}else gn=mn?Ni(c.stateNode.nextSibling):null;return!0}function UC(){for(var c=gn;c;)c=Ni(c.nextSibling)}function zs(){gn=mn=null,Rt=!1}function Eg(c){Jn===null?Jn=[c]:Jn.push(c)}var S5=C.ReactCurrentBatchConfig;function tc(c,h,m){if(c=m.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(r(309));var _=m.stateNode}if(!_)throw Error(r(147,c));var O=_,P=""+c;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===P?h.ref:(h=function(M){var H=O.refs;M===null?delete H[P]:H[P]=M},h._stringRef=P,h)}if(typeof c!="string")throw Error(r(284));if(!m._owner)throw Error(r(290,c))}return c}function qd(c,h){throw c=Object.prototype.toString.call(h),Error(r(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c))}function WC(c){var h=c._init;return h(c._payload)}function zC(c){function h(re,te){if(c){var ne=re.deletions;ne===null?(re.deletions=[te],re.flags|=16):ne.push(te)}}function m(re,te){if(!c)return null;for(;te!==null;)h(re,te),te=te.sibling;return null}function _(re,te){for(re=new Map;te!==null;)te.key!==null?re.set(te.key,te):re.set(te.index,te),te=te.sibling;return re}function O(re,te){return re=Wi(re,te),re.index=0,re.sibling=null,re}function P(re,te,ne){return re.index=ne,c?(ne=re.alternate,ne!==null?(ne=ne.index,ne<te?(re.flags|=2,te):ne):(re.flags|=2,te)):(re.flags|=1048576,te)}function M(re){return c&&re.alternate===null&&(re.flags|=2),re}function H(re,te,ne,ye){return te===null||te.tag!==6?(te=vy(ne,re.mode,ye),te.return=re,te):(te=O(te,ne),te.return=re,te)}function Q(re,te,ne,ye){var Le=ne.type;return Le===T?ve(re,te,ne.props.children,ye,ne.key):te!==null&&(te.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===X&&WC(Le)===te.type)?(ye=O(te,ne.props),ye.ref=tc(re,te,ne),ye.return=re,ye):(ye=ph(ne.type,ne.key,ne.props,null,re.mode,ye),ye.ref=tc(re,te,ne),ye.return=re,ye)}function ie(re,te,ne,ye){return te===null||te.tag!==4||te.stateNode.containerInfo!==ne.containerInfo||te.stateNode.implementation!==ne.implementation?(te=my(ne,re.mode,ye),te.return=re,te):(te=O(te,ne.children||[]),te.return=re,te)}function ve(re,te,ne,ye,Le){return te===null||te.tag!==7?(te=Mo(ne,re.mode,ye,Le),te.return=re,te):(te=O(te,ne),te.return=re,te)}function me(re,te,ne){if(typeof te=="string"&&te!==""||typeof te=="number")return te=vy(""+te,re.mode,ne),te.return=re,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case k:return ne=ph(te.type,te.key,te.props,null,re.mode,ne),ne.ref=tc(re,null,te),ne.return=re,ne;case A:return te=my(te,re.mode,ne),te.return=re,te;case X:var ye=te._init;return me(re,ye(te._payload),ne)}if(Er(te)||B(te))return te=Mo(te,re.mode,ne,null),te.return=re,te;qd(re,te)}return null}function pe(re,te,ne,ye){var Le=te!==null?te.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number")return Le!==null?null:H(re,te,""+ne,ye);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case k:return ne.key===Le?Q(re,te,ne,ye):null;case A:return ne.key===Le?ie(re,te,ne,ye):null;case X:return Le=ne._init,pe(re,te,Le(ne._payload),ye)}if(Er(ne)||B(ne))return Le!==null?null:ve(re,te,ne,ye,null);qd(re,ne)}return null}function Ce(re,te,ne,ye,Le){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return re=re.get(ne)||null,H(te,re,""+ye,Le);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case k:return re=re.get(ye.key===null?ne:ye.key)||null,Q(te,re,ye,Le);case A:return re=re.get(ye.key===null?ne:ye.key)||null,ie(te,re,ye,Le);case X:var We=ye._init;return Ce(re,te,ne,We(ye._payload),Le)}if(Er(ye)||B(ye))return re=re.get(ne)||null,ve(te,re,ye,Le,null);qd(te,ye)}return null}function Pe(re,te,ne,ye){for(var Le=null,We=null,ze=te,Ge=te=0,yr=null;ze!==null&&Ge<ne.length;Ge++){ze.index>Ge?(yr=ze,ze=null):yr=ze.sibling;var ct=pe(re,ze,ne[Ge],ye);if(ct===null){ze===null&&(ze=yr);break}c&&ze&&ct.alternate===null&&h(re,ze),te=P(ct,te,Ge),We===null?Le=ct:We.sibling=ct,We=ct,ze=yr}if(Ge===ne.length)return m(re,ze),Rt&&Oo(re,Ge),Le;if(ze===null){for(;Ge<ne.length;Ge++)ze=me(re,ne[Ge],ye),ze!==null&&(te=P(ze,te,Ge),We===null?Le=ze:We.sibling=ze,We=ze);return Rt&&Oo(re,Ge),Le}for(ze=_(re,ze);Ge<ne.length;Ge++)yr=Ce(ze,re,Ge,ne[Ge],ye),yr!==null&&(c&&yr.alternate!==null&&ze.delete(yr.key===null?Ge:yr.key),te=P(yr,te,Ge),We===null?Le=yr:We.sibling=yr,We=yr);return c&&ze.forEach(function(zi){return h(re,zi)}),Rt&&Oo(re,Ge),Le}function Ie(re,te,ne,ye){var Le=B(ne);if(typeof Le!="function")throw Error(r(150));if(ne=Le.call(ne),ne==null)throw Error(r(151));for(var We=Le=null,ze=te,Ge=te=0,yr=null,ct=ne.next();ze!==null&&!ct.done;Ge++,ct=ne.next()){ze.index>Ge?(yr=ze,ze=null):yr=ze.sibling;var zi=pe(re,ze,ct.value,ye);if(zi===null){ze===null&&(ze=yr);break}c&&ze&&zi.alternate===null&&h(re,ze),te=P(zi,te,Ge),We===null?Le=zi:We.sibling=zi,We=zi,ze=yr}if(ct.done)return m(re,ze),Rt&&Oo(re,Ge),Le;if(ze===null){for(;!ct.done;Ge++,ct=ne.next())ct=me(re,ct.value,ye),ct!==null&&(te=P(ct,te,Ge),We===null?Le=ct:We.sibling=ct,We=ct);return Rt&&Oo(re,Ge),Le}for(ze=_(re,ze);!ct.done;Ge++,ct=ne.next())ct=Ce(ze,re,Ge,ct.value,ye),ct!==null&&(c&&ct.alternate!==null&&ze.delete(ct.key===null?Ge:ct.key),te=P(ct,te,Ge),We===null?Le=ct:We.sibling=ct,We=ct);return c&&ze.forEach(function(rU){return h(re,rU)}),Rt&&Oo(re,Ge),Le}function Kt(re,te,ne,ye){if(typeof ne=="object"&&ne!==null&&ne.type===T&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case k:e:{for(var Le=ne.key,We=te;We!==null;){if(We.key===Le){if(Le=ne.type,Le===T){if(We.tag===7){m(re,We.sibling),te=O(We,ne.props.children),te.return=re,re=te;break e}}else if(We.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===X&&WC(Le)===We.type){m(re,We.sibling),te=O(We,ne.props),te.ref=tc(re,We,ne),te.return=re,re=te;break e}m(re,We);break}else h(re,We);We=We.sibling}ne.type===T?(te=Mo(ne.props.children,re.mode,ye,ne.key),te.return=re,re=te):(ye=ph(ne.type,ne.key,ne.props,null,re.mode,ye),ye.ref=tc(re,te,ne),ye.return=re,re=ye)}return M(re);case A:e:{for(We=ne.key;te!==null;){if(te.key===We)if(te.tag===4&&te.stateNode.containerInfo===ne.containerInfo&&te.stateNode.implementation===ne.implementation){m(re,te.sibling),te=O(te,ne.children||[]),te.return=re,re=te;break e}else{m(re,te);break}else h(re,te);te=te.sibling}te=my(ne,re.mode,ye),te.return=re,re=te}return M(re);case X:return We=ne._init,Kt(re,te,We(ne._payload),ye)}if(Er(ne))return Pe(re,te,ne,ye);if(B(ne))return Ie(re,te,ne,ye);qd(re,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"?(ne=""+ne,te!==null&&te.tag===6?(m(re,te.sibling),te=O(te,ne),te.return=re,re=te):(m(re,te),te=vy(ne,re.mode,ye),te.return=re,re=te),M(re)):m(re,te)}return Kt}var qs=zC(!0),qC=zC(!1),Vd=Ri(null),Hd=null,Vs=null,Cg=null;function kg(){Cg=Vs=Hd=null}function Ag(c){var h=Vd.current;At(Vd),c._currentValue=h}function Og(c,h,m){for(;c!==null;){var _=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,_!==null&&(_.childLanes|=h)):_!==null&&(_.childLanes&h)!==h&&(_.childLanes|=h),c===m)break;c=c.return}}function Hs(c,h){Hd=c,Cg=Vs=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&h)!==0&&(nn=!0),c.firstContext=null)}function In(c){var h=c._currentValue;if(Cg!==c)if(c={context:c,memoizedValue:h,next:null},Vs===null){if(Hd===null)throw Error(r(308));Vs=c,Hd.dependencies={lanes:0,firstContext:c}}else Vs=Vs.next=c;return h}var To=null;function Tg(c){To===null?To=[c]:To.push(c)}function VC(c,h,m,_){var O=h.interleaved;return O===null?(m.next=m,Tg(h)):(m.next=O.next,O.next=m),h.interleaved=m,Xa(c,_)}function Xa(c,h){c.lanes|=h;var m=c.alternate;for(m!==null&&(m.lanes|=h),m=c,c=c.return;c!==null;)c.childLanes|=h,m=c.alternate,m!==null&&(m.childLanes|=h),m=c,c=c.return;return m.tag===3?m.stateNode:null}var Di=!1;function Pg(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HC(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Ya(c,h){return{eventTime:c,lane:h,tag:0,payload:null,callback:null,next:null}}function Mi(c,h,m){var _=c.updateQueue;if(_===null)return null;if(_=_.shared,(lt&2)!==0){var O=_.pending;return O===null?h.next=h:(h.next=O.next,O.next=h),_.pending=h,Xa(c,m)}return O=_.interleaved,O===null?(h.next=h,Tg(_)):(h.next=O.next,O.next=h),_.interleaved=h,Xa(c,m)}function Gd(c,h,m){if(h=h.updateQueue,h!==null&&(h=h.shared,(m&4194240)!==0)){var _=h.lanes;_&=c.pendingLanes,m|=_,h.lanes=m,qm(c,m)}}function GC(c,h){var m=c.updateQueue,_=c.alternate;if(_!==null&&(_=_.updateQueue,m===_)){var O=null,P=null;if(m=m.firstBaseUpdate,m!==null){do{var M={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};P===null?O=P=M:P=P.next=M,m=m.next}while(m!==null);P===null?O=P=h:P=P.next=h}else O=P=h;m={baseState:_.baseState,firstBaseUpdate:O,lastBaseUpdate:P,shared:_.shared,effects:_.effects},c.updateQueue=m;return}c=m.lastBaseUpdate,c===null?m.firstBaseUpdate=h:c.next=h,m.lastBaseUpdate=h}function Kd(c,h,m,_){var O=c.updateQueue;Di=!1;var P=O.firstBaseUpdate,M=O.lastBaseUpdate,H=O.shared.pending;if(H!==null){O.shared.pending=null;var Q=H,ie=Q.next;Q.next=null,M===null?P=ie:M.next=ie,M=Q;var ve=c.alternate;ve!==null&&(ve=ve.updateQueue,H=ve.lastBaseUpdate,H!==M&&(H===null?ve.firstBaseUpdate=ie:H.next=ie,ve.lastBaseUpdate=Q))}if(P!==null){var me=O.baseState;M=0,ve=ie=Q=null,H=P;do{var pe=H.lane,Ce=H.eventTime;if((_&pe)===pe){ve!==null&&(ve=ve.next={eventTime:Ce,lane:0,tag:H.tag,payload:H.payload,callback:H.callback,next:null});e:{var Pe=c,Ie=H;switch(pe=h,Ce=m,Ie.tag){case 1:if(Pe=Ie.payload,typeof Pe=="function"){me=Pe.call(Ce,me,pe);break e}me=Pe;break e;case 3:Pe.flags=Pe.flags&-65537|128;case 0:if(Pe=Ie.payload,pe=typeof Pe=="function"?Pe.call(Ce,me,pe):Pe,pe==null)break e;me=G({},me,pe);break e;case 2:Di=!0}}H.callback!==null&&H.lane!==0&&(c.flags|=64,pe=O.effects,pe===null?O.effects=[H]:pe.push(H))}else Ce={eventTime:Ce,lane:pe,tag:H.tag,payload:H.payload,callback:H.callback,next:null},ve===null?(ie=ve=Ce,Q=me):ve=ve.next=Ce,M|=pe;if(H=H.next,H===null){if(H=O.shared.pending,H===null)break;pe=H,H=pe.next,pe.next=null,O.lastBaseUpdate=pe,O.shared.pending=null}}while(!0);if(ve===null&&(Q=me),O.baseState=Q,O.firstBaseUpdate=ie,O.lastBaseUpdate=ve,h=O.shared.interleaved,h!==null){O=h;do M|=O.lane,O=O.next;while(O!==h)}else P===null&&(O.shared.lanes=0);Ro|=M,c.lanes=M,c.memoizedState=me}}function KC(c,h,m){if(c=h.effects,h.effects=null,c!==null)for(h=0;h<c.length;h++){var _=c[h],O=_.callback;if(O!==null){if(_.callback=null,_=m,typeof O!="function")throw Error(r(191,O));O.call(_)}}}var rc={},xa=Ri(rc),nc=Ri(rc),ac=Ri(rc);function Po(c){if(c===rc)throw Error(r(174));return c}function Ng(c,h){switch(wt(ac,h),wt(nc,c),wt(xa,rc),c=h.nodeType,c){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:ga(null,"");break;default:c=c===8?h.parentNode:h,h=c.namespaceURI||null,c=c.tagName,h=ga(h,c)}At(xa),wt(xa,h)}function Gs(){At(xa),At(nc),At(ac)}function XC(c){Po(ac.current);var h=Po(xa.current),m=ga(h,c.type);h!==m&&(wt(nc,c),wt(xa,m))}function Rg(c){nc.current===c&&(At(xa),At(nc))}var Dt=Ri(0);function Xd(c){for(var h=c;h!==null;){if(h.tag===13){var m=h.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var Ig=[];function jg(){for(var c=0;c<Ig.length;c++)Ig[c]._workInProgressVersionPrimary=null;Ig.length=0}var Yd=C.ReactCurrentDispatcher,Dg=C.ReactCurrentBatchConfig,No=0,Mt=null,rr=null,mr=null,Jd=!1,ic=!1,oc=0,E5=0;function Lr(){throw Error(r(321))}function Mg(c,h){if(h===null)return!1;for(var m=0;m<h.length&&m<c.length;m++)if(!Yn(c[m],h[m]))return!1;return!0}function Fg(c,h,m,_,O,P){if(No=P,Mt=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Yd.current=c===null||c.memoizedState===null?O5:T5,c=m(_,O),ic){P=0;do{if(ic=!1,oc=0,25<=P)throw Error(r(301));P+=1,mr=rr=null,h.updateQueue=null,Yd.current=P5,c=m(_,O)}while(ic)}if(Yd.current=eh,h=rr!==null&&rr.next!==null,No=0,mr=rr=Mt=null,Jd=!1,h)throw Error(r(300));return c}function Lg(){var c=oc!==0;return oc=0,c}function wa(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?Mt.memoizedState=mr=c:mr=mr.next=c,mr}function jn(){if(rr===null){var c=Mt.alternate;c=c!==null?c.memoizedState:null}else c=rr.next;var h=mr===null?Mt.memoizedState:mr.next;if(h!==null)mr=h,rr=c;else{if(c===null)throw Error(r(310));rr=c,c={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},mr===null?Mt.memoizedState=mr=c:mr=mr.next=c}return mr}function sc(c,h){return typeof h=="function"?h(c):h}function Bg(c){var h=jn(),m=h.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=c;var _=rr,O=_.baseQueue,P=m.pending;if(P!==null){if(O!==null){var M=O.next;O.next=P.next,P.next=M}_.baseQueue=O=P,m.pending=null}if(O!==null){P=O.next,_=_.baseState;var H=M=null,Q=null,ie=P;do{var ve=ie.lane;if((No&ve)===ve)Q!==null&&(Q=Q.next={lane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),_=ie.hasEagerState?ie.eagerState:c(_,ie.action);else{var me={lane:ve,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null};Q===null?(H=Q=me,M=_):Q=Q.next=me,Mt.lanes|=ve,Ro|=ve}ie=ie.next}while(ie!==null&&ie!==P);Q===null?M=_:Q.next=H,Yn(_,h.memoizedState)||(nn=!0),h.memoizedState=_,h.baseState=M,h.baseQueue=Q,m.lastRenderedState=_}if(c=m.interleaved,c!==null){O=c;do P=O.lane,Mt.lanes|=P,Ro|=P,O=O.next;while(O!==c)}else O===null&&(m.lanes=0);return[h.memoizedState,m.dispatch]}function $g(c){var h=jn(),m=h.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=c;var _=m.dispatch,O=m.pending,P=h.memoizedState;if(O!==null){m.pending=null;var M=O=O.next;do P=c(P,M.action),M=M.next;while(M!==O);Yn(P,h.memoizedState)||(nn=!0),h.memoizedState=P,h.baseQueue===null&&(h.baseState=P),m.lastRenderedState=P}return[P,_]}function YC(){}function JC(c,h){var m=Mt,_=jn(),O=h(),P=!Yn(_.memoizedState,O);if(P&&(_.memoizedState=O,nn=!0),_=_.queue,Ug(ek.bind(null,m,_,c),[c]),_.getSnapshot!==h||P||mr!==null&&mr.memoizedState.tag&1){if(m.flags|=2048,uc(9,ZC.bind(null,m,_,O,h),void 0,null),gr===null)throw Error(r(349));(No&30)!==0||QC(m,h,O)}return O}function QC(c,h,m){c.flags|=16384,c={getSnapshot:h,value:m},h=Mt.updateQueue,h===null?(h={lastEffect:null,stores:null},Mt.updateQueue=h,h.stores=[c]):(m=h.stores,m===null?h.stores=[c]:m.push(c))}function ZC(c,h,m,_){h.value=m,h.getSnapshot=_,tk(h)&&rk(c)}function ek(c,h,m){return m(function(){tk(h)&&rk(c)})}function tk(c){var h=c.getSnapshot;c=c.value;try{var m=h();return!Yn(c,m)}catch{return!0}}function rk(c){var h=Xa(c,1);h!==null&&ta(h,c,1,-1)}function nk(c){var h=wa();return typeof c=="function"&&(c=c()),h.memoizedState=h.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:c},h.queue=c,c=c.dispatch=A5.bind(null,Mt,c),[h.memoizedState,c]}function uc(c,h,m,_){return c={tag:c,create:h,destroy:m,deps:_,next:null},h=Mt.updateQueue,h===null?(h={lastEffect:null,stores:null},Mt.updateQueue=h,h.lastEffect=c.next=c):(m=h.lastEffect,m===null?h.lastEffect=c.next=c:(_=m.next,m.next=c,c.next=_,h.lastEffect=c)),c}function ak(){return jn().memoizedState}function Qd(c,h,m,_){var O=wa();Mt.flags|=c,O.memoizedState=uc(1|h,m,void 0,_===void 0?null:_)}function Zd(c,h,m,_){var O=jn();_=_===void 0?null:_;var P=void 0;if(rr!==null){var M=rr.memoizedState;if(P=M.destroy,_!==null&&Mg(_,M.deps)){O.memoizedState=uc(h,m,P,_);return}}Mt.flags|=c,O.memoizedState=uc(1|h,m,P,_)}function ik(c,h){return Qd(8390656,8,c,h)}function Ug(c,h){return Zd(2048,8,c,h)}function ok(c,h){return Zd(4,2,c,h)}function sk(c,h){return Zd(4,4,c,h)}function uk(c,h){if(typeof h=="function")return c=c(),h(c),function(){h(null)};if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function lk(c,h,m){return m=m!=null?m.concat([c]):null,Zd(4,4,uk.bind(null,h,c),m)}function Wg(){}function ck(c,h){var m=jn();h=h===void 0?null:h;var _=m.memoizedState;return _!==null&&h!==null&&Mg(h,_[1])?_[0]:(m.memoizedState=[c,h],c)}function fk(c,h){var m=jn();h=h===void 0?null:h;var _=m.memoizedState;return _!==null&&h!==null&&Mg(h,_[1])?_[0]:(c=c(),m.memoizedState=[c,h],c)}function dk(c,h,m){return(No&21)===0?(c.baseState&&(c.baseState=!1,nn=!0),c.memoizedState=m):(Yn(m,h)||(m=WE(),Mt.lanes|=m,Ro|=m,c.baseState=!0),h)}function C5(c,h){var m=gt;gt=m!==0&&4>m?m:4,c(!0);var _=Dg.transition;Dg.transition={};try{c(!1),h()}finally{gt=m,Dg.transition=_}}function hk(){return jn().memoizedState}function k5(c,h,m){var _=$i(c);if(m={lane:_,action:m,hasEagerState:!1,eagerState:null,next:null},pk(c))vk(h,m);else if(m=VC(c,h,m,_),m!==null){var O=Qr();ta(m,c,_,O),mk(m,h,_)}}function A5(c,h,m){var _=$i(c),O={lane:_,action:m,hasEagerState:!1,eagerState:null,next:null};if(pk(c))vk(h,O);else{var P=c.alternate;if(c.lanes===0&&(P===null||P.lanes===0)&&(P=h.lastRenderedReducer,P!==null))try{var M=h.lastRenderedState,H=P(M,m);if(O.hasEagerState=!0,O.eagerState=H,Yn(H,M)){var Q=h.interleaved;Q===null?(O.next=O,Tg(h)):(O.next=Q.next,Q.next=O),h.interleaved=O;return}}catch{}m=VC(c,h,O,_),m!==null&&(O=Qr(),ta(m,c,_,O),mk(m,h,_))}}function pk(c){var h=c.alternate;return c===Mt||h!==null&&h===Mt}function vk(c,h){ic=Jd=!0;var m=c.pending;m===null?h.next=h:(h.next=m.next,m.next=h),c.pending=h}function mk(c,h,m){if((m&4194240)!==0){var _=h.lanes;_&=c.pendingLanes,m|=_,h.lanes=m,qm(c,m)}}var eh={readContext:In,useCallback:Lr,useContext:Lr,useEffect:Lr,useImperativeHandle:Lr,useInsertionEffect:Lr,useLayoutEffect:Lr,useMemo:Lr,useReducer:Lr,useRef:Lr,useState:Lr,useDebugValue:Lr,useDeferredValue:Lr,useTransition:Lr,useMutableSource:Lr,useSyncExternalStore:Lr,useId:Lr,unstable_isNewReconciler:!1},O5={readContext:In,useCallback:function(c,h){return wa().memoizedState=[c,h===void 0?null:h],c},useContext:In,useEffect:ik,useImperativeHandle:function(c,h,m){return m=m!=null?m.concat([c]):null,Qd(4194308,4,uk.bind(null,h,c),m)},useLayoutEffect:function(c,h){return Qd(4194308,4,c,h)},useInsertionEffect:function(c,h){return Qd(4,2,c,h)},useMemo:function(c,h){var m=wa();return h=h===void 0?null:h,c=c(),m.memoizedState=[c,h],c},useReducer:function(c,h,m){var _=wa();return h=m!==void 0?m(h):h,_.memoizedState=_.baseState=h,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:h},_.queue=c,c=c.dispatch=k5.bind(null,Mt,c),[_.memoizedState,c]},useRef:function(c){var h=wa();return c={current:c},h.memoizedState=c},useState:nk,useDebugValue:Wg,useDeferredValue:function(c){return wa().memoizedState=c},useTransition:function(){var c=nk(!1),h=c[0];return c=C5.bind(null,c[1]),wa().memoizedState=c,[h,c]},useMutableSource:function(){},useSyncExternalStore:function(c,h,m){var _=Mt,O=wa();if(Rt){if(m===void 0)throw Error(r(407));m=m()}else{if(m=h(),gr===null)throw Error(r(349));(No&30)!==0||QC(_,h,m)}O.memoizedState=m;var P={value:m,getSnapshot:h};return O.queue=P,ik(ek.bind(null,_,P,c),[c]),_.flags|=2048,uc(9,ZC.bind(null,_,P,m,h),void 0,null),m},useId:function(){var c=wa(),h=gr.identifierPrefix;if(Rt){var m=Ka,_=Ga;m=(_&~(1<<32-Xn(_)-1)).toString(32)+m,h=":"+h+"R"+m,m=oc++,0<m&&(h+="H"+m.toString(32)),h+=":"}else m=E5++,h=":"+h+"r"+m.toString(32)+":";return c.memoizedState=h},unstable_isNewReconciler:!1},T5={readContext:In,useCallback:ck,useContext:In,useEffect:Ug,useImperativeHandle:lk,useInsertionEffect:ok,useLayoutEffect:sk,useMemo:fk,useReducer:Bg,useRef:ak,useState:function(){return Bg(sc)},useDebugValue:Wg,useDeferredValue:function(c){var h=jn();return dk(h,rr.memoizedState,c)},useTransition:function(){var c=Bg(sc)[0],h=jn().memoizedState;return[c,h]},useMutableSource:YC,useSyncExternalStore:JC,useId:hk,unstable_isNewReconciler:!1},P5={readContext:In,useCallback:ck,useContext:In,useEffect:Ug,useImperativeHandle:lk,useInsertionEffect:ok,useLayoutEffect:sk,useMemo:fk,useReducer:$g,useRef:ak,useState:function(){return $g(sc)},useDebugValue:Wg,useDeferredValue:function(c){var h=jn();return rr===null?h.memoizedState=c:dk(h,rr.memoizedState,c)},useTransition:function(){var c=$g(sc)[0],h=jn().memoizedState;return[c,h]},useMutableSource:YC,useSyncExternalStore:JC,useId:hk,unstable_isNewReconciler:!1};function Qn(c,h){if(c&&c.defaultProps){h=G({},h),c=c.defaultProps;for(var m in c)h[m]===void 0&&(h[m]=c[m]);return h}return h}function zg(c,h,m,_){h=c.memoizedState,m=m(_,h),m=m==null?h:G({},h,m),c.memoizedState=m,c.lanes===0&&(c.updateQueue.baseState=m)}var th={isMounted:function(c){return(c=c._reactInternals)?Eo(c)===c:!1},enqueueSetState:function(c,h,m){c=c._reactInternals;var _=Qr(),O=$i(c),P=Ya(_,O);P.payload=h,m!=null&&(P.callback=m),h=Mi(c,P,O),h!==null&&(ta(h,c,O,_),Gd(h,c,O))},enqueueReplaceState:function(c,h,m){c=c._reactInternals;var _=Qr(),O=$i(c),P=Ya(_,O);P.tag=1,P.payload=h,m!=null&&(P.callback=m),h=Mi(c,P,O),h!==null&&(ta(h,c,O,_),Gd(h,c,O))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var m=Qr(),_=$i(c),O=Ya(m,_);O.tag=2,h!=null&&(O.callback=h),h=Mi(c,O,_),h!==null&&(ta(h,c,_,m),Gd(h,c,_))}};function gk(c,h,m,_,O,P,M){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(_,P,M):h.prototype&&h.prototype.isPureReactComponent?!Kl(m,_)||!Kl(O,P):!0}function yk(c,h,m){var _=!1,O=Ii,P=h.contextType;return typeof P=="object"&&P!==null?P=In(P):(O=rn(h)?ko:Fr.current,_=h.contextTypes,P=(_=_!=null)?$s(c,O):Ii),h=new h(m,P),c.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=th,c.stateNode=h,h._reactInternals=c,_&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=O,c.__reactInternalMemoizedMaskedChildContext=P),h}function bk(c,h,m,_){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(m,_),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(m,_),h.state!==c&&th.enqueueReplaceState(h,h.state,null)}function qg(c,h,m,_){var O=c.stateNode;O.props=m,O.state=c.memoizedState,O.refs={},Pg(c);var P=h.contextType;typeof P=="object"&&P!==null?O.context=In(P):(P=rn(h)?ko:Fr.current,O.context=$s(c,P)),O.state=c.memoizedState,P=h.getDerivedStateFromProps,typeof P=="function"&&(zg(c,h,P,m),O.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof O.getSnapshotBeforeUpdate=="function"||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(h=O.state,typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount(),h!==O.state&&th.enqueueReplaceState(O,O.state,null),Kd(c,m,O,_),O.state=c.memoizedState),typeof O.componentDidMount=="function"&&(c.flags|=4194308)}function Ks(c,h){try{var m="",_=h;do m+=ge(_),_=_.return;while(_);var O=m}catch(P){O=`
Error generating stack: `+P.message+`
`+P.stack}return{value:c,source:h,stack:O,digest:null}}function Vg(c,h,m){return{value:c,source:null,stack:m??null,digest:h??null}}function Hg(c,h){try{console.error(h.value)}catch(m){setTimeout(function(){throw m})}}var N5=typeof WeakMap=="function"?WeakMap:Map;function xk(c,h,m){m=Ya(-1,m),m.tag=3,m.payload={element:null};var _=h.value;return m.callback=function(){uh||(uh=!0,sy=_),Hg(c,h)},m}function wk(c,h,m){m=Ya(-1,m),m.tag=3;var _=c.type.getDerivedStateFromError;if(typeof _=="function"){var O=h.value;m.payload=function(){return _(O)},m.callback=function(){Hg(c,h)}}var P=c.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(m.callback=function(){Hg(c,h),typeof _!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var M=h.stack;this.componentDidCatch(h.value,{componentStack:M!==null?M:""})}),m}function _k(c,h,m){var _=c.pingCache;if(_===null){_=c.pingCache=new N5;var O=new Set;_.set(h,O)}else O=_.get(h),O===void 0&&(O=new Set,_.set(h,O));O.has(m)||(O.add(m),c=V5.bind(null,c,h,m),h.then(c,c))}function Sk(c){do{var h;if((h=c.tag===13)&&(h=c.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return c;c=c.return}while(c!==null);return null}function Ek(c,h,m,_,O){return(c.mode&1)===0?(c===h?c.flags|=65536:(c.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(h=Ya(-1,1),h.tag=2,Mi(m,h,1))),m.lanes|=1),c):(c.flags|=65536,c.lanes=O,c)}var R5=C.ReactCurrentOwner,nn=!1;function Jr(c,h,m,_){h.child=c===null?qC(h,null,m,_):qs(h,c.child,m,_)}function Ck(c,h,m,_,O){m=m.render;var P=h.ref;return Hs(h,O),_=Fg(c,h,m,_,P,O),m=Lg(),c!==null&&!nn?(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~O,Ja(c,h,O)):(Rt&&m&&xg(h),h.flags|=1,Jr(c,h,_,O),h.child)}function kk(c,h,m,_,O){if(c===null){var P=m.type;return typeof P=="function"&&!py(P)&&P.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(h.tag=15,h.type=P,Ak(c,h,P,_,O)):(c=ph(m.type,null,_,h,h.mode,O),c.ref=h.ref,c.return=h,h.child=c)}if(P=c.child,(c.lanes&O)===0){var M=P.memoizedProps;if(m=m.compare,m=m!==null?m:Kl,m(M,_)&&c.ref===h.ref)return Ja(c,h,O)}return h.flags|=1,c=Wi(P,_),c.ref=h.ref,c.return=h,h.child=c}function Ak(c,h,m,_,O){if(c!==null){var P=c.memoizedProps;if(Kl(P,_)&&c.ref===h.ref)if(nn=!1,h.pendingProps=_=P,(c.lanes&O)!==0)(c.flags&131072)!==0&&(nn=!0);else return h.lanes=c.lanes,Ja(c,h,O)}return Gg(c,h,m,_,O)}function Ok(c,h,m){var _=h.pendingProps,O=_.children,P=c!==null?c.memoizedState:null;if(_.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(Ys,yn),yn|=m;else{if((m&1073741824)===0)return c=P!==null?P.baseLanes|m:m,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:c,cachePool:null,transitions:null},h.updateQueue=null,wt(Ys,yn),yn|=c,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=P!==null?P.baseLanes:m,wt(Ys,yn),yn|=_}else P!==null?(_=P.baseLanes|m,h.memoizedState=null):_=m,wt(Ys,yn),yn|=_;return Jr(c,h,O,m),h.child}function Tk(c,h){var m=h.ref;(c===null&&m!==null||c!==null&&c.ref!==m)&&(h.flags|=512,h.flags|=2097152)}function Gg(c,h,m,_,O){var P=rn(m)?ko:Fr.current;return P=$s(h,P),Hs(h,O),m=Fg(c,h,m,_,P,O),_=Lg(),c!==null&&!nn?(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~O,Ja(c,h,O)):(Rt&&_&&xg(h),h.flags|=1,Jr(c,h,m,O),h.child)}function Pk(c,h,m,_,O){if(rn(m)){var P=!0;Bd(h)}else P=!1;if(Hs(h,O),h.stateNode===null)nh(c,h),yk(h,m,_),qg(h,m,_,O),_=!0;else if(c===null){var M=h.stateNode,H=h.memoizedProps;M.props=H;var Q=M.context,ie=m.contextType;typeof ie=="object"&&ie!==null?ie=In(ie):(ie=rn(m)?ko:Fr.current,ie=$s(h,ie));var ve=m.getDerivedStateFromProps,me=typeof ve=="function"||typeof M.getSnapshotBeforeUpdate=="function";me||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(H!==_||Q!==ie)&&bk(h,M,_,ie),Di=!1;var pe=h.memoizedState;M.state=pe,Kd(h,_,M,O),Q=h.memoizedState,H!==_||pe!==Q||tn.current||Di?(typeof ve=="function"&&(zg(h,m,ve,_),Q=h.memoizedState),(H=Di||gk(h,m,H,_,pe,Q,ie))?(me||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(h.flags|=4194308)):(typeof M.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=_,h.memoizedState=Q),M.props=_,M.state=Q,M.context=ie,_=H):(typeof M.componentDidMount=="function"&&(h.flags|=4194308),_=!1)}else{M=h.stateNode,HC(c,h),H=h.memoizedProps,ie=h.type===h.elementType?H:Qn(h.type,H),M.props=ie,me=h.pendingProps,pe=M.context,Q=m.contextType,typeof Q=="object"&&Q!==null?Q=In(Q):(Q=rn(m)?ko:Fr.current,Q=$s(h,Q));var Ce=m.getDerivedStateFromProps;(ve=typeof Ce=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(H!==me||pe!==Q)&&bk(h,M,_,Q),Di=!1,pe=h.memoizedState,M.state=pe,Kd(h,_,M,O);var Pe=h.memoizedState;H!==me||pe!==Pe||tn.current||Di?(typeof Ce=="function"&&(zg(h,m,Ce,_),Pe=h.memoizedState),(ie=Di||gk(h,m,ie,_,pe,Pe,Q)||!1)?(ve||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(_,Pe,Q),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(_,Pe,Q)),typeof M.componentDidUpdate=="function"&&(h.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof M.componentDidUpdate!="function"||H===c.memoizedProps&&pe===c.memoizedState||(h.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||H===c.memoizedProps&&pe===c.memoizedState||(h.flags|=1024),h.memoizedProps=_,h.memoizedState=Pe),M.props=_,M.state=Pe,M.context=Q,_=ie):(typeof M.componentDidUpdate!="function"||H===c.memoizedProps&&pe===c.memoizedState||(h.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||H===c.memoizedProps&&pe===c.memoizedState||(h.flags|=1024),_=!1)}return Kg(c,h,m,_,P,O)}function Kg(c,h,m,_,O,P){Tk(c,h);var M=(h.flags&128)!==0;if(!_&&!M)return O&&DC(h,m,!1),Ja(c,h,P);_=h.stateNode,R5.current=h;var H=M&&typeof m.getDerivedStateFromError!="function"?null:_.render();return h.flags|=1,c!==null&&M?(h.child=qs(h,c.child,null,P),h.child=qs(h,null,H,P)):Jr(c,h,H,P),h.memoizedState=_.state,O&&DC(h,m,!0),h.child}function Nk(c){var h=c.stateNode;h.pendingContext?IC(c,h.pendingContext,h.pendingContext!==h.context):h.context&&IC(c,h.context,!1),Ng(c,h.containerInfo)}function Rk(c,h,m,_,O){return zs(),Eg(O),h.flags|=256,Jr(c,h,m,_),h.child}var Xg={dehydrated:null,treeContext:null,retryLane:0};function Yg(c){return{baseLanes:c,cachePool:null,transitions:null}}function Ik(c,h,m){var _=h.pendingProps,O=Dt.current,P=!1,M=(h.flags&128)!==0,H;if((H=M)||(H=c!==null&&c.memoizedState===null?!1:(O&2)!==0),H?(P=!0,h.flags&=-129):(c===null||c.memoizedState!==null)&&(O|=1),wt(Dt,O&1),c===null)return Sg(h),c=h.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((h.mode&1)===0?h.lanes=1:c.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(M=_.children,c=_.fallback,P?(_=h.mode,P=h.child,M={mode:"hidden",children:M},(_&1)===0&&P!==null?(P.childLanes=0,P.pendingProps=M):P=vh(M,_,0,null),c=Mo(c,_,m,null),P.return=h,c.return=h,P.sibling=c,h.child=P,h.child.memoizedState=Yg(m),h.memoizedState=Xg,c):Jg(h,M));if(O=c.memoizedState,O!==null&&(H=O.dehydrated,H!==null))return I5(c,h,M,_,H,O,m);if(P){P=_.fallback,M=h.mode,O=c.child,H=O.sibling;var Q={mode:"hidden",children:_.children};return(M&1)===0&&h.child!==O?(_=h.child,_.childLanes=0,_.pendingProps=Q,h.deletions=null):(_=Wi(O,Q),_.subtreeFlags=O.subtreeFlags&14680064),H!==null?P=Wi(H,P):(P=Mo(P,M,m,null),P.flags|=2),P.return=h,_.return=h,_.sibling=P,h.child=_,_=P,P=h.child,M=c.child.memoizedState,M=M===null?Yg(m):{baseLanes:M.baseLanes|m,cachePool:null,transitions:M.transitions},P.memoizedState=M,P.childLanes=c.childLanes&~m,h.memoizedState=Xg,_}return P=c.child,c=P.sibling,_=Wi(P,{mode:"visible",children:_.children}),(h.mode&1)===0&&(_.lanes=m),_.return=h,_.sibling=null,c!==null&&(m=h.deletions,m===null?(h.deletions=[c],h.flags|=16):m.push(c)),h.child=_,h.memoizedState=null,_}function Jg(c,h){return h=vh({mode:"visible",children:h},c.mode,0,null),h.return=c,c.child=h}function rh(c,h,m,_){return _!==null&&Eg(_),qs(h,c.child,null,m),c=Jg(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function I5(c,h,m,_,O,P,M){if(m)return h.flags&256?(h.flags&=-257,_=Vg(Error(r(422))),rh(c,h,M,_)):h.memoizedState!==null?(h.child=c.child,h.flags|=128,null):(P=_.fallback,O=h.mode,_=vh({mode:"visible",children:_.children},O,0,null),P=Mo(P,O,M,null),P.flags|=2,_.return=h,P.return=h,_.sibling=P,h.child=_,(h.mode&1)!==0&&qs(h,c.child,null,M),h.child.memoizedState=Yg(M),h.memoizedState=Xg,P);if((h.mode&1)===0)return rh(c,h,M,null);if(O.data==="$!"){if(_=O.nextSibling&&O.nextSibling.dataset,_)var H=_.dgst;return _=H,P=Error(r(419)),_=Vg(P,_,void 0),rh(c,h,M,_)}if(H=(M&c.childLanes)!==0,nn||H){if(_=gr,_!==null){switch(M&-M){case 4:O=2;break;case 16:O=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:O=32;break;case 536870912:O=268435456;break;default:O=0}O=(O&(_.suspendedLanes|M))!==0?0:O,O!==0&&O!==P.retryLane&&(P.retryLane=O,Xa(c,O),ta(_,c,O,-1))}return hy(),_=Vg(Error(r(421))),rh(c,h,M,_)}return O.data==="$?"?(h.flags|=128,h.child=c.child,h=H5.bind(null,c),O._reactRetry=h,null):(c=P.treeContext,gn=Ni(O.nextSibling),mn=h,Rt=!0,Jn=null,c!==null&&(Nn[Rn++]=Ga,Nn[Rn++]=Ka,Nn[Rn++]=Ao,Ga=c.id,Ka=c.overflow,Ao=h),h=Jg(h,_.children),h.flags|=4096,h)}function jk(c,h,m){c.lanes|=h;var _=c.alternate;_!==null&&(_.lanes|=h),Og(c.return,h,m)}function Qg(c,h,m,_,O){var P=c.memoizedState;P===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:_,tail:m,tailMode:O}:(P.isBackwards=h,P.rendering=null,P.renderingStartTime=0,P.last=_,P.tail=m,P.tailMode=O)}function Dk(c,h,m){var _=h.pendingProps,O=_.revealOrder,P=_.tail;if(Jr(c,h,_.children,m),_=Dt.current,(_&2)!==0)_=_&1|2,h.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&jk(c,m,h);else if(c.tag===19)jk(c,m,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}_&=1}if(wt(Dt,_),(h.mode&1)===0)h.memoizedState=null;else switch(O){case"forwards":for(m=h.child,O=null;m!==null;)c=m.alternate,c!==null&&Xd(c)===null&&(O=m),m=m.sibling;m=O,m===null?(O=h.child,h.child=null):(O=m.sibling,m.sibling=null),Qg(h,!1,O,m,P);break;case"backwards":for(m=null,O=h.child,h.child=null;O!==null;){if(c=O.alternate,c!==null&&Xd(c)===null){h.child=O;break}c=O.sibling,O.sibling=m,m=O,O=c}Qg(h,!0,m,null,P);break;case"together":Qg(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function nh(c,h){(h.mode&1)===0&&c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2)}function Ja(c,h,m){if(c!==null&&(h.dependencies=c.dependencies),Ro|=h.lanes,(m&h.childLanes)===0)return null;if(c!==null&&h.child!==c.child)throw Error(r(153));if(h.child!==null){for(c=h.child,m=Wi(c,c.pendingProps),h.child=m,m.return=h;c.sibling!==null;)c=c.sibling,m=m.sibling=Wi(c,c.pendingProps),m.return=h;m.sibling=null}return h.child}function j5(c,h,m){switch(h.tag){case 3:Nk(h),zs();break;case 5:XC(h);break;case 1:rn(h.type)&&Bd(h);break;case 4:Ng(h,h.stateNode.containerInfo);break;case 10:var _=h.type._context,O=h.memoizedProps.value;wt(Vd,_._currentValue),_._currentValue=O;break;case 13:if(_=h.memoizedState,_!==null)return _.dehydrated!==null?(wt(Dt,Dt.current&1),h.flags|=128,null):(m&h.child.childLanes)!==0?Ik(c,h,m):(wt(Dt,Dt.current&1),c=Ja(c,h,m),c!==null?c.sibling:null);wt(Dt,Dt.current&1);break;case 19:if(_=(m&h.childLanes)!==0,(c.flags&128)!==0){if(_)return Dk(c,h,m);h.flags|=128}if(O=h.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),wt(Dt,Dt.current),_)break;return null;case 22:case 23:return h.lanes=0,Ok(c,h,m)}return Ja(c,h,m)}var Mk,Zg,Fk,Lk;Mk=function(c,h){for(var m=h.child;m!==null;){if(m.tag===5||m.tag===6)c.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},Zg=function(){},Fk=function(c,h,m,_){var O=c.memoizedProps;if(O!==_){c=h.stateNode,Po(xa.current);var P=null;switch(m){case"input":O=Fe(c,O),_=Fe(c,_),P=[];break;case"select":O=G({},O,{value:void 0}),_=G({},_,{value:void 0}),P=[];break;case"textarea":O=Yt(c,O),_=Yt(c,_),P=[];break;default:typeof O.onClick!="function"&&typeof _.onClick=="function"&&(c.onclick=Md)}Im(m,_);var M;m=null;for(ie in O)if(!_.hasOwnProperty(ie)&&O.hasOwnProperty(ie)&&O[ie]!=null)if(ie==="style"){var H=O[ie];for(M in H)H.hasOwnProperty(M)&&(m||(m={}),m[M]="")}else ie!=="dangerouslySetInnerHTML"&&ie!=="children"&&ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&ie!=="autoFocus"&&(a.hasOwnProperty(ie)?P||(P=[]):(P=P||[]).push(ie,null));for(ie in _){var Q=_[ie];if(H=O?.[ie],_.hasOwnProperty(ie)&&Q!==H&&(Q!=null||H!=null))if(ie==="style")if(H){for(M in H)!H.hasOwnProperty(M)||Q&&Q.hasOwnProperty(M)||(m||(m={}),m[M]="");for(M in Q)Q.hasOwnProperty(M)&&H[M]!==Q[M]&&(m||(m={}),m[M]=Q[M])}else m||(P||(P=[]),P.push(ie,m)),m=Q;else ie==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,H=H?H.__html:void 0,Q!=null&&H!==Q&&(P=P||[]).push(ie,Q)):ie==="children"?typeof Q!="string"&&typeof Q!="number"||(P=P||[]).push(ie,""+Q):ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&(a.hasOwnProperty(ie)?(Q!=null&&ie==="onScroll"&&kt("scroll",c),P||H===Q||(P=[])):(P=P||[]).push(ie,Q))}m&&(P=P||[]).push("style",m);var ie=P;(h.updateQueue=ie)&&(h.flags|=4)}},Lk=function(c,h,m,_){m!==_&&(h.flags|=4)};function lc(c,h){if(!Rt)switch(c.tailMode){case"hidden":h=c.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?c.tail=null:m.sibling=null;break;case"collapsed":m=c.tail;for(var _=null;m!==null;)m.alternate!==null&&(_=m),m=m.sibling;_===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:_.sibling=null}}function Br(c){var h=c.alternate!==null&&c.alternate.child===c.child,m=0,_=0;if(h)for(var O=c.child;O!==null;)m|=O.lanes|O.childLanes,_|=O.subtreeFlags&14680064,_|=O.flags&14680064,O.return=c,O=O.sibling;else for(O=c.child;O!==null;)m|=O.lanes|O.childLanes,_|=O.subtreeFlags,_|=O.flags,O.return=c,O=O.sibling;return c.subtreeFlags|=_,c.childLanes=m,h}function D5(c,h,m){var _=h.pendingProps;switch(wg(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Br(h),null;case 1:return rn(h.type)&&Ld(),Br(h),null;case 3:return _=h.stateNode,Gs(),At(tn),At(Fr),jg(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(c===null||c.child===null)&&(zd(h)?h.flags|=4:c===null||c.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Jn!==null&&(cy(Jn),Jn=null))),Zg(c,h),Br(h),null;case 5:Rg(h);var O=Po(ac.current);if(m=h.type,c!==null&&h.stateNode!=null)Fk(c,h,m,_,O),c.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!_){if(h.stateNode===null)throw Error(r(166));return Br(h),null}if(c=Po(xa.current),zd(h)){_=h.stateNode,m=h.type;var P=h.memoizedProps;switch(_[ba]=h,_[Zl]=P,c=(h.mode&1)!==0,m){case"dialog":kt("cancel",_),kt("close",_);break;case"iframe":case"object":case"embed":kt("load",_);break;case"video":case"audio":for(O=0;O<Yl.length;O++)kt(Yl[O],_);break;case"source":kt("error",_);break;case"img":case"image":case"link":kt("error",_),kt("load",_);break;case"details":kt("toggle",_);break;case"input":Xe(_,P),kt("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!P.multiple},kt("invalid",_);break;case"textarea":Mr(_,P),kt("invalid",_)}Im(m,P),O=null;for(var M in P)if(P.hasOwnProperty(M)){var H=P[M];M==="children"?typeof H=="string"?_.textContent!==H&&(P.suppressHydrationWarning!==!0&&Dd(_.textContent,H,c),O=["children",H]):typeof H=="number"&&_.textContent!==""+H&&(P.suppressHydrationWarning!==!0&&Dd(_.textContent,H,c),O=["children",""+H]):a.hasOwnProperty(M)&&H!=null&&M==="onScroll"&&kt("scroll",_)}switch(m){case"input":_e(_),Ut(_,P,!0);break;case"textarea":_e(_),Xr(_);break;case"select":case"option":break;default:typeof P.onClick=="function"&&(_.onclick=Md)}_=O,h.updateQueue=_,_!==null&&(h.flags|=4)}else{M=O.nodeType===9?O:O.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Cs(m)),c==="http://www.w3.org/1999/xhtml"?m==="script"?(c=M.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof _.is=="string"?c=M.createElement(m,{is:_.is}):(c=M.createElement(m),m==="select"&&(M=c,_.multiple?M.multiple=!0:_.size&&(M.size=_.size))):c=M.createElementNS(c,m),c[ba]=h,c[Zl]=_,Mk(c,h,!1,!1),h.stateNode=c;e:{switch(M=jm(m,_),m){case"dialog":kt("cancel",c),kt("close",c),O=_;break;case"iframe":case"object":case"embed":kt("load",c),O=_;break;case"video":case"audio":for(O=0;O<Yl.length;O++)kt(Yl[O],c);O=_;break;case"source":kt("error",c),O=_;break;case"img":case"image":case"link":kt("error",c),kt("load",c),O=_;break;case"details":kt("toggle",c),O=_;break;case"input":Xe(c,_),O=Fe(c,_),kt("invalid",c);break;case"option":O=_;break;case"select":c._wrapperState={wasMultiple:!!_.multiple},O=G({},_,{value:void 0}),kt("invalid",c);break;case"textarea":Mr(c,_),O=Yt(c,_),kt("invalid",c);break;default:O=_}Im(m,O),H=O;for(P in H)if(H.hasOwnProperty(P)){var Q=H[P];P==="style"?Os(c,Q):P==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&ks(c,Q)):P==="children"?typeof Q=="string"?(m!=="textarea"||Q!=="")&&_o(c,Q):typeof Q=="number"&&_o(c,""+Q):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(a.hasOwnProperty(P)?Q!=null&&P==="onScroll"&&kt("scroll",c):Q!=null&&E(c,P,Q,M))}switch(m){case"input":_e(c),Ut(c,_,!1);break;case"textarea":_e(c),Xr(c);break;case"option":_.value!=null&&c.setAttribute("value",""+we(_.value));break;case"select":c.multiple=!!_.multiple,P=_.value,P!=null?Nt(c,!!_.multiple,P,!1):_.defaultValue!=null&&Nt(c,!!_.multiple,_.defaultValue,!0);break;default:typeof O.onClick=="function"&&(c.onclick=Md)}switch(m){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Br(h),null;case 6:if(c&&h.stateNode!=null)Lk(c,h,c.memoizedProps,_);else{if(typeof _!="string"&&h.stateNode===null)throw Error(r(166));if(m=Po(ac.current),Po(xa.current),zd(h)){if(_=h.stateNode,m=h.memoizedProps,_[ba]=h,(P=_.nodeValue!==m)&&(c=mn,c!==null))switch(c.tag){case 3:Dd(_.nodeValue,m,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Dd(_.nodeValue,m,(c.mode&1)!==0)}P&&(h.flags|=4)}else _=(m.nodeType===9?m:m.ownerDocument).createTextNode(_),_[ba]=h,h.stateNode=_}return Br(h),null;case 13:if(At(Dt),_=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Rt&&gn!==null&&(h.mode&1)!==0&&(h.flags&128)===0)UC(),zs(),h.flags|=98560,P=!1;else if(P=zd(h),_!==null&&_.dehydrated!==null){if(c===null){if(!P)throw Error(r(318));if(P=h.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(r(317));P[ba]=h}else zs(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Br(h),P=!1}else Jn!==null&&(cy(Jn),Jn=null),P=!0;if(!P)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=m,h):(_=_!==null,_!==(c!==null&&c.memoizedState!==null)&&_&&(h.child.flags|=8192,(h.mode&1)!==0&&(c===null||(Dt.current&1)!==0?nr===0&&(nr=3):hy())),h.updateQueue!==null&&(h.flags|=4),Br(h),null);case 4:return Gs(),Zg(c,h),c===null&&Jl(h.stateNode.containerInfo),Br(h),null;case 10:return Ag(h.type._context),Br(h),null;case 17:return rn(h.type)&&Ld(),Br(h),null;case 19:if(At(Dt),P=h.memoizedState,P===null)return Br(h),null;if(_=(h.flags&128)!==0,M=P.rendering,M===null)if(_)lc(P,!1);else{if(nr!==0||c!==null&&(c.flags&128)!==0)for(c=h.child;c!==null;){if(M=Xd(c),M!==null){for(h.flags|=128,lc(P,!1),_=M.updateQueue,_!==null&&(h.updateQueue=_,h.flags|=4),h.subtreeFlags=0,_=m,m=h.child;m!==null;)P=m,c=_,P.flags&=14680066,M=P.alternate,M===null?(P.childLanes=0,P.lanes=c,P.child=null,P.subtreeFlags=0,P.memoizedProps=null,P.memoizedState=null,P.updateQueue=null,P.dependencies=null,P.stateNode=null):(P.childLanes=M.childLanes,P.lanes=M.lanes,P.child=M.child,P.subtreeFlags=0,P.deletions=null,P.memoizedProps=M.memoizedProps,P.memoizedState=M.memoizedState,P.updateQueue=M.updateQueue,P.type=M.type,c=M.dependencies,P.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),m=m.sibling;return wt(Dt,Dt.current&1|2),h.child}c=c.sibling}P.tail!==null&&Gt()>Js&&(h.flags|=128,_=!0,lc(P,!1),h.lanes=4194304)}else{if(!_)if(c=Xd(M),c!==null){if(h.flags|=128,_=!0,m=c.updateQueue,m!==null&&(h.updateQueue=m,h.flags|=4),lc(P,!0),P.tail===null&&P.tailMode==="hidden"&&!M.alternate&&!Rt)return Br(h),null}else 2*Gt()-P.renderingStartTime>Js&&m!==1073741824&&(h.flags|=128,_=!0,lc(P,!1),h.lanes=4194304);P.isBackwards?(M.sibling=h.child,h.child=M):(m=P.last,m!==null?m.sibling=M:h.child=M,P.last=M)}return P.tail!==null?(h=P.tail,P.rendering=h,P.tail=h.sibling,P.renderingStartTime=Gt(),h.sibling=null,m=Dt.current,wt(Dt,_?m&1|2:m&1),h):(Br(h),null);case 22:case 23:return dy(),_=h.memoizedState!==null,c!==null&&c.memoizedState!==null!==_&&(h.flags|=8192),_&&(h.mode&1)!==0?(yn&1073741824)!==0&&(Br(h),h.subtreeFlags&6&&(h.flags|=8192)):Br(h),null;case 24:return null;case 25:return null}throw Error(r(156,h.tag))}function M5(c,h){switch(wg(h),h.tag){case 1:return rn(h.type)&&Ld(),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return Gs(),At(tn),At(Fr),jg(),c=h.flags,(c&65536)!==0&&(c&128)===0?(h.flags=c&-65537|128,h):null;case 5:return Rg(h),null;case 13:if(At(Dt),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(r(340));zs()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return At(Dt),null;case 4:return Gs(),null;case 10:return Ag(h.type._context),null;case 22:case 23:return dy(),null;case 24:return null;default:return null}}var ah=!1,$r=!1,F5=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function Xs(c,h){var m=c.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(_){Wt(c,h,_)}else m.current=null}function ey(c,h,m){try{m()}catch(_){Wt(c,h,_)}}var Bk=!1;function L5(c,h){if(dg=Ed,c=gC(),ag(c)){if("selectionStart"in c)var m={start:c.selectionStart,end:c.selectionEnd};else e:{m=(m=c.ownerDocument)&&m.defaultView||window;var _=m.getSelection&&m.getSelection();if(_&&_.rangeCount!==0){m=_.anchorNode;var O=_.anchorOffset,P=_.focusNode;_=_.focusOffset;try{m.nodeType,P.nodeType}catch{m=null;break e}var M=0,H=-1,Q=-1,ie=0,ve=0,me=c,pe=null;t:for(;;){for(var Ce;me!==m||O!==0&&me.nodeType!==3||(H=M+O),me!==P||_!==0&&me.nodeType!==3||(Q=M+_),me.nodeType===3&&(M+=me.nodeValue.length),(Ce=me.firstChild)!==null;)pe=me,me=Ce;for(;;){if(me===c)break t;if(pe===m&&++ie===O&&(H=M),pe===P&&++ve===_&&(Q=M),(Ce=me.nextSibling)!==null)break;me=pe,pe=me.parentNode}me=Ce}m=H===-1||Q===-1?null:{start:H,end:Q}}else m=null}m=m||{start:0,end:0}}else m=null;for(hg={focusedElem:c,selectionRange:m},Ed=!1,Oe=h;Oe!==null;)if(h=Oe,c=h.child,(h.subtreeFlags&1028)!==0&&c!==null)c.return=h,Oe=c;else for(;Oe!==null;){h=Oe;try{var Pe=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(Pe!==null){var Ie=Pe.memoizedProps,Kt=Pe.memoizedState,re=h.stateNode,te=re.getSnapshotBeforeUpdate(h.elementType===h.type?Ie:Qn(h.type,Ie),Kt);re.__reactInternalSnapshotBeforeUpdate=te}break;case 3:var ne=h.stateNode.containerInfo;ne.nodeType===1?ne.textContent="":ne.nodeType===9&&ne.documentElement&&ne.removeChild(ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(ye){Wt(h,h.return,ye)}if(c=h.sibling,c!==null){c.return=h.return,Oe=c;break}Oe=h.return}return Pe=Bk,Bk=!1,Pe}function cc(c,h,m){var _=h.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var O=_=_.next;do{if((O.tag&c)===c){var P=O.destroy;O.destroy=void 0,P!==void 0&&ey(h,m,P)}O=O.next}while(O!==_)}}function ih(c,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&c)===c){var _=m.create;m.destroy=_()}m=m.next}while(m!==h)}}function ty(c){var h=c.ref;if(h!==null){var m=c.stateNode;c.tag,c=m,typeof h=="function"?h(c):h.current=c}}function $k(c){var h=c.alternate;h!==null&&(c.alternate=null,$k(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&(delete h[ba],delete h[Zl],delete h[gg],delete h[x5],delete h[w5])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function Uk(c){return c.tag===5||c.tag===3||c.tag===4}function Wk(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||Uk(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function ry(c,h,m){var _=c.tag;if(_===5||_===6)c=c.stateNode,h?m.nodeType===8?m.parentNode.insertBefore(c,h):m.insertBefore(c,h):(m.nodeType===8?(h=m.parentNode,h.insertBefore(c,m)):(h=m,h.appendChild(c)),m=m._reactRootContainer,m!=null||h.onclick!==null||(h.onclick=Md));else if(_!==4&&(c=c.child,c!==null))for(ry(c,h,m),c=c.sibling;c!==null;)ry(c,h,m),c=c.sibling}function ny(c,h,m){var _=c.tag;if(_===5||_===6)c=c.stateNode,h?m.insertBefore(c,h):m.appendChild(c);else if(_!==4&&(c=c.child,c!==null))for(ny(c,h,m),c=c.sibling;c!==null;)ny(c,h,m),c=c.sibling}var Cr=null,Zn=!1;function Fi(c,h,m){for(m=m.child;m!==null;)zk(c,h,m),m=m.sibling}function zk(c,h,m){if(ya&&typeof ya.onCommitFiberUnmount=="function")try{ya.onCommitFiberUnmount(yd,m)}catch{}switch(m.tag){case 5:$r||Xs(m,h);case 6:var _=Cr,O=Zn;Cr=null,Fi(c,h,m),Cr=_,Zn=O,Cr!==null&&(Zn?(c=Cr,m=m.stateNode,c.nodeType===8?c.parentNode.removeChild(m):c.removeChild(m)):Cr.removeChild(m.stateNode));break;case 18:Cr!==null&&(Zn?(c=Cr,m=m.stateNode,c.nodeType===8?mg(c.parentNode,m):c.nodeType===1&&mg(c,m),Wl(c)):mg(Cr,m.stateNode));break;case 4:_=Cr,O=Zn,Cr=m.stateNode.containerInfo,Zn=!0,Fi(c,h,m),Cr=_,Zn=O;break;case 0:case 11:case 14:case 15:if(!$r&&(_=m.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){O=_=_.next;do{var P=O,M=P.destroy;P=P.tag,M!==void 0&&((P&2)!==0||(P&4)!==0)&&ey(m,h,M),O=O.next}while(O!==_)}Fi(c,h,m);break;case 1:if(!$r&&(Xs(m,h),_=m.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=m.memoizedProps,_.state=m.memoizedState,_.componentWillUnmount()}catch(H){Wt(m,h,H)}Fi(c,h,m);break;case 21:Fi(c,h,m);break;case 22:m.mode&1?($r=(_=$r)||m.memoizedState!==null,Fi(c,h,m),$r=_):Fi(c,h,m);break;default:Fi(c,h,m)}}function qk(c){var h=c.updateQueue;if(h!==null){c.updateQueue=null;var m=c.stateNode;m===null&&(m=c.stateNode=new F5),h.forEach(function(_){var O=G5.bind(null,c,_);m.has(_)||(m.add(_),_.then(O,O))})}}function ea(c,h){var m=h.deletions;if(m!==null)for(var _=0;_<m.length;_++){var O=m[_];try{var P=c,M=h,H=M;e:for(;H!==null;){switch(H.tag){case 5:Cr=H.stateNode,Zn=!1;break e;case 3:Cr=H.stateNode.containerInfo,Zn=!0;break e;case 4:Cr=H.stateNode.containerInfo,Zn=!0;break e}H=H.return}if(Cr===null)throw Error(r(160));zk(P,M,O),Cr=null,Zn=!1;var Q=O.alternate;Q!==null&&(Q.return=null),O.return=null}catch(ie){Wt(O,h,ie)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)Vk(h,c),h=h.sibling}function Vk(c,h){var m=c.alternate,_=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(ea(h,c),_a(c),_&4){try{cc(3,c,c.return),ih(3,c)}catch(Ie){Wt(c,c.return,Ie)}try{cc(5,c,c.return)}catch(Ie){Wt(c,c.return,Ie)}}break;case 1:ea(h,c),_a(c),_&512&&m!==null&&Xs(m,m.return);break;case 5:if(ea(h,c),_a(c),_&512&&m!==null&&Xs(m,m.return),c.flags&32){var O=c.stateNode;try{_o(O,"")}catch(Ie){Wt(c,c.return,Ie)}}if(_&4&&(O=c.stateNode,O!=null)){var P=c.memoizedProps,M=m!==null?m.memoizedProps:P,H=c.type,Q=c.updateQueue;if(c.updateQueue=null,Q!==null)try{H==="input"&&P.type==="radio"&&P.name!=null&&Ye(O,P),jm(H,M);var ie=jm(H,P);for(M=0;M<Q.length;M+=2){var ve=Q[M],me=Q[M+1];ve==="style"?Os(O,me):ve==="dangerouslySetInnerHTML"?ks(O,me):ve==="children"?_o(O,me):E(O,ve,me,ie)}switch(H){case"input":mt(O,P);break;case"textarea":Pn(O,P);break;case"select":var pe=O._wrapperState.wasMultiple;O._wrapperState.wasMultiple=!!P.multiple;var Ce=P.value;Ce!=null?Nt(O,!!P.multiple,Ce,!1):pe!==!!P.multiple&&(P.defaultValue!=null?Nt(O,!!P.multiple,P.defaultValue,!0):Nt(O,!!P.multiple,P.multiple?[]:"",!1))}O[Zl]=P}catch(Ie){Wt(c,c.return,Ie)}}break;case 6:if(ea(h,c),_a(c),_&4){if(c.stateNode===null)throw Error(r(162));O=c.stateNode,P=c.memoizedProps;try{O.nodeValue=P}catch(Ie){Wt(c,c.return,Ie)}}break;case 3:if(ea(h,c),_a(c),_&4&&m!==null&&m.memoizedState.isDehydrated)try{Wl(h.containerInfo)}catch(Ie){Wt(c,c.return,Ie)}break;case 4:ea(h,c),_a(c);break;case 13:ea(h,c),_a(c),O=c.child,O.flags&8192&&(P=O.memoizedState!==null,O.stateNode.isHidden=P,!P||O.alternate!==null&&O.alternate.memoizedState!==null||(oy=Gt())),_&4&&qk(c);break;case 22:if(ve=m!==null&&m.memoizedState!==null,c.mode&1?($r=(ie=$r)||ve,ea(h,c),$r=ie):ea(h,c),_a(c),_&8192){if(ie=c.memoizedState!==null,(c.stateNode.isHidden=ie)&&!ve&&(c.mode&1)!==0)for(Oe=c,ve=c.child;ve!==null;){for(me=Oe=ve;Oe!==null;){switch(pe=Oe,Ce=pe.child,pe.tag){case 0:case 11:case 14:case 15:cc(4,pe,pe.return);break;case 1:Xs(pe,pe.return);var Pe=pe.stateNode;if(typeof Pe.componentWillUnmount=="function"){_=pe,m=pe.return;try{h=_,Pe.props=h.memoizedProps,Pe.state=h.memoizedState,Pe.componentWillUnmount()}catch(Ie){Wt(_,m,Ie)}}break;case 5:Xs(pe,pe.return);break;case 22:if(pe.memoizedState!==null){Kk(me);continue}}Ce!==null?(Ce.return=pe,Oe=Ce):Kk(me)}ve=ve.sibling}e:for(ve=null,me=c;;){if(me.tag===5){if(ve===null){ve=me;try{O=me.stateNode,ie?(P=O.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none"):(H=me.stateNode,Q=me.memoizedProps.style,M=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,H.style.display=As("display",M))}catch(Ie){Wt(c,c.return,Ie)}}}else if(me.tag===6){if(ve===null)try{me.stateNode.nodeValue=ie?"":me.memoizedProps}catch(Ie){Wt(c,c.return,Ie)}}else if((me.tag!==22&&me.tag!==23||me.memoizedState===null||me===c)&&me.child!==null){me.child.return=me,me=me.child;continue}if(me===c)break e;for(;me.sibling===null;){if(me.return===null||me.return===c)break e;ve===me&&(ve=null),me=me.return}ve===me&&(ve=null),me.sibling.return=me.return,me=me.sibling}}break;case 19:ea(h,c),_a(c),_&4&&qk(c);break;case 21:break;default:ea(h,c),_a(c)}}function _a(c){var h=c.flags;if(h&2){try{e:{for(var m=c.return;m!==null;){if(Uk(m)){var _=m;break e}m=m.return}throw Error(r(160))}switch(_.tag){case 5:var O=_.stateNode;_.flags&32&&(_o(O,""),_.flags&=-33);var P=Wk(c);ny(c,P,O);break;case 3:case 4:var M=_.stateNode.containerInfo,H=Wk(c);ry(c,H,M);break;default:throw Error(r(161))}}catch(Q){Wt(c,c.return,Q)}c.flags&=-3}h&4096&&(c.flags&=-4097)}function B5(c,h,m){Oe=c,Hk(c)}function Hk(c,h,m){for(var _=(c.mode&1)!==0;Oe!==null;){var O=Oe,P=O.child;if(O.tag===22&&_){var M=O.memoizedState!==null||ah;if(!M){var H=O.alternate,Q=H!==null&&H.memoizedState!==null||$r;H=ah;var ie=$r;if(ah=M,($r=Q)&&!ie)for(Oe=O;Oe!==null;)M=Oe,Q=M.child,M.tag===22&&M.memoizedState!==null?Xk(O):Q!==null?(Q.return=M,Oe=Q):Xk(O);for(;P!==null;)Oe=P,Hk(P),P=P.sibling;Oe=O,ah=H,$r=ie}Gk(c)}else(O.subtreeFlags&8772)!==0&&P!==null?(P.return=O,Oe=P):Gk(c)}}function Gk(c){for(;Oe!==null;){var h=Oe;if((h.flags&8772)!==0){var m=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:$r||ih(5,h);break;case 1:var _=h.stateNode;if(h.flags&4&&!$r)if(m===null)_.componentDidMount();else{var O=h.elementType===h.type?m.memoizedProps:Qn(h.type,m.memoizedProps);_.componentDidUpdate(O,m.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var P=h.updateQueue;P!==null&&KC(h,P,_);break;case 3:var M=h.updateQueue;if(M!==null){if(m=null,h.child!==null)switch(h.child.tag){case 5:m=h.child.stateNode;break;case 1:m=h.child.stateNode}KC(h,M,m)}break;case 5:var H=h.stateNode;if(m===null&&h.flags&4){m=H;var Q=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&m.focus();break;case"img":Q.src&&(m.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var ie=h.alternate;if(ie!==null){var ve=ie.memoizedState;if(ve!==null){var me=ve.dehydrated;me!==null&&Wl(me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}$r||h.flags&512&&ty(h)}catch(pe){Wt(h,h.return,pe)}}if(h===c){Oe=null;break}if(m=h.sibling,m!==null){m.return=h.return,Oe=m;break}Oe=h.return}}function Kk(c){for(;Oe!==null;){var h=Oe;if(h===c){Oe=null;break}var m=h.sibling;if(m!==null){m.return=h.return,Oe=m;break}Oe=h.return}}function Xk(c){for(;Oe!==null;){var h=Oe;try{switch(h.tag){case 0:case 11:case 15:var m=h.return;try{ih(4,h)}catch(Q){Wt(h,m,Q)}break;case 1:var _=h.stateNode;if(typeof _.componentDidMount=="function"){var O=h.return;try{_.componentDidMount()}catch(Q){Wt(h,O,Q)}}var P=h.return;try{ty(h)}catch(Q){Wt(h,P,Q)}break;case 5:var M=h.return;try{ty(h)}catch(Q){Wt(h,M,Q)}}}catch(Q){Wt(h,h.return,Q)}if(h===c){Oe=null;break}var H=h.sibling;if(H!==null){H.return=h.return,Oe=H;break}Oe=h.return}}var $5=Math.ceil,oh=C.ReactCurrentDispatcher,ay=C.ReactCurrentOwner,Dn=C.ReactCurrentBatchConfig,lt=0,gr=null,Jt=null,kr=0,yn=0,Ys=Ri(0),nr=0,fc=null,Ro=0,sh=0,iy=0,dc=null,an=null,oy=0,Js=1/0,Qa=null,uh=!1,sy=null,Li=null,lh=!1,Bi=null,ch=0,hc=0,uy=null,fh=-1,dh=0;function Qr(){return(lt&6)!==0?Gt():fh!==-1?fh:fh=Gt()}function $i(c){return(c.mode&1)===0?1:(lt&2)!==0&&kr!==0?kr&-kr:S5.transition!==null?(dh===0&&(dh=WE()),dh):(c=gt,c!==0||(c=window.event,c=c===void 0?16:JE(c.type)),c)}function ta(c,h,m,_){if(50<hc)throw hc=0,uy=null,Error(r(185));Fl(c,m,_),((lt&2)===0||c!==gr)&&(c===gr&&((lt&2)===0&&(sh|=m),nr===4&&Ui(c,kr)),on(c,_),m===1&&lt===0&&(h.mode&1)===0&&(Js=Gt()+500,$d&&ji()))}function on(c,h){var m=c.callbackNode;S$(c,h);var _=wd(c,c===gr?kr:0);if(_===0)m!==null&&BE(m),c.callbackNode=null,c.callbackPriority=0;else if(h=_&-_,c.callbackPriority!==h){if(m!=null&&BE(m),h===1)c.tag===0?_5(Jk.bind(null,c)):MC(Jk.bind(null,c)),y5(function(){(lt&6)===0&&ji()}),m=null;else{switch(zE(_)){case 1:m=Um;break;case 4:m=$E;break;case 16:m=gd;break;case 536870912:m=UE;break;default:m=gd}m=iA(m,Yk.bind(null,c))}c.callbackPriority=h,c.callbackNode=m}}function Yk(c,h){if(fh=-1,dh=0,(lt&6)!==0)throw Error(r(327));var m=c.callbackNode;if(Qs()&&c.callbackNode!==m)return null;var _=wd(c,c===gr?kr:0);if(_===0)return null;if((_&30)!==0||(_&c.expiredLanes)!==0||h)h=hh(c,_);else{h=_;var O=lt;lt|=2;var P=Zk();(gr!==c||kr!==h)&&(Qa=null,Js=Gt()+500,jo(c,h));do try{z5();break}catch(H){Qk(c,H)}while(!0);kg(),oh.current=P,lt=O,Jt!==null?h=0:(gr=null,kr=0,h=nr)}if(h!==0){if(h===2&&(O=Wm(c),O!==0&&(_=O,h=ly(c,O))),h===1)throw m=fc,jo(c,0),Ui(c,_),on(c,Gt()),m;if(h===6)Ui(c,_);else{if(O=c.current.alternate,(_&30)===0&&!U5(O)&&(h=hh(c,_),h===2&&(P=Wm(c),P!==0&&(_=P,h=ly(c,P))),h===1))throw m=fc,jo(c,0),Ui(c,_),on(c,Gt()),m;switch(c.finishedWork=O,c.finishedLanes=_,h){case 0:case 1:throw Error(r(345));case 2:Do(c,an,Qa);break;case 3:if(Ui(c,_),(_&130023424)===_&&(h=oy+500-Gt(),10<h)){if(wd(c,0)!==0)break;if(O=c.suspendedLanes,(O&_)!==_){Qr(),c.pingedLanes|=c.suspendedLanes&O;break}c.timeoutHandle=vg(Do.bind(null,c,an,Qa),h);break}Do(c,an,Qa);break;case 4:if(Ui(c,_),(_&4194240)===_)break;for(h=c.eventTimes,O=-1;0<_;){var M=31-Xn(_);P=1<<M,M=h[M],M>O&&(O=M),_&=~P}if(_=O,_=Gt()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*$5(_/1960))-_,10<_){c.timeoutHandle=vg(Do.bind(null,c,an,Qa),_);break}Do(c,an,Qa);break;case 5:Do(c,an,Qa);break;default:throw Error(r(329))}}}return on(c,Gt()),c.callbackNode===m?Yk.bind(null,c):null}function ly(c,h){var m=dc;return c.current.memoizedState.isDehydrated&&(jo(c,h).flags|=256),c=hh(c,h),c!==2&&(h=an,an=m,h!==null&&cy(h)),c}function cy(c){an===null?an=c:an.push.apply(an,c)}function U5(c){for(var h=c;;){if(h.flags&16384){var m=h.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var _=0;_<m.length;_++){var O=m[_],P=O.getSnapshot;O=O.value;try{if(!Yn(P(),O))return!1}catch{return!1}}}if(m=h.child,h.subtreeFlags&16384&&m!==null)m.return=h,h=m;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Ui(c,h){for(h&=~iy,h&=~sh,c.suspendedLanes|=h,c.pingedLanes&=~h,c=c.expirationTimes;0<h;){var m=31-Xn(h),_=1<<m;c[m]=-1,h&=~_}}function Jk(c){if((lt&6)!==0)throw Error(r(327));Qs();var h=wd(c,0);if((h&1)===0)return on(c,Gt()),null;var m=hh(c,h);if(c.tag!==0&&m===2){var _=Wm(c);_!==0&&(h=_,m=ly(c,_))}if(m===1)throw m=fc,jo(c,0),Ui(c,h),on(c,Gt()),m;if(m===6)throw Error(r(345));return c.finishedWork=c.current.alternate,c.finishedLanes=h,Do(c,an,Qa),on(c,Gt()),null}function fy(c,h){var m=lt;lt|=1;try{return c(h)}finally{lt=m,lt===0&&(Js=Gt()+500,$d&&ji())}}function Io(c){Bi!==null&&Bi.tag===0&&(lt&6)===0&&Qs();var h=lt;lt|=1;var m=Dn.transition,_=gt;try{if(Dn.transition=null,gt=1,c)return c()}finally{gt=_,Dn.transition=m,lt=h,(lt&6)===0&&ji()}}function dy(){yn=Ys.current,At(Ys)}function jo(c,h){c.finishedWork=null,c.finishedLanes=0;var m=c.timeoutHandle;if(m!==-1&&(c.timeoutHandle=-1,g5(m)),Jt!==null)for(m=Jt.return;m!==null;){var _=m;switch(wg(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Ld();break;case 3:Gs(),At(tn),At(Fr),jg();break;case 5:Rg(_);break;case 4:Gs();break;case 13:At(Dt);break;case 19:At(Dt);break;case 10:Ag(_.type._context);break;case 22:case 23:dy()}m=m.return}if(gr=c,Jt=c=Wi(c.current,null),kr=yn=h,nr=0,fc=null,iy=sh=Ro=0,an=dc=null,To!==null){for(h=0;h<To.length;h++)if(m=To[h],_=m.interleaved,_!==null){m.interleaved=null;var O=_.next,P=m.pending;if(P!==null){var M=P.next;P.next=O,_.next=M}m.pending=_}To=null}return c}function Qk(c,h){do{var m=Jt;try{if(kg(),Yd.current=eh,Jd){for(var _=Mt.memoizedState;_!==null;){var O=_.queue;O!==null&&(O.pending=null),_=_.next}Jd=!1}if(No=0,mr=rr=Mt=null,ic=!1,oc=0,ay.current=null,m===null||m.return===null){nr=1,fc=h,Jt=null;break}e:{var P=c,M=m.return,H=m,Q=h;if(h=kr,H.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ie=Q,ve=H,me=ve.tag;if((ve.mode&1)===0&&(me===0||me===11||me===15)){var pe=ve.alternate;pe?(ve.updateQueue=pe.updateQueue,ve.memoizedState=pe.memoizedState,ve.lanes=pe.lanes):(ve.updateQueue=null,ve.memoizedState=null)}var Ce=Sk(M);if(Ce!==null){Ce.flags&=-257,Ek(Ce,M,H,P,h),Ce.mode&1&&_k(P,ie,h),h=Ce,Q=ie;var Pe=h.updateQueue;if(Pe===null){var Ie=new Set;Ie.add(Q),h.updateQueue=Ie}else Pe.add(Q);break e}else{if((h&1)===0){_k(P,ie,h),hy();break e}Q=Error(r(426))}}else if(Rt&&H.mode&1){var Kt=Sk(M);if(Kt!==null){(Kt.flags&65536)===0&&(Kt.flags|=256),Ek(Kt,M,H,P,h),Eg(Ks(Q,H));break e}}P=Q=Ks(Q,H),nr!==4&&(nr=2),dc===null?dc=[P]:dc.push(P),P=M;do{switch(P.tag){case 3:P.flags|=65536,h&=-h,P.lanes|=h;var re=xk(P,Q,h);GC(P,re);break e;case 1:H=Q;var te=P.type,ne=P.stateNode;if((P.flags&128)===0&&(typeof te.getDerivedStateFromError=="function"||ne!==null&&typeof ne.componentDidCatch=="function"&&(Li===null||!Li.has(ne)))){P.flags|=65536,h&=-h,P.lanes|=h;var ye=wk(P,H,h);GC(P,ye);break e}}P=P.return}while(P!==null)}tA(m)}catch(Le){h=Le,Jt===m&&m!==null&&(Jt=m=m.return);continue}break}while(!0)}function Zk(){var c=oh.current;return oh.current=eh,c===null?eh:c}function hy(){(nr===0||nr===3||nr===2)&&(nr=4),gr===null||(Ro&268435455)===0&&(sh&268435455)===0||Ui(gr,kr)}function hh(c,h){var m=lt;lt|=2;var _=Zk();(gr!==c||kr!==h)&&(Qa=null,jo(c,h));do try{W5();break}catch(O){Qk(c,O)}while(!0);if(kg(),lt=m,oh.current=_,Jt!==null)throw Error(r(261));return gr=null,kr=0,nr}function W5(){for(;Jt!==null;)eA(Jt)}function z5(){for(;Jt!==null&&!p$();)eA(Jt)}function eA(c){var h=aA(c.alternate,c,yn);c.memoizedProps=c.pendingProps,h===null?tA(c):Jt=h,ay.current=null}function tA(c){var h=c;do{var m=h.alternate;if(c=h.return,(h.flags&32768)===0){if(m=D5(m,h,yn),m!==null){Jt=m;return}}else{if(m=M5(m,h),m!==null){m.flags&=32767,Jt=m;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{nr=6,Jt=null;return}}if(h=h.sibling,h!==null){Jt=h;return}Jt=h=c}while(h!==null);nr===0&&(nr=5)}function Do(c,h,m){var _=gt,O=Dn.transition;try{Dn.transition=null,gt=1,q5(c,h,m,_)}finally{Dn.transition=O,gt=_}return null}function q5(c,h,m,_){do Qs();while(Bi!==null);if((lt&6)!==0)throw Error(r(327));m=c.finishedWork;var O=c.finishedLanes;if(m===null)return null;if(c.finishedWork=null,c.finishedLanes=0,m===c.current)throw Error(r(177));c.callbackNode=null,c.callbackPriority=0;var P=m.lanes|m.childLanes;if(E$(c,P),c===gr&&(Jt=gr=null,kr=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||lh||(lh=!0,iA(gd,function(){return Qs(),null})),P=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||P){P=Dn.transition,Dn.transition=null;var M=gt;gt=1;var H=lt;lt|=4,ay.current=null,L5(c,m),Vk(m,c),c5(hg),Ed=!!dg,hg=dg=null,c.current=m,B5(m),v$(),lt=H,gt=M,Dn.transition=P}else c.current=m;if(lh&&(lh=!1,Bi=c,ch=O),P=c.pendingLanes,P===0&&(Li=null),y$(m.stateNode),on(c,Gt()),h!==null)for(_=c.onRecoverableError,m=0;m<h.length;m++)O=h[m],_(O.value,{componentStack:O.stack,digest:O.digest});if(uh)throw uh=!1,c=sy,sy=null,c;return(ch&1)!==0&&c.tag!==0&&Qs(),P=c.pendingLanes,(P&1)!==0?c===uy?hc++:(hc=0,uy=c):hc=0,ji(),null}function Qs(){if(Bi!==null){var c=zE(ch),h=Dn.transition,m=gt;try{if(Dn.transition=null,gt=16>c?16:c,Bi===null)var _=!1;else{if(c=Bi,Bi=null,ch=0,(lt&6)!==0)throw Error(r(331));var O=lt;for(lt|=4,Oe=c.current;Oe!==null;){var P=Oe,M=P.child;if((Oe.flags&16)!==0){var H=P.deletions;if(H!==null){for(var Q=0;Q<H.length;Q++){var ie=H[Q];for(Oe=ie;Oe!==null;){var ve=Oe;switch(ve.tag){case 0:case 11:case 15:cc(8,ve,P)}var me=ve.child;if(me!==null)me.return=ve,Oe=me;else for(;Oe!==null;){ve=Oe;var pe=ve.sibling,Ce=ve.return;if($k(ve),ve===ie){Oe=null;break}if(pe!==null){pe.return=Ce,Oe=pe;break}Oe=Ce}}}var Pe=P.alternate;if(Pe!==null){var Ie=Pe.child;if(Ie!==null){Pe.child=null;do{var Kt=Ie.sibling;Ie.sibling=null,Ie=Kt}while(Ie!==null)}}Oe=P}}if((P.subtreeFlags&2064)!==0&&M!==null)M.return=P,Oe=M;else e:for(;Oe!==null;){if(P=Oe,(P.flags&2048)!==0)switch(P.tag){case 0:case 11:case 15:cc(9,P,P.return)}var re=P.sibling;if(re!==null){re.return=P.return,Oe=re;break e}Oe=P.return}}var te=c.current;for(Oe=te;Oe!==null;){M=Oe;var ne=M.child;if((M.subtreeFlags&2064)!==0&&ne!==null)ne.return=M,Oe=ne;else e:for(M=te;Oe!==null;){if(H=Oe,(H.flags&2048)!==0)try{switch(H.tag){case 0:case 11:case 15:ih(9,H)}}catch(Le){Wt(H,H.return,Le)}if(H===M){Oe=null;break e}var ye=H.sibling;if(ye!==null){ye.return=H.return,Oe=ye;break e}Oe=H.return}}if(lt=O,ji(),ya&&typeof ya.onPostCommitFiberRoot=="function")try{ya.onPostCommitFiberRoot(yd,c)}catch{}_=!0}return _}finally{gt=m,Dn.transition=h}}return!1}function rA(c,h,m){h=Ks(m,h),h=xk(c,h,1),c=Mi(c,h,1),h=Qr(),c!==null&&(Fl(c,1,h),on(c,h))}function Wt(c,h,m){if(c.tag===3)rA(c,c,m);else for(;h!==null;){if(h.tag===3){rA(h,c,m);break}else if(h.tag===1){var _=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Li===null||!Li.has(_))){c=Ks(m,c),c=wk(h,c,1),h=Mi(h,c,1),c=Qr(),h!==null&&(Fl(h,1,c),on(h,c));break}}h=h.return}}function V5(c,h,m){var _=c.pingCache;_!==null&&_.delete(h),h=Qr(),c.pingedLanes|=c.suspendedLanes&m,gr===c&&(kr&m)===m&&(nr===4||nr===3&&(kr&130023424)===kr&&500>Gt()-oy?jo(c,0):iy|=m),on(c,h)}function nA(c,h){h===0&&((c.mode&1)===0?h=1:(h=xd,xd<<=1,(xd&130023424)===0&&(xd=4194304)));var m=Qr();c=Xa(c,h),c!==null&&(Fl(c,h,m),on(c,m))}function H5(c){var h=c.memoizedState,m=0;h!==null&&(m=h.retryLane),nA(c,m)}function G5(c,h){var m=0;switch(c.tag){case 13:var _=c.stateNode,O=c.memoizedState;O!==null&&(m=O.retryLane);break;case 19:_=c.stateNode;break;default:throw Error(r(314))}_!==null&&_.delete(h),nA(c,m)}var aA;aA=function(c,h,m){if(c!==null)if(c.memoizedProps!==h.pendingProps||tn.current)nn=!0;else{if((c.lanes&m)===0&&(h.flags&128)===0)return nn=!1,j5(c,h,m);nn=(c.flags&131072)!==0}else nn=!1,Rt&&(h.flags&1048576)!==0&&FC(h,Wd,h.index);switch(h.lanes=0,h.tag){case 2:var _=h.type;nh(c,h),c=h.pendingProps;var O=$s(h,Fr.current);Hs(h,m),O=Fg(null,h,_,c,O,m);var P=Lg();return h.flags|=1,typeof O=="object"&&O!==null&&typeof O.render=="function"&&O.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,rn(_)?(P=!0,Bd(h)):P=!1,h.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,Pg(h),O.updater=th,h.stateNode=O,O._reactInternals=h,qg(h,_,c,m),h=Kg(null,h,_,!0,P,m)):(h.tag=0,Rt&&P&&xg(h),Jr(null,h,O,m),h=h.child),h;case 16:_=h.elementType;e:{switch(nh(c,h),c=h.pendingProps,O=_._init,_=O(_._payload),h.type=_,O=h.tag=X5(_),c=Qn(_,c),O){case 0:h=Gg(null,h,_,c,m);break e;case 1:h=Pk(null,h,_,c,m);break e;case 11:h=Ck(null,h,_,c,m);break e;case 14:h=kk(null,h,_,Qn(_.type,c),m);break e}throw Error(r(306,_,""))}return h;case 0:return _=h.type,O=h.pendingProps,O=h.elementType===_?O:Qn(_,O),Gg(c,h,_,O,m);case 1:return _=h.type,O=h.pendingProps,O=h.elementType===_?O:Qn(_,O),Pk(c,h,_,O,m);case 3:e:{if(Nk(h),c===null)throw Error(r(387));_=h.pendingProps,P=h.memoizedState,O=P.element,HC(c,h),Kd(h,_,null,m);var M=h.memoizedState;if(_=M.element,P.isDehydrated)if(P={element:_,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},h.updateQueue.baseState=P,h.memoizedState=P,h.flags&256){O=Ks(Error(r(423)),h),h=Rk(c,h,_,m,O);break e}else if(_!==O){O=Ks(Error(r(424)),h),h=Rk(c,h,_,m,O);break e}else for(gn=Ni(h.stateNode.containerInfo.firstChild),mn=h,Rt=!0,Jn=null,m=qC(h,null,_,m),h.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(zs(),_===O){h=Ja(c,h,m);break e}Jr(c,h,_,m)}h=h.child}return h;case 5:return XC(h),c===null&&Sg(h),_=h.type,O=h.pendingProps,P=c!==null?c.memoizedProps:null,M=O.children,pg(_,O)?M=null:P!==null&&pg(_,P)&&(h.flags|=32),Tk(c,h),Jr(c,h,M,m),h.child;case 6:return c===null&&Sg(h),null;case 13:return Ik(c,h,m);case 4:return Ng(h,h.stateNode.containerInfo),_=h.pendingProps,c===null?h.child=qs(h,null,_,m):Jr(c,h,_,m),h.child;case 11:return _=h.type,O=h.pendingProps,O=h.elementType===_?O:Qn(_,O),Ck(c,h,_,O,m);case 7:return Jr(c,h,h.pendingProps,m),h.child;case 8:return Jr(c,h,h.pendingProps.children,m),h.child;case 12:return Jr(c,h,h.pendingProps.children,m),h.child;case 10:e:{if(_=h.type._context,O=h.pendingProps,P=h.memoizedProps,M=O.value,wt(Vd,_._currentValue),_._currentValue=M,P!==null)if(Yn(P.value,M)){if(P.children===O.children&&!tn.current){h=Ja(c,h,m);break e}}else for(P=h.child,P!==null&&(P.return=h);P!==null;){var H=P.dependencies;if(H!==null){M=P.child;for(var Q=H.firstContext;Q!==null;){if(Q.context===_){if(P.tag===1){Q=Ya(-1,m&-m),Q.tag=2;var ie=P.updateQueue;if(ie!==null){ie=ie.shared;var ve=ie.pending;ve===null?Q.next=Q:(Q.next=ve.next,ve.next=Q),ie.pending=Q}}P.lanes|=m,Q=P.alternate,Q!==null&&(Q.lanes|=m),Og(P.return,m,h),H.lanes|=m;break}Q=Q.next}}else if(P.tag===10)M=P.type===h.type?null:P.child;else if(P.tag===18){if(M=P.return,M===null)throw Error(r(341));M.lanes|=m,H=M.alternate,H!==null&&(H.lanes|=m),Og(M,m,h),M=P.sibling}else M=P.child;if(M!==null)M.return=P;else for(M=P;M!==null;){if(M===h){M=null;break}if(P=M.sibling,P!==null){P.return=M.return,M=P;break}M=M.return}P=M}Jr(c,h,O.children,m),h=h.child}return h;case 9:return O=h.type,_=h.pendingProps.children,Hs(h,m),O=In(O),_=_(O),h.flags|=1,Jr(c,h,_,m),h.child;case 14:return _=h.type,O=Qn(_,h.pendingProps),O=Qn(_.type,O),kk(c,h,_,O,m);case 15:return Ak(c,h,h.type,h.pendingProps,m);case 17:return _=h.type,O=h.pendingProps,O=h.elementType===_?O:Qn(_,O),nh(c,h),h.tag=1,rn(_)?(c=!0,Bd(h)):c=!1,Hs(h,m),yk(h,_,O),qg(h,_,O,m),Kg(null,h,_,!0,c,m);case 19:return Dk(c,h,m);case 22:return Ok(c,h,m)}throw Error(r(156,h.tag))};function iA(c,h){return LE(c,h)}function K5(c,h,m,_){this.tag=c,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(c,h,m,_){return new K5(c,h,m,_)}function py(c){return c=c.prototype,!(!c||!c.isReactComponent)}function X5(c){if(typeof c=="function")return py(c)?1:0;if(c!=null){if(c=c.$$typeof,c===j)return 11;if(c===q)return 14}return 2}function Wi(c,h){var m=c.alternate;return m===null?(m=Mn(c.tag,h,c.key,c.mode),m.elementType=c.elementType,m.type=c.type,m.stateNode=c.stateNode,m.alternate=c,c.alternate=m):(m.pendingProps=h,m.type=c.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=c.flags&14680064,m.childLanes=c.childLanes,m.lanes=c.lanes,m.child=c.child,m.memoizedProps=c.memoizedProps,m.memoizedState=c.memoizedState,m.updateQueue=c.updateQueue,h=c.dependencies,m.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},m.sibling=c.sibling,m.index=c.index,m.ref=c.ref,m}function ph(c,h,m,_,O,P){var M=2;if(_=c,typeof c=="function")py(c)&&(M=1);else if(typeof c=="string")M=5;else e:switch(c){case T:return Mo(m.children,O,P,h);case N:M=8,O|=8;break;case R:return c=Mn(12,m,h,O|2),c.elementType=R,c.lanes=P,c;case $:return c=Mn(13,m,h,O),c.elementType=$,c.lanes=P,c;case W:return c=Mn(19,m,h,O),c.elementType=W,c.lanes=P,c;case Y:return vh(m,O,P,h);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case I:M=10;break e;case D:M=9;break e;case j:M=11;break e;case q:M=14;break e;case X:M=16,_=null;break e}throw Error(r(130,c==null?c:typeof c,""))}return h=Mn(M,m,h,O),h.elementType=c,h.type=_,h.lanes=P,h}function Mo(c,h,m,_){return c=Mn(7,c,_,h),c.lanes=m,c}function vh(c,h,m,_){return c=Mn(22,c,_,h),c.elementType=Y,c.lanes=m,c.stateNode={isHidden:!1},c}function vy(c,h,m){return c=Mn(6,c,null,h),c.lanes=m,c}function my(c,h,m){return h=Mn(4,c.children!==null?c.children:[],c.key,h),h.lanes=m,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function Y5(c,h,m,_,O){this.tag=h,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zm(0),this.expirationTimes=zm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zm(0),this.identifierPrefix=_,this.onRecoverableError=O,this.mutableSourceEagerHydrationData=null}function gy(c,h,m,_,O,P,M,H,Q){return c=new Y5(c,h,m,H,Q),h===1?(h=1,P===!0&&(h|=8)):h=0,P=Mn(3,null,null,h),c.current=P,P.stateNode=c,P.memoizedState={element:_,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pg(P),c}function J5(c,h,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:A,key:_==null?null:""+_,children:c,containerInfo:h,implementation:m}}function oA(c){if(!c)return Ii;c=c._reactInternals;e:{if(Eo(c)!==c||c.tag!==1)throw Error(r(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(rn(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(r(171))}if(c.tag===1){var m=c.type;if(rn(m))return jC(c,m,h)}return h}function sA(c,h,m,_,O,P,M,H,Q){return c=gy(m,_,!0,c,O,P,M,H,Q),c.context=oA(null),m=c.current,_=Qr(),O=$i(m),P=Ya(_,O),P.callback=h??null,Mi(m,P,O),c.current.lanes=O,Fl(c,O,_),on(c,_),c}function mh(c,h,m,_){var O=h.current,P=Qr(),M=$i(O);return m=oA(m),h.context===null?h.context=m:h.pendingContext=m,h=Ya(P,M),h.payload={element:c},_=_===void 0?null:_,_!==null&&(h.callback=_),c=Mi(O,h,M),c!==null&&(ta(c,O,M,P),Gd(c,O,M)),M}function gh(c){return c=c.current,c.child?(c.child.tag===5,c.child.stateNode):null}function uA(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var m=c.retryLane;c.retryLane=m!==0&&m<h?m:h}}function yy(c,h){uA(c,h),(c=c.alternate)&&uA(c,h)}function Q5(){return null}var lA=typeof reportError=="function"?reportError:function(c){console.error(c)};function by(c){this._internalRoot=c}yh.prototype.render=by.prototype.render=function(c){var h=this._internalRoot;if(h===null)throw Error(r(409));mh(c,h,null,null)},yh.prototype.unmount=by.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var h=c.containerInfo;Io(function(){mh(null,c,null,null)}),h[Va]=null}};function yh(c){this._internalRoot=c}yh.prototype.unstable_scheduleHydration=function(c){if(c){var h=HE();c={blockedOn:null,target:c,priority:h};for(var m=0;m<Oi.length&&h!==0&&h<Oi[m].priority;m++);Oi.splice(m,0,c),m===0&&XE(c)}};function xy(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function bh(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function cA(){}function Z5(c,h,m,_,O){if(O){if(typeof _=="function"){var P=_;_=function(){var ie=gh(M);P.call(ie)}}var M=sA(h,_,c,0,null,!1,!1,"",cA);return c._reactRootContainer=M,c[Va]=M.current,Jl(c.nodeType===8?c.parentNode:c),Io(),M}for(;O=c.lastChild;)c.removeChild(O);if(typeof _=="function"){var H=_;_=function(){var ie=gh(Q);H.call(ie)}}var Q=gy(c,0,!1,null,null,!1,!1,"",cA);return c._reactRootContainer=Q,c[Va]=Q.current,Jl(c.nodeType===8?c.parentNode:c),Io(function(){mh(h,Q,m,_)}),Q}function xh(c,h,m,_,O){var P=m._reactRootContainer;if(P){var M=P;if(typeof O=="function"){var H=O;O=function(){var Q=gh(M);H.call(Q)}}mh(h,M,c,O)}else M=Z5(m,h,c,O,_);return gh(M)}qE=function(c){switch(c.tag){case 3:var h=c.stateNode;if(h.current.memoizedState.isDehydrated){var m=Ml(h.pendingLanes);m!==0&&(qm(h,m|1),on(h,Gt()),(lt&6)===0&&(Js=Gt()+500,ji()))}break;case 13:Io(function(){var _=Xa(c,1);if(_!==null){var O=Qr();ta(_,c,1,O)}}),yy(c,1)}},Vm=function(c){if(c.tag===13){var h=Xa(c,134217728);if(h!==null){var m=Qr();ta(h,c,134217728,m)}yy(c,134217728)}},VE=function(c){if(c.tag===13){var h=$i(c),m=Xa(c,h);if(m!==null){var _=Qr();ta(m,c,h,_)}yy(c,h)}},HE=function(){return gt},GE=function(c,h){var m=gt;try{return gt=c,h()}finally{gt=m}},Fm=function(c,h,m){switch(h){case"input":if(mt(c,m),h=m.name,m.type==="radio"&&h!=null){for(m=c;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<m.length;h++){var _=m[h];if(_!==c&&_.form===c.form){var O=Fd(_);if(!O)throw Error(r(90));le(_),mt(_,O)}}}break;case"textarea":Pn(c,m);break;case"select":h=m.value,h!=null&&Nt(c,!!m.multiple,h,!1)}},NE=fy,RE=Io;var eU={usingClientEntryPoint:!1,Events:[ec,Ls,Fd,TE,PE,fy]},pc={findFiberByHostInstance:Co,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tU={bundleType:pc.bundleType,version:pc.version,rendererPackageName:pc.rendererPackageName,rendererConfig:pc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=ME(c),c===null?null:c.stateNode},findFiberByHostInstance:pc.findFiberByHostInstance||Q5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wh.isDisabled&&wh.supportsFiber)try{yd=wh.inject(tU),ya=wh}catch{}}return sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eU,sn.createPortal=function(c,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xy(h))throw Error(r(200));return J5(c,h,null,m)},sn.createRoot=function(c,h){if(!xy(c))throw Error(r(299));var m=!1,_="",O=lA;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(_=h.identifierPrefix),h.onRecoverableError!==void 0&&(O=h.onRecoverableError)),h=gy(c,1,!1,null,null,m,!1,_,O),c[Va]=h.current,Jl(c.nodeType===8?c.parentNode:c),new by(h)},sn.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(r(188)):(c=Object.keys(c).join(","),Error(r(268,c)));return c=ME(h),c=c===null?null:c.stateNode,c},sn.flushSync=function(c){return Io(c)},sn.hydrate=function(c,h,m){if(!bh(h))throw Error(r(200));return xh(null,c,h,!0,m)},sn.hydrateRoot=function(c,h,m){if(!xy(c))throw Error(r(405));var _=m!=null&&m.hydratedSources||null,O=!1,P="",M=lA;if(m!=null&&(m.unstable_strictMode===!0&&(O=!0),m.identifierPrefix!==void 0&&(P=m.identifierPrefix),m.onRecoverableError!==void 0&&(M=m.onRecoverableError)),h=sA(h,null,c,1,m??null,O,!1,P,M),c[Va]=h.current,Jl(c),_)for(c=0;c<_.length;c++)m=_[c],O=m._getVersion,O=O(m._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[m,O]:h.mutableSourceEagerHydrationData.push(m,O);return new yh(h)},sn.render=function(c,h,m){if(!bh(h))throw Error(r(200));return xh(null,c,h,!1,m)},sn.unmountComponentAtNode=function(c){if(!bh(c))throw Error(r(40));return c._reactRootContainer?(Io(function(){xh(null,null,c,!1,function(){c._reactRootContainer=null,c[Va]=null})}),!0):!1},sn.unstable_batchedUpdates=fy,sn.unstable_renderSubtreeIntoContainer=function(c,h,m,_){if(!bh(m))throw Error(r(200));if(c==null||c._reactInternals===void 0)throw Error(r(38));return xh(c,h,m,!1,_)},sn.version="18.3.1-next-f1338f8080-20240426",sn}var yA;function zD(){if(yA)return Sy.exports;yA=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Sy.exports=fU(),Sy.exports}var bA;function dU(){if(bA)return Sh;bA=1;var t=zD();return Sh.createRoot=t.createRoot,Sh.hydrateRoot=t.hydrateRoot,Sh}var hU=dU();const pU=yt(hU);zD();function Kc(){return Kc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Kc.apply(this,arguments)}var Ji;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ji||(Ji={}));const xA="popstate";function vU(t){t===void 0&&(t={});function e(n,a){let{pathname:i,search:o,hash:s}=n.location;return u1("",{pathname:i,search:o,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:ap(a)}return gU(e,r,null,t)}function Bt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function d2(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function mU(){return Math.random().toString(36).substr(2,8)}function wA(t,e){return{usr:t.state,key:t.key,idx:e}}function u1(t,e,r,n){return r===void 0&&(r=null),Kc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ml(e):e,{state:r,key:e&&e.key||n||mU()})}function ap(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ml(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function gU(t,e,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,s=Ji.Pop,u=null,l=f();l==null&&(l=0,o.replaceState(Kc({},o.state,{idx:l}),""));function f(){return(o.state||{idx:null}).idx}function d(){s=Ji.Pop;let y=f(),x=y==null?null:y-l;l=y,u&&u({action:s,location:b.location,delta:x})}function p(y,x){s=Ji.Push;let S=u1(b.location,y,x);l=f()+1;let E=wA(S,l),C=b.createHref(S);try{o.pushState(E,"",C)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;a.location.assign(C)}i&&u&&u({action:s,location:b.location,delta:1})}function v(y,x){s=Ji.Replace;let S=u1(b.location,y,x);l=f();let E=wA(S,l),C=b.createHref(S);o.replaceState(E,"",C),i&&u&&u({action:s,location:b.location,delta:0})}function g(y){let x=a.location.origin!=="null"?a.location.origin:a.location.href,S=typeof y=="string"?y:ap(y);return S=S.replace(/ $/,"%20"),Bt(x,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,x)}let b={get action(){return s},get location(){return t(a,o)},listen(y){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(xA,d),u=y,()=>{a.removeEventListener(xA,d),u=null}},createHref(y){return e(a,y)},createURL:g,encodeLocation(y){let x=g(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:v,go(y){return o.go(y)}};return b}var _A;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(_A||(_A={}));function yU(t,e,r){return r===void 0&&(r="/"),bU(t,e,r)}function bU(t,e,r,n){let a=typeof e=="string"?ml(e):e,i=Lu(a.pathname||"/",r);if(i==null)return null;let o=qD(t);xU(o);let s=null;for(let u=0;s==null&&u<o.length;++u){let l=NU(i);s=TU(o[u],l)}return s}function qD(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,o,s)=>{let u={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Bt(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let l=no([n,u.relativePath]),f=r.concat(u);i.children&&i.children.length>0&&(Bt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),qD(i.children,e,f,l)),!(i.path==null&&!i.index)&&e.push({path:l,score:AU(l,i.index),routesMeta:f})};return t.forEach((i,o)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))a(i,o);else for(let u of VD(i.path))a(i,o,u)}),e}function VD(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=VD(n.join("/")),s=[];return s.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&s.push(...o),s.map(u=>t.startsWith("/")&&u===""?"/":u)}function xU(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:OU(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const wU=/^:[\w-]+$/,_U=3,SU=2,EU=1,CU=10,kU=-2,SA=t=>t==="*";function AU(t,e){let r=t.split("/"),n=r.length;return r.some(SA)&&(n+=kU),e&&(n+=SU),r.filter(a=>!SA(a)).reduce((a,i)=>a+(wU.test(i)?_U:i===""?EU:CU),n)}function OU(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function TU(t,e,r){let{routesMeta:n}=t,a={},i="/",o=[];for(let s=0;s<n.length;++s){let u=n[s],l=s===n.length-1,f=i==="/"?e:e.slice(i.length)||"/",d=l1({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},f),p=u.route;if(!d)return null;Object.assign(a,d.params),o.push({params:a,pathname:no([i,d.pathname]),pathnameBase:MU(no([i,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(i=no([i,d.pathnameBase]))}return o}function l1(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=PU(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:n.reduce((l,f,d)=>{let{paramName:p,isOptional:v}=f;if(p==="*"){let b=s[d]||"";o=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const g=s[d];return v&&!g?l[p]=void 0:l[p]=(g||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:o,pattern:t}}function PU(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),d2(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,s,u)=>(n.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function NU(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return d2(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Lu(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const RU=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IU=t=>RU.test(t);function jU(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?ml(t):t,i;if(r)if(IU(r))i=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),d2(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?i=EA(r.substring(1),"/"):i=EA(r,e)}else i=e;return{pathname:i,search:FU(n),hash:LU(a)}}function EA(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function ky(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function DU(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function h2(t,e){let r=DU(t);return e?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function p2(t,e,r,n){n===void 0&&(n=!1);let a;typeof t=="string"?a=ml(t):(a=Kc({},t),Bt(!a.pathname||!a.pathname.includes("?"),ky("?","pathname","search",a)),Bt(!a.pathname||!a.pathname.includes("#"),ky("#","pathname","hash",a)),Bt(!a.search||!a.search.includes("#"),ky("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,s;if(o==null)s=r;else{let d=e.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}s=d>=0?e[d]:"/"}let u=jU(a,s),l=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(l||f)&&(u.pathname+="/"),u}const no=t=>t.join("/").replace(/\/\/+/g,"/"),MU=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),FU=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,LU=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function BU(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const HD=["post","put","patch","delete"];new Set(HD);const $U=["get",...HD];new Set($U);function Xc(){return Xc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Xc.apply(this,arguments)}const jv=V.createContext(null),GD=V.createContext(null),pi=V.createContext(null),Dv=V.createContext(null),Ba=V.createContext({outlet:null,matches:[],isDataRoute:!1}),KD=V.createContext(null);function UU(t,e){let{relative:r}=e===void 0?{}:e;gl()||Bt(!1);let{basename:n,navigator:a}=V.useContext(pi),{hash:i,pathname:o,search:s}=Mv(t,{relative:r}),u=o;return n!=="/"&&(u=o==="/"?n:no([n,o])),a.createHref({pathname:u,search:s,hash:i})}function gl(){return V.useContext(Dv)!=null}function fo(){return gl()||Bt(!1),V.useContext(Dv).location}function XD(t){V.useContext(pi).static||V.useLayoutEffect(t)}function ps(){let{isDataRoute:t}=V.useContext(Ba);return t?r6():WU()}function WU(){gl()||Bt(!1);let t=V.useContext(jv),{basename:e,future:r,navigator:n}=V.useContext(pi),{matches:a}=V.useContext(Ba),{pathname:i}=fo(),o=JSON.stringify(h2(a,r.v7_relativeSplatPath)),s=V.useRef(!1);return XD(()=>{s.current=!0}),V.useCallback(function(l,f){if(f===void 0&&(f={}),!s.current)return;if(typeof l=="number"){n.go(l);return}let d=p2(l,JSON.parse(o),i,f.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:no([e,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[e,n,o,i,t])}const zU=V.createContext(null);function qU(t){let e=V.useContext(Ba).outlet;return e&&V.createElement(zU.Provider,{value:t},e)}function YD(){let{matches:t}=V.useContext(Ba),e=t[t.length-1];return e?e.params:{}}function Mv(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=V.useContext(pi),{matches:a}=V.useContext(Ba),{pathname:i}=fo(),o=JSON.stringify(h2(a,n.v7_relativeSplatPath));return V.useMemo(()=>p2(t,JSON.parse(o),i,r==="path"),[t,o,i,r])}function VU(t,e){return HU(t,e)}function HU(t,e,r,n){gl()||Bt(!1);let{navigator:a}=V.useContext(pi),{matches:i}=V.useContext(Ba),o=i[i.length-1],s=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let l=fo(),f;if(e){var d;let y=typeof e=="string"?ml(e):e;u==="/"||(d=y.pathname)!=null&&d.startsWith(u)||Bt(!1),f=y}else f=l;let p=f.pathname||"/",v=p;if(u!=="/"){let y=u.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let g=yU(t,{pathname:v}),b=JU(g&&g.map(y=>Object.assign({},y,{params:Object.assign({},s,y.params),pathname:no([u,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:no([u,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return e&&b?V.createElement(Dv.Provider,{value:{location:Xc({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Ji.Pop}},b):b}function GU(){let t=t6(),e=BU(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},e),r?V.createElement("pre",{style:a},r):null,null)}const KU=V.createElement(GU,null);class XU extends V.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?V.createElement(Ba.Provider,{value:this.props.routeContext},V.createElement(KD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YU(t){let{routeContext:e,match:r,children:n}=t,a=V.useContext(jv);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),V.createElement(Ba.Provider,{value:e},n)}function JU(t,e,r,n){var a;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,s=(a=r)==null?void 0:a.errors;if(s!=null){let f=o.findIndex(d=>d.route.id&&s?.[d.route.id]!==void 0);f>=0||Bt(!1),o=o.slice(0,Math.min(o.length,f+1))}let u=!1,l=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<o.length;f++){let d=o[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=f),d.route.id){let{loaderData:p,errors:v}=r,g=d.route.loader&&p[d.route.id]===void 0&&(!v||v[d.route.id]===void 0);if(d.route.lazy||g){u=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((f,d,p)=>{let v,g=!1,b=null,y=null;r&&(v=s&&d.route.id?s[d.route.id]:void 0,b=d.route.errorElement||KU,u&&(l<0&&p===0?(n6("route-fallback"),g=!0,y=null):l===p&&(g=!0,y=d.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,p+1)),S=()=>{let E;return v?E=b:g?E=y:d.route.Component?E=V.createElement(d.route.Component,null):d.route.element?E=d.route.element:E=f,V.createElement(YU,{match:d,routeContext:{outlet:f,matches:x,isDataRoute:r!=null},children:E})};return r&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?V.createElement(XU,{location:r.location,revalidation:r.revalidation,component:b,error:v,children:S(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):S()},null)}var JD=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(JD||{}),QD=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(QD||{});function QU(t){let e=V.useContext(jv);return e||Bt(!1),e}function ZU(t){let e=V.useContext(GD);return e||Bt(!1),e}function e6(t){let e=V.useContext(Ba);return e||Bt(!1),e}function ZD(t){let e=e6(),r=e.matches[e.matches.length-1];return r.route.id||Bt(!1),r.route.id}function t6(){var t;let e=V.useContext(KD),r=ZU(),n=ZD();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function r6(){let{router:t}=QU(JD.UseNavigateStable),e=ZD(QD.UseNavigateStable),r=V.useRef(!1);return XD(()=>{r.current=!0}),V.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Xc({fromRouteId:e},i)))},[t,e])}const CA={};function n6(t,e,r){CA[t]||(CA[t]=!0)}function a6(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function Yc(t){let{to:e,replace:r,state:n,relative:a}=t;gl()||Bt(!1);let{future:i,static:o}=V.useContext(pi),{matches:s}=V.useContext(Ba),{pathname:u}=fo(),l=ps(),f=p2(e,h2(s,i.v7_relativeSplatPath),u,a==="path"),d=JSON.stringify(f);return V.useEffect(()=>l(JSON.parse(d),{replace:r,state:n,relative:a}),[l,d,a,r,n]),null}function v2(t){return qU(t.context)}function zt(t){Bt(!1)}function i6(t){let{basename:e="/",children:r=null,location:n,navigationType:a=Ji.Pop,navigator:i,static:o=!1,future:s}=t;gl()&&Bt(!1);let u=e.replace(/^\/*/,"/"),l=V.useMemo(()=>({basename:u,navigator:i,static:o,future:Xc({v7_relativeSplatPath:!1},s)}),[u,s,i,o]);typeof n=="string"&&(n=ml(n));let{pathname:f="/",search:d="",hash:p="",state:v=null,key:g="default"}=n,b=V.useMemo(()=>{let y=Lu(f,u);return y==null?null:{location:{pathname:y,search:d,hash:p,state:v,key:g},navigationType:a}},[u,f,d,p,v,g,a]);return b==null?null:V.createElement(pi.Provider,{value:l},V.createElement(Dv.Provider,{children:r,value:b}))}function o6(t){let{children:e,location:r}=t;return VU(c1(e),r)}new Promise(()=>{});function c1(t,e){e===void 0&&(e=[]);let r=[];return V.Children.forEach(t,(n,a)=>{if(!V.isValidElement(n))return;let i=[...e,a];if(n.type===V.Fragment){r.push.apply(r,c1(n.props.children,i));return}n.type!==zt&&Bt(!1),!n.props.index||!n.props.children||Bt(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=c1(n.props.children,i)),r.push(o)}),r}function ip(){return ip=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ip.apply(this,arguments)}function eM(t,e){if(t==null)return{};var r={},n=Object.keys(t),a,i;for(i=0;i<n.length;i++)a=n[i],!(e.indexOf(a)>=0)&&(r[a]=t[a]);return r}function s6(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function u6(t,e){return t.button===0&&(!e||e==="_self")&&!s6(t)}function f1(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function l6(t,e){let r=f1(t);return e&&e.forEach((n,a)=>{r.has(a)||e.getAll(a).forEach(i=>{r.append(a,i)})}),r}const c6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],f6=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],d6="6";try{window.__reactRouterVersion=d6}catch{}const h6=V.createContext({isTransitioning:!1}),p6="startTransition",kA=uU[p6];function v6(t){let{basename:e,children:r,future:n,window:a}=t,i=V.useRef();i.current==null&&(i.current=vU({window:a,v5Compat:!0}));let o=i.current,[s,u]=V.useState({action:o.action,location:o.location}),{v7_startTransition:l}=n||{},f=V.useCallback(d=>{l&&kA?kA(()=>u(d)):u(d)},[u,l]);return V.useLayoutEffect(()=>o.listen(f),[o,f]),V.useEffect(()=>a6(n),[n]),V.createElement(i6,{basename:e,children:r,location:s.location,navigationType:s.action,navigator:o,future:n})}const m6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",g6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,d1=V.forwardRef(function(e,r){let{onClick:n,relative:a,reloadDocument:i,replace:o,state:s,target:u,to:l,preventScrollReset:f,viewTransition:d}=e,p=eM(e,c6),{basename:v}=V.useContext(pi),g,b=!1;if(typeof l=="string"&&g6.test(l)&&(g=l,m6))try{let E=new URL(window.location.href),C=l.startsWith("//")?new URL(E.protocol+l):new URL(l),k=Lu(C.pathname,v);C.origin===E.origin&&k!=null?l=k+C.search+C.hash:b=!0}catch{}let y=UU(l,{relative:a}),x=x6(l,{replace:o,state:s,target:u,preventScrollReset:f,relative:a,viewTransition:d});function S(E){n&&n(E),E.defaultPrevented||x(E)}return V.createElement("a",ip({},p,{href:g||y,onClick:b||i?n:S,ref:r,target:u}))}),y6=V.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:a=!1,className:i="",end:o=!1,style:s,to:u,viewTransition:l,children:f}=e,d=eM(e,f6),p=Mv(u,{relative:d.relative}),v=fo(),g=V.useContext(GD),{navigator:b,basename:y}=V.useContext(pi),x=g!=null&&w6(p)&&l===!0,S=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,E=v.pathname,C=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;a||(E=E.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&y&&(C=Lu(C,y)||C);const k=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let A=E===S||!o&&E.startsWith(S)&&E.charAt(k)==="/",T=C!=null&&(C===S||!o&&C.startsWith(S)&&C.charAt(S.length)==="/"),N={isActive:A,isPending:T,isTransitioning:x},R=A?n:void 0,I;typeof i=="function"?I=i(N):I=[i,A?"active":null,T?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let D=typeof s=="function"?s(N):s;return V.createElement(d1,ip({},d,{"aria-current":R,className:I,ref:r,style:D,to:u,viewTransition:l}),typeof f=="function"?f(N):f)});var h1;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(h1||(h1={}));var AA;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(AA||(AA={}));function b6(t){let e=V.useContext(jv);return e||Bt(!1),e}function x6(t,e){let{target:r,replace:n,state:a,preventScrollReset:i,relative:o,viewTransition:s}=e===void 0?{}:e,u=ps(),l=fo(),f=Mv(t,{relative:o});return V.useCallback(d=>{if(u6(d,r)){d.preventDefault();let p=n!==void 0?n:ap(l)===ap(f);u(t,{replace:p,state:a,preventScrollReset:i,relative:o,viewTransition:s})}},[l,u,f,n,a,r,t,i,o,s])}function tM(t){let e=V.useRef(f1(t)),r=V.useRef(!1),n=fo(),a=V.useMemo(()=>l6(n.search,r.current?null:e.current),[n.search]),i=ps(),o=V.useCallback((s,u)=>{const l=f1(typeof s=="function"?s(a):s);r.current=!0,i("?"+l,u)},[i,a]);return[a,o]}function w6(t,e){e===void 0&&(e={});let r=V.useContext(h6);r==null&&Bt(!1);let{basename:n}=b6(h1.useViewTransitionState),a=Mv(t,{relative:e.relative});if(!r.isTransitioning)return!1;let i=Lu(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Lu(r.nextLocation.pathname,n)||r.nextLocation.pathname;return l1(a.pathname,o)!=null||l1(a.pathname,i)!=null}function Fv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function _6(t,e,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function s(f){try{l(n.next(f))}catch(d){o(d)}}function u(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?i(f.value):a(f.value).then(s,u)}l((n=n.apply(t,e||[])).next())})}const S6=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class m2 extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class E6 extends m2{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class OA extends m2{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class TA extends m2{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var p1;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(p1||(p1={}));class C6{constructor(e,{headers:r={},customFetch:n,region:a=p1.Any}={}){this.url=e,this.headers=r,this.region=a,this.fetch=S6(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return _6(this,arguments,void 0,function*(r,n={}){var a;let i,o;try{const{headers:s,method:u,body:l,signal:f,timeout:d}=n;let p={},{region:v}=n;v||(v=this.region);const g=new URL(`${this.url}/${r}`);v&&v!=="any"&&(p["x-region"]=v,g.searchParams.set("forceFunctionRegion",v));let b;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",b=l):typeof l=="string"?(p["Content-Type"]="text/plain",b=l):typeof FormData<"u"&&l instanceof FormData?b=l:(p["Content-Type"]="application/json",b=JSON.stringify(l)):l&&typeof l!="string"&&!(typeof Blob<"u"&&l instanceof Blob)&&!(l instanceof ArrayBuffer)&&!(typeof FormData<"u"&&l instanceof FormData)?b=JSON.stringify(l):b=l;let y=f;d&&(o=new AbortController,i=setTimeout(()=>o.abort(),d),f?(y=o.signal,f.addEventListener("abort",()=>o.abort())):y=o.signal);const x=yield this.fetch(g.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),s),body:b,signal:y}).catch(k=>{throw new E6(k)}),S=x.headers.get("x-relay-error");if(S&&S==="true")throw new OA(x);if(!x.ok)throw new TA(x);let E=((a=x.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),C;return E==="application/json"?C=yield x.json():E==="application/octet-stream"||E==="application/pdf"?C=yield x.blob():E==="text/event-stream"?C=x:E==="multipart/form-data"?C=yield x.formData():C=yield x.text(),{data:C,error:null,response:x}}catch(s){return{data:null,error:s,response:s instanceof TA||s instanceof OA?s.context:void 0}}finally{i&&clearTimeout(i)}})}}var k6=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},A6=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,s=null,u=null,l=i.status,f=i.statusText;if(i.ok){var d,p;if(r.method!=="HEAD"){var v;const x=await i.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((v=r.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?s=x:s=JSON.parse(x))}const b=(d=r.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),y=(p=i.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");b&&y&&y.length>1&&(u=parseInt(y[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(s)&&(s.length>1?(o={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,u=null,l=406,f="Not Acceptable"):s.length===1?s=s[0]:s=null)}else{var g;const b=await i.text();try{o=JSON.parse(b),Array.isArray(o)&&i.status===404&&(s=[],o=null,l=200,f="OK")}catch{i.status===404&&b===""?(l=204,f="No Content"):o={message:b}}if(o&&r.isMaybeSingle&&(!(o==null||(g=o.details)===null||g===void 0)&&g.includes("0 rows"))&&(o=null,l=200,f="OK"),o&&r.shouldThrowOnError)throw new k6(o)}return{error:o,data:s,count:u,status:l,statusText:f}});return this.shouldThrowOnError||(a=a.catch(i=>{var o;let s="";const u=i?.cause;if(u){var l,f,d,p;const g=(l=u?.message)!==null&&l!==void 0?l:"",b=(f=u?.code)!==null&&f!==void 0?f:"";s=`${(d=i?.name)!==null&&d!==void 0?d:"FetchError"}: ${i?.message}`,s+=`

Caused by: ${(p=u?.name)!==null&&p!==void 0?p:"Error"}: ${g}`,b&&(s+=` (${b})`),u?.stack&&(s+=`
${u.stack}`)}else{var v;s=(v=i?.stack)!==null&&v!==void 0?v:""}return{error:{message:`${(o=i?.name)!==null&&o!==void 0?o:"FetchError"}: ${i?.message}`,details:s,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(t,e)}returns(){return this}overrideTypes(){return this}},O6=class extends A6{select(t){let e=!1;const r=(t??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:i="text"}={}){var o;const s=[t?"analyze":null,e?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${s};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const PA=new RegExp("[,()]");var hu=class extends O6{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(n=>typeof n=="string"&&PA.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(n=>typeof n=="string"&&PA.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${a}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},T6=class{constructor(t,{headers:e={},schema:r,fetch:n}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:r=!1,count:n}=e??{},a=r?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join(""),{url:s,headers:u}=this.cloneRequestState();return s.searchParams.set("select",o),n&&u.append("Prefer",`count=${n}`),new hu({method:a,url:s,headers:u,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var n;const a="POST",{url:i,headers:o}=this.cloneRequestState();if(e&&o.append("Prefer",`count=${e}`),r||o.append("Prefer","missing=default"),Array.isArray(t)){const s=t.reduce((u,l)=>u.concat(Object.keys(l)),[]);if(s.length>0){const u=[...new Set(s)].map(l=>`"${l}"`);i.searchParams.set("columns",u.join(","))}}return new hu({method:a,url:i,headers:o,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){var i;const o="POST",{url:s,headers:u}=this.cloneRequestState();if(u.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&s.searchParams.set("on_conflict",e),n&&u.append("Prefer",`count=${n}`),a||u.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(l.length>0){const f=[...new Set(l)].map(d=>`"${d}"`);s.searchParams.set("columns",f.join(","))}}return new hu({method:o,url:s,headers:u,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var r;const n="PATCH",{url:a,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new hu({method:n,url:a,headers:i,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE",{url:n,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new hu({method:r,url:n,headers:a,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},P6=class rM{constructor(e,{headers:r={},schema:n,fetch:a}={}){this.url=e,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new T6(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new rM(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:a=!1,count:i}={}){var o;let s;const u=new URL(`${this.url}/rpc/${e}`);let l;const f=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(f)),d=n&&Object.values(r).some(f);d?(s="POST",l=r):n||a?(s=n?"HEAD":"GET",Object.entries(r).filter(([v,g])=>g!==void 0).map(([v,g])=>[v,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([v,g])=>{u.searchParams.append(v,g)})):(s="POST",l=r);const p=new Headers(this.headers);return d?p.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&p.set("Prefer",`count=${i}`),new hu({method:s,url:u,headers:p,schema:this.schemaName,body:l,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class N6{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const a=n.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const R6="2.93.2",I6=`realtime-js/${R6}`,j6="1.0.0",nM="2.0.0",NA=nM,v1=1e4,D6=1e3,M6=100;var Gi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Gi||(Gi={}));var or;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(or||(or={}));var aa;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(aa||(aa={}));var m1;(function(t){t.websocket="websocket"})(m1||(m1={}));var Ho;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ho||(Ho={}));class F6{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,n;const a=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var r,n;const a=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,r,n){var a,i;const o=e.topic,s=(a=e.ref)!==null&&a!==void 0?a:"",u=(i=e.join_ref)!==null&&i!==void 0?i:"",l=e.payload.event,f=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},d=Object.keys(f).length===0?"":JSON.stringify(f);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(s.length>255)throw new Error(`ref length ${s.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`userEvent length ${l.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+s.length+o.length+l.length+d.length,v=new ArrayBuffer(this.HEADER_LENGTH+p);let g=new DataView(v),b=0;g.setUint8(b++,this.KINDS.userBroadcastPush),g.setUint8(b++,u.length),g.setUint8(b++,s.length),g.setUint8(b++,o.length),g.setUint8(b++,l.length),g.setUint8(b++,d.length),g.setUint8(b++,r),Array.from(u,x=>g.setUint8(b++,x.charCodeAt(0))),Array.from(s,x=>g.setUint8(b++,x.charCodeAt(0))),Array.from(o,x=>g.setUint8(b++,x.charCodeAt(0))),Array.from(l,x=>g.setUint8(b++,x.charCodeAt(0))),Array.from(d,x=>g.setUint8(b++,x.charCodeAt(0)));var y=new Uint8Array(v.byteLength+n.byteLength);return y.set(new Uint8Array(v),0),y.set(new Uint8Array(n),v.byteLength),y.buffer}decode(e,r){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return r(n)}if(typeof e=="string"){const n=JSON.parse(e),[a,i,o,s,u]=n;return r({join_ref:a,ref:i,topic:o,event:s,payload:u})}return r({})}_binaryDecode(e){const r=new DataView(e),n=r.getUint8(0),a=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,r,a)}_decodeUserBroadcast(e,r,n){const a=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),s=r.getUint8(4);let u=this.HEADER_LENGTH+4;const l=n.decode(e.slice(u,u+a));u=u+a;const f=n.decode(e.slice(u,u+i));u=u+i;const d=n.decode(e.slice(u,u+o));u=u+o;const p=e.slice(u,e.byteLength),v=s===this.JSON_ENCODING?JSON.parse(n.decode(p)):p,g={type:this.BROADCAST_EVENT,event:f,payload:v};return o>0&&(g.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:g}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>r.includes(n)))}}class aM{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _t;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(_t||(_t={}));const RA=(t,e,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=L6(o,t,e,a),i),{}):{}},L6=(t,e,r,n)=>{const a=e.find(s=>s.name===t),i=a?.type,o=r[t];return i&&!n.includes(i)?iM(i,o):g1(o)},iM=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return W6(e,r)}switch(t){case _t.bool:return B6(e);case _t.float4:case _t.float8:case _t.int2:case _t.int4:case _t.int8:case _t.numeric:case _t.oid:return $6(e);case _t.json:case _t.jsonb:return U6(e);case _t.timestamp:return z6(e);case _t.abstime:case _t.date:case _t.daterange:case _t.int4range:case _t.int8range:case _t.money:case _t.reltime:case _t.text:case _t.time:case _t.timestamptz:case _t.timetz:case _t.tsrange:case _t.tstzrange:return g1(e);default:return g1(e)}},g1=t=>t,B6=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},$6=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},U6=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},W6=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(s=>iM(e,s))}return t},z6=t=>typeof t=="string"?t.replace(" ","T"):t,oM=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Ay{constructor(e,r,n={},a=v1){this.channel=e,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var IA;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(IA||(IA={}));class Mc{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Mc.syncState(this.state,a,i,o),this.pendingDiffs.forEach(u=>{this.state=Mc.syncDiff(this.state,u,i,o)}),this.pendingDiffs=[],s()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Mc.syncDiff(this.state,a,i,o),s())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,a){const i=this.cloneDeep(e),o=this.transformState(r),s={},u={};return this.map(i,(l,f)=>{o[l]||(u[l]=f)}),this.map(o,(l,f)=>{const d=i[l];if(d){const p=f.map(y=>y.presence_ref),v=d.map(y=>y.presence_ref),g=f.filter(y=>v.indexOf(y.presence_ref)<0),b=d.filter(y=>p.indexOf(y.presence_ref)<0);g.length>0&&(s[l]=g),b.length>0&&(u[l]=b)}else s[l]=f}),this.syncDiff(i,{joins:s,leaves:u},n,a)}static syncDiff(e,r,n,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(s,u)=>{var l;const f=(l=e[s])!==null&&l!==void 0?l:[];if(e[s]=this.cloneDeep(u),f.length>0){const d=e[s].map(v=>v.presence_ref),p=f.filter(v=>d.indexOf(v.presence_ref)<0);e[s].unshift(...p)}n(s,f,u)}),this.map(o,(s,u)=>{let l=e[s];if(!l)return;const f=u.map(d=>d.presence_ref);l=l.filter(d=>f.indexOf(d.presence_ref)<0),e[s]=l,a(s,l,u),l.length===0&&delete e[s]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const a=e[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jA;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(jA||(jA={}));var Fc;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Fc||(Fc={}));var ri;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ri||(ri={}));class xu{constructor(e,r={config:{}},n){var a,i;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=or.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ay(this,aa.join,this.params,this.timeout),this.rejoinTimer=new aM(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=or.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=or.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=or.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=or.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=or.errored,this.rejoinTimer.scheduleTimeout())}),this._on(aa.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new Mc(this),this.broadcastEndpointURL=oM(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==or.closed){const{config:{broadcast:o,presence:s,private:u}}=this.params,l=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(v=>v.filter))!==null&&a!==void 0?a:[],f=!!this.bindings[Fc.PRESENCE]&&this.bindings[Fc.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},p={broadcast:o,presence:Object.assign(Object.assign({},s),{enabled:f}),postgres_changes:l,private:u};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(ri.CHANNEL_ERROR,v)),this._onClose(()=>e?.(ri.CLOSED)),this.updateJoinPayload(Object.assign({config:p},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var g;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){e?.(ri.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,y=(g=b?.length)!==null&&g!==void 0?g:0,x=[];for(let S=0;S<y;S++){const E=b[S],{filter:{event:C,schema:k,table:A,filter:T}}=E,N=v&&v[S];if(N&&N.event===C&&xu.isFilterValueEqual(N.schema,k)&&xu.isFilterValueEqual(N.table,A)&&xu.isFilterValueEqual(N.filter,T))x.push(Object.assign(Object.assign({},E),{id:N.id}));else{this.unsubscribe(),this.state=or.errored,e?.(ri.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(ri.SUBSCRIBED);return}}).receive("error",v=>{this.state=or.errored,e?.(ri.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(ri.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===or.joined&&e===Fc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,n)}async httpSend(e,r,n={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},s=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(s.status===202)return{success:!0};let u=s.statusText;try{const l=await s.json();u=l.error||l.message||u}catch{}return Promise.reject(new Error(u))}async send(e,r={}){var n,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=l.body)===null||a===void 0?void 0:a.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,s,u;const l=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(s=(o=this.params)===null||o===void 0?void 0:o.config)===null||s===void 0?void 0:s.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),l.receive("ok",()=>i("ok")),l.receive("error",()=>i("error")),l.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=or.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(aa.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Ay(this,aa.leave,{},e),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=or.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Ay(this,e,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>M6){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var a,i;const o=e.toLocaleLowerCase(),{close:s,error:u,leave:l,join:f}=aa;if(n&&[s,u,l,f].indexOf(o)>=0&&n!==this._joinRef())return;let p=this._onMessage(o,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var g,b,y;return((g=v.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(b=v.filter)===null||b===void 0?void 0:b.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(v=>v.callback(p,n)):(i=this.bindings[o])===null||i===void 0||i.filter(v=>{var g,b,y,x,S,E;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const C=v.id,k=(g=v.filter)===null||g===void 0?void 0:g.event;return C&&((b=r.ids)===null||b===void 0?void 0:b.includes(C))&&(k==="*"||k?.toLocaleLowerCase()===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const C=(S=(x=v?.filter)===null||x===void 0?void 0:x.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return C==="*"||C===((E=r?.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof p=="object"&&"ids"in p){const g=p.data,{schema:b,table:y,commit_timestamp:x,type:S,errors:E}=g;p=Object.assign(Object.assign({},{schema:b,table:y,commit_timestamp:x,eventType:S,new:{},old:{},errors:E}),this._getPayloadRecords(g))}v.callback(p,n)})}_isClosed(){return this.state===or.closed}_isJoined(){return this.state===or.joined}_isJoining(){return this.state===or.joining}_isLeaving(){return this.state===or.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const a=e.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&xu.isEqual(a.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(aa.close,{},e)}_onError(e){this._on(aa.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=or.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=RA(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=RA(e.columns,e.old_record)),r}}const Oy=()=>{},Eh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},q6=[1e3,2e3,5e3,1e4],V6=1e4,H6=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class G6{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=v1,this.transport=null,this.heartbeatIntervalMs=Eh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Oy,this.ref=0,this.reconnectTimer=null,this.vsn=NA,this.logger=Oy,this.conn=null,this.sendBuffer=[],this.serializer=new F6,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${m1.websocket}`,this.httpEndpoint=oM(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=N6.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Gi.connecting:return Ho.Connecting;case Gi.open:return Ho.Open;case Gi.closing:return Ho.Closing;default:return Ho.Closed}}isConnected(){return this.connectionState()===Ho.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new xu(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:a,ref:i}=e,o=()=>{this.encode(e,s=>{var u;(u=this.conn)===null||u===void 0||u.send(s)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(D6,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Eh.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const l=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",l)}catch(f){this.log("error","error in heartbeat callback",f)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:a,payload:i,ref:o}=r,s=o?`(${o})`:"",u=i.status||"";this.log("receive",`${u} ${n} ${a} ${s}`.trim(),i),this.channels.filter(l=>l._isMember(n)).forEach(l=>l._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Gi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Gi.open||this.conn.readyState===Gi.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(aa.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${e}${n}${a}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([H6],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,n=!1;if(e)r=e,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const i={access_token:r,version:I6};r&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(aa.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new aM(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Eh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,a,i,o,s,u,l,f,d,p,v;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:v1,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:Eh.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(s=e?.heartbeatCallback)!==null&&s!==void 0?s:Oy,this.vsn=(u=e?.vsn)!==null&&u!==void 0?u:NA,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e?.reconnectAfterMs)!==null&&l!==void 0?l:(g=>q6[g-1]||V6),this.vsn){case j6:this.encode=(f=e?.encode)!==null&&f!==void 0?f:((g,b)=>b(JSON.stringify(g))),this.decode=(d=e?.decode)!==null&&d!==void 0?d:((g,b)=>b(JSON.parse(g)));break;case nM:this.encode=(p=e?.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Jc=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function K6(t,e,r){const n=new URL(e,t);if(r)for(const[a,i]of Object.entries(r))i!==void 0&&n.searchParams.set(a,i);return n.toString()}async function X6(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function Y6(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:i,headers:o}){const s=K6(t.baseUrl,n,a),u=await X6(t.auth),l=await e(s,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...u,...o},body:i?JSON.stringify(i):void 0}),f=await l.text(),d=(l.headers.get("content-type")||"").includes("application/json"),p=d&&f?JSON.parse(f):f;if(!l.ok){const v=d?p:void 0,g=v?.error;throw new Jc(g?.message??`Request failed with status ${l.status}`,{status:l.status,icebergType:g?.type,icebergCode:g?.code,details:v})}return{status:l.status,headers:l.headers,data:p}}}}function Ch(t){return t.join("")}var J6=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Ch(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ch(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ch(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ch(t.namespace)}`}),!0}catch(e){if(e instanceof Jc&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Jc&&r.status===409)return;throw r}}};function Zs(t){return t.join("")}var Q6=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Zs(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Zs(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Zs(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Zs(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Zs(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Zs(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Jc&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Jc&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},Z6=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=Y6({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new J6(this.client,e),this.tableOps=new Q6(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Lv=class extends Error{constructor(t,e="storage",r,n){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Bv(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var kh=class extends Lv{constructor(t,e,r,n="storage"){super(t,n,e,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},sM=class extends Lv{constructor(t,e,r="storage"){super(t,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const eW=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),tW=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},y1=t=>{if(Array.isArray(t))return t.map(r=>y1(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=y1(n)}),e},rW=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Qc(t){"@babel/helpers - typeof";return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qc(t)}function nW(t,e){if(Qc(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Qc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aW(t){var e=nW(t,"string");return Qc(e)=="symbol"?e:e+""}function iW(t,e,r){return(e=aW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function He(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DA(Object(r),!0).forEach(function(n){iW(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}const MA=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},oW=async(t,e,r,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const a=t,i=a.status||500;if(typeof a.json=="function")a.json().then(o=>{const s=o?.statusCode||o?.code||i+"";e(new kh(MA(o),i,s,n))}).catch(()=>{if(n==="vectors"){const o=i+"";e(new kh(a.statusText||`HTTP ${i} error`,i,o,n))}else{const o=i+"";e(new kh(a.statusText||`HTTP ${i} error`,i,o,n))}});else{const o=i+"";e(new kh(a.statusText||`HTTP ${i} error`,i,o,n))}}else e(new sM(MA(t),t,n))},sW=(t,e,r,n)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"||t==="HEAD"||!n?He(He({},a),r):(tW(n)?(a.headers=He({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(n)):a.body=n,e?.duplex&&(a.duplex=e.duplex),He(He({},a),r))};async function mc(t,e,r,n,a,i,o){return new Promise((s,u)=>{t(r,sW(e,n,a,i)).then(l=>{if(!l.ok)throw l;if(n?.noResolveJson)return l;if(o==="vectors"){const f=l.headers.get("content-type");if(!f||!f.includes("application/json"))return{}}return l.json()}).then(l=>s(l)).catch(l=>oW(l,u,n,o))})}function uW(t="storage"){return{get:async(e,r,n,a)=>mc(e,"GET",r,n,a,void 0,t),post:async(e,r,n,a,i)=>mc(e,"POST",r,a,i,n,t),put:async(e,r,n,a,i)=>mc(e,"PUT",r,a,i,n,t),head:async(e,r,n,a)=>mc(e,"HEAD",r,He(He({},n),{},{noResolveJson:!0}),a,void 0,t),remove:async(e,r,n,a,i)=>mc(e,"DELETE",r,a,i,n,t)}}const lW=uW("storage"),{get:Zc,post:It,put:b1,head:cW,remove:g2}=lW;var yl=class{constructor(t,e={},r,n="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=eW(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Bv(r))return{data:null,error:r};throw r}}},fW=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Bv(e))return{data:null,error:e};throw e}}};let uM;uM=Symbol.toStringTag;var dW=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[uM]="BlobDownloadBuilder",this.promise=null}asStream(){return new fW(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Bv(e))return{data:null,error:e};throw e}}};const hW={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},FA={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var pW=class extends yl{constructor(t,e={},r,n){super(t,e,n,"storage"),this.bucketId=r}async uploadOrUpdate(t,e,r,n){var a=this;return a.handleOperation(async()=>{let i;const o=He(He({},FA),n);let s=He(He({},a.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",a.encodeMetadata(u)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),u&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(u))):(i=r,s["cache-control"]=`max-age=${o.cacheControl}`,s["content-type"]=o.contentType,u&&(s["x-metadata"]=a.toBase64(a.encodeMetadata(u))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(s=He(He({},s),n.headers));const l=a._removeEmptyFolders(e),f=a._getFinalPath(l),d=await(t=="PUT"?b1:It)(a.fetch,`${a.url}/object/${f}`,i,He({headers:s},o?.duplex?{duplex:o.duplex}:{}));return{path:l,id:d.Id,fullPath:d.Key}})}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,n){var a=this;const i=a._removeEmptyFolders(t),o=a._getFinalPath(i),s=new URL(a.url+`/object/upload/sign/${o}`);return s.searchParams.set("token",e),a.handleOperation(async()=>{let u;const l=He({upsert:FA.upsert},n),f=He(He({},a.headers),{"x-upsert":String(l.upsert)});return typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",l.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",l.cacheControl)):(u=r,f["cache-control"]=`max-age=${l.cacheControl}`,f["content-type"]=l.contentType),{path:i,fullPath:(await b1(a.fetch,s.toString(),u,{headers:f})).Key}})}async createSignedUploadUrl(t,e){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(t);const a=He({},r.headers);e?.upsert&&(a["x-upsert"]="true");const i=await It(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(r.url+i.url),s=o.searchParams.get("token");if(!s)throw new Lv("No token returned by API");return{signedUrl:o.toString(),path:t,token:s}})}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var n=this;return n.handleOperation(async()=>await It(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:n.headers}))}async copy(t,e,r){var n=this;return n.handleOperation(async()=>({path:(await It(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(t,e,r){var n=this;return n.handleOperation(async()=>{let a=n._getFinalPath(t),i=await It(n.fetch,`${n.url}/object/sign/${a}`,He({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${i.signedURL}${o}`)}})}async createSignedUrls(t,e,r){var n=this;return n.handleOperation(async()=>{const a=await It(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:t},{headers:n.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a.map(o=>He(He({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${i}`):null}))})}download(t,e){const r=typeof e?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(e?.transform||{}),a=n?`?${n}`:"",i=this._getFinalPath(t),o=()=>Zc(this.fetch,`${this.url}/${r}/${i}${a}`,{headers:this.headers,noResolveJson:!0});return new dW(o,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);return e.handleOperation(async()=>y1(await Zc(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})))}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await cW(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bv(n)&&n instanceof sM){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}}getPublicUrl(t,e){const r=this._getFinalPath(t),n=[],a=e?.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&n.push(a);const i=typeof e?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(e?.transform||{});o!==""&&n.push(o);let s=n.join("&");return s!==""&&(s=`?${s}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${s}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await g2(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,r){var n=this;return n.handleOperation(async()=>{const a=He(He(He({},hW),e),{},{prefix:t||""});return await It(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},r)})}async listV2(t,e){var r=this;return r.handleOperation(async()=>{const n=He({},t);return await It(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const vW="2.93.2",Gf={"X-Client-Info":`storage-js/${vW}`};var mW=class extends yl{constructor(t,e={},r,n){const a=new URL(t);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."));const i=a.href.replace(/\/$/,""),o=He(He({},Gf),e);super(i,o,r,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const r=e.listBucketOptionsToQueryString(t);return await Zc(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await Zc(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var r=this;return r.handleOperation(async()=>await It(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}))}async updateBucket(t,e){var r=this;return r.handleOperation(async()=>await b1(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await g2(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},gW=class extends yl{constructor(t,e={},r){const n=t.replace(/\/$/,""),a=He(He({},Gf),e);super(n,a,r,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const n=r.toString(),a=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return await Zc(e.fetch,a,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await g2(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!rW(t))throw new Lv("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Z6({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(a,i){const o=a[i];return typeof o!="function"?o:async(...s)=>{try{return{data:await o.apply(a,s),error:null}}catch(u){if(n)throw u;return{data:null,error:u}}}}})}},yW=class extends yl{constructor(t,e={},r){const n=t.replace(/\/$/,""),a=He(He({},Gf),{},{"Content-Type":"application/json"},e);super(n,a,r,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var r=this;return r.handleOperation(async()=>await It(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var r=this;return r.handleOperation(async()=>await It(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{})}},bW=class extends yl{constructor(t,e={},r){const n=t.replace(/\/$/,""),a=He(He({},Gf),{},{"Content-Type":"application/json"},e);super(n,a,r,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await It(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await It(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await It(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},xW=class extends yl{constructor(t,e={},r){const n=t.replace(/\/$/,""),a=He(He({},Gf),{},{"Content-Type":"application/json"},e);super(n,a,r,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await It(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},wW=class extends xW{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new _W(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},_W=class extends yW{constructor(t,e,r,n){super(t,e,n),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,He(He({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,He(He({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new SW(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},SW=class extends bW{constructor(t,e,r,n,a){super(t,e,a),this.vectorBucketName=r,this.indexName=n}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,He(He({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,He(He({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,He(He({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,He(He({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,He(He({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},EW=class extends mW{constructor(t,e={},r,n){super(t,e,r,n)}from(t){return new pW(this.url,this.headers,t,this.fetch)}get vectors(){return new wW(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new gW(this.url+"/iceberg",this.headers,this.fetch)}};const lM="2.93.2",pu=30*1e3,x1=3,Ty=x1*pu,CW="http://localhost:9999",kW="supabase.auth.token",AW={"X-Client-Info":`gotrue-js/${lM}`},w1="X-Supabase-Api-Version",cM={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},OW=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,TW=600*1e3;class ef extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ue(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class PW extends ef{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function NW(t){return Ue(t)&&t.name==="AuthApiError"}class Go extends ef{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class vi extends ef{constructor(e,r,n,a){super(e,n,a),this.name=r,this.status=n}}class bn extends vi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Py(t){return Ue(t)&&t.name==="AuthSessionMissingError"}class eu extends vi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ah extends vi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Oh extends vi{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function RW(t){return Ue(t)&&t.name==="AuthImplicitGrantRedirectError"}class LA extends vi{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class IW extends vi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class _1 extends vi{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ny(t){return Ue(t)&&t.name==="AuthRetryableFetchError"}class BA extends vi{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class S1 extends vi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const op="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$A=` 	
\r=`.split(""),jW=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<$A.length;e+=1)t[$A[e].charCodeAt(0)]=-2;for(let e=0;e<op.length;e+=1)t[op[e].charCodeAt(0)]=e;return t})();function UA(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(op[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(op[n]),e.queuedBits-=6}}function fM(t,e,r){const n=jW[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function WA(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{FW(o,n,r)};for(let o=0;o<t.length;o+=1)fM(t.charCodeAt(o),a,i);return e.join("")}function DW(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function MW(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}DW(n,e)}}function FW(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Eu(t){const e=[],r={queue:0,queuedBits:0},n=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)fM(t.charCodeAt(a),r,n);return new Uint8Array(e)}function LW(t){const e=[];return MW(t,r=>e.push(r)),new Uint8Array(e)}function Xo(t){const e=[],r={queue:0,queuedBits:0},n=a=>{e.push(a)};return t.forEach(a=>UA(a,r,n)),UA(null,r,n),e.join("")}function BW(t){return Math.round(Date.now()/1e3)+t}function $W(){return Symbol("auth-callback")}const Or=()=>typeof window<"u"&&typeof document<"u",Fo={tested:!1,writable:!1},dM=()=>{if(!Or())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fo.tested)return Fo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Fo.tested=!0,Fo.writable=!0}catch{Fo.tested=!0,Fo.writable=!1}return Fo.writable};function UW(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{e[a]=n}),e}const hM=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),WW=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",vu=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Lo=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ar=async(t,e)=>{await t.removeItem(e)};class $v{constructor(){this.promise=new $v.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}$v.promiseConstructor=Promise;function Th(t){const e=t.split(".");if(e.length!==3)throw new S1("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!OW.test(e[n]))throw new S1("JWT not in base64url format");return{header:JSON.parse(WA(e[0])),payload:JSON.parse(WA(e[1])),signature:Eu(e[2]),raw:{header:e[0],payload:e[1]}}}async function zW(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function qW(t,e){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function VW(t){return("0"+t.toString(16)).substr(-2)}function HW(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(e),Array.from(e,VW).join("")}async function GW(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function KW(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await GW(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function tu(t,e,r=!1){const n=HW();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await vu(t,`${e}-code-verifier`,a);const i=await KW(n);return[i,n===i?"plain":"s256"]}const XW=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function YW(t){const e=t.headers.get(w1);if(!e||!e.match(XW))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function JW(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function QW(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ZW=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ru(t){if(!ZW.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ry(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ez(t,e){return new Proxy(t,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,n,a)}})}function zA(t){return JSON.parse(JSON.stringify(t))}const Uo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),tz=[502,503,504];async function qA(t){var e;if(!WW(t))throw new _1(Uo(t),0);if(tz.includes(t.status))throw new _1(Uo(t),t.status);let r;try{r=await t.json()}catch(i){throw new Go(Uo(i),i)}let n;const a=YW(t);if(a&&a.getTime()>=cM["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new BA(Uo(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new bn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new BA(Uo(r),t.status,r.weak_password.reasons);throw new PW(Uo(r),t.status||500,n)}const rz=(t,e,r,n)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ve(t,e,r,n){var a;const i=Object.assign({},n?.headers);i[w1]||(i[w1]=cM["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const s=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await nz(t,e,r+s,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(u):{data:Object.assign({},u),error:null}}async function nz(t,e,r,n,a,i){const o=rz(e,n,a,i);let s;try{s=await t(r,Object.assign({},o))}catch(u){throw console.error(u),new _1(Uo(u),0)}if(s.ok||await qA(s),n?.noResolveJson)return s;try{return await s.json()}catch(u){await qA(u)}}function na(t){var e;let r=null;oz(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=BW(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function VA(t){const e=na(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Xi(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function az(t){return{data:t,error:null}}function iz(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=t,o=Fv(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),s={action_link:e,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},u=Object.assign({},o);return{data:{properties:s,user:u},error:null}}function HA(t){return t}function oz(t){return t.access_token&&t.refresh_token&&t.expires_in}const Iy=["global","local","others"];class sz{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=hM(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Iy[0]){if(Iy.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Iy.join(", ")}`);try{return await Ve(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ue(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await Ve(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Xi})}catch(n){if(Ue(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=Fv(e,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await Ve(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:iz,redirectTo:r?.redirectTo})}catch(r){if(Ue(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Ve(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Xi})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,a,i,o,s,u;try{const l={nextPage:null,lastPage:0,total:0},f=await Ve(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:HA});if(f.error)throw f.error;const d=await f.json(),p=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(u=(s=f.headers.get("link"))===null||s===void 0?void 0:s.split(","))!==null&&u!==void 0?u:[];return v.length>0&&(v.forEach(g=>{const b=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);l[`${y}Page`]=b}),l.total=parseInt(p)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ue(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){ru(e);try{return await Ve(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Xi})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){ru(e);try{return await Ve(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Xi})}catch(n){if(Ue(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){ru(e);try{return await Ve(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Xi})}catch(n){if(Ue(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){ru(e.userId);try{const{data:r,error:n}=await Ve(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async _deleteFactor(e){ru(e.userId),ru(e.id);try{return{data:await Ve(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,a,i,o,s,u;try{const l={nextPage:null,lastPage:0,total:0},f=await Ve(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:HA});if(f.error)throw f.error;const d=await f.json(),p=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(u=(s=f.headers.get("link"))===null||s===void 0?void 0:s.split(","))!==null&&u!==void 0?u:[];return v.length>0&&(v.forEach(g=>{const b=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);l[`${y}Page`]=b}),l.total=parseInt(p)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ue(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await Ve(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await Ve(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await Ve(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ue(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await Ve(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await Ve(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ue(r))return{data:null,error:r};throw r}}}function GA(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const nu={debug:!!(globalThis&&dM()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class pM extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class uz extends pM{}async function lz(t,e,r){nu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),nu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){nu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await r()}finally{nu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw nu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new uz(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(nu.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function cz(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function vM(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function fz(t){return parseInt(t,16)}function dz(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function hz(t){var e;const{chainId:r,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:s,requestId:u,resources:l,scheme:f,uri:d,version:p}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const v=vM(t.address),g=f?`${f}://${n}`:n,b=t.statement?`${t.statement}
`:"",y=`${g} wants you to sign in with your Ethereum account:
${v}

${b}`;let x=`URI: ${d}
Version: ${p}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),s&&(x+=`
Not Before: ${s.toISOString()}`),u&&(x+=`
Request ID: ${u}`),l){let S=`
Resources:`;for(const E of l){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);S+=`
- ${E}`}x+=S}return`${y}
${x}`}class Zt extends Error{constructor({message:e,code:r,cause:n,name:a}){var i;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class sp extends Zt{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function pz({error:t,options:e}){var r,n,a;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Zt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Zt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Zt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Zt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Zt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Zt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(s=>s.type==="public-key").length===0?new Zt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Zt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(mM(o)){if(i.rp.id!==o)return new Zt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Zt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Zt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function vz({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Zt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Zt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(mM(n)){if(r.rpId!==n)return new Zt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Zt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class mz{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const gz=new mz;function yz(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,a=Fv(t,["challenge","user","excludeCredentials"]),i=Eu(e).buffer,o=Object.assign(Object.assign({},r),{id:Eu(r.id).buffer}),s=Object.assign(Object.assign({},a),{challenge:i,user:o});if(n&&n.length>0){s.excludeCredentials=new Array(n.length);for(let u=0;u<n.length;u++){const l=n[u];s.excludeCredentials[u]=Object.assign(Object.assign({},l),{id:Eu(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return s}function bz(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=Fv(t,["challenge","allowCredentials"]),a=Eu(e).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const s=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},s),{id:Eu(s.id).buffer,type:s.type||"public-key",transports:s.transports})}}return i}function xz(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Xo(new Uint8Array(t.response.attestationObject)),clientDataJSON:Xo(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function wz(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),a=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Xo(new Uint8Array(a.authenticatorData)),clientDataJSON:Xo(new Uint8Array(a.clientDataJSON)),signature:Xo(new Uint8Array(a.signature)),userHandle:a.userHandle?Xo(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function mM(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function KA(){var t,e;return!!(Or()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function _z(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new sp("Browser returned unexpected credential type",e)}:{data:null,error:new sp("Empty credential response",e)}}catch(e){return{data:null,error:pz({error:e,options:t})}}}async function Sz(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new sp("Browser returned unexpected credential type",e)}:{data:null,error:new sp("Empty credential response",e)}}catch(e){return{data:null,error:vz({error:e,options:t})}}}const Ez={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Cz={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function up(...t){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of t)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(r(o))n[i]=o;else if(e(o)){const s=n[i];e(s)?n[i]=up(s,o):n[i]=up(o)}else n[i]=o}return n}function kz(t,e){return up(Ez,t,e||{})}function Az(t,e){return up(Cz,t,e||{})}class Oz{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:a},i){try{const{data:o,error:s}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!o)return{data:null,error:s};const u=a??gz.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:l}=o.webauthn.credential_options.publicKey;l.name||(l.name=`${l.id}:${n}`),l.displayName||(l.displayName=l.name)}switch(o.webauthn.type){case"create":{const l=kz(o.webauthn.credential_options.publicKey,i?.create),{data:f,error:d}=await _z({publicKey:l,signal:u});return f?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}case"request":{const l=Az(o.webauthn.credential_options.publicKey,i?.request),{data:f,error:d}=await Sz(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:l,signal:u}));return f?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}}}catch(o){return Ue(o)?{data:null,error:o}:{data:null,error:new Go("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new ef("rpId is required for WebAuthn authentication")};try{if(!KA())return{data:null,error:new Go("Browser does not support WebAuthn",null)};const{data:o,error:s}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:i});if(!o)return{data:null,error:s};const{webauthn:u}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:u.type,rpId:r,rpOrigins:n,credential_response:u.credential_response}})}catch(o){return Ue(o)?{data:null,error:o}:{data:null,error:new Go("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new ef("rpId is required for WebAuthn registration")};try{if(!KA())return{data:null,error:new Go("Browser does not support WebAuthn",null)};const{data:o,error:s}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(f=>{var d;return(d=f.data)===null||d===void 0?void 0:d.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===e&&p.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f?.id}):void 0),{data:null,error:s};const{data:u,error:l}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:i});return u?this._verify({factorId:o.id,challengeId:u.challengeId,webauthn:{rpId:r,rpOrigins:n,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:l}}catch(o){return Ue(o)?{data:null,error:o}:{data:null,error:new Go("Unexpected error in register",o)}}}}cz();const Tz={url:CW,storageKey:kW,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:AW,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function XA(t,e,r){return await r()}const au={};class tf{get jwks(){var e,r;return(r=(e=au[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){au[this.storageKey]=Object.assign(Object.assign({},au[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=au[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){au[this.storageKey]=Object.assign(Object.assign({},au[this.storageKey]),{cachedAt:e})}constructor(e){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},Tz),e);if(this.storageKey=i.storageKey,this.instanceID=(r=tf.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,tf.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Or()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new sz({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=hM(i.fetch),this.lock=i.lock||XA,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&Or()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=lz:this.lock=XA,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Oz(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:dM()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=GA(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=GA(this.memoryStorage)),Or()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(s){this._debug("#broadcastChannel","error",s)}})}this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${lM}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},n="none";if(Or()&&(r=UW(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Or()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),RW(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:s}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",s),await this._saveSession(o),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ue(r)?this._returnResult({error:r}):this._returnResult({error:new Go("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,a;try{const i=await Ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:na}),{data:o,error:s}=i;if(s||!o)return this._returnResult({data:{user:null,session:null},error:s});const u=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:l,session:u},error:null})}catch(i){if(Ue(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var r,n,a;try{let i;if("email"in e){const{email:f,password:d,options:p}=e;let v=null,g=null;this.flowType==="pkce"&&([v,g]=await tu(this.storage,this.storageKey)),i=await Ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p?.emailRedirectTo,body:{email:f,password:d,data:(r=p?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:v,code_challenge_method:g},xform:na})}else if("phone"in e){const{phone:f,password:d,options:p}=e;i=await Ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=p?.data)!==null&&n!==void 0?n:{},channel:(a=p?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:na})}else throw new Ah("You must provide either an email or phone number and a password");const{data:o,error:s}=i;if(s||!o)return await Ar(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:s});const u=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:l,session:u},error:null})}catch(i){if(await Ar(this.storage,`${this.storageKey}-code-verifier`),Ue(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:s}=e;r=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:VA})}else if("phone"in e){const{phone:i,password:o,options:s}=e;r=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:VA})}else throw new Ah("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new eu;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Ue(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,n,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,a,i,o,s,u,l,f,d,p;let v,g;if("message"in e)v=e.message,g=e.signature;else{const{chain:b,wallet:y,statement:x,options:S}=e;let E;if(Or())if(typeof y=="object")E=y;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")E=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=y}const C=new URL((r=S?.url)!==null&&r!==void 0?r:window.location.href),k=await E.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!k||k.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=vM(k[0]);let T=(n=S?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!T){const R=await E.request({method:"eth_chainId"});T=fz(R)}const N={domain:C.host,address:A,statement:x,uri:C.href,version:"1",chainId:T,nonce:(a=S?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=S?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(s=S?.signInWithEthereum)===null||s===void 0?void 0:s.expirationTime,notBefore:(u=S?.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(l=S?.signInWithEthereum)===null||l===void 0?void 0:l.requestId,resources:(f=S?.signInWithEthereum)===null||f===void 0?void 0:f.resources};v=hz(N),g=await E.request({method:"personal_sign",params:[dz(v),A]})}try{const{data:b,error:y}=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:g},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:na});if(y)throw y;if(!b||!b.session||!b.user){const x=new eu;return this._returnResult({data:{user:null,session:null},error:x})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:y})}catch(b){if(Ue(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(e){var r,n,a,i,o,s,u,l,f,d,p,v;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:y,wallet:x,statement:S,options:E}=e;let C;if(Or())if(typeof x=="object")C=x;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))C=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=x}const k=new URL((r=E?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in C&&C.signIn){const A=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E?.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),S?{statement:S}:null));let T;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")T=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)T=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)g=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),b=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${k.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...S?["",S,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(a=(n=E?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=E?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((o=E?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((s=E?.signInWithSolana)===null||s===void 0)&&s.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((u=E?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((l=E?.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((d=(f=E?.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...E.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const A=await C.signMessage(new TextEncoder().encode(g),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=A}}try{const{data:y,error:x}=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Xo(b)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:na});if(x)throw x;if(!y||!y.session||!y.user){const S=new eu;return this._returnResult({data:{user:null,session:null},error:S})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:x})}catch(y){if(Ue(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(e){const r=await Lo(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new IW;const{data:i,error:o}=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:na});if(await Ar(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const s=new eu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:s})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(await Ar(this.storage,`${this.storageKey}-code-verifier`),Ue(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:a,access_token:i,nonce:o}=e,s=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:na}),{data:u,error:l}=s;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!u||!u.session||!u.user){const f=new eu;return this._returnResult({data:{user:null,session:null},error:f})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:l})}catch(r){if(Ue(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,n,a,i,o;try{if("email"in e){const{email:s,options:u}=e;let l=null,f=null;this.flowType==="pkce"&&([l,f]=await tu(this.storage,this.storageKey));const{error:d}=await Ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:(r=u?.data)!==null&&r!==void 0?r:{},create_user:(n=u?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:l,code_challenge_method:f},redirectTo:u?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in e){const{phone:s,options:u}=e,{data:l,error:f}=await Ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:s,data:(a=u?.data)!==null&&a!==void 0?a:{},create_user:(i=u?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(o=u?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:f})}throw new Ah("You must provide either an email or phone number.")}catch(s){if(await Ar(this.storage,`${this.storageKey}-code-verifier`),Ue(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async verifyOtp(e){var r,n;try{let a,i;"options"in e&&(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:s}=await Ve(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:na});if(s)throw s;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,l=o.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:l,session:u},error:null})}catch(a){if(Ue(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var r,n,a,i,o;try{let s=null,u=null;this.flowType==="pkce"&&([s,u]=await tu(this.storage,this.storageKey));const l=await Ve(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:u}),headers:this.headers,xform:az});return!((i=l.data)===null||i===void 0)&&i.url&&Or()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(s){if(await Ar(this.storage,`${this.storageKey}-code-verifier`),Ue(s))return this._returnResult({data:null,error:s});throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new bn;const{error:a}=await Ve(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(Ue(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:a,options:i}=e,{error:o}=await Ve(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:n,type:a,options:i}=e,{data:o,error:s}=await Ve(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:s})}throw new Ah("You must provide either an email or phone number and a type")}catch(r){if(Ue(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Lo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Ty:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await Lo(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Ry()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=ez(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await Ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Xi}):await this._useSession(async r=>{var n,a,i;const{data:o,error:s}=r;if(s)throw s;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new bn}:await Ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Xi})})}catch(r){if(Ue(r))return Py(r)&&(await this._removeSession(),await Ar(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new bn;const o=a.session;let s=null,u=null;this.flowType==="pkce"&&e.email!=null&&([s,u]=await tu(this.storage,this.storageKey));const{data:l,error:f}=await Ve(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:u}),jwt:o.access_token,xform:Xi});if(f)throw f;return o.user=l.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await Ar(this.storage,`${this.storageKey}-code-verifier`),Ue(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new bn;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:o}=Th(e.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{data:s,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!s)return{data:{user:null,session:null},error:null};i=s}else{const{data:s,error:u}=await this._getUser(e.access_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});i={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(Ue(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:s}=r;if(s)throw s;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new bn;const{data:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ue(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!Or())throw new Oh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Oh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new LA("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Oh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new LA("No code detected.");const{data:S,error:E}=await this._exchangeCodeForSession(e.code);if(E)throw E;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:s,expires_at:u,token_type:l}=e;if(!i||!s||!o||!l)throw new Oh("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(s);let p=f+d;u&&(p=parseInt(u));const v=p-f;v*1e3<=pu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${d}s`);const g=p-d;f-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,p,f):f-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,p,f);const{data:b,error:y}=await this._getUser(i);if(y)throw y;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:d,expires_at:p,refresh_token:o,token_type:l,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:e.type},error:null})}catch(n){if(Ue(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Lo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i&&!Py(i))return this._returnResult({error:i});const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:s}=await this.admin.signOut(o,e);if(s&&!(NW(s)&&(s.status===404||s.status===401||s.status===403)||Py(s)))return this._returnResult({error:s})}return e!=="others"&&(await this._removeSession(),await Ar(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=$W(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await tu(this.storage,this.storageKey,!0));try{return await Ve(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await Ar(this.storage,`${this.storageKey}-code-verifier`),Ue(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var o,s,u,l,f;const{data:d,error:p}=i;if(p)throw p;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Ve(this.fetch,"GET",v,{headers:this.headers,jwt:(f=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return Or()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:e.provider,url:n?.url},error:null})}catch(n){if(Ue(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:o,provider:s,token:u,access_token:l,nonce:f}=e,d=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:s,id_token:u,access_token:l,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:na}),{data:p,error:v}=d;return v?this._returnResult({data:{user:null,session:null},error:v}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new eu}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:v}))}catch(a){if(await Ar(this.storage,`${this.storageKey}-code-verifier`),Ue(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)throw o;return await Ve(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await qW(async a=>(a>0&&await zW(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ve(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:na})),(a,i)=>{const o=200*Math.pow(2,a);return i&&Ny(i)&&Date.now()+o-n<pu})}catch(n){if(this._debug(r,"error",n),Ue(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Or()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Lo(this.storage,this.storageKey);if(a&&this.userStorage){let o=await Lo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await vu(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o?.user)!==null&&e!==void 0?e:Ry()}else if(a&&!a.user&&!a.user){const o=await Lo(this.storage,this.storageKey+"-user");o&&o?.user?(a.user=o.user,await Ar(this.storage,this.storageKey+"-user"),await vu(this.storage,this.storageKey,a)):a.user=Ry()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ty;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Ty}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),Ny(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:s}=await this._getUser(a.access_token);!s&&o?.user?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new bn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new $v;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new bn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const s={data:i.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(i){if(this._debug(a,"error",i),Ue(i)){const o={data:null,error:i};return Ny(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,r,n=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,r)}catch(u){i.push(u)}});if(await Promise.all(o),i.length>0){for(let s=0;s<i.length;s+=1)console.error(i[s]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ar(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await vu(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=zA(a);await vu(this.storage,this.storageKey,i)}else{const a=zA(r);await vu(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ar(this.storage,this.storageKey),await Ar(this.storage,this.storageKey+"-code-verifier"),await Ar(this.storage,this.storageKey+"-user"),this.userStorage&&await Ar(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Or()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),pu);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-e)/pu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${pu}ms, refresh threshold is ${x1} ticks`),a<=x1&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof pM)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Or()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await tu(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(s.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?this._returnResult({data:null,error:i}):await Ve(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:u,error:l}=await Ve(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(e.factorType==="totp"&&u.type==="totp"&&(!((a=u?.totp)===null||a===void 0)&&a.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?xz(e.webauthn.credential_response):wz(e.webauthn.credential_response)})}:{code:e.code}),{data:s,error:u}=await Ve(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),this._returnResult({data:s,error:u}))})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await Ve(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:s}=o;if(s.type!=="webauthn")return{data:s,error:null};switch(s.webauthn.type){case"create":return{data:Object.assign(Object.assign({},s),{webauthn:Object.assign(Object.assign({},s.webauthn),{credential_options:Object.assign(Object.assign({},s.webauthn.credential_options),{publicKey:yz(s.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},s),{webauthn:Object.assign(Object.assign({},s.webauthn),{credential_options:Object.assign(Object.assign({},s.webauthn.credential_options),{publicKey:bz(s.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=r?.factors)!==null&&e!==void 0?e:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(e){var r,n,a,i;if(e)try{const{payload:v}=Th(e);let g=null;v.aal&&(g=v.aal);let b=g;const{data:{user:y},error:x}=await this.getUser(e);if(x)return this._returnResult({data:null,error:x});((n=(r=y?.factors)===null||r===void 0?void 0:r.filter(C=>C.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(b="aal2");const E=v.amr||[];return{data:{currentLevel:g,nextLevel:b,currentAuthenticationMethods:E},error:null}}catch(v){if(Ue(v))return this._returnResult({data:null,error:v});throw v}const{data:{session:o},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=Th(o.access_token);let l=null;u.aal&&(l=u.aal);let f=l;((i=(a=o.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(f="aal2");const p=u.amr||[];return{data:{currentLevel:l,nextLevel:f,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await Ve(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new bn})})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new bn});const o=await Ve(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:s=>({data:s,error:null})});return o.data&&o.data.redirect_url&&Or()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Ue(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new bn});const o=await Ve(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:s=>({data:s,error:null})});return o.data&&o.data.redirect_url&&Or()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Ue(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;return n?this._returnResult({data:null,error:n}):r?await Ve(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new bn})})}catch(e){if(Ue(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await Ve(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new bn})})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(s=>s.kid===e);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(s=>s.kid===e),n&&this.jwks_cached_at+TW>a)return n;const{data:i,error:o}=await Ve(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(s=>s.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:v,error:g}=await this.getSession();if(g||!v.session)return this._returnResult({data:null,error:g});n=v.session.access_token}const{header:a,payload:i,signature:o,raw:{header:s,payload:u}}=Th(n);r?.allowExpired||JW(i.exp);const l=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!l){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:i,header:a,signature:o},error:null}}const f=QW(a.alg),d=await crypto.subtle.importKey("jwk",l,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,o,LW(`${s}.${u}`)))throw new S1("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(n){if(Ue(n))return this._returnResult({data:null,error:n});throw n}}}tf.nextInstanceID={};const Pz=tf,Nz="2.93.2";let Nc="";typeof Deno<"u"?Nc="deno":typeof document<"u"?Nc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Nc="react-native":Nc="node";const Rz={"X-Client-Info":`supabase-js-${Nc}/${Nz}`},Iz={headers:Rz},jz={schema:"public"},Dz={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Mz={};function rf(t){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rf(t)}function Fz(t,e){if(rf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(rf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lz(t){var e=Fz(t,"string");return rf(e)=="symbol"?e:e+""}function Bz(t,e,r){return(e=Lz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Vt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YA(Object(r),!0).forEach(function(n){Bz(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}const $z=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Uz=()=>Headers,Wz=(t,e,r)=>{const n=$z(r),a=Uz();return async(i,o)=>{var s;const u=(s=await e())!==null&&s!==void 0?s:t;let l=new a(o?.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${u}`),n(i,Vt(Vt({},o),{},{headers:l}))}};function zz(t){return t.endsWith("/")?t:t+"/"}function qz(t,e){var r,n;const{db:a,auth:i,realtime:o,global:s}=t,{db:u,auth:l,realtime:f,global:d}=e,p={db:Vt(Vt({},u),a),auth:Vt(Vt({},l),i),realtime:Vt(Vt({},f),o),storage:{},global:Vt(Vt(Vt({},d),s),{},{headers:Vt(Vt({},(r=d?.headers)!==null&&r!==void 0?r:{}),(n=s?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}function Vz(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(zz(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Hz=class extends Pz{constructor(t){super(t)}},Gz=class{constructor(t,e,r){var n,a;this.supabaseUrl=t,this.supabaseKey=e;const i=Vz(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,s={db:jz,realtime:Mz,auth:Vt(Vt({},Dz),{},{storageKey:o}),global:Iz},u=qz(r??{},s);if(this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=u.global.headers)!==null&&a!==void 0?a:{},u.accessToken)this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var l;this.auth=this._initSupabaseAuthClient((l=u.auth)!==null&&l!==void 0?l:{},this.headers,u.global.fetch)}this.fetch=Wz(e,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Vt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new P6(new URL("rest/v1",i).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new EW(this.storageUrl.href,this.headers,this.fetch,r?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new C6(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:n}=await t.auth.getSession();return(e=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:n,userStorage:a,storageKey:i,flowType:o,lock:s,debug:u,throwOnError:l},f,d){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Hz({url:this.authUrl.href,headers:Vt(Vt({},p),f),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:n,userStorage:a,flowType:o,lock:s,debug:u,throwOnError:l,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new G6(this.realtimeUrl.href,Vt(Vt({},t),{},{params:Vt(Vt({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Kz=(t,e,r)=>new Gz(t,e,r);function Xz(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Xz()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Yz="https://honvtakaaloovmammwva.supabase.co",Jz="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhvbnZ0YWthYWxvb3ZtYW1td3ZhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2NTEwMjQsImV4cCI6MjA4NTIyNzAyNH0.-Wn0FnZchV4BXR8Ya0rW9dJ2bsUIYk3eUeKKweAkBcA",gc=Kz(Yz,Jz),gM=V.createContext(null);function Qz({children:t}){const[e,r]=V.useState(null),[n,a]=V.useState(null),[i,o]=V.useState(!0),[s,u]=V.useState([]);V.useEffect(()=>{console.log("AuthContext: Initializing..."),gc.auth.getSession().then(({data:{session:b}})=>{if(console.log("AuthContext: GetSession found:",b?.user?.email),a(b),r(b?.user??null),b?.user){const y=b.user.app_metadata?.roles;y&&Array.isArray(y)&&y.length>0?(u(y),o(!1)):l(b.user.id)}else o(!1)});const{data:{subscription:v}}=gc.auth.onAuthStateChange(async(b,y)=>{if(console.log("AuthContext: AuthStateChange:",b,y?.user?.email),y?.user){a(y),r(y.user);const x=y.user.app_metadata?.roles;x&&Array.isArray(x)&&x.length>0?(console.log("AuthContext: Roles found in token:",x),u(x),o(!1)):await l(y.user.id)}else a(null),r(null),u([]),o(!1)}),g=setTimeout(()=>{console.warn("AuthContext: Loading timed out, forcing render."),o(!1)},5e3);return()=>{v.unsubscribe(),clearTimeout(g)}},[]);async function l(v){console.log("AuthContext: Fetching roles for",v);try{const{data:g,error:b}=await gc.from("users").select("roles").eq("id",v).single();b?console.error("AuthContext: Error fetching roles from DB:",b):(console.log("AuthContext: Roles fetched:",g?.roles),u(g?.roles||[]))}catch(g){console.error("AuthContext: Critical Error fetching roles:",g)}finally{console.log("AuthContext: Finished loading"),o(!1)}}const f=async(v,g)=>{const{data:b,error:y}=await gc.auth.signInWithPassword({email:v,password:g});if(y)throw y;return b},d=async()=>{a(null),r(null),u([]),o(!1);try{await gc.auth.signOut()}catch(v){console.error("Error signing out:",v)}},p=V.useMemo(()=>({user:e,session:n,roles:s,loading:i,login:f,logout:d}),[e,n,s,i]);return w.jsx(gM.Provider,{value:p,children:t})}function ha(){const t=V.useContext(gM);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function Zz(){const{user:t,loading:e}=ha();return e?w.jsx("div",{className:"flex min-h-screen items-center justify-center",children:w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-primary-500 border-t-transparent"})}):t?w.jsx(v2,{}):w.jsx(Yc,{to:"/login",replace:!0})}function JA({allowedRoles:t}){const{user:e,roles:r,loading:n}=ha();return n?w.jsx("div",{className:"flex min-h-screen items-center justify-center",children:w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-primary-500 border-t-transparent"})}):e?r.some(i=>t.includes(i))?w.jsx(v2,{}):w.jsx(Yc,{to:"/unauthorized",replace:!0}):w.jsx(Yc,{to:"/login",replace:!0})}const yM=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();const eq=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const tq=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase());const QA=t=>{const e=tq(t);return e.charAt(0).toUpperCase()+e.slice(1)};var rq={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const nq=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const aq=V.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...s},u)=>V.createElement("svg",{ref:u,...rq,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:yM("lucide",a),...!i&&!nq(s)&&{"aria-hidden":"true"},...s},[...o.map(([l,f])=>V.createElement(l,f)),...Array.isArray(i)?i:[i]]));const Je=(t,e)=>{const r=V.forwardRef(({className:n,...a},i)=>V.createElement(aq,{ref:i,iconNode:e,className:yM(`lucide-${eq(QA(t))}`,`lucide-${t}`,n),...a}));return r.displayName=QA(t),r};const iq=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],oq=Je("arrow-left",iq);const sq=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],y2=Je("arrow-right",sq);const uq=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],ZA=Je("bell-ring",uq);const lq=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],os=Je("book-open",lq);const cq=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],bM=Je("briefcase",cq);const fq=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Kf=Je("building-2",fq);const dq=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],hq=Je("calendar-check",dq);const pq=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],E1=Je("calendar-days",pq);const vq=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Bu=Je("calendar",vq);const mq=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],gq=Je("camera",mq);const yq=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],bq=Je("chart-column",yq);const xq=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wq=Je("check",xq);const _q=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Qi=Je("chevron-right",_q);const Sq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],xM=Je("circle-alert",Sq);const Eq=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],wM=Je("circle-check-big",Eq);const Cq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],kq=Je("circle-check",Cq);const Aq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],Oq=Je("circle-stop",Aq);const Tq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],_M=Je("circle-x",Tq);const Pq=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Nq=Je("clipboard-list",Pq);const Rq=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],$u=Je("clock",Rq);const Iq=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],jq=Je("ellipsis-vertical",Iq);const Dq=[["path",{d:"M16 22h2a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v2.85",key:"ryk6xj"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 14v2.2l1.6 1",key:"6m4bie"}],["circle",{cx:"8",cy:"16",r:"6",key:"10v15b"}]],SM=Je("file-clock",Dq);const Mq=[["path",{d:"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34",key:"o6klzx"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z",key:"zhnas1"}]],Fq=Je("file-pen",Mq);const Lq=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],eO=Je("file-text",Lq);const Bq=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Uu=Je("graduation-cap",Bq);const $q=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Uq=Je("history",$q);const Wq=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],nf=Je("layout-dashboard",Wq);const zq=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Lc=Je("layout-grid",zq);const qq=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Vq=Je("loader-circle",qq);const Hq=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Gq=Je("lock",Hq);const Kq=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Xq=Je("log-out",Kq);const Yq=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Jq=Je("mail",Yq);const Qq=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Zq=Je("monitor",Qq);const e8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],EM=Je("plus",e8);const t8=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],r8=Je("save",t8);const n8=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 9h.01",key:"x1ddxp"}]],CM=Je("scan-face",n8);const a8=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],b2=Je("search",a8);const i8=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],o8=Je("shield-check",i8);const s8=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Bc=Je("shield",s8);const u8=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],tO=Je("trash-2",u8);const l8=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],lp=Je("trending-up",l8);const c8=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],f8=Je("triangle-alert",c8);const d8=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],kM=Je("user-check",d8);const h8=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],uo=Je("users",h8);const p8=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],AM=Je("x",p8);function v8(...t){return t.filter(Boolean).join(" ")}function m8(){const{user:t,roles:e,logout:r}=ha(),n=ps(),a=e[0],i=fo(),[o,s]=V.useState([]),u=["STAFF","LECTURER","HOD","PRINCIPAL"],l=e.some(g=>u.includes(g));V.useEffect(()=>{l&&t?.id&&f()},[t,l]);const f=async()=>{try{const g=(new Date().getDay()+6)%7;if(g>4)return;const b=await fetch(`http://localhost:5000/api/admin/staff-dashboard-data?staffId=${t.id}`);if(b.ok){const x=((await b.json()).timetable||[]).filter(S=>S.day_of_week===g).sort((S,E)=>S.period-E.period);s(x)}}catch(g){console.error("Sidebar schedule load failed:",g)}},d=e.includes("SUPER_ADMIN")||e.includes("IT_ADMIN"),p=[{to:"/dashboard",label:"Dashboard",icon:nf},{to:"/attendance",label:"Attendance",icon:hq},{to:"/reports",label:"Reports",icon:bq}].filter(g=>!(l&&(g.label==="Dashboard"||g.label==="Attendance")||d&&(g.label==="Dashboard"||g.label==="Attendance")));d&&(p.push({to:"/admin?tab=overview",label:"Overview",icon:nf}),p.push({to:"/admin?tab=users",label:"All Users",icon:uo}),p.push({to:"/admin?tab=departments",label:"Departments",icon:Kf}),p.push({to:"/admin?tab=manage-roles",label:"Manage Roles",icon:Bc}),p.push({to:"/admin?tab=add-student",label:"Add Student",icon:Uu}),p.push({to:"/admin?tab=add-course",label:"Add Course",icon:os}),p.push({to:"/admin?tab=timetable",label:"Timetable",icon:E1}),p.push({to:"/admin?tab=add-staff",label:"Add Staff",icon:bM}),p.push({to:"/admin?tab=promote",label:"Promote Students",icon:Uu}),p.push({to:"/devices",label:"Devices",icon:Zq})),l&&(p.unshift({to:"/dashboard",label:"My Schedule",icon:$u}),p.push({to:"/mark-attendance",label:"Mark Attendance",icon:kM}),p.push({to:"/leave",label:"Leave & Apps",icon:Fq}),p.push({to:"/forms",label:"My Forms",icon:eO}),(e.includes("HOD")||e.includes("PRINCIPAL"))&&p.push({to:"/attendance",label:"Dept Stats",icon:lp})),e.includes("STUDENT")&&(p.push({to:"/my-courses",label:"My Courses",icon:os}),p.push({to:"/schedule",label:"My Timetable",icon:E1}),p.push({to:"/leave",label:"Leave Applications",icon:SM}),p.push({to:"/forms",label:"Forms & Certs",icon:eO}),p.push({to:"/survey",label:"Activity Survey",icon:Nq}));const v=async()=>{try{await r()}catch(g){console.error("Logout failed:",g)}finally{n("/login")}};return w.jsxs("div",{className:"flex min-h-screen bg-slate-50/50 font-sans",children:[w.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200 hidden lg:flex flex-col sticky top-0 h-screen",children:[w.jsx("div",{className:"p-6 border-b border-slate-100",children:w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary-600 shadow-lg shadow-primary-200 text-white",children:w.jsx(Bc,{size:24})}),w.jsxs("div",{children:[w.jsx("div",{className:"text-lg font-bold text-slate-900 leading-none",children:"Campus Connect"}),w.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500 mt-1",children:a||"User"})]})]})}),w.jsxs("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto scrollbar-hide",children:[w.jsxs("div",{className:"pb-4",children:[w.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-3 px-4",children:"Menu"}),p.map(g=>{const b=i.pathname+i.search===g.to||g.to==="/admin?tab=overview"&&i.pathname==="/admin"&&!i.search;return w.jsxs(y6,{to:g.to,className:v8("group flex items-center gap-3 rounded-xl px-4 py-3 text-sm font-medium transition-all duration-200",b?"bg-primary-50 text-primary-700 shadow-sm ring-1 ring-primary-100":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"),children:[w.jsx(g.icon,{size:18,className:`transition-colors duration-200 ${b?"text-primary-600":"text-slate-400 group-hover:text-slate-600"}`}),g.label,b&&w.jsx(Qi,{size:14,className:"ml-auto opacity-50"})]},g.to+g.label)})]}),l&&o.length>0&&w.jsxs("div",{className:"pt-6 border-t border-slate-100",children:[w.jsxs("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-4 px-4 flex items-center justify-between",children:[w.jsx("span",{children:"Today's Hours"}),w.jsx($u,{size:12,className:"text-primary-400"})]}),w.jsx("div",{className:"space-y-1",children:o.map(g=>w.jsxs("button",{onClick:()=>n(`/mark-attendance?classId=${g.class_id}&period=${g.period}&subjectId=${g.subject_id}`),className:"w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-slate-50 transition-all group border border-transparent hover:border-slate-100",children:[w.jsxs("div",{className:"h-8 w-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-[10px] font-black group-hover:bg-primary-100 group-hover:text-primary-600 transition-colors",children:["P",g.period]}),w.jsxs("div",{className:"min-w-0 flex-1",children:[w.jsx("div",{className:"text-[11px] font-bold text-slate-700 truncate group-hover:text-slate-900",children:g.subject?.name}),w.jsxs("div",{className:"flex items-center gap-1 text-[9px] font-bold text-slate-400 uppercase group-hover:text-slate-600 tracking-tight",children:[w.jsx("span",{children:g.class?.name}),g.class?.semester&&w.jsxs(w.Fragment,{children:[w.jsx("span",{className:"text-slate-300",children:""}),w.jsxs("span",{children:["S",g.class.semester]})]})]})]}),w.jsx(y2,{size:12,className:"text-slate-300 opacity-0 group-hover:opacity-100 transition-all -translate-x-2 group-hover:translate-x-0"})]},g.id))})]})]}),w.jsx("div",{className:"p-4 border-t border-slate-100 mt-auto",children:w.jsxs("button",{onClick:v,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold text-red-500 hover:bg-red-50 transition-all active:scale-95",children:[w.jsx(Xq,{size:18}),"Sign Out"]})})]}),w.jsxs("div",{className:"flex min-h-screen flex-1 flex-col overflow-hidden",children:[w.jsxs("header",{className:"flex items-center justify-between border-b border-slate-200 bg-white/80 px-6 py-4 shadow-sm backdrop-blur-md sticky top-0 z-20",children:[w.jsxs("div",{className:"flex items-center gap-3 lg:hidden",children:[w.jsx("div",{className:"h-10 w-10 rounded-xl bg-primary-600 flex items-center justify-center text-white shadow-lg shadow-primary-200",children:w.jsx(Bc,{size:20})}),w.jsx("span",{className:"text-lg font-bold text-slate-900 tracking-tight",children:"Campus Connect"})]}),w.jsxs("div",{className:"flex flex-1 items-center justify-end gap-5",children:[w.jsxs("div",{className:"text-right",children:[w.jsx("div",{className:"text-sm font-bold text-slate-900 leading-none",children:t?.user_metadata?.full_name||t?.name||t?.email}),w.jsx("div",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-1.5",children:a})]}),w.jsx("div",{className:"h-10 w-10 rounded-xl bg-slate-100 border border-slate-200 flex items-center justify-center text-slate-600 font-bold shadow-inner",children:(t?.user_metadata?.full_name||t?.name||t?.email)?.[0].toUpperCase()})]})]}),w.jsx("main",{className:"flex-1 p-6 lg:p-10 overflow-y-auto",children:w.jsx("div",{className:"max-w-[1600px] mx-auto",children:w.jsx(v2,{})})}),w.jsx("footer",{className:"border-t border-slate-200 bg-white/60 px-8 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:w.jsxs("div",{className:"flex items-center justify-between max-w-[1600px] mx-auto",children:[w.jsxs("span",{children:[" ",new Date().getFullYear()," Campus Connect"]}),w.jsxs("div",{className:"flex gap-6",children:[w.jsx(d1,{to:"/privacy",className:"hover:text-primary-600 transition-colors",children:"Privacy"}),w.jsx(d1,{to:"/support",className:"hover:text-primary-600 transition-colors",children:"Support"})]})]})})]})]})}function g8(){const{login:t}=ha(),e=ps(),[r,n]=V.useState(""),[a,i]=V.useState(""),[o,s]=V.useState(!1),[u,l]=V.useState(""),f=async d=>{d.preventDefault(),l(""),s(!0);try{console.log("Attempting login...");const{user:p}=await t(r,a);console.log("Login successful, navigating...",p),setTimeout(()=>{e("/dashboard",{replace:!0})},100)}catch(p){console.error("Login Error:",p),l(p.message||p.error_description||"Login failed"),s(!1)}};return w.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-4 py-12",children:w.jsxs("div",{className:"w-full max-w-md space-y-8",children:[w.jsxs("div",{className:"flex flex-col items-center text-center",children:[w.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-primary-600 to-primary-700 shadow-xl text-white mb-6 transform transition-transform hover:scale-105 duration-300",children:w.jsx(nf,{size:32})}),w.jsx("h2",{className:"mt-2 text-3xl font-bold tracking-tight text-slate-900",children:"Welcome back"}),w.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"Sign in to access your Campus Connect dashboard"})]}),w.jsx("div",{className:"rounded-2xl bg-white p-8 shadow-xl shadow-slate-200/50 ring-1 ring-slate-100",children:w.jsxs("form",{className:"space-y-6",onSubmit:f,children:[w.jsxs("div",{className:"space-y-5",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-semibold text-slate-700 uppercase tracking-wider mb-2",children:"Email Address"}),w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400",children:w.jsx(Jq,{size:18})}),w.jsx("input",{type:"email",required:!0,className:"block w-full rounded-xl border-slate-200 bg-slate-50 pl-10 text-sm text-slate-900 placeholder-slate-400 focus:border-primary-500 focus:bg-white focus:ring-primary-500 transition-colors py-2.5",placeholder:"you@example.com",value:r,onChange:d=>n(d.target.value)})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-semibold text-slate-700 uppercase tracking-wider mb-2",children:"Password"}),w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400",children:w.jsx(Gq,{size:18})}),w.jsx("input",{type:"password",required:!0,className:"block w-full rounded-xl border-slate-200 bg-slate-50 pl-10 text-sm text-slate-900 placeholder-slate-400 focus:border-primary-500 focus:bg-white focus:ring-primary-500 transition-colors py-2.5",placeholder:"",value:a,onChange:d=>i(d.target.value)})]})]})]}),u&&w.jsxs("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-600 ring-1 ring-red-100 flex items-center gap-2",children:[w.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-red-600 shrink-0"}),u]}),w.jsxs("button",{type:"submit",disabled:o,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-primary-600 px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-primary-200 transition-all hover:bg-primary-700 hover:shadow-primary-300 hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?w.jsx(Vq,{className:"animate-spin",size:20}):"Sign in to Dashboard",!o&&w.jsx(y2,{size:18})]})]})}),w.jsxs("p",{className:"text-center text-xs text-slate-400",children:[" ",new Date().getFullYear()," Campus Connect ERP. All rights reserved."]})]})})}function OM(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=OM(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function st(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=OM(t))&&(n&&(n+=" "),n+=e);return n}var jy,rO;function pn(){if(rO)return jy;rO=1;var t=Array.isArray;return jy=t,jy}var Dy,nO;function TM(){if(nO)return Dy;nO=1;var t=typeof _h=="object"&&_h&&_h.Object===Object&&_h;return Dy=t,Dy}var My,aO;function $a(){if(aO)return My;aO=1;var t=TM(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return My=r,My}var Fy,iO;function Xf(){if(iO)return Fy;iO=1;var t=$a(),e=t.Symbol;return Fy=e,Fy}var Ly,oO;function y8(){if(oO)return Ly;oO=1;var t=Xf(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,a=t?t.toStringTag:void 0;function i(o){var s=r.call(o,a),u=o[a];try{o[a]=void 0;var l=!0}catch{}var f=n.call(o);return l&&(s?o[a]=u:delete o[a]),f}return Ly=i,Ly}var By,sO;function b8(){if(sO)return By;sO=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return By=r,By}var $y,uO;function mi(){if(uO)return $y;uO=1;var t=Xf(),e=y8(),r=b8(),n="[object Null]",a="[object Undefined]",i=t?t.toStringTag:void 0;function o(s){return s==null?s===void 0?a:n:i&&i in Object(s)?e(s):r(s)}return $y=o,$y}var Uy,lO;function gi(){if(lO)return Uy;lO=1;function t(e){return e!=null&&typeof e=="object"}return Uy=t,Uy}var Wy,cO;function bl(){if(cO)return Wy;cO=1;var t=mi(),e=gi(),r="[object Symbol]";function n(a){return typeof a=="symbol"||e(a)&&t(a)==r}return Wy=n,Wy}var zy,fO;function x2(){if(fO)return zy;fO=1;var t=pn(),e=bl(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,o){if(t(i))return!1;var s=typeof i;return s=="number"||s=="symbol"||s=="boolean"||i==null||e(i)?!0:n.test(i)||!r.test(i)||o!=null&&i in Object(o)}return zy=a,zy}var qy,dO;function ho(){if(dO)return qy;dO=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return qy=t,qy}var Vy,hO;function w2(){if(hO)return Vy;hO=1;var t=mi(),e=ho(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",i="[object Proxy]";function o(s){if(!e(s))return!1;var u=t(s);return u==n||u==a||u==r||u==i}return Vy=o,Vy}var Hy,pO;function x8(){if(pO)return Hy;pO=1;var t=$a(),e=t["__core-js_shared__"];return Hy=e,Hy}var Gy,vO;function w8(){if(vO)return Gy;vO=1;var t=x8(),e=(function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!e&&e in n}return Gy=r,Gy}var Ky,mO;function PM(){if(mO)return Ky;mO=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return Ky=r,Ky}var Xy,gO;function _8(){if(gO)return Xy;gO=1;var t=w2(),e=w8(),r=ho(),n=PM(),a=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,o=Function.prototype,s=Object.prototype,u=o.toString,l=s.hasOwnProperty,f=RegExp("^"+u.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(p){if(!r(p)||e(p))return!1;var v=t(p)?f:i;return v.test(n(p))}return Xy=d,Xy}var Yy,yO;function S8(){if(yO)return Yy;yO=1;function t(e,r){return e?.[r]}return Yy=t,Yy}var Jy,bO;function vs(){if(bO)return Jy;bO=1;var t=_8(),e=S8();function r(n,a){var i=e(n,a);return t(i)?i:void 0}return Jy=r,Jy}var Qy,xO;function Uv(){if(xO)return Qy;xO=1;var t=vs(),e=t(Object,"create");return Qy=e,Qy}var Zy,wO;function E8(){if(wO)return Zy;wO=1;var t=Uv();function e(){this.__data__=t?t(null):{},this.size=0}return Zy=e,Zy}var e0,_O;function C8(){if(_O)return e0;_O=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return e0=t,e0}var t0,SO;function k8(){if(SO)return t0;SO=1;var t=Uv(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(i){var o=this.__data__;if(t){var s=o[i];return s===e?void 0:s}return n.call(o,i)?o[i]:void 0}return t0=a,t0}var r0,EO;function A8(){if(EO)return r0;EO=1;var t=Uv(),e=Object.prototype,r=e.hasOwnProperty;function n(a){var i=this.__data__;return t?i[a]!==void 0:r.call(i,a)}return r0=n,r0}var n0,CO;function O8(){if(CO)return n0;CO=1;var t=Uv(),e="__lodash_hash_undefined__";function r(n,a){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=t&&a===void 0?e:a,this}return n0=r,n0}var a0,kO;function T8(){if(kO)return a0;kO=1;var t=E8(),e=C8(),r=k8(),n=A8(),a=O8();function i(o){var s=-1,u=o==null?0:o.length;for(this.clear();++s<u;){var l=o[s];this.set(l[0],l[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,a0=i,a0}var i0,AO;function P8(){if(AO)return i0;AO=1;function t(){this.__data__=[],this.size=0}return i0=t,i0}var o0,OO;function _2(){if(OO)return o0;OO=1;function t(e,r){return e===r||e!==e&&r!==r}return o0=t,o0}var s0,TO;function Wv(){if(TO)return s0;TO=1;var t=_2();function e(r,n){for(var a=r.length;a--;)if(t(r[a][0],n))return a;return-1}return s0=e,s0}var u0,PO;function N8(){if(PO)return u0;PO=1;var t=Wv(),e=Array.prototype,r=e.splice;function n(a){var i=this.__data__,o=t(i,a);if(o<0)return!1;var s=i.length-1;return o==s?i.pop():r.call(i,o,1),--this.size,!0}return u0=n,u0}var l0,NO;function R8(){if(NO)return l0;NO=1;var t=Wv();function e(r){var n=this.__data__,a=t(n,r);return a<0?void 0:n[a][1]}return l0=e,l0}var c0,RO;function I8(){if(RO)return c0;RO=1;var t=Wv();function e(r){return t(this.__data__,r)>-1}return c0=e,c0}var f0,IO;function j8(){if(IO)return f0;IO=1;var t=Wv();function e(r,n){var a=this.__data__,i=t(a,r);return i<0?(++this.size,a.push([r,n])):a[i][1]=n,this}return f0=e,f0}var d0,jO;function zv(){if(jO)return d0;jO=1;var t=P8(),e=N8(),r=R8(),n=I8(),a=j8();function i(o){var s=-1,u=o==null?0:o.length;for(this.clear();++s<u;){var l=o[s];this.set(l[0],l[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,d0=i,d0}var h0,DO;function S2(){if(DO)return h0;DO=1;var t=vs(),e=$a(),r=t(e,"Map");return h0=r,h0}var p0,MO;function D8(){if(MO)return p0;MO=1;var t=T8(),e=zv(),r=S2();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return p0=n,p0}var v0,FO;function M8(){if(FO)return v0;FO=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return v0=t,v0}var m0,LO;function qv(){if(LO)return m0;LO=1;var t=M8();function e(r,n){var a=r.__data__;return t(n)?a[typeof n=="string"?"string":"hash"]:a.map}return m0=e,m0}var g0,BO;function F8(){if(BO)return g0;BO=1;var t=qv();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return g0=e,g0}var y0,$O;function L8(){if($O)return y0;$O=1;var t=qv();function e(r){return t(this,r).get(r)}return y0=e,y0}var b0,UO;function B8(){if(UO)return b0;UO=1;var t=qv();function e(r){return t(this,r).has(r)}return b0=e,b0}var x0,WO;function $8(){if(WO)return x0;WO=1;var t=qv();function e(r,n){var a=t(this,r),i=a.size;return a.set(r,n),this.size+=a.size==i?0:1,this}return x0=e,x0}var w0,zO;function E2(){if(zO)return w0;zO=1;var t=D8(),e=F8(),r=L8(),n=B8(),a=$8();function i(o){var s=-1,u=o==null?0:o.length;for(this.clear();++s<u;){var l=o[s];this.set(l[0],l[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,w0=i,w0}var _0,qO;function NM(){if(qO)return _0;qO=1;var t=E2(),e="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(e);var i=function(){var o=arguments,s=a?a.apply(this,o):o[0],u=i.cache;if(u.has(s))return u.get(s);var l=n.apply(this,o);return i.cache=u.set(s,l)||u,l};return i.cache=new(r.Cache||t),i}return r.Cache=t,_0=r,_0}var S0,VO;function U8(){if(VO)return S0;VO=1;var t=NM(),e=500;function r(n){var a=t(n,function(o){return i.size===e&&i.clear(),o}),i=a.cache;return a}return S0=r,S0}var E0,HO;function W8(){if(HO)return E0;HO=1;var t=U8(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(e,function(o,s,u,l){i.push(u?l.replace(r,"$1"):s||o)}),i});return E0=n,E0}var C0,GO;function C2(){if(GO)return C0;GO=1;function t(e,r){for(var n=-1,a=e==null?0:e.length,i=Array(a);++n<a;)i[n]=r(e[n],n,e);return i}return C0=t,C0}var k0,KO;function z8(){if(KO)return k0;KO=1;var t=Xf(),e=C2(),r=pn(),n=bl(),a=t?t.prototype:void 0,i=a?a.toString:void 0;function o(s){if(typeof s=="string")return s;if(r(s))return e(s,o)+"";if(n(s))return i?i.call(s):"";var u=s+"";return u=="0"&&1/s==-1/0?"-0":u}return k0=o,k0}var A0,XO;function RM(){if(XO)return A0;XO=1;var t=z8();function e(r){return r==null?"":t(r)}return A0=e,A0}var O0,YO;function IM(){if(YO)return O0;YO=1;var t=pn(),e=x2(),r=W8(),n=RM();function a(i,o){return t(i)?i:e(i,o)?[i]:r(n(i))}return O0=a,O0}var T0,JO;function Vv(){if(JO)return T0;JO=1;var t=bl();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return T0=e,T0}var P0,QO;function k2(){if(QO)return P0;QO=1;var t=IM(),e=Vv();function r(n,a){a=t(a,n);for(var i=0,o=a.length;n!=null&&i<o;)n=n[e(a[i++])];return i&&i==o?n:void 0}return P0=r,P0}var N0,ZO;function jM(){if(ZO)return N0;ZO=1;var t=k2();function e(r,n,a){var i=r==null?void 0:t(r,n);return i===void 0?a:i}return N0=e,N0}var q8=jM();const qn=yt(q8);var R0,eT;function V8(){if(eT)return R0;eT=1;function t(e){return e==null}return R0=t,R0}var H8=V8();const nt=yt(H8);var I0,tT;function G8(){if(tT)return I0;tT=1;var t=mi(),e=pn(),r=gi(),n="[object String]";function a(i){return typeof i=="string"||!e(i)&&r(i)&&t(i)==n}return I0=a,I0}var K8=G8();const ss=yt(K8);var X8=w2();const et=yt(X8);var Y8=ho();const xl=yt(Y8);var j0={exports:{}},ht={};var rT;function J8(){if(rT)return ht;rT=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),s=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.offscreen"),g;g=Symbol.for("react.module.reference");function b(y){if(typeof y=="object"&&y!==null){var x=y.$$typeof;switch(x){case t:switch(y=y.type,y){case r:case a:case n:case l:case f:return y;default:switch(y=y&&y.$$typeof,y){case s:case o:case u:case p:case d:case i:return y;default:return x}}case e:return x}}}return ht.ContextConsumer=o,ht.ContextProvider=i,ht.Element=t,ht.ForwardRef=u,ht.Fragment=r,ht.Lazy=p,ht.Memo=d,ht.Portal=e,ht.Profiler=a,ht.StrictMode=n,ht.Suspense=l,ht.SuspenseList=f,ht.isAsyncMode=function(){return!1},ht.isConcurrentMode=function(){return!1},ht.isContextConsumer=function(y){return b(y)===o},ht.isContextProvider=function(y){return b(y)===i},ht.isElement=function(y){return typeof y=="object"&&y!==null&&y.$$typeof===t},ht.isForwardRef=function(y){return b(y)===u},ht.isFragment=function(y){return b(y)===r},ht.isLazy=function(y){return b(y)===p},ht.isMemo=function(y){return b(y)===d},ht.isPortal=function(y){return b(y)===e},ht.isProfiler=function(y){return b(y)===a},ht.isStrictMode=function(y){return b(y)===n},ht.isSuspense=function(y){return b(y)===l},ht.isSuspenseList=function(y){return b(y)===f},ht.isValidElementType=function(y){return typeof y=="string"||typeof y=="function"||y===r||y===a||y===n||y===l||y===f||y===v||typeof y=="object"&&y!==null&&(y.$$typeof===p||y.$$typeof===d||y.$$typeof===i||y.$$typeof===o||y.$$typeof===u||y.$$typeof===g||y.getModuleId!==void 0)},ht.typeOf=b,ht}var nT;function Q8(){return nT||(nT=1,j0.exports=J8()),j0.exports}var Z8=Q8(),D0,aT;function DM(){if(aT)return D0;aT=1;var t=mi(),e=gi(),r="[object Number]";function n(a){return typeof a=="number"||e(a)&&t(a)==r}return D0=n,D0}var M0,iT;function eV(){if(iT)return M0;iT=1;var t=DM();function e(r){return t(r)&&r!=+r}return M0=e,M0}var tV=eV();const wl=yt(tV);var rV=DM();const nV=yt(rV);var ca=function(e){return e===0?0:e>0?1:-1},Yo=function(e){return ss(e)&&e.indexOf("%")===e.length-1},be=function(e){return nV(e)&&!wl(e)},aV=function(e){return nt(e)},ur=function(e){return be(e)||ss(e)},iV=0,_l=function(e){var r=++iV;return"".concat(e||"").concat(r)},us=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!be(e)&&!ss(e))return n;var i;if(Yo(e)){var o=e.indexOf("%");i=r*parseFloat(e.slice(0,o))/100}else i=+e;return wl(i)&&(i=n),a&&i>r&&(i=r),i},Yi=function(e){if(!e)return null;var r=Object.keys(e);return r&&r.length?e[r[0]]:null},oV=function(e){if(!Array.isArray(e))return!1;for(var r=e.length,n={},a=0;a<r;a++)if(!n[e[a]])n[e[a]]=!0;else return!0;return!1},Ir=function(e,r){return be(e)&&be(r)?function(n){return e+n*(r-e)}:function(){return r}};function cp(t,e,r){return!t||!t.length?null:t.find(function(n){return n&&(typeof e=="function"?e(n):qn(n,e))===r})}var sV=function(e,r){return be(e)&&be(r)?e-r:ss(e)&&ss(r)?e.localeCompare(r):e instanceof Date&&r instanceof Date?e.getTime()-r.getTime():String(e).localeCompare(String(r))};function Cu(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function C1(t){"@babel/helpers - typeof";return C1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C1(t)}var uV=["viewBox","children"],lV=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],oT=["points","pathLength"],F0={svg:uV,polygon:oT,polyline:oT},A2=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],fp=function(e,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(V.isValidElement(e)&&(n=e.props),!xl(n))return null;var a={};return Object.keys(n).forEach(function(i){A2.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},cV=function(e,r,n){return function(a){return e(r,n,a),null}},dp=function(e,r,n){if(!xl(e)||C1(e)!=="object")return null;var a=null;return Object.keys(e).forEach(function(i){var o=e[i];A2.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=cV(o,r,n))}),a},fV=["children"],dV=["children"];function sT(t,e){if(t==null)return{};var r=hV(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function hV(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function k1(t){"@babel/helpers - typeof";return k1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k1(t)}var uT={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},si=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},lT=null,L0=null,O2=function t(e){if(e===lT&&Array.isArray(L0))return L0;var r=[];return V.Children.forEach(e,function(n){nt(n)||(Z8.isFragment(n)?r=r.concat(t(n.props.children)):r.push(n))}),L0=r,lT=e,r};function Vn(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(function(a){return si(a)}):n=[si(e)],O2(t).forEach(function(a){var i=qn(a,"type.displayName")||qn(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function _n(t,e){var r=Vn(t,e);return r&&r[0]}var cT=function(e){if(!e||!e.props)return!1;var r=e.props,n=r.width,a=r.height;return!(!be(n)||n<=0||!be(a)||a<=0)},pV=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],vV=function(e){return e&&e.type&&ss(e.type)&&pV.indexOf(e.type)>=0},MM=function(e){return e&&k1(e)==="object"&&"clipDot"in e},mV=function(e,r,n,a){var i,o=(i=F0?.[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!et(e)&&(a&&o.includes(r)||lV.includes(r))||n&&A2.includes(r)},rt=function(e,r,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var a=e;if(V.isValidElement(e)&&(a=e.props),!xl(a))return null;var i={};return Object.keys(a).forEach(function(o){var s;mV((s=a)===null||s===void 0?void 0:s[o],o,r,n)&&(i[o]=a[o])}),i},A1=function t(e,r){if(e===r)return!0;var n=V.Children.count(e);if(n!==V.Children.count(r))return!1;if(n===0)return!0;if(n===1)return fT(Array.isArray(e)?e[0]:e,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=e[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!t(i,o))return!1}else if(!fT(i,o))return!1}return!0},fT=function(e,r){if(nt(e)&&nt(r))return!0;if(!nt(e)&&!nt(r)){var n=e.props||{},a=n.children,i=sT(n,fV),o=r.props||{},s=o.children,u=sT(o,dV);return a&&s?Cu(i,u)&&A1(a,s):!a&&!s?Cu(i,u):!1}return!1},dT=function(e,r){var n=[],a={};return O2(e).forEach(function(i,o){if(vV(i))n.push(i);else if(i){var s=si(i.type),u=r[s]||{},l=u.handler,f=u.once;if(l&&(!f||!a[s])){var d=l(i,s,o);n.push(d),a[s]=!0}}}),n},gV=function(e){var r=e&&e.type;return r&&uT[r]?uT[r]:null},yV=function(e,r){return O2(r).indexOf(e)},bV=["children","width","height","viewBox","className","style","title","desc"];function O1(){return O1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},O1.apply(this,arguments)}function xV(t,e){if(t==null)return{};var r=wV(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function wV(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function T1(t){var e=t.children,r=t.width,n=t.height,a=t.viewBox,i=t.className,o=t.style,s=t.title,u=t.desc,l=xV(t,bV),f=a||{width:r,height:n,x:0,y:0},d=st("recharts-surface",i);return Z.createElement("svg",O1({},rt(l,!0,"svg"),{className:d,width:r,height:n,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height)}),Z.createElement("title",null,s),Z.createElement("desc",null,u),e)}var _V=["children","className"];function P1(){return P1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},P1.apply(this,arguments)}function SV(t,e){if(t==null)return{};var r=EV(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function EV(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Et=Z.forwardRef(function(t,e){var r=t.children,n=t.className,a=SV(t,_V),i=st("recharts-layer",n);return Z.createElement("g",P1({className:i},rt(a,!0),{ref:e}),r)}),ui=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},B0,hT;function CV(){if(hT)return B0;hT=1;function t(e,r,n){var a=-1,i=e.length;r<0&&(r=-r>i?0:i+r),n=n>i?i:n,n<0&&(n+=i),i=r>n?0:n-r>>>0,r>>>=0;for(var o=Array(i);++a<i;)o[a]=e[a+r];return o}return B0=t,B0}var $0,pT;function kV(){if(pT)return $0;pT=1;var t=CV();function e(r,n,a){var i=r.length;return a=a===void 0?i:a,!n&&a>=i?r:t(r,n,a)}return $0=e,$0}var U0,vT;function FM(){if(vT)return U0;vT=1;var t="\\ud800-\\udfff",e="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=e+r+n,i="\\ufe0e\\ufe0f",o="\\u200d",s=RegExp("["+o+t+a+i+"]");function u(l){return s.test(l)}return U0=u,U0}var W0,mT;function AV(){if(mT)return W0;mT=1;function t(e){return e.split("")}return W0=t,W0}var z0,gT;function OV(){if(gT)return z0;gT=1;var t="\\ud800-\\udfff",e="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=e+r+n,i="\\ufe0e\\ufe0f",o="["+t+"]",s="["+a+"]",u="\\ud83c[\\udffb-\\udfff]",l="(?:"+s+"|"+u+")",f="[^"+t+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",v="\\u200d",g=l+"?",b="["+i+"]?",y="(?:"+v+"(?:"+[f,d,p].join("|")+")"+b+g+")*",x=b+g+y,S="(?:"+[f+s+"?",s,d,p,o].join("|")+")",E=RegExp(u+"(?="+u+")|"+S+x,"g");function C(k){return k.match(E)||[]}return z0=C,z0}var q0,yT;function TV(){if(yT)return q0;yT=1;var t=AV(),e=FM(),r=OV();function n(a){return e(a)?r(a):t(a)}return q0=n,q0}var V0,bT;function PV(){if(bT)return V0;bT=1;var t=kV(),e=FM(),r=TV(),n=RM();function a(i){return function(o){o=n(o);var s=e(o)?r(o):void 0,u=s?s[0]:o.charAt(0),l=s?t(s,1).join(""):o.slice(1);return u[i]()+l}}return V0=a,V0}var H0,xT;function NV(){if(xT)return H0;xT=1;var t=PV(),e=t("toUpperCase");return H0=e,H0}var RV=NV();const Hv=yt(RV);function St(t){return function(){return t}}const LM=Math.cos,hp=Math.sin,pa=Math.sqrt,pp=Math.PI,Gv=2*pp,N1=Math.PI,R1=2*N1,Wo=1e-6,IV=R1-Wo;function BM(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function jV(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return BM;const r=10**e;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class DV{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?BM:jV(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,i,o){this._append`C${+e},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(e,r,n,a,i){if(e=+e,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,s=this._y1,u=n-e,l=a-r,f=o-e,d=s-r,p=f*f+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(p>Wo)if(!(Math.abs(d*u-l*f)>Wo)||!i)this._append`L${this._x1=e},${this._y1=r}`;else{let v=n-o,g=a-s,b=u*u+l*l,y=v*v+g*g,x=Math.sqrt(b),S=Math.sqrt(p),E=i*Math.tan((N1-Math.acos((b+p-y)/(2*x*S)))/2),C=E/S,k=E/x;Math.abs(C-1)>Wo&&this._append`L${e+C*f},${r+C*d}`,this._append`A${i},${i},0,0,${+(d*v>f*g)},${this._x1=e+k*u},${this._y1=r+k*l}`}}arc(e,r,n,a,i,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(a),u=n*Math.sin(a),l=e+s,f=r+u,d=1^o,p=o?a-i:i-a;this._x1===null?this._append`M${l},${f}`:(Math.abs(this._x1-l)>Wo||Math.abs(this._y1-f)>Wo)&&this._append`L${l},${f}`,n&&(p<0&&(p=p%R1+R1),p>IV?this._append`A${n},${n},0,1,${d},${e-s},${r-u}A${n},${n},0,1,${d},${this._x1=l},${this._y1=f}`:p>Wo&&this._append`A${n},${n},0,${+(p>=N1)},${d},${this._x1=e+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function T2(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new DV(e)}function P2(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function $M(t){this._context=t}$M.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Kv(t){return new $M(t)}function UM(t){return t[0]}function WM(t){return t[1]}function zM(t,e){var r=St(!0),n=null,a=Kv,i=null,o=T2(s);t=typeof t=="function"?t:t===void 0?UM:St(t),e=typeof e=="function"?e:e===void 0?WM:St(e);function s(u){var l,f=(u=P2(u)).length,d,p=!1,v;for(n==null&&(i=a(v=o())),l=0;l<=f;++l)!(l<f&&r(d=u[l],l,u))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+t(d,l,u),+e(d,l,u));if(v)return i=null,v+""||null}return s.x=function(u){return arguments.length?(t=typeof u=="function"?u:St(+u),s):t},s.y=function(u){return arguments.length?(e=typeof u=="function"?u:St(+u),s):e},s.defined=function(u){return arguments.length?(r=typeof u=="function"?u:St(!!u),s):r},s.curve=function(u){return arguments.length?(a=u,n!=null&&(i=a(n)),s):a},s.context=function(u){return arguments.length?(u==null?n=i=null:i=a(n=u),s):n},s}function Ph(t,e,r){var n=null,a=St(!0),i=null,o=Kv,s=null,u=T2(l);t=typeof t=="function"?t:t===void 0?UM:St(+t),e=typeof e=="function"?e:St(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?WM:St(+r);function l(d){var p,v,g,b=(d=P2(d)).length,y,x=!1,S,E=new Array(b),C=new Array(b);for(i==null&&(s=o(S=u())),p=0;p<=b;++p){if(!(p<b&&a(y=d[p],p,d))===x)if(x=!x)v=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),g=p-1;g>=v;--g)s.point(E[g],C[g]);s.lineEnd(),s.areaEnd()}x&&(E[p]=+t(y,p,d),C[p]=+e(y,p,d),s.point(n?+n(y,p,d):E[p],r?+r(y,p,d):C[p]))}if(S)return s=null,S+""||null}function f(){return zM().defined(a).curve(o).context(i)}return l.x=function(d){return arguments.length?(t=typeof d=="function"?d:St(+d),n=null,l):t},l.x0=function(d){return arguments.length?(t=typeof d=="function"?d:St(+d),l):t},l.x1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:St(+d),l):n},l.y=function(d){return arguments.length?(e=typeof d=="function"?d:St(+d),r=null,l):e},l.y0=function(d){return arguments.length?(e=typeof d=="function"?d:St(+d),l):e},l.y1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:St(+d),l):r},l.lineX0=l.lineY0=function(){return f().x(t).y(e)},l.lineY1=function(){return f().x(t).y(r)},l.lineX1=function(){return f().x(n).y(e)},l.defined=function(d){return arguments.length?(a=typeof d=="function"?d:St(!!d),l):a},l.curve=function(d){return arguments.length?(o=d,i!=null&&(s=o(i)),l):o},l.context=function(d){return arguments.length?(d==null?i=s=null:s=o(i=d),l):i},l}class qM{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function MV(t){return new qM(t,!0)}function FV(t){return new qM(t,!1)}const N2={draw(t,e){const r=pa(e/pp);t.moveTo(r,0),t.arc(0,0,r,0,Gv)}},LV={draw(t,e){const r=pa(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},VM=pa(1/3),BV=VM*2,$V={draw(t,e){const r=pa(e/BV),n=r*VM;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},UV={draw(t,e){const r=pa(e),n=-r/2;t.rect(n,n,r,r)}},WV=.8908130915292852,HM=hp(pp/10)/hp(7*pp/10),zV=hp(Gv/10)*HM,qV=-LM(Gv/10)*HM,VV={draw(t,e){const r=pa(e*WV),n=zV*r,a=qV*r;t.moveTo(0,-r),t.lineTo(n,a);for(let i=1;i<5;++i){const o=Gv*i/5,s=LM(o),u=hp(o);t.lineTo(u*r,-s*r),t.lineTo(s*n-u*a,u*n+s*a)}t.closePath()}},G0=pa(3),HV={draw(t,e){const r=-pa(e/(G0*3));t.moveTo(0,r*2),t.lineTo(-G0*r,-r),t.lineTo(G0*r,-r),t.closePath()}},Fn=-.5,Ln=pa(3)/2,I1=1/pa(12),GV=(I1/2+1)*3,KV={draw(t,e){const r=pa(e/GV),n=r/2,a=r*I1,i=n,o=r*I1+r,s=-i,u=o;t.moveTo(n,a),t.lineTo(i,o),t.lineTo(s,u),t.lineTo(Fn*n-Ln*a,Ln*n+Fn*a),t.lineTo(Fn*i-Ln*o,Ln*i+Fn*o),t.lineTo(Fn*s-Ln*u,Ln*s+Fn*u),t.lineTo(Fn*n+Ln*a,Fn*a-Ln*n),t.lineTo(Fn*i+Ln*o,Fn*o-Ln*i),t.lineTo(Fn*s+Ln*u,Fn*u-Ln*s),t.closePath()}};function XV(t,e){let r=null,n=T2(a);t=typeof t=="function"?t:St(t||N2),e=typeof e=="function"?e:St(e===void 0?64:+e);function a(){let i;if(r||(r=i=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(t=typeof i=="function"?i:St(i),a):t},a.size=function(i){return arguments.length?(e=typeof i=="function"?i:St(+i),a):e},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function vp(){}function mp(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function GM(t){this._context=t}GM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:mp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:mp(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function YV(t){return new GM(t)}function KM(t){this._context=t}KM.prototype={areaStart:vp,areaEnd:vp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:mp(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function JV(t){return new KM(t)}function XM(t){this._context=t}XM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:mp(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function QV(t){return new XM(t)}function YM(t){this._context=t}YM.prototype={areaStart:vp,areaEnd:vp,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function ZV(t){return new YM(t)}function wT(t){return t<0?-1:1}function _T(t,e,r){var n=t._x1-t._x0,a=e-t._x1,i=(t._y1-t._y0)/(n||a<0&&-0),o=(r-t._y1)/(a||n<0&&-0),s=(i*a+o*n)/(n+a);return(wT(i)+wT(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function ST(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function K0(t,e,r){var n=t._x0,a=t._y0,i=t._x1,o=t._y1,s=(i-n)/3;t._context.bezierCurveTo(n+s,a+s*e,i-s,o-s*r,i,o)}function gp(t){this._context=t}gp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:K0(this,this._t0,ST(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,K0(this,ST(this,r=_T(this,t,e)),r);break;default:K0(this,this._t0,r=_T(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function JM(t){this._context=new QM(t)}(JM.prototype=Object.create(gp.prototype)).point=function(t,e){gp.prototype.point.call(this,e,t)};function QM(t){this._context=t}QM.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,i){this._context.bezierCurveTo(e,t,n,r,i,a)}};function eH(t){return new gp(t)}function tH(t){return new JM(t)}function ZM(t){this._context=t}ZM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=ET(t),a=ET(e),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function ET(t){var e,r=t.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,i[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/i[e-1],i[e]-=n,o[e]-=n*o[e-1];for(a[r-1]=o[r-1]/i[r-1],e=r-2;e>=0;--e)a[e]=(o[e]-a[e+1])/i[e];for(i[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)i[e]=2*t[e+1]-a[e+1];return[a,i]}function rH(t){return new ZM(t)}function Xv(t,e){this._context=t,this._t=e}Xv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function nH(t){return new Xv(t,.5)}function aH(t){return new Xv(t,0)}function iH(t){return new Xv(t,1)}function Wu(t,e){if((o=t.length)>1)for(var r=1,n,a,i=t[e[0]],o,s=i.length;r<o;++r)for(a=i,i=t[e[r]],n=0;n<s;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function j1(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function oH(t,e){return t[e]}function sH(t){const e=[];return e.key=t,e}function uH(){var t=St([]),e=j1,r=Wu,n=oH;function a(i){var o=Array.from(t.apply(this,arguments),sH),s,u=o.length,l=-1,f;for(const d of i)for(s=0,++l;s<u;++s)(o[s][l]=[0,+n(d,o[s].key,l,i)]).data=d;for(s=0,f=P2(e(o));s<u;++s)o[f[s]].index=s;return r(o,f),o}return a.keys=function(i){return arguments.length?(t=typeof i=="function"?i:St(Array.from(i)),a):t},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:St(+i),a):n},a.order=function(i){return arguments.length?(e=i==null?j1:typeof i=="function"?i:St(Array.from(i)),a):e},a.offset=function(i){return arguments.length?(r=i??Wu,a):r},a}function lH(t,e){if((n=t.length)>0){for(var r,n,a=0,i=t[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=t[r][a][1]||0;if(o)for(r=0;r<n;++r)t[r][a][1]/=o}Wu(t,e)}}function cH(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,i=n.length;r<i;++r){for(var o=0,s=0;o<a;++o)s+=t[o][r][1]||0;n[r][1]+=n[r][0]=-s/2}Wu(t,e)}}function fH(t,e){if(!(!((o=t.length)>0)||!((i=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var s=0,u=0,l=0;s<o;++s){for(var f=t[e[s]],d=f[n][1]||0,p=f[n-1][1]||0,v=(d-p)/2,g=0;g<s;++g){var b=t[e[g]],y=b[n][1]||0,x=b[n-1][1]||0;v+=y-x}u+=d,l+=v*d}a[n-1][1]+=a[n-1][0]=r,u&&(r-=l/u)}a[n-1][1]+=a[n-1][0]=r,Wu(t,e)}}function af(t){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},af(t)}var dH=["type","size","sizeType"];function D1(){return D1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},D1.apply(this,arguments)}function CT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function kT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CT(Object(r),!0).forEach(function(n){hH(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hH(t,e,r){return e=pH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pH(t){var e=vH(t,"string");return af(e)=="symbol"?e:e+""}function vH(t,e){if(af(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mH(t,e){if(t==null)return{};var r=gH(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function gH(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var e4={symbolCircle:N2,symbolCross:LV,symbolDiamond:$V,symbolSquare:UV,symbolStar:VV,symbolTriangle:HV,symbolWye:KV},yH=Math.PI/180,bH=function(e){var r="symbol".concat(Hv(e));return e4[r]||N2},xH=function(e,r,n){if(r==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*yH;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},wH=function(e,r){e4["symbol".concat(Hv(e))]=r},R2=function(e){var r=e.type,n=r===void 0?"circle":r,a=e.size,i=a===void 0?64:a,o=e.sizeType,s=o===void 0?"area":o,u=mH(e,dH),l=kT(kT({},u),{},{type:n,size:i,sizeType:s}),f=function(){var y=bH(n),x=XV().type(y).size(xH(i,s,n));return x()},d=l.className,p=l.cx,v=l.cy,g=rt(l,!0);return p===+p&&v===+v&&i===+i?Z.createElement("path",D1({},g,{className:st("recharts-symbols",d),transform:"translate(".concat(p,", ").concat(v,")"),d:f()})):null};R2.registerSymbol=wH;function zu(t){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zu(t)}function M1(){return M1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},M1.apply(this,arguments)}function AT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _H(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?AT(Object(r),!0).forEach(function(n){of(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):AT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,r4(n.key),n)}}function CH(t,e,r){return e&&EH(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function kH(t,e,r){return e=yp(e),AH(t,t4()?Reflect.construct(e,r||[],yp(t).constructor):e.apply(t,r))}function AH(t,e){if(e&&(zu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OH(t)}function OH(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function t4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t4=function(){return!!t})()}function yp(t){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yp(t)}function TH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F1(t,e)}function F1(t,e){return F1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},F1(t,e)}function of(t,e,r){return e=r4(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r4(t){var e=PH(t,"string");return zu(e)=="symbol"?e:e+""}function PH(t,e){if(zu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(zu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Bn=32,I2=(function(t){function e(){return SH(this,e),kH(this,e,arguments)}return TH(e,t),CH(e,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Bn/2,o=Bn/6,s=Bn/3,u=n.inactive?a:n.color;if(n.type==="plainline")return Z.createElement("line",{strokeWidth:4,fill:"none",stroke:u,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Bn,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return Z.createElement("path",{strokeWidth:4,fill:"none",stroke:u,d:"M0,".concat(i,"h").concat(s,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*s,",").concat(i,`
            H`).concat(Bn,"M").concat(2*s,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(s,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return Z.createElement("path",{stroke:"none",fill:u,d:"M0,".concat(Bn/8,"h").concat(Bn,"v").concat(Bn*3/4,"h").concat(-Bn,"z"),className:"recharts-legend-icon"});if(Z.isValidElement(n.legendIcon)){var l=_H({},n);return delete l.legendIcon,Z.cloneElement(n.legendIcon,l)}return Z.createElement(R2,{fill:u,cx:i,cy:i,size:Bn,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,s=a.layout,u=a.formatter,l=a.inactiveColor,f={x:0,y:0,width:Bn,height:Bn},d={display:s==="horizontal"?"inline-block":"block",marginRight:10},p={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(v,g){var b=v.formatter||u,y=st(of(of({"recharts-legend-item":!0},"legend-item-".concat(g),!0),"inactive",v.inactive));if(v.type==="none")return null;var x=et(v.value)?null:v.value;ui(!et(v.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var S=v.inactive?l:v.color;return Z.createElement("li",M1({className:y,style:d,key:"legend-item-".concat(g)},dp(n.props,v,g)),Z.createElement(T1,{width:o,height:o,viewBox:f,style:p},n.renderIcon(v)),Z.createElement("span",{className:"recharts-legend-item-text",style:{color:S}},b?b(x,v,g):x))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var s={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return Z.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])})(V.PureComponent);of(I2,"displayName","Legend");of(I2,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var X0,OT;function NH(){if(OT)return X0;OT=1;var t=zv();function e(){this.__data__=new t,this.size=0}return X0=e,X0}var Y0,TT;function RH(){if(TT)return Y0;TT=1;function t(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}return Y0=t,Y0}var J0,PT;function IH(){if(PT)return J0;PT=1;function t(e){return this.__data__.get(e)}return J0=t,J0}var Q0,NT;function jH(){if(NT)return Q0;NT=1;function t(e){return this.__data__.has(e)}return Q0=t,Q0}var Z0,RT;function DH(){if(RT)return Z0;RT=1;var t=zv(),e=S2(),r=E2(),n=200;function a(i,o){var s=this.__data__;if(s instanceof t){var u=s.__data__;if(!e||u.length<n-1)return u.push([i,o]),this.size=++s.size,this;s=this.__data__=new r(u)}return s.set(i,o),this.size=s.size,this}return Z0=a,Z0}var eb,IT;function n4(){if(IT)return eb;IT=1;var t=zv(),e=NH(),r=RH(),n=IH(),a=jH(),i=DH();function o(s){var u=this.__data__=new t(s);this.size=u.size}return o.prototype.clear=e,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=a,o.prototype.set=i,eb=o,eb}var tb,jT;function MH(){if(jT)return tb;jT=1;var t="__lodash_hash_undefined__";function e(r){return this.__data__.set(r,t),this}return tb=e,tb}var rb,DT;function FH(){if(DT)return rb;DT=1;function t(e){return this.__data__.has(e)}return rb=t,rb}var nb,MT;function a4(){if(MT)return nb;MT=1;var t=E2(),e=MH(),r=FH();function n(a){var i=-1,o=a==null?0:a.length;for(this.__data__=new t;++i<o;)this.add(a[i])}return n.prototype.add=n.prototype.push=e,n.prototype.has=r,nb=n,nb}var ab,FT;function i4(){if(FT)return ab;FT=1;function t(e,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(e[n],n,e))return!0;return!1}return ab=t,ab}var ib,LT;function o4(){if(LT)return ib;LT=1;function t(e,r){return e.has(r)}return ib=t,ib}var ob,BT;function s4(){if(BT)return ob;BT=1;var t=a4(),e=i4(),r=o4(),n=1,a=2;function i(o,s,u,l,f,d){var p=u&n,v=o.length,g=s.length;if(v!=g&&!(p&&g>v))return!1;var b=d.get(o),y=d.get(s);if(b&&y)return b==s&&y==o;var x=-1,S=!0,E=u&a?new t:void 0;for(d.set(o,s),d.set(s,o);++x<v;){var C=o[x],k=s[x];if(l)var A=p?l(k,C,x,s,o,d):l(C,k,x,o,s,d);if(A!==void 0){if(A)continue;S=!1;break}if(E){if(!e(s,function(T,N){if(!r(E,N)&&(C===T||f(C,T,u,l,d)))return E.push(N)})){S=!1;break}}else if(!(C===k||f(C,k,u,l,d))){S=!1;break}}return d.delete(o),d.delete(s),S}return ob=i,ob}var sb,$T;function LH(){if($T)return sb;$T=1;var t=$a(),e=t.Uint8Array;return sb=e,sb}var ub,UT;function BH(){if(UT)return ub;UT=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(a,i){n[++r]=[i,a]}),n}return ub=t,ub}var lb,WT;function j2(){if(WT)return lb;WT=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(a){n[++r]=a}),n}return lb=t,lb}var cb,zT;function $H(){if(zT)return cb;zT=1;var t=Xf(),e=LH(),r=_2(),n=s4(),a=BH(),i=j2(),o=1,s=2,u="[object Boolean]",l="[object Date]",f="[object Error]",d="[object Map]",p="[object Number]",v="[object RegExp]",g="[object Set]",b="[object String]",y="[object Symbol]",x="[object ArrayBuffer]",S="[object DataView]",E=t?t.prototype:void 0,C=E?E.valueOf:void 0;function k(A,T,N,R,I,D,j){switch(N){case S:if(A.byteLength!=T.byteLength||A.byteOffset!=T.byteOffset)return!1;A=A.buffer,T=T.buffer;case x:return!(A.byteLength!=T.byteLength||!D(new e(A),new e(T)));case u:case l:case p:return r(+A,+T);case f:return A.name==T.name&&A.message==T.message;case v:case b:return A==T+"";case d:var $=a;case g:var W=R&o;if($||($=i),A.size!=T.size&&!W)return!1;var q=j.get(A);if(q)return q==T;R|=s,j.set(A,T);var X=n($(A),$(T),R,I,D,j);return j.delete(A),X;case y:if(C)return C.call(A)==C.call(T)}return!1}return cb=k,cb}var fb,qT;function u4(){if(qT)return fb;qT=1;function t(e,r){for(var n=-1,a=r.length,i=e.length;++n<a;)e[i+n]=r[n];return e}return fb=t,fb}var db,VT;function UH(){if(VT)return db;VT=1;var t=u4(),e=pn();function r(n,a,i){var o=a(n);return e(n)?o:t(o,i(n))}return db=r,db}var hb,HT;function WH(){if(HT)return hb;HT=1;function t(e,r){for(var n=-1,a=e==null?0:e.length,i=0,o=[];++n<a;){var s=e[n];r(s,n,e)&&(o[i++]=s)}return o}return hb=t,hb}var pb,GT;function zH(){if(GT)return pb;GT=1;function t(){return[]}return pb=t,pb}var vb,KT;function qH(){if(KT)return vb;KT=1;var t=WH(),e=zH(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(o){return o==null?[]:(o=Object(o),t(a(o),function(s){return n.call(o,s)}))}:e;return vb=i,vb}var mb,XT;function VH(){if(XT)return mb;XT=1;function t(e,r){for(var n=-1,a=Array(e);++n<e;)a[n]=r(n);return a}return mb=t,mb}var gb,YT;function HH(){if(YT)return gb;YT=1;var t=mi(),e=gi(),r="[object Arguments]";function n(a){return e(a)&&t(a)==r}return gb=n,gb}var yb,JT;function D2(){if(JT)return yb;JT=1;var t=HH(),e=gi(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,i=t((function(){return arguments})())?t:function(o){return e(o)&&n.call(o,"callee")&&!a.call(o,"callee")};return yb=i,yb}var Rc={exports:{}},bb,QT;function GH(){if(QT)return bb;QT=1;function t(){return!1}return bb=t,bb}Rc.exports;var ZT;function l4(){return ZT||(ZT=1,(function(t,e){var r=$a(),n=GH(),a=e&&!e.nodeType&&e,i=a&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===a,s=o?r.Buffer:void 0,u=s?s.isBuffer:void 0,l=u||n;t.exports=l})(Rc,Rc.exports)),Rc.exports}var xb,eP;function M2(){if(eP)return xb;eP=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,a){var i=typeof n;return a=a??t,!!a&&(i=="number"||i!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<a}return xb=r,xb}var wb,tP;function F2(){if(tP)return wb;tP=1;var t=9007199254740991;function e(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=t}return wb=e,wb}var _b,rP;function KH(){if(rP)return _b;rP=1;var t=mi(),e=F2(),r=gi(),n="[object Arguments]",a="[object Array]",i="[object Boolean]",o="[object Date]",s="[object Error]",u="[object Function]",l="[object Map]",f="[object Number]",d="[object Object]",p="[object RegExp]",v="[object Set]",g="[object String]",b="[object WeakMap]",y="[object ArrayBuffer]",x="[object DataView]",S="[object Float32Array]",E="[object Float64Array]",C="[object Int8Array]",k="[object Int16Array]",A="[object Int32Array]",T="[object Uint8Array]",N="[object Uint8ClampedArray]",R="[object Uint16Array]",I="[object Uint32Array]",D={};D[S]=D[E]=D[C]=D[k]=D[A]=D[T]=D[N]=D[R]=D[I]=!0,D[n]=D[a]=D[y]=D[i]=D[x]=D[o]=D[s]=D[u]=D[l]=D[f]=D[d]=D[p]=D[v]=D[g]=D[b]=!1;function j($){return r($)&&e($.length)&&!!D[t($)]}return _b=j,_b}var Sb,nP;function c4(){if(nP)return Sb;nP=1;function t(e){return function(r){return e(r)}}return Sb=t,Sb}var Ic={exports:{}};Ic.exports;var aP;function XH(){return aP||(aP=1,(function(t,e){var r=TM(),n=e&&!e.nodeType&&e,a=n&&!0&&t&&!t.nodeType&&t,i=a&&a.exports===n,o=i&&r.process,s=(function(){try{var u=a&&a.require&&a.require("util").types;return u||o&&o.binding&&o.binding("util")}catch{}})();t.exports=s})(Ic,Ic.exports)),Ic.exports}var Eb,iP;function f4(){if(iP)return Eb;iP=1;var t=KH(),e=c4(),r=XH(),n=r&&r.isTypedArray,a=n?e(n):t;return Eb=a,Eb}var Cb,oP;function YH(){if(oP)return Cb;oP=1;var t=VH(),e=D2(),r=pn(),n=l4(),a=M2(),i=f4(),o=Object.prototype,s=o.hasOwnProperty;function u(l,f){var d=r(l),p=!d&&e(l),v=!d&&!p&&n(l),g=!d&&!p&&!v&&i(l),b=d||p||v||g,y=b?t(l.length,String):[],x=y.length;for(var S in l)(f||s.call(l,S))&&!(b&&(S=="length"||v&&(S=="offset"||S=="parent")||g&&(S=="buffer"||S=="byteLength"||S=="byteOffset")||a(S,x)))&&y.push(S);return y}return Cb=u,Cb}var kb,sP;function JH(){if(sP)return kb;sP=1;var t=Object.prototype;function e(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||t;return r===a}return kb=e,kb}var Ab,uP;function d4(){if(uP)return Ab;uP=1;function t(e,r){return function(n){return e(r(n))}}return Ab=t,Ab}var Ob,lP;function QH(){if(lP)return Ob;lP=1;var t=d4(),e=t(Object.keys,Object);return Ob=e,Ob}var Tb,cP;function ZH(){if(cP)return Tb;cP=1;var t=JH(),e=QH(),r=Object.prototype,n=r.hasOwnProperty;function a(i){if(!t(i))return e(i);var o=[];for(var s in Object(i))n.call(i,s)&&s!="constructor"&&o.push(s);return o}return Tb=a,Tb}var Pb,fP;function Yf(){if(fP)return Pb;fP=1;var t=w2(),e=F2();function r(n){return n!=null&&e(n.length)&&!t(n)}return Pb=r,Pb}var Nb,dP;function Yv(){if(dP)return Nb;dP=1;var t=YH(),e=ZH(),r=Yf();function n(a){return r(a)?t(a):e(a)}return Nb=n,Nb}var Rb,hP;function eG(){if(hP)return Rb;hP=1;var t=UH(),e=qH(),r=Yv();function n(a){return t(a,r,e)}return Rb=n,Rb}var Ib,pP;function tG(){if(pP)return Ib;pP=1;var t=eG(),e=1,r=Object.prototype,n=r.hasOwnProperty;function a(i,o,s,u,l,f){var d=s&e,p=t(i),v=p.length,g=t(o),b=g.length;if(v!=b&&!d)return!1;for(var y=v;y--;){var x=p[y];if(!(d?x in o:n.call(o,x)))return!1}var S=f.get(i),E=f.get(o);if(S&&E)return S==o&&E==i;var C=!0;f.set(i,o),f.set(o,i);for(var k=d;++y<v;){x=p[y];var A=i[x],T=o[x];if(u)var N=d?u(T,A,x,o,i,f):u(A,T,x,i,o,f);if(!(N===void 0?A===T||l(A,T,s,u,f):N)){C=!1;break}k||(k=x=="constructor")}if(C&&!k){var R=i.constructor,I=o.constructor;R!=I&&"constructor"in i&&"constructor"in o&&!(typeof R=="function"&&R instanceof R&&typeof I=="function"&&I instanceof I)&&(C=!1)}return f.delete(i),f.delete(o),C}return Ib=a,Ib}var jb,vP;function rG(){if(vP)return jb;vP=1;var t=vs(),e=$a(),r=t(e,"DataView");return jb=r,jb}var Db,mP;function nG(){if(mP)return Db;mP=1;var t=vs(),e=$a(),r=t(e,"Promise");return Db=r,Db}var Mb,gP;function h4(){if(gP)return Mb;gP=1;var t=vs(),e=$a(),r=t(e,"Set");return Mb=r,Mb}var Fb,yP;function aG(){if(yP)return Fb;yP=1;var t=vs(),e=$a(),r=t(e,"WeakMap");return Fb=r,Fb}var Lb,bP;function iG(){if(bP)return Lb;bP=1;var t=rG(),e=S2(),r=nG(),n=h4(),a=aG(),i=mi(),o=PM(),s="[object Map]",u="[object Object]",l="[object Promise]",f="[object Set]",d="[object WeakMap]",p="[object DataView]",v=o(t),g=o(e),b=o(r),y=o(n),x=o(a),S=i;return(t&&S(new t(new ArrayBuffer(1)))!=p||e&&S(new e)!=s||r&&S(r.resolve())!=l||n&&S(new n)!=f||a&&S(new a)!=d)&&(S=function(E){var C=i(E),k=C==u?E.constructor:void 0,A=k?o(k):"";if(A)switch(A){case v:return p;case g:return s;case b:return l;case y:return f;case x:return d}return C}),Lb=S,Lb}var Bb,xP;function oG(){if(xP)return Bb;xP=1;var t=n4(),e=s4(),r=$H(),n=tG(),a=iG(),i=pn(),o=l4(),s=f4(),u=1,l="[object Arguments]",f="[object Array]",d="[object Object]",p=Object.prototype,v=p.hasOwnProperty;function g(b,y,x,S,E,C){var k=i(b),A=i(y),T=k?f:a(b),N=A?f:a(y);T=T==l?d:T,N=N==l?d:N;var R=T==d,I=N==d,D=T==N;if(D&&o(b)){if(!o(y))return!1;k=!0,R=!1}if(D&&!R)return C||(C=new t),k||s(b)?e(b,y,x,S,E,C):r(b,y,T,x,S,E,C);if(!(x&u)){var j=R&&v.call(b,"__wrapped__"),$=I&&v.call(y,"__wrapped__");if(j||$){var W=j?b.value():b,q=$?y.value():y;return C||(C=new t),E(W,q,x,S,C)}}return D?(C||(C=new t),n(b,y,x,S,E,C)):!1}return Bb=g,Bb}var $b,wP;function L2(){if(wP)return $b;wP=1;var t=oG(),e=gi();function r(n,a,i,o,s){return n===a?!0:n==null||a==null||!e(n)&&!e(a)?n!==n&&a!==a:t(n,a,i,o,r,s)}return $b=r,$b}var Ub,_P;function sG(){if(_P)return Ub;_P=1;var t=n4(),e=L2(),r=1,n=2;function a(i,o,s,u){var l=s.length,f=l,d=!u;if(i==null)return!f;for(i=Object(i);l--;){var p=s[l];if(d&&p[2]?p[1]!==i[p[0]]:!(p[0]in i))return!1}for(;++l<f;){p=s[l];var v=p[0],g=i[v],b=p[1];if(d&&p[2]){if(g===void 0&&!(v in i))return!1}else{var y=new t;if(u)var x=u(g,b,v,i,o,y);if(!(x===void 0?e(b,g,r|n,u,y):x))return!1}}return!0}return Ub=a,Ub}var Wb,SP;function p4(){if(SP)return Wb;SP=1;var t=ho();function e(r){return r===r&&!t(r)}return Wb=e,Wb}var zb,EP;function uG(){if(EP)return zb;EP=1;var t=p4(),e=Yv();function r(n){for(var a=e(n),i=a.length;i--;){var o=a[i],s=n[o];a[i]=[o,s,t(s)]}return a}return zb=r,zb}var qb,CP;function v4(){if(CP)return qb;CP=1;function t(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==void 0||e in Object(n))}}return qb=t,qb}var Vb,kP;function lG(){if(kP)return Vb;kP=1;var t=sG(),e=uG(),r=v4();function n(a){var i=e(a);return i.length==1&&i[0][2]?r(i[0][0],i[0][1]):function(o){return o===a||t(o,a,i)}}return Vb=n,Vb}var Hb,AP;function cG(){if(AP)return Hb;AP=1;function t(e,r){return e!=null&&r in Object(e)}return Hb=t,Hb}var Gb,OP;function fG(){if(OP)return Gb;OP=1;var t=IM(),e=D2(),r=pn(),n=M2(),a=F2(),i=Vv();function o(s,u,l){u=t(u,s);for(var f=-1,d=u.length,p=!1;++f<d;){var v=i(u[f]);if(!(p=s!=null&&l(s,v)))break;s=s[v]}return p||++f!=d?p:(d=s==null?0:s.length,!!d&&a(d)&&n(v,d)&&(r(s)||e(s)))}return Gb=o,Gb}var Kb,TP;function dG(){if(TP)return Kb;TP=1;var t=cG(),e=fG();function r(n,a){return n!=null&&e(n,a,t)}return Kb=r,Kb}var Xb,PP;function hG(){if(PP)return Xb;PP=1;var t=L2(),e=jM(),r=dG(),n=x2(),a=p4(),i=v4(),o=Vv(),s=1,u=2;function l(f,d){return n(f)&&a(d)?i(o(f),d):function(p){var v=e(p,f);return v===void 0&&v===d?r(p,f):t(d,v,s|u)}}return Xb=l,Xb}var Yb,NP;function Sl(){if(NP)return Yb;NP=1;function t(e){return e}return Yb=t,Yb}var Jb,RP;function pG(){if(RP)return Jb;RP=1;function t(e){return function(r){return r?.[e]}}return Jb=t,Jb}var Qb,IP;function vG(){if(IP)return Qb;IP=1;var t=k2();function e(r){return function(n){return t(n,r)}}return Qb=e,Qb}var Zb,jP;function mG(){if(jP)return Zb;jP=1;var t=pG(),e=vG(),r=x2(),n=Vv();function a(i){return r(i)?t(n(i)):e(i)}return Zb=a,Zb}var ex,DP;function po(){if(DP)return ex;DP=1;var t=lG(),e=hG(),r=Sl(),n=pn(),a=mG();function i(o){return typeof o=="function"?o:o==null?r:typeof o=="object"?n(o)?e(o[0],o[1]):t(o):a(o)}return ex=i,ex}var tx,MP;function m4(){if(MP)return tx;MP=1;function t(e,r,n,a){for(var i=e.length,o=n+(a?1:-1);a?o--:++o<i;)if(r(e[o],o,e))return o;return-1}return tx=t,tx}var rx,FP;function gG(){if(FP)return rx;FP=1;function t(e){return e!==e}return rx=t,rx}var nx,LP;function yG(){if(LP)return nx;LP=1;function t(e,r,n){for(var a=n-1,i=e.length;++a<i;)if(e[a]===r)return a;return-1}return nx=t,nx}var ax,BP;function bG(){if(BP)return ax;BP=1;var t=m4(),e=gG(),r=yG();function n(a,i,o){return i===i?r(a,i,o):t(a,e,o)}return ax=n,ax}var ix,$P;function xG(){if($P)return ix;$P=1;var t=bG();function e(r,n){var a=r==null?0:r.length;return!!a&&t(r,n,0)>-1}return ix=e,ix}var ox,UP;function wG(){if(UP)return ox;UP=1;function t(e,r,n){for(var a=-1,i=e==null?0:e.length;++a<i;)if(n(r,e[a]))return!0;return!1}return ox=t,ox}var sx,WP;function _G(){if(WP)return sx;WP=1;function t(){}return sx=t,sx}var ux,zP;function SG(){if(zP)return ux;zP=1;var t=h4(),e=_G(),r=j2(),n=1/0,a=t&&1/r(new t([,-0]))[1]==n?function(i){return new t(i)}:e;return ux=a,ux}var lx,qP;function EG(){if(qP)return lx;qP=1;var t=a4(),e=xG(),r=wG(),n=o4(),a=SG(),i=j2(),o=200;function s(u,l,f){var d=-1,p=e,v=u.length,g=!0,b=[],y=b;if(f)g=!1,p=r;else if(v>=o){var x=l?null:a(u);if(x)return i(x);g=!1,p=n,y=new t}else y=l?[]:b;e:for(;++d<v;){var S=u[d],E=l?l(S):S;if(S=f||S!==0?S:0,g&&E===E){for(var C=y.length;C--;)if(y[C]===E)continue e;l&&y.push(E),b.push(S)}else p(y,E,f)||(y!==b&&y.push(E),b.push(S))}return b}return lx=s,lx}var cx,VP;function CG(){if(VP)return cx;VP=1;var t=po(),e=EG();function r(n,a){return n&&n.length?e(n,t(a,2)):[]}return cx=r,cx}var kG=CG();const HP=yt(kG);function g4(t,e,r){return e===!0?HP(t,r):et(e)?HP(t,e):t}function qu(t){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qu(t)}var AG=["ref"];function GP(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Za(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GP(Object(r),!0).forEach(function(n){Jv(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GP(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KP(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b4(n.key),n)}}function TG(t,e,r){return e&&KP(t.prototype,e),r&&KP(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PG(t,e,r){return e=bp(e),NG(t,y4()?Reflect.construct(e,r||[],bp(t).constructor):e.apply(t,r))}function NG(t,e){if(e&&(qu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RG(t)}function RG(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(y4=function(){return!!t})()}function bp(t){return bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bp(t)}function IG(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L1(t,e)}function L1(t,e){return L1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},L1(t,e)}function Jv(t,e,r){return e=b4(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b4(t){var e=jG(t,"string");return qu(e)=="symbol"?e:e+""}function jG(t,e){if(qu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(qu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function DG(t,e){if(t==null)return{};var r=MG(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function MG(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function FG(t){return t.value}function LG(t,e){if(Z.isValidElement(t))return Z.cloneElement(t,e);if(typeof t=="function")return Z.createElement(t,e);e.ref;var r=DG(e,AG);return Z.createElement(I2,r)}var XP=1,ku=(function(t){function e(){var r;OG(this,e);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=PG(this,e,[].concat(a)),Jv(r,"lastBoundingBox",{width:-1,height:-1}),r}return IG(e,t),TG(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>XP||Math.abs(a.height-this.lastBoundingBox.height)>XP)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Za({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,s=a.verticalAlign,u=a.margin,l=a.chartWidth,f=a.chartHeight,d,p;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var v=this.getBBoxSnapshot();d={left:((l||0)-v.width)/2}}else d=o==="right"?{right:u&&u.right||0}:{left:u&&u.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(s==="middle"){var g=this.getBBoxSnapshot();p={top:((f||0)-g.height)/2}}else p=s==="bottom"?{bottom:u&&u.bottom||0}:{top:u&&u.top||0};return Za(Za({},d),p)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,s=a.height,u=a.wrapperStyle,l=a.payloadUniqBy,f=a.payload,d=Za(Za({position:"absolute",width:o||"auto",height:s||"auto"},this.getDefaultPosition(u)),u);return Z.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(v){n.wrapperNode=v}},LG(i,Za(Za({},this.props),{},{payload:g4(f,l,FG)})))}}],[{key:"getWithHeight",value:function(n,a){var i=Za(Za({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&be(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])})(V.PureComponent);Jv(ku,"displayName","Legend");Jv(ku,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var fx,YP;function BG(){if(YP)return fx;YP=1;var t=Xf(),e=D2(),r=pn(),n=t?t.isConcatSpreadable:void 0;function a(i){return r(i)||e(i)||!!(n&&i&&i[n])}return fx=a,fx}var dx,JP;function x4(){if(JP)return dx;JP=1;var t=u4(),e=BG();function r(n,a,i,o,s){var u=-1,l=n.length;for(i||(i=e),s||(s=[]);++u<l;){var f=n[u];a>0&&i(f)?a>1?r(f,a-1,i,o,s):t(s,f):o||(s[s.length]=f)}return s}return dx=r,dx}var hx,QP;function $G(){if(QP)return hx;QP=1;function t(e){return function(r,n,a){for(var i=-1,o=Object(r),s=a(r),u=s.length;u--;){var l=s[e?u:++i];if(n(o[l],l,o)===!1)break}return r}}return hx=t,hx}var px,ZP;function UG(){if(ZP)return px;ZP=1;var t=$G(),e=t();return px=e,px}var vx,eN;function w4(){if(eN)return vx;eN=1;var t=UG(),e=Yv();function r(n,a){return n&&t(n,a,e)}return vx=r,vx}var mx,tN;function WG(){if(tN)return mx;tN=1;var t=Yf();function e(r,n){return function(a,i){if(a==null)return a;if(!t(a))return r(a,i);for(var o=a.length,s=n?o:-1,u=Object(a);(n?s--:++s<o)&&i(u[s],s,u)!==!1;);return a}}return mx=e,mx}var gx,rN;function B2(){if(rN)return gx;rN=1;var t=w4(),e=WG(),r=e(t);return gx=r,gx}var yx,nN;function _4(){if(nN)return yx;nN=1;var t=B2(),e=Yf();function r(n,a){var i=-1,o=e(n)?Array(n.length):[];return t(n,function(s,u,l){o[++i]=a(s,u,l)}),o}return yx=r,yx}var bx,aN;function zG(){if(aN)return bx;aN=1;function t(e,r){var n=e.length;for(e.sort(r);n--;)e[n]=e[n].value;return e}return bx=t,bx}var xx,iN;function qG(){if(iN)return xx;iN=1;var t=bl();function e(r,n){if(r!==n){var a=r!==void 0,i=r===null,o=r===r,s=t(r),u=n!==void 0,l=n===null,f=n===n,d=t(n);if(!l&&!d&&!s&&r>n||s&&u&&f&&!l&&!d||i&&u&&f||!a&&f||!o)return 1;if(!i&&!s&&!d&&r<n||d&&a&&o&&!i&&!s||l&&a&&o||!u&&o||!f)return-1}return 0}return xx=e,xx}var wx,oN;function VG(){if(oN)return wx;oN=1;var t=qG();function e(r,n,a){for(var i=-1,o=r.criteria,s=n.criteria,u=o.length,l=a.length;++i<u;){var f=t(o[i],s[i]);if(f){if(i>=l)return f;var d=a[i];return f*(d=="desc"?-1:1)}}return r.index-n.index}return wx=e,wx}var _x,sN;function HG(){if(sN)return _x;sN=1;var t=C2(),e=k2(),r=po(),n=_4(),a=zG(),i=c4(),o=VG(),s=Sl(),u=pn();function l(f,d,p){d.length?d=t(d,function(b){return u(b)?function(y){return e(y,b.length===1?b[0]:b)}:b}):d=[s];var v=-1;d=t(d,i(r));var g=n(f,function(b,y,x){var S=t(d,function(E){return E(b)});return{criteria:S,index:++v,value:b}});return a(g,function(b,y){return o(b,y,p)})}return _x=l,_x}var Sx,uN;function GG(){if(uN)return Sx;uN=1;function t(e,r,n){switch(n.length){case 0:return e.call(r);case 1:return e.call(r,n[0]);case 2:return e.call(r,n[0],n[1]);case 3:return e.call(r,n[0],n[1],n[2])}return e.apply(r,n)}return Sx=t,Sx}var Ex,lN;function KG(){if(lN)return Ex;lN=1;var t=GG(),e=Math.max;function r(n,a,i){return a=e(a===void 0?n.length-1:a,0),function(){for(var o=arguments,s=-1,u=e(o.length-a,0),l=Array(u);++s<u;)l[s]=o[a+s];s=-1;for(var f=Array(a+1);++s<a;)f[s]=o[s];return f[a]=i(l),t(n,this,f)}}return Ex=r,Ex}var Cx,cN;function XG(){if(cN)return Cx;cN=1;function t(e){return function(){return e}}return Cx=t,Cx}var kx,fN;function S4(){if(fN)return kx;fN=1;var t=vs(),e=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return kx=e,kx}var Ax,dN;function YG(){if(dN)return Ax;dN=1;var t=XG(),e=S4(),r=Sl(),n=e?function(a,i){return e(a,"toString",{configurable:!0,enumerable:!1,value:t(i),writable:!0})}:r;return Ax=n,Ax}var Ox,hN;function JG(){if(hN)return Ox;hN=1;var t=800,e=16,r=Date.now;function n(a){var i=0,o=0;return function(){var s=r(),u=e-(s-o);if(o=s,u>0){if(++i>=t)return arguments[0]}else i=0;return a.apply(void 0,arguments)}}return Ox=n,Ox}var Tx,pN;function QG(){if(pN)return Tx;pN=1;var t=YG(),e=JG(),r=e(t);return Tx=r,Tx}var Px,vN;function ZG(){if(vN)return Px;vN=1;var t=Sl(),e=KG(),r=QG();function n(a,i){return r(e(a,i,t),a+"")}return Px=n,Px}var Nx,mN;function Qv(){if(mN)return Nx;mN=1;var t=_2(),e=Yf(),r=M2(),n=ho();function a(i,o,s){if(!n(s))return!1;var u=typeof o;return(u=="number"?e(s)&&r(o,s.length):u=="string"&&o in s)?t(s[o],i):!1}return Nx=a,Nx}var Rx,gN;function eK(){if(gN)return Rx;gN=1;var t=x4(),e=HG(),r=ZG(),n=Qv(),a=r(function(i,o){if(i==null)return[];var s=o.length;return s>1&&n(i,o[0],o[1])?o=[]:s>2&&n(o[0],o[1],o[2])&&(o=[o[0]]),e(i,t(o,1),[])});return Rx=a,Rx}var tK=eK();const $2=yt(tK);function sf(t){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sf(t)}function B1(){return B1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},B1.apply(this,arguments)}function rK(t,e){return oK(t)||iK(t,e)||aK(t,e)||nK()}function nK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aK(t,e){if(t){if(typeof t=="string")return yN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yN(t,e)}}function yN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function iK(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function oK(t){if(Array.isArray(t))return t}function bN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ix(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bN(Object(r),!0).forEach(function(n){sK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sK(t,e,r){return e=uK(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uK(t){var e=lK(t,"string");return sf(e)=="symbol"?e:e+""}function lK(t,e){if(sf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cK(t){return Array.isArray(t)&&ur(t[0])&&ur(t[1])?t.join(" ~ "):t}var fK=function(e){var r=e.separator,n=r===void 0?" : ":r,a=e.contentStyle,i=a===void 0?{}:a,o=e.itemStyle,s=o===void 0?{}:o,u=e.labelStyle,l=u===void 0?{}:u,f=e.payload,d=e.formatter,p=e.itemSorter,v=e.wrapperClassName,g=e.labelClassName,b=e.label,y=e.labelFormatter,x=e.accessibilityLayer,S=x===void 0?!1:x,E=function(){if(f&&f.length){var j={padding:0,margin:0},$=(p?$2(f,p):f).map(function(W,q){if(W.type==="none")return null;var X=Ix({display:"block",paddingTop:4,paddingBottom:4,color:W.color||"#000"},s),Y=W.formatter||d||cK,z=W.value,B=W.name,G=z,L=B;if(Y&&G!=null&&L!=null){var K=Y(z,B,W,q,f);if(Array.isArray(K)){var oe=rK(K,2);G=oe[0],L=oe[1]}else G=K}return Z.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(q),style:X},ur(L)?Z.createElement("span",{className:"recharts-tooltip-item-name"},L):null,ur(L)?Z.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Z.createElement("span",{className:"recharts-tooltip-item-value"},G),Z.createElement("span",{className:"recharts-tooltip-item-unit"},W.unit||""))});return Z.createElement("ul",{className:"recharts-tooltip-item-list",style:j},$)}return null},C=Ix({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),k=Ix({margin:0},l),A=!nt(b),T=A?b:"",N=st("recharts-default-tooltip",v),R=st("recharts-tooltip-label",g);A&&y&&f!==void 0&&f!==null&&(T=y(b,f));var I=S?{role:"status","aria-live":"assertive"}:{};return Z.createElement("div",B1({className:N,style:C},I),Z.createElement("p",{className:R,style:k},Z.isValidElement(T)?T:"".concat(T)),E())};function uf(t){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uf(t)}function Nh(t,e,r){return e=dK(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dK(t){var e=hK(t,"string");return uf(e)=="symbol"?e:e+""}function hK(t,e){if(uf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(uf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yc="recharts-tooltip-wrapper",pK={visibility:"hidden"};function vK(t){var e=t.coordinate,r=t.translateX,n=t.translateY;return st(yc,Nh(Nh(Nh(Nh({},"".concat(yc,"-right"),be(r)&&e&&be(e.x)&&r>=e.x),"".concat(yc,"-left"),be(r)&&e&&be(e.x)&&r<e.x),"".concat(yc,"-bottom"),be(n)&&e&&be(e.y)&&n>=e.y),"".concat(yc,"-top"),be(n)&&e&&be(e.y)&&n<e.y))}function xN(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.key,a=t.offsetTopLeft,i=t.position,o=t.reverseDirection,s=t.tooltipDimension,u=t.viewBox,l=t.viewBoxDimension;if(i&&be(i[n]))return i[n];var f=r[n]-s-a,d=r[n]+a;if(e[n])return o[n]?f:d;if(o[n]){var p=f,v=u[n];return p<v?Math.max(d,u[n]):Math.max(f,u[n])}var g=d+s,b=u[n]+l;return g>b?Math.max(f,u[n]):Math.max(d,u[n])}function mK(t){var e=t.translateX,r=t.translateY,n=t.useTranslate3d;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function gK(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.offsetTopLeft,a=t.position,i=t.reverseDirection,o=t.tooltipBox,s=t.useTranslate3d,u=t.viewBox,l,f,d;return o.height>0&&o.width>0&&r?(f=xN({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:u,viewBoxDimension:u.width}),d=xN({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:u,viewBoxDimension:u.height}),l=mK({translateX:f,translateY:d,useTranslate3d:s})):l=pK,{cssProperties:l,cssClasses:vK({translateX:f,translateY:d,coordinate:r})}}function Vu(t){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vu(t)}function wN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _N(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wN(Object(r),!0).forEach(function(n){U1(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bK(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,C4(n.key),n)}}function xK(t,e,r){return e&&bK(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function wK(t,e,r){return e=xp(e),_K(t,E4()?Reflect.construct(e,r||[],xp(t).constructor):e.apply(t,r))}function _K(t,e){if(e&&(Vu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SK(t)}function SK(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(E4=function(){return!!t})()}function xp(t){return xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xp(t)}function EK(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$1(t,e)}function $1(t,e){return $1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$1(t,e)}function U1(t,e,r){return e=C4(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C4(t){var e=CK(t,"string");return Vu(e)=="symbol"?e:e+""}function CK(t,e){if(Vu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Vu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var SN=1,kK=(function(t){function e(){var r;yK(this,e);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=wK(this,e,[].concat(a)),U1(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),U1(r,"handleKeyDown",function(o){if(o.key==="Escape"){var s,u,l,f;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(u=r.props.coordinate)===null||u===void 0?void 0:u.x)!==null&&s!==void 0?s:0,y:(l=(f=r.props.coordinate)===null||f===void 0?void 0:f.y)!==null&&l!==void 0?l:0}})}}),r}return EK(e,t),xK(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>SN||Math.abs(n.height-this.state.lastBoundingBox.height)>SN)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,s=a.animationDuration,u=a.animationEasing,l=a.children,f=a.coordinate,d=a.hasPayload,p=a.isAnimationActive,v=a.offset,g=a.position,b=a.reverseDirection,y=a.useTranslate3d,x=a.viewBox,S=a.wrapperStyle,E=gK({allowEscapeViewBox:o,coordinate:f,offsetTopLeft:v,position:g,reverseDirection:b,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:x}),C=E.cssClasses,k=E.cssProperties,A=_N(_N({transition:p&&i?"transform ".concat(s,"ms ").concat(u):void 0},k),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&d?"visible":"hidden",position:"absolute",top:0,left:0},S);return Z.createElement("div",{tabIndex:-1,className:C,style:A,ref:function(N){n.wrapperNode=N}},l)}}])})(V.PureComponent),AK=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},ms={isSsr:AK()};function Hu(t){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hu(t)}function EN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function CN(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EN(Object(r),!0).forEach(function(n){U2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TK(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,A4(n.key),n)}}function PK(t,e,r){return e&&TK(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function NK(t,e,r){return e=wp(e),RK(t,k4()?Reflect.construct(e,r||[],wp(t).constructor):e.apply(t,r))}function RK(t,e){if(e&&(Hu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IK(t)}function IK(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k4=function(){return!!t})()}function wp(t){return wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wp(t)}function jK(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&W1(t,e)}function W1(t,e){return W1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},W1(t,e)}function U2(t,e,r){return e=A4(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A4(t){var e=DK(t,"string");return Hu(e)=="symbol"?e:e+""}function DK(t,e){if(Hu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Hu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function MK(t){return t.dataKey}function FK(t,e){return Z.isValidElement(t)?Z.cloneElement(t,e):typeof t=="function"?Z.createElement(t,e):Z.createElement(fK,e)}var ia=(function(t){function e(){return OK(this,e),NK(this,e,arguments)}return jK(e,t),PK(e,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,s=a.animationDuration,u=a.animationEasing,l=a.content,f=a.coordinate,d=a.filterNull,p=a.isAnimationActive,v=a.offset,g=a.payload,b=a.payloadUniqBy,y=a.position,x=a.reverseDirection,S=a.useTranslate3d,E=a.viewBox,C=a.wrapperStyle,k=g??[];d&&k.length&&(k=g4(g.filter(function(T){return T.value!=null&&(T.hide!==!0||n.props.includeHidden)}),b,MK));var A=k.length>0;return Z.createElement(kK,{allowEscapeViewBox:o,animationDuration:s,animationEasing:u,isAnimationActive:p,active:i,coordinate:f,hasPayload:A,offset:v,position:y,reverseDirection:x,useTranslate3d:S,viewBox:E,wrapperStyle:C},FK(l,CN(CN({},this.props),{},{payload:k})))}}])})(V.PureComponent);U2(ia,"displayName","Tooltip");U2(ia,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!ms.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var jx,kN;function LK(){if(kN)return jx;kN=1;var t=$a(),e=function(){return t.Date.now()};return jx=e,jx}var Dx,AN;function BK(){if(AN)return Dx;AN=1;var t=/\s/;function e(r){for(var n=r.length;n--&&t.test(r.charAt(n)););return n}return Dx=e,Dx}var Mx,ON;function $K(){if(ON)return Mx;ON=1;var t=BK(),e=/^\s+/;function r(n){return n&&n.slice(0,t(n)+1).replace(e,"")}return Mx=r,Mx}var Fx,TN;function O4(){if(TN)return Fx;TN=1;var t=$K(),e=ho(),r=bl(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt;function u(l){if(typeof l=="number")return l;if(r(l))return n;if(e(l)){var f=typeof l.valueOf=="function"?l.valueOf():l;l=e(f)?f+"":f}if(typeof l!="string")return l===0?l:+l;l=t(l);var d=i.test(l);return d||o.test(l)?s(l.slice(2),d?2:8):a.test(l)?n:+l}return Fx=u,Fx}var Lx,PN;function UK(){if(PN)return Lx;PN=1;var t=ho(),e=LK(),r=O4(),n="Expected a function",a=Math.max,i=Math.min;function o(s,u,l){var f,d,p,v,g,b,y=0,x=!1,S=!1,E=!0;if(typeof s!="function")throw new TypeError(n);u=r(u)||0,t(l)&&(x=!!l.leading,S="maxWait"in l,p=S?a(r(l.maxWait)||0,u):p,E="trailing"in l?!!l.trailing:E);function C($){var W=f,q=d;return f=d=void 0,y=$,v=s.apply(q,W),v}function k($){return y=$,g=setTimeout(N,u),x?C($):v}function A($){var W=$-b,q=$-y,X=u-W;return S?i(X,p-q):X}function T($){var W=$-b,q=$-y;return b===void 0||W>=u||W<0||S&&q>=p}function N(){var $=e();if(T($))return R($);g=setTimeout(N,A($))}function R($){return g=void 0,E&&f?C($):(f=d=void 0,v)}function I(){g!==void 0&&clearTimeout(g),y=0,f=b=d=g=void 0}function D(){return g===void 0?v:R(e())}function j(){var $=e(),W=T($);if(f=arguments,d=this,b=$,W){if(g===void 0)return k(b);if(S)return clearTimeout(g),g=setTimeout(N,u),C(b)}return g===void 0&&(g=setTimeout(N,u)),v}return j.cancel=I,j.flush=D,j}return Lx=o,Lx}var Bx,NN;function WK(){if(NN)return Bx;NN=1;var t=UK(),e=ho(),r="Expected a function";function n(a,i,o){var s=!0,u=!0;if(typeof a!="function")throw new TypeError(r);return e(o)&&(s="leading"in o?!!o.leading:s,u="trailing"in o?!!o.trailing:u),t(a,i,{leading:s,maxWait:i,trailing:u})}return Bx=n,Bx}var zK=WK();const T4=yt(zK);function lf(t){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lf(t)}function RN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Rh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RN(Object(r),!0).forEach(function(n){qK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qK(t,e,r){return e=VK(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VK(t){var e=HK(t,"string");return lf(e)=="symbol"?e:e+""}function HK(t,e){if(lf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(lf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GK(t,e){return JK(t)||YK(t,e)||XK(t,e)||KK()}function KK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XK(t,e){if(t){if(typeof t=="string")return IN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IN(t,e)}}function IN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function YK(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function JK(t){if(Array.isArray(t))return t}var P4=V.forwardRef(function(t,e){var r=t.aspect,n=t.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=t.width,o=i===void 0?"100%":i,s=t.height,u=s===void 0?"100%":s,l=t.minWidth,f=l===void 0?0:l,d=t.minHeight,p=t.maxHeight,v=t.children,g=t.debounce,b=g===void 0?0:g,y=t.id,x=t.className,S=t.onResize,E=t.style,C=E===void 0?{}:E,k=V.useRef(null),A=V.useRef();A.current=S,V.useImperativeHandle(e,function(){return Object.defineProperty(k.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),k.current},configurable:!0})});var T=V.useState({containerWidth:a.width,containerHeight:a.height}),N=GK(T,2),R=N[0],I=N[1],D=V.useCallback(function($,W){I(function(q){var X=Math.round($),Y=Math.round(W);return q.containerWidth===X&&q.containerHeight===Y?q:{containerWidth:X,containerHeight:Y}})},[]);V.useEffect(function(){var $=function(B){var G,L=B[0].contentRect,K=L.width,oe=L.height;D(K,oe),(G=A.current)===null||G===void 0||G.call(A,K,oe)};b>0&&($=T4($,b,{trailing:!0,leading:!1}));var W=new ResizeObserver($),q=k.current.getBoundingClientRect(),X=q.width,Y=q.height;return D(X,Y),W.observe(k.current),function(){W.disconnect()}},[D,b]);var j=V.useMemo(function(){var $=R.containerWidth,W=R.containerHeight;if($<0||W<0)return null;ui(Yo(o)||Yo(u),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,u),ui(!r||r>0,"The aspect(%s) must be greater than zero.",r);var q=Yo(o)?$:o,X=Yo(u)?W:u;r&&r>0&&(q?X=q/r:X&&(q=X*r),p&&X>p&&(X=p)),ui(q>0||X>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,q,X,o,u,f,d,r);var Y=!Array.isArray(v)&&si(v.type).endsWith("Chart");return Z.Children.map(v,function(z){return Z.isValidElement(z)?V.cloneElement(z,Rh({width:q,height:X},Y?{style:Rh({height:"100%",width:"100%",maxHeight:X,maxWidth:q},z.props.style)}:{})):z})},[r,v,u,p,d,f,R,o]);return Z.createElement("div",{id:y?"".concat(y):void 0,className:st("recharts-responsive-container",x),style:Rh(Rh({},C),{},{width:o,height:u,minWidth:f,minHeight:d,maxHeight:p}),ref:k},j)}),N4=function(e){return null};N4.displayName="Cell";function cf(t){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cf(t)}function jN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function z1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jN(Object(r),!0).forEach(function(n){QK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QK(t,e,r){return e=ZK(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZK(t){var e=e9(t,"string");return cf(e)=="symbol"?e:e+""}function e9(t,e){if(cf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var iu={widthCache:{},cacheCount:0},t9=2e3,r9={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},DN="recharts_measurement_span";function n9(t){var e=z1({},t);return Object.keys(e).forEach(function(r){e[r]||delete e[r]}),e}var $c=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||ms.isSsr)return{width:0,height:0};var n=n9(r),a=JSON.stringify({text:e,copyStyle:n});if(iu.widthCache[a])return iu.widthCache[a];try{var i=document.getElementById(DN);i||(i=document.createElement("span"),i.setAttribute("id",DN),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=z1(z1({},r9),n);Object.assign(i.style,o),i.textContent="".concat(e);var s=i.getBoundingClientRect(),u={width:s.width,height:s.height};return iu.widthCache[a]=u,++iu.cacheCount>t9&&(iu.cacheCount=0,iu.widthCache={}),u}catch{return{width:0,height:0}}},a9=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function ff(t){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ff(t)}function _p(t,e){return u9(t)||s9(t,e)||o9(t,e)||i9()}function i9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o9(t,e){if(t){if(typeof t=="string")return MN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MN(t,e)}}function MN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s9(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function u9(t){if(Array.isArray(t))return t}function l9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f9(n.key),n)}}function c9(t,e,r){return e&&FN(t.prototype,e),r&&FN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f9(t){var e=d9(t,"string");return ff(e)=="symbol"?e:e+""}function d9(t,e){if(ff(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var LN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,BN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,h9=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,p9=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,R4={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},v9=Object.keys(R4),wu="NaN";function m9(t,e){return t*R4[e]}var Ih=(function(){function t(e,r){l9(this,t),this.num=e,this.unit=r,this.num=e,this.unit=r,Number.isNaN(e)&&(this.unit=""),r!==""&&!h9.test(r)&&(this.num=NaN,this.unit=""),v9.includes(r)&&(this.num=m9(e,r),this.unit="px")}return c9(t,[{key:"add",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=p9.exec(r))!==null&&n!==void 0?n:[],i=_p(a,3),o=i[1],s=i[2];return new t(parseFloat(o),s??"")}}])})();function I4(t){if(t.includes(wu))return wu;for(var e=t;e.includes("*")||e.includes("/");){var r,n=(r=LN.exec(e))!==null&&r!==void 0?r:[],a=_p(n,4),i=a[1],o=a[2],s=a[3],u=Ih.parse(i??""),l=Ih.parse(s??""),f=o==="*"?u.multiply(l):u.divide(l);if(f.isNaN())return wu;e=e.replace(LN,f.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var d,p=(d=BN.exec(e))!==null&&d!==void 0?d:[],v=_p(p,4),g=v[1],b=v[2],y=v[3],x=Ih.parse(g??""),S=Ih.parse(y??""),E=b==="+"?x.add(S):x.subtract(S);if(E.isNaN())return wu;e=e.replace(BN,E.toString())}return e}var $N=/\(([^()]*)\)/;function g9(t){for(var e=t;e.includes("(");){var r=$N.exec(e),n=_p(r,2),a=n[1];e=e.replace($N,I4(a))}return e}function y9(t){var e=t.replace(/\s+/g,"");return e=g9(e),e=I4(e),e}function b9(t){try{return y9(t)}catch{return wu}}function $x(t){var e=b9(t.slice(5,-1));return e===wu?"":e}var x9=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],w9=["dx","dy","angle","className","breakAll"];function q1(){return q1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},q1.apply(this,arguments)}function UN(t,e){if(t==null)return{};var r=_9(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function _9(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function WN(t,e){return k9(t)||C9(t,e)||E9(t,e)||S9()}function S9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E9(t,e){if(t){if(typeof t=="string")return zN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zN(t,e)}}function zN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function C9(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function k9(t){if(Array.isArray(t))return t}var j4=/[ \f\n\r\t\v\u2028\u2029]+/,D4=function(e){var r=e.children,n=e.breakAll,a=e.style;try{var i=[];nt(r)||(n?i=r.toString().split(""):i=r.toString().split(j4));var o=i.map(function(u){return{word:u,width:$c(u,a).width}}),s=n?0:$c("",a).width;return{wordsWithComputedWidth:o,spaceWidth:s}}catch{return null}},A9=function(e,r,n,a,i){var o=e.maxLines,s=e.children,u=e.style,l=e.breakAll,f=be(o),d=s,p=function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return q.reduce(function(X,Y){var z=Y.word,B=Y.width,G=X[X.length-1];if(G&&(a==null||i||G.width+B+n<Number(a)))G.words.push(z),G.width+=B+n;else{var L={words:[z],width:B};X.push(L)}return X},[])},v=p(r),g=function(q){return q.reduce(function(X,Y){return X.width>Y.width?X:Y})};if(!f)return v;for(var b="",y=function(q){var X=d.slice(0,q),Y=D4({breakAll:l,style:u,children:X+b}).wordsWithComputedWidth,z=p(Y),B=z.length>o||g(z).width>Number(a);return[B,z]},x=0,S=d.length-1,E=0,C;x<=S&&E<=d.length-1;){var k=Math.floor((x+S)/2),A=k-1,T=y(A),N=WN(T,2),R=N[0],I=N[1],D=y(k),j=WN(D,1),$=j[0];if(!R&&!$&&(x=k+1),R&&$&&(S=k-1),!R&&$){C=I;break}E++}return C||v},qN=function(e){var r=nt(e)?[]:e.toString().split(j4);return[{words:r}]},O9=function(e){var r=e.width,n=e.scaleToFit,a=e.children,i=e.style,o=e.breakAll,s=e.maxLines;if((r||n)&&!ms.isSsr){var u,l,f=D4({breakAll:o,children:a,style:i});if(f){var d=f.wordsWithComputedWidth,p=f.spaceWidth;u=d,l=p}else return qN(a);return A9({breakAll:o,children:a,maxLines:s,style:i},u,l,r,n)}return qN(a)},VN="#808080",Sp=function(e){var r=e.x,n=r===void 0?0:r,a=e.y,i=a===void 0?0:a,o=e.lineHeight,s=o===void 0?"1em":o,u=e.capHeight,l=u===void 0?"0.71em":u,f=e.scaleToFit,d=f===void 0?!1:f,p=e.textAnchor,v=p===void 0?"start":p,g=e.verticalAnchor,b=g===void 0?"end":g,y=e.fill,x=y===void 0?VN:y,S=UN(e,x9),E=V.useMemo(function(){return O9({breakAll:S.breakAll,children:S.children,maxLines:S.maxLines,scaleToFit:d,style:S.style,width:S.width})},[S.breakAll,S.children,S.maxLines,d,S.style,S.width]),C=S.dx,k=S.dy,A=S.angle,T=S.className,N=S.breakAll,R=UN(S,w9);if(!ur(n)||!ur(i))return null;var I=n+(be(C)?C:0),D=i+(be(k)?k:0),j;switch(b){case"start":j=$x("calc(".concat(l,")"));break;case"middle":j=$x("calc(".concat((E.length-1)/2," * -").concat(s," + (").concat(l," / 2))"));break;default:j=$x("calc(".concat(E.length-1," * -").concat(s,")"));break}var $=[];if(d){var W=E[0].width,q=S.width;$.push("scale(".concat((be(q)?q/W:1)/W,")"))}return A&&$.push("rotate(".concat(A,", ").concat(I,", ").concat(D,")")),$.length&&(R.transform=$.join(" ")),Z.createElement("text",q1({},rt(R,!0),{x:I,y:D,className:st("recharts-text",T),textAnchor:v,fill:x.includes("url")?VN:x}),E.map(function(X,Y){var z=X.words.join(N?"":" ");return Z.createElement("tspan",{x:I,dy:Y===0?j:s,key:"".concat(z,"-").concat(Y)},z)}))};function ao(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function T9(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function W2(t){let e,r,n;t.length!==2?(e=ao,r=(s,u)=>ao(t(s),u),n=(s,u)=>t(s)-u):(e=t===ao||t===T9?t:P9,r=t,n=t);function a(s,u,l=0,f=s.length){if(l<f){if(e(u,u)!==0)return f;do{const d=l+f>>>1;r(s[d],u)<0?l=d+1:f=d}while(l<f)}return l}function i(s,u,l=0,f=s.length){if(l<f){if(e(u,u)!==0)return f;do{const d=l+f>>>1;r(s[d],u)<=0?l=d+1:f=d}while(l<f)}return l}function o(s,u,l=0,f=s.length){const d=a(s,u,l,f-1);return d>l&&n(s[d-1],u)>-n(s[d],u)?d-1:d}return{left:a,center:o,right:i}}function P9(){return 0}function M4(t){return t===null?NaN:+t}function*N9(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const R9=W2(ao),Jf=R9.right;W2(M4).center;class HN extends Map{constructor(e,r=D9){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(GN(this,e))}has(e){return super.has(GN(this,e))}set(e,r){return super.set(I9(this,e),r)}delete(e){return super.delete(j9(this,e))}}function GN({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function I9({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function j9({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function D9(t){return t!==null&&typeof t=="object"?t.valueOf():t}function M9(t=ao){if(t===ao)return F4;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function F4(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const F9=Math.sqrt(50),L9=Math.sqrt(10),B9=Math.sqrt(2);function Ep(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=F9?10:i>=L9?5:i>=B9?2:1;let s,u,l;return a<0?(l=Math.pow(10,-a)/o,s=Math.round(t*l),u=Math.round(e*l),s/l<t&&++s,u/l>e&&--u,l=-l):(l=Math.pow(10,a)*o,s=Math.round(t/l),u=Math.round(e/l),s*l<t&&++s,u*l>e&&--u),u<s&&.5<=r&&r<2?Ep(t,e,r*2):[s,u,l]}function V1(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,i,o]=n?Ep(e,t,r):Ep(t,e,r);if(!(i>=a))return[];const s=i-a+1,u=new Array(s);if(n)if(o<0)for(let l=0;l<s;++l)u[l]=(i-l)/-o;else for(let l=0;l<s;++l)u[l]=(i-l)*o;else if(o<0)for(let l=0;l<s;++l)u[l]=(a+l)/-o;else for(let l=0;l<s;++l)u[l]=(a+l)*o;return u}function H1(t,e,r){return e=+e,t=+t,r=+r,Ep(t,e,r)[2]}function G1(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?H1(e,t,r):H1(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function KN(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function XN(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function L4(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?F4:M9(a);n>r;){if(n-r>600){const u=n-r+1,l=e-r+1,f=Math.log(u),d=.5*Math.exp(2*f/3),p=.5*Math.sqrt(f*d*(u-d)/u)*(l-u/2<0?-1:1),v=Math.max(r,Math.floor(e-l*d/u+p)),g=Math.min(n,Math.floor(e+(u-l)*d/u+p));L4(t,e,v,g,a)}const i=t[e];let o=r,s=n;for(bc(t,r,e),a(t[n],i)>0&&bc(t,r,n);o<s;){for(bc(t,o,s),++o,--s;a(t[o],i)<0;)++o;for(;a(t[s],i)>0;)--s}a(t[r],i)===0?bc(t,r,s):(++s,bc(t,s,n)),s<=e&&(r=s+1),e<=s&&(n=s-1)}return t}function bc(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function $9(t,e,r){if(t=Float64Array.from(N9(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return XN(t);if(e>=1)return KN(t);var n,a=(n-1)*e,i=Math.floor(a),o=KN(L4(t,i).subarray(0,i+1)),s=XN(t.subarray(i+1));return o+(s-o)*(a-i)}}function U9(t,e,r=M4){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,i=Math.floor(a),o=+r(t[i],i,t),s=+r(t[i+1],i+1,t);return o+(s-o)*(a-i)}}function W9(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,i=new Array(a);++n<a;)i[n]=t+n*r;return i}function Gn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function yi(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const K1=Symbol("implicit");function z2(){var t=new HN,e=[],r=[],n=K1;function a(i){let o=t.get(i);if(o===void 0){if(n!==K1)return n;t.set(i,o=e.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new HN;for(const o of i)t.has(o)||t.set(o,e.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return z2(e,r).unknown(n)},Gn.apply(a,arguments),a}function df(){var t=z2().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,i,o,s=!1,u=0,l=0,f=.5;delete t.unknown;function d(){var p=e().length,v=a<n,g=v?a:n,b=v?n:a;i=(b-g)/Math.max(1,p-u+l*2),s&&(i=Math.floor(i)),g+=(b-g-i*(p-u))*f,o=i*(1-u),s&&(g=Math.round(g),o=Math.round(o));var y=W9(p).map(function(x){return g+i*x});return r(v?y.reverse():y)}return t.domain=function(p){return arguments.length?(e(p),d()):e()},t.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,d()):[n,a]},t.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,s=!0,d()},t.bandwidth=function(){return o},t.step=function(){return i},t.round=function(p){return arguments.length?(s=!!p,d()):s},t.padding=function(p){return arguments.length?(u=Math.min(1,l=+p),d()):u},t.paddingInner=function(p){return arguments.length?(u=Math.min(1,p),d()):u},t.paddingOuter=function(p){return arguments.length?(l=+p,d()):l},t.align=function(p){return arguments.length?(f=Math.max(0,Math.min(1,p)),d()):f},t.copy=function(){return df(e(),[n,a]).round(s).paddingInner(u).paddingOuter(l).align(f)},Gn.apply(d(),arguments)}function B4(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return B4(e())},t}function Uc(){return B4(df.apply(null,arguments).paddingInner(1))}function q2(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function $4(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Qf(){}var hf=.7,Cp=1/hf,Au="\\s*([+-]?\\d+)\\s*",pf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Na="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",z9=/^#([0-9a-f]{3,8})$/,q9=new RegExp(`^rgb\\(${Au},${Au},${Au}\\)$`),V9=new RegExp(`^rgb\\(${Na},${Na},${Na}\\)$`),H9=new RegExp(`^rgba\\(${Au},${Au},${Au},${pf}\\)$`),G9=new RegExp(`^rgba\\(${Na},${Na},${Na},${pf}\\)$`),K9=new RegExp(`^hsl\\(${pf},${Na},${Na}\\)$`),X9=new RegExp(`^hsla\\(${pf},${Na},${Na},${pf}\\)$`),YN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};q2(Qf,vf,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:JN,formatHex:JN,formatHex8:Y9,formatHsl:J9,formatRgb:QN,toString:QN});function JN(){return this.rgb().formatHex()}function Y9(){return this.rgb().formatHex8()}function J9(){return U4(this).formatHsl()}function QN(){return this.rgb().formatRgb()}function vf(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=z9.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?ZN(e):r===3?new cn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?jh(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?jh(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=q9.exec(t))?new cn(e[1],e[2],e[3],1):(e=V9.exec(t))?new cn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=H9.exec(t))?jh(e[1],e[2],e[3],e[4]):(e=G9.exec(t))?jh(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=K9.exec(t))?rR(e[1],e[2]/100,e[3]/100,1):(e=X9.exec(t))?rR(e[1],e[2]/100,e[3]/100,e[4]):YN.hasOwnProperty(t)?ZN(YN[t]):t==="transparent"?new cn(NaN,NaN,NaN,0):null}function ZN(t){return new cn(t>>16&255,t>>8&255,t&255,1)}function jh(t,e,r,n){return n<=0&&(t=e=r=NaN),new cn(t,e,r,n)}function Q9(t){return t instanceof Qf||(t=vf(t)),t?(t=t.rgb(),new cn(t.r,t.g,t.b,t.opacity)):new cn}function X1(t,e,r,n){return arguments.length===1?Q9(t):new cn(t,e,r,n??1)}function cn(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}q2(cn,X1,$4(Qf,{brighter(t){return t=t==null?Cp:Math.pow(Cp,t),new cn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?hf:Math.pow(hf,t),new cn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new cn(ns(this.r),ns(this.g),ns(this.b),kp(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:eR,formatHex:eR,formatHex8:Z9,formatRgb:tR,toString:tR}));function eR(){return`#${Jo(this.r)}${Jo(this.g)}${Jo(this.b)}`}function Z9(){return`#${Jo(this.r)}${Jo(this.g)}${Jo(this.b)}${Jo((isNaN(this.opacity)?1:this.opacity)*255)}`}function tR(){const t=kp(this.opacity);return`${t===1?"rgb(":"rgba("}${ns(this.r)}, ${ns(this.g)}, ${ns(this.b)}${t===1?")":`, ${t})`}`}function kp(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ns(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jo(t){return t=ns(t),(t<16?"0":"")+t.toString(16)}function rR(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new la(t,e,r,n)}function U4(t){if(t instanceof la)return new la(t.h,t.s,t.l,t.opacity);if(t instanceof Qf||(t=vf(t)),!t)return new la;if(t instanceof la)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),i=Math.max(e,r,n),o=NaN,s=i-a,u=(i+a)/2;return s?(e===i?o=(r-n)/s+(r<n)*6:r===i?o=(n-e)/s+2:o=(e-r)/s+4,s/=u<.5?i+a:2-i-a,o*=60):s=u>0&&u<1?0:o,new la(o,s,u,t.opacity)}function e7(t,e,r,n){return arguments.length===1?U4(t):new la(t,e,r,n??1)}function la(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}q2(la,e7,$4(Qf,{brighter(t){return t=t==null?Cp:Math.pow(Cp,t),new la(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?hf:Math.pow(hf,t),new la(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new cn(Ux(t>=240?t-240:t+120,a,n),Ux(t,a,n),Ux(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new la(nR(this.h),Dh(this.s),Dh(this.l),kp(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=kp(this.opacity);return`${t===1?"hsl(":"hsla("}${nR(this.h)}, ${Dh(this.s)*100}%, ${Dh(this.l)*100}%${t===1?")":`, ${t})`}`}}));function nR(t){return t=(t||0)%360,t<0?t+360:t}function Dh(t){return Math.max(0,Math.min(1,t||0))}function Ux(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const V2=t=>()=>t;function t7(t,e){return function(r){return t+r*e}}function r7(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function n7(t){return(t=+t)==1?W4:function(e,r){return r-e?r7(e,r,t):V2(isNaN(e)?r:e)}}function W4(t,e){var r=e-t;return r?t7(t,r):V2(isNaN(t)?e:t)}const aR=(function t(e){var r=n7(e);function n(a,i){var o=r((a=X1(a)).r,(i=X1(i)).r),s=r(a.g,i.g),u=r(a.b,i.b),l=W4(a.opacity,i.opacity);return function(f){return a.r=o(f),a.g=s(f),a.b=u(f),a.opacity=l(f),a+""}}return n.gamma=t,n})(1);function a7(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=t[a]*(1-i)+e[a]*i;return n}}function i7(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function o7(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=El(t[o],e[o]);for(;o<r;++o)i[o]=e[o];return function(s){for(o=0;o<n;++o)i[o]=a[o](s);return i}}function s7(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Ap(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function u7(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=El(t[a],e[a]):n[a]=e[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Y1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wx=new RegExp(Y1.source,"g");function l7(t){return function(){return t}}function c7(t){return function(e){return t(e)+""}}function f7(t,e){var r=Y1.lastIndex=Wx.lastIndex=0,n,a,i,o=-1,s=[],u=[];for(t=t+"",e=e+"";(n=Y1.exec(t))&&(a=Wx.exec(e));)(i=a.index)>r&&(i=e.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,u.push({i:o,x:Ap(n,a)})),r=Wx.lastIndex;return r<e.length&&(i=e.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?c7(u[0].x):l7(e):(e=u.length,function(l){for(var f=0,d;f<e;++f)s[(d=u[f]).i]=d.x(l);return s.join("")})}function El(t,e){var r=typeof e,n;return e==null||r==="boolean"?V2(e):(r==="number"?Ap:r==="string"?(n=vf(e))?(e=n,aR):f7:e instanceof vf?aR:e instanceof Date?s7:i7(e)?a7:Array.isArray(e)?o7:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?u7:Ap)(t,e)}function H2(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function d7(t,e){e===void 0&&(e=t,t=El);for(var r=0,n=e.length-1,a=e[0],i=new Array(n<0?0:n);r<n;)i[r]=t(a,a=e[++r]);return function(o){var s=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[s](o-s)}}function h7(t){return function(){return t}}function Op(t){return+t}var iR=[0,1];function Zr(t){return t}function J1(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:h7(isNaN(e)?NaN:.5)}function p7(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function v7(t,e,r){var n=t[0],a=t[1],i=e[0],o=e[1];return a<n?(n=J1(a,n),i=r(o,i)):(n=J1(n,a),i=r(i,o)),function(s){return i(n(s))}}function m7(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),i=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)a[o]=J1(t[o],t[o+1]),i[o]=r(e[o],e[o+1]);return function(s){var u=Jf(t,s,1,n)-1;return i[u](a[u](s))}}function Zf(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Zv(){var t=iR,e=iR,r=El,n,a,i,o=Zr,s,u,l;function f(){var p=Math.min(t.length,e.length);return o!==Zr&&(o=p7(t[0],t[p-1])),s=p>2?m7:v7,u=l=null,d}function d(p){return p==null||isNaN(p=+p)?i:(u||(u=s(t.map(n),e,r)))(n(o(p)))}return d.invert=function(p){return o(a((l||(l=s(e,t.map(n),Ap)))(p)))},d.domain=function(p){return arguments.length?(t=Array.from(p,Op),f()):t.slice()},d.range=function(p){return arguments.length?(e=Array.from(p),f()):e.slice()},d.rangeRound=function(p){return e=Array.from(p),r=H2,f()},d.clamp=function(p){return arguments.length?(o=p?!0:Zr,f()):o!==Zr},d.interpolate=function(p){return arguments.length?(r=p,f()):r},d.unknown=function(p){return arguments.length?(i=p,d):i},function(p,v){return n=p,a=v,f()}}function G2(){return Zv()(Zr,Zr)}function g7(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Tp(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Gu(t){return t=Tp(Math.abs(t)),t?t[1]:NaN}function y7(t,e){return function(r,n){for(var a=r.length,i=[],o=0,s=t[0],u=0;a>0&&s>0&&(u+s+1>n&&(s=Math.max(1,n-u)),i.push(r.substring(a-=s,a+s)),!((u+=s+1)>n));)s=t[o=(o+1)%t.length];return i.reverse().join(e)}}function b7(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var x7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function mf(t){if(!(e=x7.exec(t)))throw new Error("invalid format: "+t);var e;return new K2({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}mf.prototype=K2.prototype;function K2(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}K2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function w7(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var Pp;function _7(t,e){var r=Tp(t,e);if(!r)return Pp=void 0,t.toPrecision(e);var n=r[0],a=r[1],i=a-(Pp=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Tp(t,Math.max(0,e+i-1))[0]}function oR(t,e){var r=Tp(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const sR={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:g7,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>oR(t*100,e),r:oR,s:_7,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function uR(t){return t}var lR=Array.prototype.map,cR=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function S7(t){var e=t.grouping===void 0||t.thousands===void 0?uR:y7(lR.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?uR:b7(lR.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function l(d,p){d=mf(d);var v=d.fill,g=d.align,b=d.sign,y=d.symbol,x=d.zero,S=d.width,E=d.comma,C=d.precision,k=d.trim,A=d.type;A==="n"?(E=!0,A="g"):sR[A]||(C===void 0&&(C=12),k=!0,A="g"),(x||v==="0"&&g==="=")&&(x=!0,v="0",g="=");var T=(p&&p.prefix!==void 0?p.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():""),N=(y==="$"?n:/[%p]/.test(A)?o:"")+(p&&p.suffix!==void 0?p.suffix:""),R=sR[A],I=/[defgprs%]/.test(A);C=C===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,C)):Math.max(0,Math.min(20,C));function D(j){var $=T,W=N,q,X,Y;if(A==="c")W=R(j)+W,j="";else{j=+j;var z=j<0||1/j<0;if(j=isNaN(j)?u:R(Math.abs(j),C),k&&(j=w7(j)),z&&+j==0&&b!=="+"&&(z=!1),$=(z?b==="("?b:s:b==="-"||b==="("?"":b)+$,W=(A==="s"&&!isNaN(j)&&Pp!==void 0?cR[8+Pp/3]:"")+W+(z&&b==="("?")":""),I){for(q=-1,X=j.length;++q<X;)if(Y=j.charCodeAt(q),48>Y||Y>57){W=(Y===46?a+j.slice(q+1):j.slice(q))+W,j=j.slice(0,q);break}}}E&&!x&&(j=e(j,1/0));var B=$.length+j.length+W.length,G=B<S?new Array(S-B+1).join(v):"";switch(E&&x&&(j=e(G+j,G.length?S-W.length:1/0),G=""),g){case"<":j=$+j+W+G;break;case"=":j=$+G+j+W;break;case"^":j=G.slice(0,B=G.length>>1)+$+j+W+G.slice(B);break;default:j=G+$+j+W;break}return i(j)}return D.toString=function(){return d+""},D}function f(d,p){var v=Math.max(-8,Math.min(8,Math.floor(Gu(p)/3)))*3,g=Math.pow(10,-v),b=l((d=mf(d),d.type="f",d),{suffix:cR[8+v/3]});return function(y){return b(g*y)}}return{format:l,formatPrefix:f}}var Mh,X2,z4;E7({thousands:",",grouping:[3],currency:["$",""]});function E7(t){return Mh=S7(t),X2=Mh.format,z4=Mh.formatPrefix,Mh}function C7(t){return Math.max(0,-Gu(Math.abs(t)))}function k7(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Gu(e)/3)))*3-Gu(Math.abs(t)))}function A7(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Gu(e)-Gu(t))+1}function q4(t,e,r,n){var a=G1(t,e,r),i;switch(n=mf(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=k7(a,o))&&(n.precision=i),z4(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=A7(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=C7(a))&&(n.precision=i-(n.type==="%")*2);break}}return X2(n)}function vo(t){var e=t.domain;return t.ticks=function(r){var n=e();return V1(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return q4(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,i=n.length-1,o=n[a],s=n[i],u,l,f=10;for(s<o&&(l=o,o=s,s=l,l=a,a=i,i=l);f-- >0;){if(l=H1(o,s,r),l===u)return n[a]=o,n[i]=s,e(n);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;u=l}return t},t}function Np(){var t=G2();return t.copy=function(){return Zf(t,Np())},Gn.apply(t,arguments),vo(t)}function V4(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Op),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return V4(t).unknown(e)},t=arguments.length?Array.from(t,Op):[0,1],vo(r)}function H4(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],i=t[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),t[r]=e.floor(a),t[n]=e.ceil(i),t}function fR(t){return Math.log(t)}function dR(t){return Math.exp(t)}function O7(t){return-Math.log(-t)}function T7(t){return-Math.exp(-t)}function P7(t){return isFinite(t)?+("1e"+t):t<0?0:t}function N7(t){return t===10?P7:t===Math.E?Math.exp:e=>Math.pow(t,e)}function R7(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function hR(t){return(e,r)=>-t(-e,r)}function Y2(t){const e=t(fR,dR),r=e.domain;let n=10,a,i;function o(){return a=R7(n),i=N7(n),r()[0]<0?(a=hR(a),i=hR(i),t(O7,T7)):t(fR,dR),e}return e.base=function(s){return arguments.length?(n=+s,o()):n},e.domain=function(s){return arguments.length?(r(s),o()):r()},e.ticks=s=>{const u=r();let l=u[0],f=u[u.length-1];const d=f<l;d&&([l,f]=[f,l]);let p=a(l),v=a(f),g,b;const y=s==null?10:+s;let x=[];if(!(n%1)&&v-p<y){if(p=Math.floor(p),v=Math.ceil(v),l>0){for(;p<=v;++p)for(g=1;g<n;++g)if(b=p<0?g/i(-p):g*i(p),!(b<l)){if(b>f)break;x.push(b)}}else for(;p<=v;++p)for(g=n-1;g>=1;--g)if(b=p>0?g/i(-p):g*i(p),!(b<l)){if(b>f)break;x.push(b)}x.length*2<y&&(x=V1(l,f,y))}else x=V1(p,v,Math.min(v-p,y)).map(i);return d?x.reverse():x},e.tickFormat=(s,u)=>{if(s==null&&(s=10),u==null&&(u=n===10?"s":","),typeof u!="function"&&(!(n%1)&&(u=mf(u)).precision==null&&(u.trim=!0),u=X2(u)),s===1/0)return u;const l=Math.max(1,n*s/e.ticks().length);return f=>{let d=f/i(Math.round(a(f)));return d*n<n-.5&&(d*=n),d<=l?u(f):""}},e.nice=()=>r(H4(r(),{floor:s=>i(Math.floor(a(s))),ceil:s=>i(Math.ceil(a(s)))})),e}function G4(){const t=Y2(Zv()).domain([1,10]);return t.copy=()=>Zf(t,G4()).base(t.base()),Gn.apply(t,arguments),t}function pR(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function vR(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function J2(t){var e=1,r=t(pR(e),vR(e));return r.constant=function(n){return arguments.length?t(pR(e=+n),vR(e)):e},vo(r)}function K4(){var t=J2(Zv());return t.copy=function(){return Zf(t,K4()).constant(t.constant())},Gn.apply(t,arguments)}function mR(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function I7(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function j7(t){return t<0?-t*t:t*t}function Q2(t){var e=t(Zr,Zr),r=1;function n(){return r===1?t(Zr,Zr):r===.5?t(I7,j7):t(mR(r),mR(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},vo(e)}function Z2(){var t=Q2(Zv());return t.copy=function(){return Zf(t,Z2()).exponent(t.exponent())},Gn.apply(t,arguments),t}function D7(){return Z2.apply(null,arguments).exponent(.5)}function gR(t){return Math.sign(t)*t*t}function M7(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function X4(){var t=G2(),e=[0,1],r=!1,n;function a(i){var o=M7(t(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return t.invert(gR(i))},a.domain=function(i){return arguments.length?(t.domain(i),a):t.domain()},a.range=function(i){return arguments.length?(t.range((e=Array.from(i,Op)).map(gR)),a):e.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(t.clamp(i),a):t.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return X4(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Gn.apply(a,arguments),vo(a)}function Y4(){var t=[],e=[],r=[],n;function a(){var o=0,s=Math.max(1,e.length);for(r=new Array(s-1);++o<s;)r[o-1]=U9(t,o/s);return i}function i(o){return o==null||isNaN(o=+o)?n:e[Jf(r,o)]}return i.invertExtent=function(o){var s=e.indexOf(o);return s<0?[NaN,NaN]:[s>0?r[s-1]:t[0],s<r.length?r[s]:t[t.length-1]]},i.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let s of o)s!=null&&!isNaN(s=+s)&&t.push(s);return t.sort(ao),a()},i.range=function(o){return arguments.length?(e=Array.from(o),a()):e.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return Y4().domain(t).range(e).unknown(n)},Gn.apply(i,arguments)}function J4(){var t=0,e=1,r=1,n=[.5],a=[0,1],i;function o(u){return u!=null&&u<=u?a[Jf(n,u,0,r)]:i}function s(){var u=-1;for(n=new Array(r);++u<r;)n[u]=((u+1)*e-(u-r)*t)/(r+1);return o}return o.domain=function(u){return arguments.length?([t,e]=u,t=+t,e=+e,s()):[t,e]},o.range=function(u){return arguments.length?(r=(a=Array.from(u)).length-1,s()):a.slice()},o.invertExtent=function(u){var l=a.indexOf(u);return l<0?[NaN,NaN]:l<1?[t,n[0]]:l>=r?[n[r-1],e]:[n[l-1],n[l]]},o.unknown=function(u){return arguments.length&&(i=u),o},o.thresholds=function(){return n.slice()},o.copy=function(){return J4().domain([t,e]).range(a).unknown(i)},Gn.apply(vo(o),arguments)}function Q4(){var t=[.5],e=[0,1],r,n=1;function a(i){return i!=null&&i<=i?e[Jf(t,i,0,n)]:r}return a.domain=function(i){return arguments.length?(t=Array.from(i),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(i){return arguments.length?(e=Array.from(i),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(i){var o=e.indexOf(i);return[t[o-1],t[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return Q4().domain(t).range(e).unknown(r)},Gn.apply(a,arguments)}const zx=new Date,qx=new Date;function pr(t,e,r,n){function a(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(t(i=new Date(+i)),i),a.ceil=i=>(t(i=new Date(i-1)),e(i,1),t(i),i),a.round=i=>{const o=a(i),s=a.ceil(i);return i-o<s-i?o:s},a.offset=(i,o)=>(e(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,s)=>{const u=[];if(i=a.ceil(i),s=s==null?1:Math.floor(s),!(i<o)||!(s>0))return u;let l;do u.push(l=new Date(+i)),e(i,s),t(i);while(l<i&&i<o);return u},a.filter=i=>pr(o=>{if(o>=o)for(;t(o),!i(o);)o.setTime(o-1)},(o,s)=>{if(o>=o)if(s<0)for(;++s<=0;)for(;e(o,-1),!i(o););else for(;--s>=0;)for(;e(o,1),!i(o););}),r&&(a.count=(i,o)=>(zx.setTime(+i),qx.setTime(+o),t(zx),t(qx),Math.floor(r(zx,qx))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const Rp=pr(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Rp.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?pr(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Rp);Rp.range;const ai=1e3,Wn=ai*60,ii=Wn*60,fi=ii*24,eS=fi*7,yR=fi*30,Vx=fi*365,Qo=pr(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*ai)},(t,e)=>(e-t)/ai,t=>t.getUTCSeconds());Qo.range;const tS=pr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ai)},(t,e)=>{t.setTime(+t+e*Wn)},(t,e)=>(e-t)/Wn,t=>t.getMinutes());tS.range;const rS=pr(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Wn)},(t,e)=>(e-t)/Wn,t=>t.getUTCMinutes());rS.range;const nS=pr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ai-t.getMinutes()*Wn)},(t,e)=>{t.setTime(+t+e*ii)},(t,e)=>(e-t)/ii,t=>t.getHours());nS.range;const aS=pr(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*ii)},(t,e)=>(e-t)/ii,t=>t.getUTCHours());aS.range;const ed=pr(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Wn)/fi,t=>t.getDate()-1);ed.range;const em=pr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/fi,t=>t.getUTCDate()-1);em.range;const Z4=pr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/fi,t=>Math.floor(t/fi));Z4.range;function gs(t){return pr(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Wn)/eS)}const tm=gs(0),Ip=gs(1),F7=gs(2),L7=gs(3),Ku=gs(4),B7=gs(5),$7=gs(6);tm.range;Ip.range;F7.range;L7.range;Ku.range;B7.range;$7.range;function ys(t){return pr(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/eS)}const rm=ys(0),jp=ys(1),U7=ys(2),W7=ys(3),Xu=ys(4),z7=ys(5),q7=ys(6);rm.range;jp.range;U7.range;W7.range;Xu.range;z7.range;q7.range;const iS=pr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());iS.range;const oS=pr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());oS.range;const di=pr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());di.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:pr(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});di.range;const hi=pr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());hi.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:pr(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});hi.range;function e3(t,e,r,n,a,i){const o=[[Qo,1,ai],[Qo,5,5*ai],[Qo,15,15*ai],[Qo,30,30*ai],[i,1,Wn],[i,5,5*Wn],[i,15,15*Wn],[i,30,30*Wn],[a,1,ii],[a,3,3*ii],[a,6,6*ii],[a,12,12*ii],[n,1,fi],[n,2,2*fi],[r,1,eS],[e,1,yR],[e,3,3*yR],[t,1,Vx]];function s(l,f,d){const p=f<l;p&&([l,f]=[f,l]);const v=d&&typeof d.range=="function"?d:u(l,f,d),g=v?v.range(l,+f+1):[];return p?g.reverse():g}function u(l,f,d){const p=Math.abs(f-l)/d,v=W2(([,,y])=>y).right(o,p);if(v===o.length)return t.every(G1(l/Vx,f/Vx,d));if(v===0)return Rp.every(Math.max(G1(l,f,d),1));const[g,b]=o[p/o[v-1][2]<o[v][2]/p?v-1:v];return g.every(b)}return[s,u]}const[V7,H7]=e3(hi,oS,rm,Z4,aS,rS),[G7,K7]=e3(di,iS,tm,ed,nS,tS);function Hx(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Gx(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function xc(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function X7(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,i=t.days,o=t.shortDays,s=t.months,u=t.shortMonths,l=wc(a),f=_c(a),d=wc(i),p=_c(i),v=wc(o),g=_c(o),b=wc(s),y=_c(s),x=wc(u),S=_c(u),E={a:Y,A:z,b:B,B:G,c:null,d:ER,e:ER,f:yX,g:OX,G:PX,H:vX,I:mX,j:gX,L:t3,m:bX,M:xX,p:L,q:K,Q:AR,s:OR,S:wX,u:_X,U:SX,V:EX,w:CX,W:kX,x:null,X:null,y:AX,Y:TX,Z:NX,"%":kR},C={a:oe,A:he,b:ge,B:xe,c:null,d:CR,e:CR,f:DX,g:VX,G:GX,H:RX,I:IX,j:jX,L:n3,m:MX,M:FX,p:ke,q:we,Q:AR,s:OR,S:LX,u:BX,U:$X,V:UX,w:WX,W:zX,x:null,X:null,y:qX,Y:HX,Z:KX,"%":kR},k={a:I,A:D,b:j,B:$,c:W,d:_R,e:_R,f:fX,g:wR,G:xR,H:SR,I:SR,j:sX,L:cX,m:oX,M:uX,p:R,q:iX,Q:hX,s:pX,S:lX,u:eX,U:tX,V:rX,w:Z7,W:nX,x:q,X,y:wR,Y:xR,Z:aX,"%":dX};E.x=A(r,E),E.X=A(n,E),E.c=A(e,E),C.x=A(r,C),C.X=A(n,C),C.c=A(e,C);function A(ue,Se){return function(_e){var le=[],$e=-1,Fe=0,Xe=ue.length,Ye,mt,Ut;for(_e instanceof Date||(_e=new Date(+_e));++$e<Xe;)ue.charCodeAt($e)===37&&(le.push(ue.slice(Fe,$e)),(mt=bR[Ye=ue.charAt(++$e)])!=null?Ye=ue.charAt(++$e):mt=Ye==="e"?" ":"0",(Ut=Se[Ye])&&(Ye=Ut(_e,mt)),le.push(Ye),Fe=$e+1);return le.push(ue.slice(Fe,$e)),le.join("")}}function T(ue,Se){return function(_e){var le=xc(1900,void 0,1),$e=N(le,ue,_e+="",0),Fe,Xe;if($e!=_e.length)return null;if("Q"in le)return new Date(le.Q);if("s"in le)return new Date(le.s*1e3+("L"in le?le.L:0));if(Se&&!("Z"in le)&&(le.Z=0),"p"in le&&(le.H=le.H%12+le.p*12),le.m===void 0&&(le.m="q"in le?le.q:0),"V"in le){if(le.V<1||le.V>53)return null;"w"in le||(le.w=1),"Z"in le?(Fe=Gx(xc(le.y,0,1)),Xe=Fe.getUTCDay(),Fe=Xe>4||Xe===0?jp.ceil(Fe):jp(Fe),Fe=em.offset(Fe,(le.V-1)*7),le.y=Fe.getUTCFullYear(),le.m=Fe.getUTCMonth(),le.d=Fe.getUTCDate()+(le.w+6)%7):(Fe=Hx(xc(le.y,0,1)),Xe=Fe.getDay(),Fe=Xe>4||Xe===0?Ip.ceil(Fe):Ip(Fe),Fe=ed.offset(Fe,(le.V-1)*7),le.y=Fe.getFullYear(),le.m=Fe.getMonth(),le.d=Fe.getDate()+(le.w+6)%7)}else("W"in le||"U"in le)&&("w"in le||(le.w="u"in le?le.u%7:"W"in le?1:0),Xe="Z"in le?Gx(xc(le.y,0,1)).getUTCDay():Hx(xc(le.y,0,1)).getDay(),le.m=0,le.d="W"in le?(le.w+6)%7+le.W*7-(Xe+5)%7:le.w+le.U*7-(Xe+6)%7);return"Z"in le?(le.H+=le.Z/100|0,le.M+=le.Z%100,Gx(le)):Hx(le)}}function N(ue,Se,_e,le){for(var $e=0,Fe=Se.length,Xe=_e.length,Ye,mt;$e<Fe;){if(le>=Xe)return-1;if(Ye=Se.charCodeAt($e++),Ye===37){if(Ye=Se.charAt($e++),mt=k[Ye in bR?Se.charAt($e++):Ye],!mt||(le=mt(ue,_e,le))<0)return-1}else if(Ye!=_e.charCodeAt(le++))return-1}return le}function R(ue,Se,_e){var le=l.exec(Se.slice(_e));return le?(ue.p=f.get(le[0].toLowerCase()),_e+le[0].length):-1}function I(ue,Se,_e){var le=v.exec(Se.slice(_e));return le?(ue.w=g.get(le[0].toLowerCase()),_e+le[0].length):-1}function D(ue,Se,_e){var le=d.exec(Se.slice(_e));return le?(ue.w=p.get(le[0].toLowerCase()),_e+le[0].length):-1}function j(ue,Se,_e){var le=x.exec(Se.slice(_e));return le?(ue.m=S.get(le[0].toLowerCase()),_e+le[0].length):-1}function $(ue,Se,_e){var le=b.exec(Se.slice(_e));return le?(ue.m=y.get(le[0].toLowerCase()),_e+le[0].length):-1}function W(ue,Se,_e){return N(ue,e,Se,_e)}function q(ue,Se,_e){return N(ue,r,Se,_e)}function X(ue,Se,_e){return N(ue,n,Se,_e)}function Y(ue){return o[ue.getDay()]}function z(ue){return i[ue.getDay()]}function B(ue){return u[ue.getMonth()]}function G(ue){return s[ue.getMonth()]}function L(ue){return a[+(ue.getHours()>=12)]}function K(ue){return 1+~~(ue.getMonth()/3)}function oe(ue){return o[ue.getUTCDay()]}function he(ue){return i[ue.getUTCDay()]}function ge(ue){return u[ue.getUTCMonth()]}function xe(ue){return s[ue.getUTCMonth()]}function ke(ue){return a[+(ue.getUTCHours()>=12)]}function we(ue){return 1+~~(ue.getUTCMonth()/3)}return{format:function(ue){var Se=A(ue+="",E);return Se.toString=function(){return ue},Se},parse:function(ue){var Se=T(ue+="",!1);return Se.toString=function(){return ue},Se},utcFormat:function(ue){var Se=A(ue+="",C);return Se.toString=function(){return ue},Se},utcParse:function(ue){var Se=T(ue+="",!0);return Se.toString=function(){return ue},Se}}}var bR={"-":"",_:" ",0:"0"},Sr=/^\s*\d+/,Y7=/^%/,J7=/[\\^$*+?|[\]().{}]/g;function ft(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(e)+a:a)}function Q7(t){return t.replace(J7,"\\$&")}function wc(t){return new RegExp("^(?:"+t.map(Q7).join("|")+")","i")}function _c(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function Z7(t,e,r){var n=Sr.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function eX(t,e,r){var n=Sr.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function tX(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function rX(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function nX(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function xR(t,e,r){var n=Sr.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function wR(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function aX(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function iX(t,e,r){var n=Sr.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function oX(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function _R(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function sX(t,e,r){var n=Sr.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function SR(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function uX(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function lX(t,e,r){var n=Sr.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function cX(t,e,r){var n=Sr.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function fX(t,e,r){var n=Sr.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function dX(t,e,r){var n=Y7.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function hX(t,e,r){var n=Sr.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function pX(t,e,r){var n=Sr.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function ER(t,e){return ft(t.getDate(),e,2)}function vX(t,e){return ft(t.getHours(),e,2)}function mX(t,e){return ft(t.getHours()%12||12,e,2)}function gX(t,e){return ft(1+ed.count(di(t),t),e,3)}function t3(t,e){return ft(t.getMilliseconds(),e,3)}function yX(t,e){return t3(t,e)+"000"}function bX(t,e){return ft(t.getMonth()+1,e,2)}function xX(t,e){return ft(t.getMinutes(),e,2)}function wX(t,e){return ft(t.getSeconds(),e,2)}function _X(t){var e=t.getDay();return e===0?7:e}function SX(t,e){return ft(tm.count(di(t)-1,t),e,2)}function r3(t){var e=t.getDay();return e>=4||e===0?Ku(t):Ku.ceil(t)}function EX(t,e){return t=r3(t),ft(Ku.count(di(t),t)+(di(t).getDay()===4),e,2)}function CX(t){return t.getDay()}function kX(t,e){return ft(Ip.count(di(t)-1,t),e,2)}function AX(t,e){return ft(t.getFullYear()%100,e,2)}function OX(t,e){return t=r3(t),ft(t.getFullYear()%100,e,2)}function TX(t,e){return ft(t.getFullYear()%1e4,e,4)}function PX(t,e){var r=t.getDay();return t=r>=4||r===0?Ku(t):Ku.ceil(t),ft(t.getFullYear()%1e4,e,4)}function NX(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ft(e/60|0,"0",2)+ft(e%60,"0",2)}function CR(t,e){return ft(t.getUTCDate(),e,2)}function RX(t,e){return ft(t.getUTCHours(),e,2)}function IX(t,e){return ft(t.getUTCHours()%12||12,e,2)}function jX(t,e){return ft(1+em.count(hi(t),t),e,3)}function n3(t,e){return ft(t.getUTCMilliseconds(),e,3)}function DX(t,e){return n3(t,e)+"000"}function MX(t,e){return ft(t.getUTCMonth()+1,e,2)}function FX(t,e){return ft(t.getUTCMinutes(),e,2)}function LX(t,e){return ft(t.getUTCSeconds(),e,2)}function BX(t){var e=t.getUTCDay();return e===0?7:e}function $X(t,e){return ft(rm.count(hi(t)-1,t),e,2)}function a3(t){var e=t.getUTCDay();return e>=4||e===0?Xu(t):Xu.ceil(t)}function UX(t,e){return t=a3(t),ft(Xu.count(hi(t),t)+(hi(t).getUTCDay()===4),e,2)}function WX(t){return t.getUTCDay()}function zX(t,e){return ft(jp.count(hi(t)-1,t),e,2)}function qX(t,e){return ft(t.getUTCFullYear()%100,e,2)}function VX(t,e){return t=a3(t),ft(t.getUTCFullYear()%100,e,2)}function HX(t,e){return ft(t.getUTCFullYear()%1e4,e,4)}function GX(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Xu(t):Xu.ceil(t),ft(t.getUTCFullYear()%1e4,e,4)}function KX(){return"+0000"}function kR(){return"%"}function AR(t){return+t}function OR(t){return Math.floor(+t/1e3)}var ou,i3,o3;XX({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function XX(t){return ou=X7(t),i3=ou.format,ou.parse,o3=ou.utcFormat,ou.utcParse,ou}function YX(t){return new Date(t)}function JX(t){return t instanceof Date?+t:+new Date(+t)}function sS(t,e,r,n,a,i,o,s,u,l){var f=G2(),d=f.invert,p=f.domain,v=l(".%L"),g=l(":%S"),b=l("%I:%M"),y=l("%I %p"),x=l("%a %d"),S=l("%b %d"),E=l("%B"),C=l("%Y");function k(A){return(u(A)<A?v:s(A)<A?g:o(A)<A?b:i(A)<A?y:n(A)<A?a(A)<A?x:S:r(A)<A?E:C)(A)}return f.invert=function(A){return new Date(d(A))},f.domain=function(A){return arguments.length?p(Array.from(A,JX)):p().map(YX)},f.ticks=function(A){var T=p();return t(T[0],T[T.length-1],A??10)},f.tickFormat=function(A,T){return T==null?k:l(T)},f.nice=function(A){var T=p();return(!A||typeof A.range!="function")&&(A=e(T[0],T[T.length-1],A??10)),A?p(H4(T,A)):f},f.copy=function(){return Zf(f,sS(t,e,r,n,a,i,o,s,u,l))},f}function QX(){return Gn.apply(sS(G7,K7,di,iS,tm,ed,nS,tS,Qo,i3).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ZX(){return Gn.apply(sS(V7,H7,hi,oS,rm,em,aS,rS,Qo,o3).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function nm(){var t=0,e=1,r,n,a,i,o=Zr,s=!1,u;function l(d){return d==null||isNaN(d=+d)?u:o(a===0?.5:(d=(i(d)-r)*a,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([t,e]=d,r=i(t=+t),n=i(e=+e),a=r===n?0:1/(n-r),l):[t,e]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(o=d,l):o};function f(d){return function(p){var v,g;return arguments.length?([v,g]=p,o=d(v,g),l):[o(0),o(1)]}}return l.range=f(El),l.rangeRound=f(H2),l.unknown=function(d){return arguments.length?(u=d,l):u},function(d){return i=d,r=d(t),n=d(e),a=r===n?0:1/(n-r),l}}function mo(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function s3(){var t=vo(nm()(Zr));return t.copy=function(){return mo(t,s3())},yi.apply(t,arguments)}function u3(){var t=Y2(nm()).domain([1,10]);return t.copy=function(){return mo(t,u3()).base(t.base())},yi.apply(t,arguments)}function l3(){var t=J2(nm());return t.copy=function(){return mo(t,l3()).constant(t.constant())},yi.apply(t,arguments)}function uS(){var t=Q2(nm());return t.copy=function(){return mo(t,uS()).exponent(t.exponent())},yi.apply(t,arguments)}function eY(){return uS.apply(null,arguments).exponent(.5)}function c3(){var t=[],e=Zr;function r(n){if(n!=null&&!isNaN(n=+n))return e((Jf(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(ao),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>$9(t,i/n))},r.copy=function(){return c3(e).domain(t)},yi.apply(r,arguments)}function am(){var t=0,e=.5,r=1,n=1,a,i,o,s,u,l=Zr,f,d=!1,p;function v(b){return isNaN(b=+b)?p:(b=.5+((b=+f(b))-i)*(n*b<n*i?s:u),l(d?Math.max(0,Math.min(1,b)):b))}v.domain=function(b){return arguments.length?([t,e,r]=b,a=f(t=+t),i=f(e=+e),o=f(r=+r),s=a===i?0:.5/(i-a),u=i===o?0:.5/(o-i),n=i<a?-1:1,v):[t,e,r]},v.clamp=function(b){return arguments.length?(d=!!b,v):d},v.interpolator=function(b){return arguments.length?(l=b,v):l};function g(b){return function(y){var x,S,E;return arguments.length?([x,S,E]=y,l=d7(b,[x,S,E]),v):[l(0),l(.5),l(1)]}}return v.range=g(El),v.rangeRound=g(H2),v.unknown=function(b){return arguments.length?(p=b,v):p},function(b){return f=b,a=b(t),i=b(e),o=b(r),s=a===i?0:.5/(i-a),u=i===o?0:.5/(o-i),n=i<a?-1:1,v}}function f3(){var t=vo(am()(Zr));return t.copy=function(){return mo(t,f3())},yi.apply(t,arguments)}function d3(){var t=Y2(am()).domain([.1,1,10]);return t.copy=function(){return mo(t,d3()).base(t.base())},yi.apply(t,arguments)}function h3(){var t=J2(am());return t.copy=function(){return mo(t,h3()).constant(t.constant())},yi.apply(t,arguments)}function lS(){var t=Q2(am());return t.copy=function(){return mo(t,lS()).exponent(t.exponent())},yi.apply(t,arguments)}function tY(){return lS.apply(null,arguments).exponent(.5)}const TR=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:df,scaleDiverging:f3,scaleDivergingLog:d3,scaleDivergingPow:lS,scaleDivergingSqrt:tY,scaleDivergingSymlog:h3,scaleIdentity:V4,scaleImplicit:K1,scaleLinear:Np,scaleLog:G4,scaleOrdinal:z2,scalePoint:Uc,scalePow:Z2,scaleQuantile:Y4,scaleQuantize:J4,scaleRadial:X4,scaleSequential:s3,scaleSequentialLog:u3,scaleSequentialPow:uS,scaleSequentialQuantile:c3,scaleSequentialSqrt:eY,scaleSequentialSymlog:l3,scaleSqrt:D7,scaleSymlog:K4,scaleThreshold:Q4,scaleTime:QX,scaleUtc:ZX,tickFormat:q4},Symbol.toStringTag,{value:"Module"}));var Kx,PR;function p3(){if(PR)return Kx;PR=1;var t=bl();function e(r,n,a){for(var i=-1,o=r.length;++i<o;){var s=r[i],u=n(s);if(u!=null&&(l===void 0?u===u&&!t(u):a(u,l)))var l=u,f=s}return f}return Kx=e,Kx}var Xx,NR;function rY(){if(NR)return Xx;NR=1;function t(e,r){return e>r}return Xx=t,Xx}var Yx,RR;function nY(){if(RR)return Yx;RR=1;var t=p3(),e=rY(),r=Sl();function n(a){return a&&a.length?t(a,r,e):void 0}return Yx=n,Yx}var aY=nY();const Zi=yt(aY);var Jx,IR;function iY(){if(IR)return Jx;IR=1;function t(e,r){return e<r}return Jx=t,Jx}var Qx,jR;function oY(){if(jR)return Qx;jR=1;var t=p3(),e=iY(),r=Sl();function n(a){return a&&a.length?t(a,r,e):void 0}return Qx=n,Qx}var sY=oY();const im=yt(sY);var Zx,DR;function uY(){if(DR)return Zx;DR=1;var t=C2(),e=po(),r=_4(),n=pn();function a(i,o){var s=n(i)?t:r;return s(i,e(o,3))}return Zx=a,Zx}var ew,MR;function lY(){if(MR)return ew;MR=1;var t=x4(),e=uY();function r(n,a){return t(e(n,a),1)}return ew=r,ew}var cY=lY();const fY=yt(cY);var tw,FR;function dY(){if(FR)return tw;FR=1;var t=L2();function e(r,n){return t(r,n)}return tw=e,tw}var hY=dY();const Yu=yt(hY);var Cl=1e9,pY={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},fS,jt=!0,Hn="[DecimalError] ",as=Hn+"Invalid argument: ",cS=Hn+"Exponent out of range: ",kl=Math.floor,zo=Math.pow,vY=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Cn,xr=1e7,Tt=7,v3=9007199254740991,Dp=kl(v3/Tt),Te={};Te.absoluteValue=Te.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Te.comparedTo=Te.cmp=function(t){var e,r,n,a,i=this;if(t=new i.constructor(t),i.s!==t.s)return i.s||-t.s;if(i.e!==t.e)return i.e>t.e^i.s<0?1:-1;for(n=i.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(i.d[e]!==t.d[e])return i.d[e]>t.d[e]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Te.decimalPlaces=Te.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*Tt;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};Te.dividedBy=Te.div=function(t){return li(this,new this.constructor(t))};Te.dividedToIntegerBy=Te.idiv=function(t){var e=this,r=e.constructor;return xt(li(e,new r(t),0,1),r.precision)};Te.equals=Te.eq=function(t){return!this.cmp(t)};Te.exponent=function(){return tr(this)};Te.greaterThan=Te.gt=function(t){return this.cmp(t)>0};Te.greaterThanOrEqualTo=Te.gte=function(t){return this.cmp(t)>=0};Te.isInteger=Te.isint=function(){return this.e>this.d.length-2};Te.isNegative=Te.isneg=function(){return this.s<0};Te.isPositive=Te.ispos=function(){return this.s>0};Te.isZero=function(){return this.s===0};Te.lessThan=Te.lt=function(t){return this.cmp(t)<0};Te.lessThanOrEqualTo=Te.lte=function(t){return this.cmp(t)<1};Te.logarithm=Te.log=function(t){var e,r=this,n=r.constructor,a=n.precision,i=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Cn))throw Error(Hn+"NaN");if(r.s<1)throw Error(Hn+(r.s?"NaN":"-Infinity"));return r.eq(Cn)?new n(0):(jt=!1,e=li(gf(r,i),gf(t,i),i),jt=!0,xt(e,a))};Te.minus=Te.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?y3(e,t):m3(e,(t.s=-t.s,t))};Te.modulo=Te.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(Hn+"NaN");return r.s?(jt=!1,e=li(r,t,0,1).times(t),jt=!0,r.minus(e)):xt(new n(r),a)};Te.naturalExponential=Te.exp=function(){return g3(this)};Te.naturalLogarithm=Te.ln=function(){return gf(this)};Te.negated=Te.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Te.plus=Te.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?m3(e,t):y3(e,(t.s=-t.s,t))};Te.precision=Te.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(as+t);if(e=tr(a)+1,n=a.d.length-1,r=n*Tt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};Te.squareRoot=Te.sqrt=function(){var t,e,r,n,a,i,o,s=this,u=s.constructor;if(s.s<1){if(!s.s)return new u(0);throw Error(Hn+"NaN")}for(t=tr(s),jt=!1,a=Math.sqrt(+s),a==0||a==1/0?(e=Oa(s.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=kl((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new u(e)):n=new u(a.toString()),r=u.precision,a=o=r+3;;)if(i=n,n=i.plus(li(s,i,o+2)).times(.5),Oa(i.d).slice(0,o)===(e=Oa(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),a==o&&e=="4999"){if(xt(i,r+1,0),i.times(i).eq(s)){n=i;break}}else if(e!="9999")break;o+=4}return jt=!0,xt(n,r)};Te.times=Te.mul=function(t){var e,r,n,a,i,o,s,u,l,f=this,d=f.constructor,p=f.d,v=(t=new d(t)).d;if(!f.s||!t.s)return new d(0);for(t.s*=f.s,r=f.e+t.e,u=p.length,l=v.length,u<l&&(i=p,p=v,v=i,o=u,u=l,l=o),i=[],o=u+l,n=o;n--;)i.push(0);for(n=l;--n>=0;){for(e=0,a=u+n;a>n;)s=i[a]+v[n]*p[a-n-1]+e,i[a--]=s%xr|0,e=s/xr|0;i[a]=(i[a]+e)%xr|0}for(;!i[--o];)i.pop();return e?++r:i.shift(),t.d=i,t.e=r,jt?xt(t,d.precision):t};Te.toDecimalPlaces=Te.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Ma(t,0,Cl),e===void 0?e=n.rounding:Ma(e,0,8),xt(r,t+tr(r)+1,e))};Te.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=ls(n,!0):(Ma(t,0,Cl),e===void 0?e=a.rounding:Ma(e,0,8),n=xt(new a(n),t+1,e),r=ls(n,!0,t+1)),r};Te.toFixed=function(t,e){var r,n,a=this,i=a.constructor;return t===void 0?ls(a):(Ma(t,0,Cl),e===void 0?e=i.rounding:Ma(e,0,8),n=xt(new i(a),t+tr(a)+1,e),r=ls(n.abs(),!1,t+tr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Te.toInteger=Te.toint=function(){var t=this,e=t.constructor;return xt(new e(t),tr(t)+1,e.rounding)};Te.toNumber=function(){return+this};Te.toPower=Te.pow=function(t){var e,r,n,a,i,o,s=this,u=s.constructor,l=12,f=+(t=new u(t));if(!t.s)return new u(Cn);if(s=new u(s),!s.s){if(t.s<1)throw Error(Hn+"Infinity");return s}if(s.eq(Cn))return s;if(n=u.precision,t.eq(Cn))return xt(s,n);if(e=t.e,r=t.d.length-1,o=e>=r,i=s.s,o){if((r=f<0?-f:f)<=v3){for(a=new u(Cn),e=Math.ceil(n/Tt+4),jt=!1;r%2&&(a=a.times(s),BR(a.d,e)),r=kl(r/2),r!==0;)s=s.times(s),BR(s.d,e);return jt=!0,t.s<0?new u(Cn).div(a):xt(a,n)}}else if(i<0)throw Error(Hn+"NaN");return i=i<0&&t.d[Math.max(e,r)]&1?-1:1,s.s=1,jt=!1,a=t.times(gf(s,n+l)),jt=!0,a=g3(a),a.s=i,a};Te.toPrecision=function(t,e){var r,n,a=this,i=a.constructor;return t===void 0?(r=tr(a),n=ls(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ma(t,1,Cl),e===void 0?e=i.rounding:Ma(e,0,8),a=xt(new i(a),t,e),r=tr(a),n=ls(a,t<=r||r<=i.toExpNeg,t)),n};Te.toSignificantDigits=Te.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Ma(t,1,Cl),e===void 0?e=n.rounding:Ma(e,0,8)),xt(new n(r),t,e)};Te.toString=Te.valueOf=Te.val=Te.toJSON=Te[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=tr(t),r=t.constructor;return ls(t,e<=r.toExpNeg||e>=r.toExpPos)};function m3(t,e){var r,n,a,i,o,s,u,l,f=t.constructor,d=f.precision;if(!t.s||!e.s)return e.s||(e=new f(t)),jt?xt(e,d):e;if(u=t.d,l=e.d,o=t.e,a=e.e,u=u.slice(),i=o-a,i){for(i<0?(n=u,i=-i,s=l.length):(n=l,a=o,s=u.length),o=Math.ceil(d/Tt),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=u.length,i=l.length,s-i<0&&(i=s,n=l,l=u,u=n),r=0;i;)r=(u[--i]=u[i]+l[i]+r)/xr|0,u[i]%=xr;for(r&&(u.unshift(r),++a),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=a,jt?xt(e,d):e}function Ma(t,e,r){if(t!==~~t||t<e||t>r)throw Error(as+t)}function Oa(t){var e,r,n,a=t.length-1,i="",o=t[0];if(a>0){for(i+=o,e=1;e<a;e++)n=t[e]+"",r=Tt-n.length,r&&(i+=Ki(r)),i+=n;o=t[e],n=o+"",r=Tt-n.length,r&&(i+=Ki(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var li=(function(){function t(n,a){var i,o=0,s=n.length;for(n=n.slice();s--;)i=n[s]*a+o,n[s]=i%xr|0,o=i/xr|0;return o&&n.unshift(o),n}function e(n,a,i,o){var s,u;if(i!=o)u=i>o?1:-1;else for(s=u=0;s<i;s++)if(n[s]!=a[s]){u=n[s]>a[s]?1:-1;break}return u}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*xr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var s,u,l,f,d,p,v,g,b,y,x,S,E,C,k,A,T,N,R=n.constructor,I=n.s==a.s?1:-1,D=n.d,j=a.d;if(!n.s)return new R(n);if(!a.s)throw Error(Hn+"Division by zero");for(u=n.e-a.e,T=j.length,k=D.length,v=new R(I),g=v.d=[],l=0;j[l]==(D[l]||0);)++l;if(j[l]>(D[l]||0)&&--u,i==null?S=i=R.precision:o?S=i+(tr(n)-tr(a))+1:S=i,S<0)return new R(0);if(S=S/Tt+2|0,l=0,T==1)for(f=0,j=j[0],S++;(l<k||f)&&S--;l++)E=f*xr+(D[l]||0),g[l]=E/j|0,f=E%j|0;else{for(f=xr/(j[0]+1)|0,f>1&&(j=t(j,f),D=t(D,f),T=j.length,k=D.length),C=T,b=D.slice(0,T),y=b.length;y<T;)b[y++]=0;N=j.slice(),N.unshift(0),A=j[0],j[1]>=xr/2&&++A;do f=0,s=e(j,b,T,y),s<0?(x=b[0],T!=y&&(x=x*xr+(b[1]||0)),f=x/A|0,f>1?(f>=xr&&(f=xr-1),d=t(j,f),p=d.length,y=b.length,s=e(d,b,p,y),s==1&&(f--,r(d,T<p?N:j,p))):(f==0&&(s=f=1),d=j.slice()),p=d.length,p<y&&d.unshift(0),r(b,d,y),s==-1&&(y=b.length,s=e(j,b,T,y),s<1&&(f++,r(b,T<y?N:j,y))),y=b.length):s===0&&(f++,b=[0]),g[l++]=f,s&&b[0]?b[y++]=D[C]||0:(b=[D[C]],y=1);while((C++<k||b[0]!==void 0)&&S--)}return g[0]||g.shift(),v.e=u,xt(v,o?i+tr(v)+1:i)}})();function g3(t,e){var r,n,a,i,o,s,u=0,l=0,f=t.constructor,d=f.precision;if(tr(t)>16)throw Error(cS+tr(t));if(!t.s)return new f(Cn);for(jt=!1,s=d,o=new f(.03125);t.abs().gte(.1);)t=t.times(o),l+=5;for(n=Math.log(zo(2,l))/Math.LN10*2+5|0,s+=n,r=a=i=new f(Cn),f.precision=s;;){if(a=xt(a.times(t),s),r=r.times(++u),o=i.plus(li(a,r,s)),Oa(o.d).slice(0,s)===Oa(i.d).slice(0,s)){for(;l--;)i=xt(i.times(i),s);return f.precision=d,e==null?(jt=!0,xt(i,d)):i}i=o}}function tr(t){for(var e=t.e*Tt,r=t.d[0];r>=10;r/=10)e++;return e}function rw(t,e,r){if(e>t.LN10.sd())throw jt=!0,r&&(t.precision=r),Error(Hn+"LN10 precision limit exceeded");return xt(new t(t.LN10),e)}function Ki(t){for(var e="";t--;)e+="0";return e}function gf(t,e){var r,n,a,i,o,s,u,l,f,d=1,p=10,v=t,g=v.d,b=v.constructor,y=b.precision;if(v.s<1)throw Error(Hn+(v.s?"NaN":"-Infinity"));if(v.eq(Cn))return new b(0);if(e==null?(jt=!1,l=y):l=e,v.eq(10))return e==null&&(jt=!0),rw(b,l);if(l+=p,b.precision=l,r=Oa(g),n=r.charAt(0),i=tr(v),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)v=v.times(t),r=Oa(v.d),n=r.charAt(0),d++;i=tr(v),n>1?(v=new b("0."+r),i++):v=new b(n+"."+r.slice(1))}else return u=rw(b,l+2,y).times(i+""),v=gf(new b(n+"."+r.slice(1)),l-p).plus(u),b.precision=y,e==null?(jt=!0,xt(v,y)):v;for(s=o=v=li(v.minus(Cn),v.plus(Cn),l),f=xt(v.times(v),l),a=3;;){if(o=xt(o.times(f),l),u=s.plus(li(o,new b(a),l)),Oa(u.d).slice(0,l)===Oa(s.d).slice(0,l))return s=s.times(2),i!==0&&(s=s.plus(rw(b,l+2,y).times(i+""))),s=li(s,new b(d),l),b.precision=y,e==null?(jt=!0,xt(s,y)):s;s=u,a+=2}}function LR(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=kl(r/Tt),t.d=[],n=(r+1)%Tt,r<0&&(n+=Tt),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=Tt;n<a;)t.d.push(+e.slice(n,n+=Tt));e=e.slice(n),n=Tt-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),jt&&(t.e>Dp||t.e<-Dp))throw Error(cS+r)}else t.s=0,t.e=0,t.d=[0];return t}function xt(t,e,r){var n,a,i,o,s,u,l,f,d=t.d;for(o=1,i=d[0];i>=10;i/=10)o++;if(n=e-o,n<0)n+=Tt,a=e,l=d[f=0];else{if(f=Math.ceil((n+1)/Tt),i=d.length,f>=i)return t;for(l=i=d[f],o=1;i>=10;i/=10)o++;n%=Tt,a=n-Tt+o}if(r!==void 0&&(i=zo(10,o-a-1),s=l/i%10|0,u=e<0||d[f+1]!==void 0||l%i,u=r<4?(s||u)&&(r==0||r==(t.s<0?3:2)):s>5||s==5&&(r==4||u||r==6&&(n>0?a>0?l/zo(10,o-a):0:d[f-1])%10&1||r==(t.s<0?8:7))),e<1||!d[0])return u?(i=tr(t),d.length=1,e=e-i-1,d[0]=zo(10,(Tt-e%Tt)%Tt),t.e=kl(-e/Tt)||0):(d.length=1,d[0]=t.e=t.s=0),t;if(n==0?(d.length=f,i=1,f--):(d.length=f+1,i=zo(10,Tt-n),d[f]=a>0?(l/zo(10,o-a)%zo(10,a)|0)*i:0),u)for(;;)if(f==0){(d[0]+=i)==xr&&(d[0]=1,++t.e);break}else{if(d[f]+=i,d[f]!=xr)break;d[f--]=0,i=1}for(n=d.length;d[--n]===0;)d.pop();if(jt&&(t.e>Dp||t.e<-Dp))throw Error(cS+tr(t));return t}function y3(t,e){var r,n,a,i,o,s,u,l,f,d,p=t.constructor,v=p.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new p(t),jt?xt(e,v):e;if(u=t.d,d=e.d,n=e.e,l=t.e,u=u.slice(),o=l-n,o){for(f=o<0,f?(r=u,o=-o,s=d.length):(r=d,n=l,s=u.length),a=Math.max(Math.ceil(v/Tt),s)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=u.length,s=d.length,f=a<s,f&&(s=a),a=0;a<s;a++)if(u[a]!=d[a]){f=u[a]<d[a];break}o=0}for(f&&(r=u,u=d,d=r,e.s=-e.s),s=u.length,a=d.length-s;a>0;--a)u[s++]=0;for(a=d.length;a>o;){if(u[--a]<d[a]){for(i=a;i&&u[--i]===0;)u[i]=xr-1;--u[i],u[a]+=xr}u[a]-=d[a]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=n,jt?xt(e,v):e):new p(0)}function ls(t,e,r){var n,a=tr(t),i=Oa(t.d),o=i.length;return e?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Ki(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Ki(-a-1)+i,r&&(n=r-o)>0&&(i+=Ki(n))):a>=o?(i+=Ki(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+Ki(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=Ki(n))),t.s<0?"-"+i:i}function BR(t,e){if(t.length>e)return t.length=e,!0}function b3(t){var e,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(as+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return LR(o,i.toString())}else if(typeof i!="string")throw Error(as+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,vY.test(i))LR(o,i);else throw Error(as+i)}if(a.prototype=Te,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=b3,a.config=a.set=mY,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function mY(t){if(!t||typeof t!="object")throw Error(Hn+"Object expected");var e,r,n,a=["precision",1,Cl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(kl(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(as+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(as+r+": "+n);return this}var fS=b3(pY);Cn=new fS(1);const bt=fS;function gY(t){return wY(t)||xY(t)||bY(t)||yY()}function yY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bY(t,e){if(t){if(typeof t=="string")return Q1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q1(t,e)}}function xY(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function wY(t){if(Array.isArray(t))return Q1(t)}function Q1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var _Y=function(e){return e},x3={},w3=function(e){return e===x3},$R=function(e){return function r(){return arguments.length===0||arguments.length===1&&w3(arguments.length<=0?void 0:arguments[0])?r:e.apply(void 0,arguments)}},SY=function t(e,r){return e===1?r:$R(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(s){return s!==x3}).length;return o>=e?r.apply(void 0,a):t(e-o,$R(function(){for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];var f=a.map(function(d){return w3(d)?u.shift():d});return r.apply(void 0,gY(f).concat(u))}))})},om=function(e){return SY(e.length,e)},Z1=function(e,r){for(var n=[],a=e;a<r;++a)n[a-e]=a;return n},EY=om(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(r){return e[r]}).map(t)}),CY=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return _Y;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(s,u){return u(s)},i.apply(void 0,arguments))}},e_=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},_3=function(e){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(s,u){return s===r[u]})||(r=i,n=e.apply(void 0,i)),n}};function kY(t){var e;return t===0?e=1:e=Math.floor(new bt(t).abs().log(10).toNumber())+1,e}function AY(t,e,r){for(var n=new bt(t),a=0,i=[];n.lt(e)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var OY=om(function(t,e,r){var n=+t,a=+e;return n+r*(a-n)}),TY=om(function(t,e,r){var n=e-+t;return n=n||1/0,(r-t)/n}),PY=om(function(t,e,r){var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});const sm={rangeStep:AY,getDigitCount:kY,interpolateNumber:OY,uninterpolateNumber:TY,uninterpolateTruncation:PY};function t_(t){return IY(t)||RY(t)||S3(t)||NY()}function NY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RY(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function IY(t){if(Array.isArray(t))return r_(t)}function yf(t,e){return MY(t)||DY(t,e)||S3(t,e)||jY()}function jY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S3(t,e){if(t){if(typeof t=="string")return r_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r_(t,e)}}function r_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function DY(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=t[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(r.push(s.value),!(e&&r.length===e));n=!0);}catch(u){a=!0,i=u}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function MY(t){if(Array.isArray(t))return t}function E3(t){var e=yf(t,2),r=e[0],n=e[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function C3(t,e,r){if(t.lte(0))return new bt(0);var n=sm.getDigitCount(t.toNumber()),a=new bt(10).pow(n),i=t.div(a),o=n!==1?.05:.1,s=new bt(Math.ceil(i.div(o).toNumber())).add(r).mul(o),u=s.mul(a);return e?u:new bt(Math.ceil(u))}function FY(t,e,r){var n=1,a=new bt(t);if(!a.isint()&&r){var i=Math.abs(t);i<1?(n=new bt(10).pow(sm.getDigitCount(t)-1),a=new bt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new bt(Math.floor(t)))}else t===0?a=new bt(Math.floor((e-1)/2)):r||(a=new bt(Math.floor(t)));var o=Math.floor((e-1)/2),s=CY(EY(function(u){return a.add(new bt(u-o).mul(n)).toNumber()}),Z1);return s(0,e)}function k3(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(r-1)))return{step:new bt(0),tickMin:new bt(0),tickMax:new bt(0)};var i=C3(new bt(e).sub(t).div(r-1),n,a),o;t<=0&&e>=0?o=new bt(0):(o=new bt(t).add(e).div(2),o=o.sub(new bt(o).mod(i)));var s=Math.ceil(o.sub(t).div(i).toNumber()),u=Math.ceil(new bt(e).sub(o).div(i).toNumber()),l=s+u+1;return l>r?k3(t,e,r,n,a+1):(l<r&&(u=e>0?u+(r-l):u,s=e>0?s:s+(r-l)),{step:i,tickMin:o.sub(new bt(s).mul(i)),tickMax:o.add(new bt(u).mul(i))})}function LY(t){var e=yf(t,2),r=e[0],n=e[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),s=E3([r,n]),u=yf(s,2),l=u[0],f=u[1];if(l===-1/0||f===1/0){var d=f===1/0?[l].concat(t_(Z1(0,a-1).map(function(){return 1/0}))):[].concat(t_(Z1(0,a-1).map(function(){return-1/0})),[f]);return r>n?e_(d):d}if(l===f)return FY(l,a,i);var p=k3(l,f,o,i),v=p.step,g=p.tickMin,b=p.tickMax,y=sm.rangeStep(g,b.add(new bt(.1).mul(v)),v);return r>n?e_(y):y}function BY(t,e){var r=yf(t,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=E3([n,a]),s=yf(o,2),u=s[0],l=s[1];if(u===-1/0||l===1/0)return[n,a];if(u===l)return[u];var f=Math.max(e,2),d=C3(new bt(l).sub(u).div(f-1),i,0),p=[].concat(t_(sm.rangeStep(new bt(u),new bt(l).sub(new bt(.99).mul(d)),d)),[l]);return n>a?e_(p):p}var $Y=_3(LY),UY=_3(BY),WY="Invariant failed";function cs(t,e){throw new Error(WY)}var zY=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ju(t){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ju(t)}function Mp(){return Mp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mp.apply(this,arguments)}function qY(t,e){return KY(t)||GY(t,e)||HY(t,e)||VY()}function VY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HY(t,e){if(t){if(typeof t=="string")return UR(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UR(t,e)}}function UR(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function GY(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function KY(t){if(Array.isArray(t))return t}function XY(t,e){if(t==null)return{};var r=YY(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function YY(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function JY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QY(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T3(n.key),n)}}function ZY(t,e,r){return e&&QY(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function eJ(t,e,r){return e=Fp(e),tJ(t,A3()?Reflect.construct(e,r||[],Fp(t).constructor):e.apply(t,r))}function tJ(t,e){if(e&&(Ju(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rJ(t)}function rJ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A3(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(A3=function(){return!!t})()}function Fp(t){return Fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fp(t)}function nJ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n_(t,e)}function n_(t,e){return n_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},n_(t,e)}function O3(t,e,r){return e=T3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T3(t){var e=aJ(t,"string");return Ju(e)=="symbol"?e:e+""}function aJ(t,e){if(Ju(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ju(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var td=(function(t){function e(){return JY(this,e),eJ(this,e,arguments)}return nJ(e,t),ZY(e,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,s=n.dataKey,u=n.data,l=n.dataPointFormatter,f=n.xAxis,d=n.yAxis,p=XY(n,zY),v=rt(p,!1);this.props.direction==="x"&&f.type!=="number"&&cs();var g=u.map(function(b){var y=l(b,s),x=y.x,S=y.y,E=y.value,C=y.errorVal;if(!C)return null;var k=[],A,T;if(Array.isArray(C)){var N=qY(C,2);A=N[0],T=N[1]}else A=T=C;if(i==="vertical"){var R=f.scale,I=S+a,D=I+o,j=I-o,$=R(E-A),W=R(E+T);k.push({x1:W,y1:D,x2:W,y2:j}),k.push({x1:$,y1:I,x2:W,y2:I}),k.push({x1:$,y1:D,x2:$,y2:j})}else if(i==="horizontal"){var q=d.scale,X=x+a,Y=X-o,z=X+o,B=q(E-A),G=q(E+T);k.push({x1:Y,y1:G,x2:z,y2:G}),k.push({x1:X,y1:B,x2:X,y2:G}),k.push({x1:Y,y1:B,x2:z,y2:B})}return Z.createElement(Et,Mp({className:"recharts-errorBar",key:"bar-".concat(k.map(function(L){return"".concat(L.x1,"-").concat(L.x2,"-").concat(L.y1,"-").concat(L.y2)}))},v),k.map(function(L){return Z.createElement("line",Mp({},L,{key:"line-".concat(L.x1,"-").concat(L.x2,"-").concat(L.y1,"-").concat(L.y2)}))}))});return Z.createElement(Et,{className:"recharts-errorBars"},g)}}])})(Z.Component);O3(td,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});O3(td,"displayName","ErrorBar");function bf(t){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bf(t)}function WR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Bo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WR(Object(r),!0).forEach(function(n){iJ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iJ(t,e,r){return e=oJ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oJ(t){var e=sJ(t,"string");return bf(e)=="symbol"?e:e+""}function sJ(t,e){if(bf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(bf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var P3=function(e){var r=e.children,n=e.formattedGraphicalItems,a=e.legendWidth,i=e.legendContent,o=_n(r,ku);if(!o)return null;var s=ku.defaultProps,u=s!==void 0?Bo(Bo({},s),o.props):{},l;return o.props&&o.props.payload?l=o.props&&o.props.payload:i==="children"?l=(n||[]).reduce(function(f,d){var p=d.item,v=d.props,g=v.sectors||v.data||[];return f.concat(g.map(function(b){return{type:o.props.iconType||p.props.legendType,value:b.name,color:b.fill,payload:b}}))},[]):l=(n||[]).map(function(f){var d=f.item,p=d.type.defaultProps,v=p!==void 0?Bo(Bo({},p),d.props):{},g=v.dataKey,b=v.name,y=v.legendType,x=v.hide;return{inactive:x,dataKey:g,type:u.iconType||y||"square",color:dS(d),value:b||g,payload:v}}),Bo(Bo(Bo({},u),ku.getWithHeight(o,a)),{},{payload:l,item:o})};function xf(t){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xf(t)}function zR(t){return fJ(t)||cJ(t)||lJ(t)||uJ()}function uJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lJ(t,e){if(t){if(typeof t=="string")return a_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a_(t,e)}}function cJ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function fJ(t){if(Array.isArray(t))return a_(t)}function a_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ht(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qR(Object(r),!0).forEach(function(n){Ou(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ou(t,e,r){return e=dJ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dJ(t){var e=hJ(t,"string");return xf(e)=="symbol"?e:e+""}function hJ(t,e){if(xf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(xf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function en(t,e,r){return nt(t)||nt(e)?r:ur(e)?qn(t,e,r):et(e)?e(t):r}function Wc(t,e,r,n){var a=fY(t,function(s){return en(s,e)});if(r==="number"){var i=a.filter(function(s){return be(s)||parseFloat(s)});return i.length?[im(i),Zi(i)]:[1/0,-1/0]}var o=n?a.filter(function(s){return!nt(s)}):a;return o.map(function(s){return ur(s)||s instanceof Date?s:""})}var pJ=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,s=(r=n?.length)!==null&&r!==void 0?r:0;if(s<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var u=i.range,l=0;l<s;l++){var f=l>0?a[l-1].coordinate:a[s-1].coordinate,d=a[l].coordinate,p=l>=s-1?a[0].coordinate:a[l+1].coordinate,v=void 0;if(ca(d-f)!==ca(p-d)){var g=[];if(ca(p-d)===ca(u[1]-u[0])){v=p;var b=d+u[1]-u[0];g[0]=Math.min(b,(b+f)/2),g[1]=Math.max(b,(b+f)/2)}else{v=f;var y=p+u[1]-u[0];g[0]=Math.min(d,(y+d)/2),g[1]=Math.max(d,(y+d)/2)}var x=[Math.min(d,(v+d)/2),Math.max(d,(v+d)/2)];if(e>x[0]&&e<=x[1]||e>=g[0]&&e<=g[1]){o=a[l].index;break}}else{var S=Math.min(f,p),E=Math.max(f,p);if(e>(S+d)/2&&e<=(E+d)/2){o=a[l].index;break}}}else for(var C=0;C<s;C++)if(C===0&&e<=(n[C].coordinate+n[C+1].coordinate)/2||C>0&&C<s-1&&e>(n[C].coordinate+n[C-1].coordinate)/2&&e<=(n[C].coordinate+n[C+1].coordinate)/2||C===s-1&&e>(n[C].coordinate+n[C-1].coordinate)/2){o=n[C].index;break}return o},dS=function(e){var r,n=e,a=n.type.displayName,i=(r=e.type)!==null&&r!==void 0&&r.defaultProps?Ht(Ht({},e.type.defaultProps),e.props):e.props,o=i.stroke,s=i.fill,u;switch(a){case"Line":u=o;break;case"Area":case"Radar":u=o&&o!=="none"?o:s;break;default:u=s;break}return u},vJ=function(e){var r=e.barSize,n=e.totalSize,a=e.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},s=Object.keys(i),u=0,l=s.length;u<l;u++)for(var f=i[s[u]].stackGroups,d=Object.keys(f),p=0,v=d.length;p<v;p++){var g=f[d[p]],b=g.items,y=g.cateAxisId,x=b.filter(function(T){return si(T.type).indexOf("Bar")>=0});if(x&&x.length){var S=x[0].type.defaultProps,E=S!==void 0?Ht(Ht({},S),x[0].props):x[0].props,C=E.barSize,k=E[y];o[k]||(o[k]=[]);var A=nt(C)?r:C;o[k].push({item:x[0],stackList:x.slice(1),barSize:nt(A)?void 0:us(A,n,0)})}}return o},mJ=function(e){var r=e.barGap,n=e.barCategoryGap,a=e.bandSize,i=e.sizeList,o=i===void 0?[]:i,s=e.maxBarSize,u=o.length;if(u<1)return null;var l=us(r,a,0,!0),f,d=[];if(o[0].barSize===+o[0].barSize){var p=!1,v=a/u,g=o.reduce(function(C,k){return C+k.barSize||0},0);g+=(u-1)*l,g>=a&&(g-=(u-1)*l,l=0),g>=a&&v>0&&(p=!0,v*=.9,g=u*v);var b=(a-g)/2>>0,y={offset:b-l,size:0};f=o.reduce(function(C,k){var A={item:k.item,position:{offset:y.offset+y.size+l,size:p?v:k.barSize}},T=[].concat(zR(C),[A]);return y=T[T.length-1].position,k.stackList&&k.stackList.length&&k.stackList.forEach(function(N){T.push({item:N,position:y})}),T},d)}else{var x=us(n,a,0,!0);a-2*x-(u-1)*l<=0&&(l=0);var S=(a-2*x-(u-1)*l)/u;S>1&&(S>>=0);var E=s===+s?Math.min(S,s):S;f=o.reduce(function(C,k,A){var T=[].concat(zR(C),[{item:k.item,position:{offset:x+(S+l)*A+(S-E)/2,size:E}}]);return k.stackList&&k.stackList.length&&k.stackList.forEach(function(N){T.push({item:N,position:T[T.length-1].position})}),T},d)}return f},gJ=function(e,r,n,a){var i=n.children,o=n.width,s=n.margin,u=o-(s.left||0)-(s.right||0),l=P3({children:i,legendWidth:u});if(l){var f=a||{},d=f.width,p=f.height,v=l.align,g=l.verticalAlign,b=l.layout;if((b==="vertical"||b==="horizontal"&&g==="middle")&&v!=="center"&&be(e[v]))return Ht(Ht({},e),{},Ou({},v,e[v]+(d||0)));if((b==="horizontal"||b==="vertical"&&v==="center")&&g!=="middle"&&be(e[g]))return Ht(Ht({},e),{},Ou({},g,e[g]+(p||0)))}return e},yJ=function(e,r,n){return nt(r)?!0:e==="horizontal"?r==="yAxis":e==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},N3=function(e,r,n,a,i){var o=r.props.children,s=Vn(o,td).filter(function(l){return yJ(a,i,l.props.direction)});if(s&&s.length){var u=s.map(function(l){return l.props.dataKey});return e.reduce(function(l,f){var d=en(f,n);if(nt(d))return l;var p=Array.isArray(d)?[im(d),Zi(d)]:[d,d],v=u.reduce(function(g,b){var y=en(f,b,0),x=p[0]-Math.abs(Array.isArray(y)?y[0]:y),S=p[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(x,g[0]),Math.max(S,g[1])]},[1/0,-1/0]);return[Math.min(v[0],l[0]),Math.max(v[1],l[1])]},[1/0,-1/0])}return null},bJ=function(e,r,n,a,i){var o=r.map(function(s){return N3(e,s,n,i,a)}).filter(function(s){return!nt(s)});return o&&o.length?o.reduce(function(s,u){return[Math.min(s[0],u[0]),Math.max(s[1],u[1])]},[1/0,-1/0]):null},R3=function(e,r,n,a,i){var o=r.map(function(u){var l=u.props.dataKey;return n==="number"&&l&&N3(e,u,l,a)||Wc(e,l,n,i)});if(n==="number")return o.reduce(function(u,l){return[Math.min(u[0],l[0]),Math.max(u[1],l[1])]},[1/0,-1/0]);var s={};return o.reduce(function(u,l){for(var f=0,d=l.length;f<d;f++)s[l[f]]||(s[l[f]]=!0,u.push(l[f]));return u},[])},I3=function(e,r){return e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis"},j3=function(e,r,n,a){if(a)return e.map(function(u){return u.coordinate});var i,o,s=e.map(function(u){return u.coordinate===r&&(i=!0),u.coordinate===n&&(o=!0),u.coordinate});return i||s.push(r),o||s.push(n),s},oi=function(e,r,n){if(!e)return null;var a=e.scale,i=e.duplicateDomain,o=e.type,s=e.range,u=e.realScaleType==="scaleBand"?a.bandwidth()/2:2,l=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/u:0;if(l=e.axisType==="angleAxis"&&s?.length>=2?ca(s[0]-s[1])*2*l:l,r&&(e.ticks||e.niceTicks)){var f=(e.ticks||e.niceTicks).map(function(d){var p=i?i.indexOf(d):d;return{coordinate:a(p)+l,value:d,offset:l}});return f.filter(function(d){return!wl(d.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(d,p){return{coordinate:a(d)+l,value:d,index:p,offset:l}}):a.ticks&&!n?a.ticks(e.tickCount).map(function(d){return{coordinate:a(d)+l,value:d,offset:l}}):a.domain().map(function(d,p){return{coordinate:a(d)+l,value:i?i[d]:d,index:p,offset:l}})},nw=new WeakMap,Fh=function(e,r){if(typeof r!="function")return e;nw.has(e)||nw.set(e,new WeakMap);var n=nw.get(e);if(n.has(r))return n.get(r);var a=function(){e.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},xJ=function(e,r,n){var a=e.scale,i=e.type,o=e.layout,s=e.axisType;if(a==="auto")return o==="radial"&&s==="radiusAxis"?{scale:df(),realScaleType:"band"}:o==="radial"&&s==="angleAxis"?{scale:Np(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Uc(),realScaleType:"point"}:i==="category"?{scale:df(),realScaleType:"band"}:{scale:Np(),realScaleType:"linear"};if(ss(a)){var u="scale".concat(Hv(a));return{scale:(TR[u]||Uc)(),realScaleType:TR[u]?u:"point"}}return et(a)?{scale:a}:{scale:Uc(),realScaleType:"point"}},VR=1e-4,wJ=function(e){var r=e.domain();if(!(!r||r.length<=2)){var n=r.length,a=e.range(),i=Math.min(a[0],a[1])-VR,o=Math.max(a[0],a[1])+VR,s=e(r[0]),u=e(r[n-1]);(s<i||s>o||u<i||u>o)&&e.domain([r[0],r[n-1]])}},_J=function(e,r){if(!e)return null;for(var n=0,a=e.length;n<a;n++)if(e[n].item===r)return e[n].position;return null},SJ=function(e,r){if(!r||r.length!==2||!be(r[0])||!be(r[1]))return e;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[e[0],e[1]];return(!be(e[0])||e[0]<n)&&(i[0]=n),(!be(e[1])||e[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},EJ=function(e){var r=e.length;if(!(r<=0))for(var n=0,a=e[0].length;n<a;++n)for(var i=0,o=0,s=0;s<r;++s){var u=wl(e[s][n][1])?e[s][n][0]:e[s][n][1];u>=0?(e[s][n][0]=i,e[s][n][1]=i+u,i=e[s][n][1]):(e[s][n][0]=o,e[s][n][1]=o+u,o=e[s][n][1])}},CJ=function(e){var r=e.length;if(!(r<=0))for(var n=0,a=e[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var s=wl(e[o][n][1])?e[o][n][0]:e[o][n][1];s>=0?(e[o][n][0]=i,e[o][n][1]=i+s,i=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},kJ={sign:EJ,expand:lH,none:Wu,silhouette:cH,wiggle:fH,positive:CJ},AJ=function(e,r,n){var a=r.map(function(s){return s.props.dataKey}),i=kJ[n],o=uH().keys(a).value(function(s,u){return+en(s,u,0)}).order(j1).offset(i);return o(e)},OJ=function(e,r,n,a,i,o){if(!e)return null;var s=o?r.reverse():r,u={},l=s.reduce(function(d,p){var v,g=(v=p.type)!==null&&v!==void 0&&v.defaultProps?Ht(Ht({},p.type.defaultProps),p.props):p.props,b=g.stackId,y=g.hide;if(y)return d;var x=g[n],S=d[x]||{hasStack:!1,stackGroups:{}};if(ur(b)){var E=S.stackGroups[b]||{numericAxisId:n,cateAxisId:a,items:[]};E.items.push(p),S.hasStack=!0,S.stackGroups[b]=E}else S.stackGroups[_l("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[p]};return Ht(Ht({},d),{},Ou({},x,S))},u),f={};return Object.keys(l).reduce(function(d,p){var v=l[p];if(v.hasStack){var g={};v.stackGroups=Object.keys(v.stackGroups).reduce(function(b,y){var x=v.stackGroups[y];return Ht(Ht({},b),{},Ou({},y,{numericAxisId:n,cateAxisId:a,items:x.items,stackedData:AJ(e,x.items,i)}))},g)}return Ht(Ht({},d),{},Ou({},p,v))},f)},TJ=function(e,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,s=r.allowDecimals,u=n||r.scale;if(u!=="auto"&&u!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var l=e.domain();if(!l.length)return null;var f=$Y(l,i,s);return e.domain([im(f),Zi(f)]),{niceTicks:f}}if(i&&a==="number"){var d=e.domain(),p=UY(d,i,s);return{niceTicks:p}}return null};function Lp(t){var e=t.axis,r=t.ticks,n=t.bandSize,a=t.entry,i=t.index,o=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!nt(a[e.dataKey])){var s=cp(r,"value",a[e.dataKey]);if(s)return s.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var u=en(a,nt(o)?e.dataKey:o);return nt(u)?null:e.scale(u)}var HR=function(e){var r=e.axis,n=e.ticks,a=e.offset,i=e.bandSize,o=e.entry,s=e.index;if(r.type==="category")return n[s]?n[s].coordinate+a:null;var u=en(o,r.dataKey,r.domain[s]);return nt(u)?null:r.scale(u)-i/2+a},PJ=function(e){var r=e.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},NJ=function(e,r){var n,a=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Ht(Ht({},e.type.defaultProps),e.props):e.props,i=a.stackId;if(ur(i)){var o=r[i];if(o){var s=o.items.indexOf(e);return s>=0?o.stackedData[s]:null}}return null},RJ=function(e){return e.reduce(function(r,n){return[im(n.concat([r[0]]).filter(be)),Zi(n.concat([r[1]]).filter(be))]},[1/0,-1/0])},D3=function(e,r,n){return Object.keys(e).reduce(function(a,i){var o=e[i],s=o.stackedData,u=s.reduce(function(l,f){var d=RJ(f.slice(r,n+1));return[Math.min(l[0],d[0]),Math.max(l[1],d[1])]},[1/0,-1/0]);return[Math.min(u[0],a[0]),Math.max(u[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},GR=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,KR=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,i_=function(e,r,n){if(et(e))return e(r,n);if(!Array.isArray(e))return r;var a=[];if(be(e[0]))a[0]=n?e[0]:Math.min(e[0],r[0]);else if(GR.test(e[0])){var i=+GR.exec(e[0])[1];a[0]=r[0]-i}else et(e[0])?a[0]=e[0](r[0]):a[0]=r[0];if(be(e[1]))a[1]=n?e[1]:Math.max(e[1],r[1]);else if(KR.test(e[1])){var o=+KR.exec(e[1])[1];a[1]=r[1]+o}else et(e[1])?a[1]=e[1](r[1]):a[1]=r[1];return a},Bp=function(e,r,n){if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!n||a>0)return a}if(e&&r&&r.length>=2){for(var i=$2(r,function(d){return d.coordinate}),o=1/0,s=1,u=i.length;s<u;s++){var l=i[s],f=i[s-1];o=Math.min((l.coordinate||0)-(f.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},XR=function(e,r,n){return!e||!e.length||Yu(e,qn(n,"type.defaultProps.domain"))?r:e},M3=function(e,r){var n=e.type.defaultProps?Ht(Ht({},e.type.defaultProps),e.props):e.props,a=n.dataKey,i=n.name,o=n.unit,s=n.formatter,u=n.tooltipType,l=n.chartType,f=n.hide;return Ht(Ht({},rt(e,!1)),{},{dataKey:a,unit:o,formatter:s,name:i||a,color:dS(e),value:en(r,a),type:u,payload:r,chartType:l,hide:f})};function wf(t){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wf(t)}function YR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function JR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YR(Object(r),!0).forEach(function(n){IJ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function IJ(t,e,r){return e=jJ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jJ(t){var e=DJ(t,"string");return wf(e)=="symbol"?e:e+""}function DJ(t,e){if(wf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $p=Math.PI/180,MJ=function(e){return e*180/Math.PI},jr=function(e,r,n,a){return{x:e+Math.cos(-$p*a)*n,y:r+Math.sin(-$p*a)*n}},FJ=function(e,r){var n=e.x,a=e.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},LJ=function(e,r){var n=e.x,a=e.y,i=r.cx,o=r.cy,s=FJ({x:n,y:a},{x:i,y:o});if(s<=0)return{radius:s};var u=(n-i)/s,l=Math.acos(u);return a>o&&(l=2*Math.PI-l),{radius:s,angle:MJ(l),angleInRadian:l}},BJ=function(e){var r=e.startAngle,n=e.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},$J=function(e,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),s=Math.min(i,o);return e+s*360},QR=function(e,r){var n=e.x,a=e.y,i=LJ({x:n,y:a},r),o=i.radius,s=i.angle,u=r.innerRadius,l=r.outerRadius;if(o<u||o>l)return!1;if(o===0)return!0;var f=BJ(r),d=f.startAngle,p=f.endAngle,v=s,g;if(d<=p){for(;v>p;)v-=360;for(;v<d;)v+=360;g=v>=d&&v<=p}else{for(;v>d;)v-=360;for(;v<p;)v+=360;g=v>=p&&v<=d}return g?JR(JR({},r),{},{radius:o,angle:$J(v,r)}):null};function _f(t){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_f(t)}var UJ=["offset"];function WJ(t){return HJ(t)||VJ(t)||qJ(t)||zJ()}function zJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qJ(t,e){if(t){if(typeof t=="string")return o_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o_(t,e)}}function VJ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function HJ(t){if(Array.isArray(t))return o_(t)}function o_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function GJ(t,e){if(t==null)return{};var r=KJ(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function KJ(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function ZR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ir(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZR(Object(r),!0).forEach(function(n){XJ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XJ(t,e,r){return e=YJ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YJ(t){var e=JJ(t,"string");return _f(e)=="symbol"?e:e+""}function JJ(t,e){if(_f(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(_f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sf(){return Sf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Sf.apply(this,arguments)}var QJ=function(e){var r=e.value,n=e.formatter,a=nt(e.children)?r:e.children;return et(n)?n(a):a},ZJ=function(e,r){var n=ca(r-e),a=Math.min(Math.abs(r-e),360);return n*a},eQ=function(e,r,n){var a=e.position,i=e.viewBox,o=e.offset,s=e.className,u=i,l=u.cx,f=u.cy,d=u.innerRadius,p=u.outerRadius,v=u.startAngle,g=u.endAngle,b=u.clockWise,y=(d+p)/2,x=ZJ(v,g),S=x>=0?1:-1,E,C;a==="insideStart"?(E=v+S*o,C=b):a==="insideEnd"?(E=g-S*o,C=!b):a==="end"&&(E=g+S*o,C=b),C=x<=0?C:!C;var k=jr(l,f,y,E),A=jr(l,f,y,E+(C?1:-1)*359),T="M".concat(k.x,",").concat(k.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(C?0:1,`,
    `).concat(A.x,",").concat(A.y),N=nt(e.id)?_l("recharts-radial-line-"):e.id;return Z.createElement("text",Sf({},n,{dominantBaseline:"central",className:st("recharts-radial-bar-label",s)}),Z.createElement("defs",null,Z.createElement("path",{id:N,d:T})),Z.createElement("textPath",{xlinkHref:"#".concat(N)},r))},tQ=function(e){var r=e.viewBox,n=e.offset,a=e.position,i=r,o=i.cx,s=i.cy,u=i.innerRadius,l=i.outerRadius,f=i.startAngle,d=i.endAngle,p=(f+d)/2;if(a==="outside"){var v=jr(o,s,l+n,p),g=v.x,b=v.y;return{x:g,y:b,textAnchor:g>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"end"};var y=(u+l)/2,x=jr(o,s,y,p),S=x.x,E=x.y;return{x:S,y:E,textAnchor:"middle",verticalAnchor:"middle"}},rQ=function(e){var r=e.viewBox,n=e.parentViewBox,a=e.offset,i=e.position,o=r,s=o.x,u=o.y,l=o.width,f=o.height,d=f>=0?1:-1,p=d*a,v=d>0?"end":"start",g=d>0?"start":"end",b=l>=0?1:-1,y=b*a,x=b>0?"end":"start",S=b>0?"start":"end";if(i==="top"){var E={x:s+l/2,y:u-d*a,textAnchor:"middle",verticalAnchor:v};return ir(ir({},E),n?{height:Math.max(u-n.y,0),width:l}:{})}if(i==="bottom"){var C={x:s+l/2,y:u+f+p,textAnchor:"middle",verticalAnchor:g};return ir(ir({},C),n?{height:Math.max(n.y+n.height-(u+f),0),width:l}:{})}if(i==="left"){var k={x:s-y,y:u+f/2,textAnchor:x,verticalAnchor:"middle"};return ir(ir({},k),n?{width:Math.max(k.x-n.x,0),height:f}:{})}if(i==="right"){var A={x:s+l+y,y:u+f/2,textAnchor:S,verticalAnchor:"middle"};return ir(ir({},A),n?{width:Math.max(n.x+n.width-A.x,0),height:f}:{})}var T=n?{width:l,height:f}:{};return i==="insideLeft"?ir({x:s+y,y:u+f/2,textAnchor:S,verticalAnchor:"middle"},T):i==="insideRight"?ir({x:s+l-y,y:u+f/2,textAnchor:x,verticalAnchor:"middle"},T):i==="insideTop"?ir({x:s+l/2,y:u+p,textAnchor:"middle",verticalAnchor:g},T):i==="insideBottom"?ir({x:s+l/2,y:u+f-p,textAnchor:"middle",verticalAnchor:v},T):i==="insideTopLeft"?ir({x:s+y,y:u+p,textAnchor:S,verticalAnchor:g},T):i==="insideTopRight"?ir({x:s+l-y,y:u+p,textAnchor:x,verticalAnchor:g},T):i==="insideBottomLeft"?ir({x:s+y,y:u+f-p,textAnchor:S,verticalAnchor:v},T):i==="insideBottomRight"?ir({x:s+l-y,y:u+f-p,textAnchor:x,verticalAnchor:v},T):xl(i)&&(be(i.x)||Yo(i.x))&&(be(i.y)||Yo(i.y))?ir({x:s+us(i.x,l),y:u+us(i.y,f),textAnchor:"end",verticalAnchor:"end"},T):ir({x:s+l/2,y:u+f/2,textAnchor:"middle",verticalAnchor:"middle"},T)},nQ=function(e){return"cx"in e&&be(e.cx)};function zr(t){var e=t.offset,r=e===void 0?5:e,n=GJ(t,UJ),a=ir({offset:r},n),i=a.viewBox,o=a.position,s=a.value,u=a.children,l=a.content,f=a.className,d=f===void 0?"":f,p=a.textBreakAll;if(!i||nt(s)&&nt(u)&&!V.isValidElement(l)&&!et(l))return null;if(V.isValidElement(l))return V.cloneElement(l,a);var v;if(et(l)){if(v=V.createElement(l,a),V.isValidElement(v))return v}else v=QJ(a);var g=nQ(i),b=rt(a,!0);if(g&&(o==="insideStart"||o==="insideEnd"||o==="end"))return eQ(a,v,b);var y=g?tQ(a):rQ(a);return Z.createElement(Sp,Sf({className:st("recharts-label",d)},b,y,{breakAll:p}),v)}zr.displayName="Label";var F3=function(e){var r=e.cx,n=e.cy,a=e.angle,i=e.startAngle,o=e.endAngle,s=e.r,u=e.radius,l=e.innerRadius,f=e.outerRadius,d=e.x,p=e.y,v=e.top,g=e.left,b=e.width,y=e.height,x=e.clockWise,S=e.labelViewBox;if(S)return S;if(be(b)&&be(y)){if(be(d)&&be(p))return{x:d,y:p,width:b,height:y};if(be(v)&&be(g))return{x:v,y:g,width:b,height:y}}return be(d)&&be(p)?{x:d,y:p,width:0,height:0}:be(r)&&be(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:l||0,outerRadius:f||u||s||0,clockWise:x}:e.viewBox?e.viewBox:{}},aQ=function(e,r){return e?e===!0?Z.createElement(zr,{key:"label-implicit",viewBox:r}):ur(e)?Z.createElement(zr,{key:"label-implicit",viewBox:r,value:e}):V.isValidElement(e)?e.type===zr?V.cloneElement(e,{key:"label-implicit",viewBox:r}):Z.createElement(zr,{key:"label-implicit",content:e,viewBox:r}):et(e)?Z.createElement(zr,{key:"label-implicit",content:e,viewBox:r}):xl(e)?Z.createElement(zr,Sf({viewBox:r},e,{key:"label-implicit"})):null:null},iQ=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var a=e.children,i=F3(e),o=Vn(a,zr).map(function(u,l){return V.cloneElement(u,{viewBox:r||i,key:"label-".concat(l)})});if(!n)return o;var s=aQ(e.label,r||i);return[s].concat(WJ(o))};zr.parseViewBox=F3;zr.renderCallByParent=iQ;var aw,eI;function oQ(){if(eI)return aw;eI=1;function t(e){var r=e==null?0:e.length;return r?e[r-1]:void 0}return aw=t,aw}var sQ=oQ();const uQ=yt(sQ);function Ef(t){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ef(t)}var lQ=["valueAccessor"],cQ=["data","dataKey","clockWise","id","textBreakAll"];function fQ(t){return vQ(t)||pQ(t)||hQ(t)||dQ()}function dQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hQ(t,e){if(t){if(typeof t=="string")return s_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s_(t,e)}}function pQ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vQ(t){if(Array.isArray(t))return s_(t)}function s_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Up(){return Up=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Up.apply(this,arguments)}function tI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tI(Object(r),!0).forEach(function(n){mQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mQ(t,e,r){return e=gQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gQ(t){var e=yQ(t,"string");return Ef(e)=="symbol"?e:e+""}function yQ(t,e){if(Ef(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ef(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nI(t,e){if(t==null)return{};var r=bQ(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function bQ(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var xQ=function(e){return Array.isArray(e.value)?uQ(e.value):e.value};function ci(t){var e=t.valueAccessor,r=e===void 0?xQ:e,n=nI(t,lQ),a=n.data,i=n.dataKey,o=n.clockWise,s=n.id,u=n.textBreakAll,l=nI(n,cQ);return!a||!a.length?null:Z.createElement(Et,{className:"recharts-label-list"},a.map(function(f,d){var p=nt(i)?r(f,d):en(f&&f.payload,i),v=nt(s)?{}:{id:"".concat(s,"-").concat(d)};return Z.createElement(zr,Up({},rt(f,!0),l,v,{parentViewBox:f.parentViewBox,value:p,textBreakAll:u,viewBox:zr.parseViewBox(nt(o)?f:rI(rI({},f),{},{clockWise:o})),key:"label-".concat(d),index:d}))}))}ci.displayName="LabelList";function wQ(t,e){return t?t===!0?Z.createElement(ci,{key:"labelList-implicit",data:e}):Z.isValidElement(t)||et(t)?Z.createElement(ci,{key:"labelList-implicit",data:e,content:t}):xl(t)?Z.createElement(ci,Up({data:e},t,{key:"labelList-implicit"})):null:null}function _Q(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var n=t.children,a=Vn(n,ci).map(function(o,s){return V.cloneElement(o,{data:e,key:"labelList-".concat(s)})});if(!r)return a;var i=wQ(t.label,e);return[i].concat(fQ(a))}ci.renderCallByParent=_Q;function Cf(t){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cf(t)}function u_(){return u_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},u_.apply(this,arguments)}function aI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function iI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aI(Object(r),!0).forEach(function(n){SQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SQ(t,e,r){return e=EQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EQ(t){var e=CQ(t,"string");return Cf(e)=="symbol"?e:e+""}function CQ(t,e){if(Cf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kQ=function(e,r){var n=ca(r-e),a=Math.min(Math.abs(r-e),359.999);return n*a},Lh=function(e){var r=e.cx,n=e.cy,a=e.radius,i=e.angle,o=e.sign,s=e.isExternal,u=e.cornerRadius,l=e.cornerIsExternal,f=u*(s?1:-1)+a,d=Math.asin(u/f)/$p,p=l?i:i+o*d,v=jr(r,n,f,p),g=jr(r,n,a,p),b=l?i-o*d:i,y=jr(r,n,f*Math.cos(d*$p),b);return{center:v,circleTangency:g,lineTangency:y,theta:d}},L3=function(e){var r=e.cx,n=e.cy,a=e.innerRadius,i=e.outerRadius,o=e.startAngle,s=e.endAngle,u=kQ(o,s),l=o+u,f=jr(r,n,i,o),d=jr(r,n,i,l),p="M ".concat(f.x,",").concat(f.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(u)>180),",").concat(+(o>l),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(a>0){var v=jr(r,n,a,o),g=jr(r,n,a,l);p+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(u)>180),",").concat(+(o<=l),`,
            `).concat(v.x,",").concat(v.y," Z")}else p+="L ".concat(r,",").concat(n," Z");return p},AQ=function(e){var r=e.cx,n=e.cy,a=e.innerRadius,i=e.outerRadius,o=e.cornerRadius,s=e.forceCornerRadius,u=e.cornerIsExternal,l=e.startAngle,f=e.endAngle,d=ca(f-l),p=Lh({cx:r,cy:n,radius:i,angle:l,sign:d,cornerRadius:o,cornerIsExternal:u}),v=p.circleTangency,g=p.lineTangency,b=p.theta,y=Lh({cx:r,cy:n,radius:i,angle:f,sign:-d,cornerRadius:o,cornerIsExternal:u}),x=y.circleTangency,S=y.lineTangency,E=y.theta,C=u?Math.abs(l-f):Math.abs(l-f)-b-E;if(C<0)return s?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):L3({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:l,endAngle:f});var k="M ".concat(g.x,",").concat(g.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(C>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(S.x,",").concat(S.y,`
  `);if(a>0){var A=Lh({cx:r,cy:n,radius:a,angle:l,sign:d,isExternal:!0,cornerRadius:o,cornerIsExternal:u}),T=A.circleTangency,N=A.lineTangency,R=A.theta,I=Lh({cx:r,cy:n,radius:a,angle:f,sign:-d,isExternal:!0,cornerRadius:o,cornerIsExternal:u}),D=I.circleTangency,j=I.lineTangency,$=I.theta,W=u?Math.abs(l-f):Math.abs(l-f)-R-$;if(W<0&&o===0)return"".concat(k,"L").concat(r,",").concat(n,"Z");k+="L".concat(j.x,",").concat(j.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(W>180),",").concat(+(d>0),",").concat(T.x,",").concat(T.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else k+="L".concat(r,",").concat(n,"Z");return k},OQ={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},B3=function(e){var r=iI(iI({},OQ),e),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,s=r.cornerRadius,u=r.forceCornerRadius,l=r.cornerIsExternal,f=r.startAngle,d=r.endAngle,p=r.className;if(o<i||f===d)return null;var v=st("recharts-sector",p),g=o-i,b=us(s,g,0,!0),y;return b>0&&Math.abs(f-d)<360?y=AQ({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(b,g/2),forceCornerRadius:u,cornerIsExternal:l,startAngle:f,endAngle:d}):y=L3({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:f,endAngle:d}),Z.createElement("path",u_({},rt(r,!0),{className:v,d:y,role:"img"}))};function kf(t){"@babel/helpers - typeof";return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kf(t)}function l_(){return l_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},l_.apply(this,arguments)}function oI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function sI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oI(Object(r),!0).forEach(function(n){TQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function TQ(t,e,r){return e=PQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PQ(t){var e=NQ(t,"string");return kf(e)=="symbol"?e:e+""}function NQ(t,e){if(kf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uI={curveBasisClosed:JV,curveBasisOpen:QV,curveBasis:YV,curveBumpX:MV,curveBumpY:FV,curveLinearClosed:ZV,curveLinear:Kv,curveMonotoneX:eH,curveMonotoneY:tH,curveNatural:rH,curveStep:nH,curveStepAfter:iH,curveStepBefore:aH},Bh=function(e){return e.x===+e.x&&e.y===+e.y},Sc=function(e){return e.x},Ec=function(e){return e.y},RQ=function(e,r){if(et(e))return e;var n="curve".concat(Hv(e));return(n==="curveMonotone"||n==="curveBump")&&r?uI["".concat(n).concat(r==="vertical"?"Y":"X")]:uI[n]||Kv},IQ=function(e){var r=e.type,n=r===void 0?"linear":r,a=e.points,i=a===void 0?[]:a,o=e.baseLine,s=e.layout,u=e.connectNulls,l=u===void 0?!1:u,f=RQ(n,s),d=l?i.filter(function(b){return Bh(b)}):i,p;if(Array.isArray(o)){var v=l?o.filter(function(b){return Bh(b)}):o,g=d.map(function(b,y){return sI(sI({},b),{},{base:v[y]})});return s==="vertical"?p=Ph().y(Ec).x1(Sc).x0(function(b){return b.base.x}):p=Ph().x(Sc).y1(Ec).y0(function(b){return b.base.y}),p.defined(Bh).curve(f),p(g)}return s==="vertical"&&be(o)?p=Ph().y(Ec).x1(Sc).x0(o):be(o)?p=Ph().x(Sc).y1(Ec).y0(o):p=zM().x(Sc).y(Ec),p.defined(Bh).curve(f),p(d)},Tu=function(e){var r=e.className,n=e.points,a=e.path,i=e.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?IQ(e):a;return V.createElement("path",l_({},rt(e,!1),fp(e),{className:st("recharts-curve",r),d:o,ref:i}))},iw={exports:{}},ow,lI;function jQ(){if(lI)return ow;lI=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ow=t,ow}var sw,cI;function DQ(){if(cI)return sw;cI=1;var t=jQ();function e(){}function r(){}return r.resetWarningCache=e,sw=function(){function n(o,s,u,l,f,d){if(d!==t){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}n.isRequired=n;function a(){return n}var i={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:e};return i.PropTypes=i,i},sw}var fI;function MQ(){return fI||(fI=1,iw.exports=DQ()()),iw.exports}var FQ=MQ();const pt=yt(FQ),{getOwnPropertyNames:LQ,getOwnPropertySymbols:BQ}=Object,{hasOwnProperty:$Q}=Object.prototype;function uw(t,e){return function(n,a,i){return t(n,a,i)&&e(n,a,i)}}function $h(t){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,a);const{cache:i}=a,o=i.get(r),s=i.get(n);if(o&&s)return o===n&&s===r;i.set(r,n),i.set(n,r);const u=t(r,n,a);return i.delete(r),i.delete(n),u}}function UQ(t){return t?.[Symbol.toStringTag]}function dI(t){return LQ(t).concat(BQ(t))}const WQ=Object.hasOwn||((t,e)=>$Q.call(t,e));function bs(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const zQ="__v",qQ="__o",VQ="_owner",{getOwnPropertyDescriptor:hI,keys:pI}=Object;function HQ(t,e){return t.byteLength===e.byteLength&&Wp(new Uint8Array(t),new Uint8Array(e))}function GQ(t,e,r){let n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function KQ(t,e){return t.byteLength===e.byteLength&&Wp(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function XQ(t,e){return bs(t.getTime(),e.getTime())}function YQ(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function JQ(t,e){return t===e}function vI(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const a=new Array(n),i=t.entries();let o,s,u=0;for(;(o=i.next())&&!o.done;){const l=e.entries();let f=!1,d=0;for(;(s=l.next())&&!s.done;){if(a[d]){d++;continue}const p=o.value,v=s.value;if(r.equals(p[0],v[0],u,d,t,e,r)&&r.equals(p[1],v[1],p[0],v[0],t,e,r)){f=a[d]=!0;break}d++}if(!f)return!1;u++}return!0}const QQ=bs;function ZQ(t,e,r){const n=pI(t);let a=n.length;if(pI(e).length!==a)return!1;for(;a-- >0;)if(!$3(t,e,r,n[a]))return!1;return!0}function Cc(t,e,r){const n=dI(t);let a=n.length;if(dI(e).length!==a)return!1;let i,o,s;for(;a-- >0;)if(i=n[a],!$3(t,e,r,i)||(o=hI(t,i),s=hI(e,i),(o||s)&&(!o||!s||o.configurable!==s.configurable||o.enumerable!==s.enumerable||o.writable!==s.writable)))return!1;return!0}function eZ(t,e){return bs(t.valueOf(),e.valueOf())}function tZ(t,e){return t.source===e.source&&t.flags===e.flags}function mI(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const a=new Array(n),i=t.values();let o,s;for(;(o=i.next())&&!o.done;){const u=e.values();let l=!1,f=0;for(;(s=u.next())&&!s.done;){if(!a[f]&&r.equals(o.value,s.value,o.value,s.value,t,e,r)){l=a[f]=!0;break}f++}if(!l)return!1}return!0}function Wp(t,e){let r=t.byteLength;if(e.byteLength!==r||t.byteOffset!==e.byteOffset)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function rZ(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function $3(t,e,r,n){return(n===VQ||n===qQ||n===zQ)&&(t.$$typeof||e.$$typeof)?!0:WQ(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}const nZ="[object ArrayBuffer]",aZ="[object Arguments]",iZ="[object Boolean]",oZ="[object DataView]",sZ="[object Date]",uZ="[object Error]",lZ="[object Map]",cZ="[object Number]",fZ="[object Object]",dZ="[object RegExp]",hZ="[object Set]",pZ="[object String]",vZ={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},mZ="[object URL]",gZ=Object.prototype.toString;function yZ({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:a,areFunctionsEqual:i,areMapsEqual:o,areNumbersEqual:s,areObjectsEqual:u,arePrimitiveWrappersEqual:l,areRegExpsEqual:f,areSetsEqual:d,areTypedArraysEqual:p,areUrlsEqual:v,unknownTagComparators:g}){return function(y,x,S){if(y===x)return!0;if(y==null||x==null)return!1;const E=typeof y;if(E!==typeof x)return!1;if(E!=="object")return E==="number"?s(y,x,S):E==="function"?i(y,x,S):!1;const C=y.constructor;if(C!==x.constructor)return!1;if(C===Object)return u(y,x,S);if(Array.isArray(y))return e(y,x,S);if(C===Date)return n(y,x,S);if(C===RegExp)return f(y,x,S);if(C===Map)return o(y,x,S);if(C===Set)return d(y,x,S);const k=gZ.call(y);if(k===sZ)return n(y,x,S);if(k===dZ)return f(y,x,S);if(k===lZ)return o(y,x,S);if(k===hZ)return d(y,x,S);if(k===fZ)return typeof y.then!="function"&&typeof x.then!="function"&&u(y,x,S);if(k===mZ)return v(y,x,S);if(k===uZ)return a(y,x,S);if(k===aZ)return u(y,x,S);if(vZ[k])return p(y,x,S);if(k===nZ)return t(y,x,S);if(k===oZ)return r(y,x,S);if(k===iZ||k===cZ||k===pZ)return l(y,x,S);if(g){let A=g[k];if(!A){const T=UQ(y);T&&(A=g[T])}if(A)return A(y,x,S)}return!1}}function bZ({circular:t,createCustomConfig:e,strict:r}){let n={areArrayBuffersEqual:HQ,areArraysEqual:r?Cc:GQ,areDataViewsEqual:KQ,areDatesEqual:XQ,areErrorsEqual:YQ,areFunctionsEqual:JQ,areMapsEqual:r?uw(vI,Cc):vI,areNumbersEqual:QQ,areObjectsEqual:r?Cc:ZQ,arePrimitiveWrappersEqual:eZ,areRegExpsEqual:tZ,areSetsEqual:r?uw(mI,Cc):mI,areTypedArraysEqual:r?uw(Wp,Cc):Wp,areUrlsEqual:rZ,unknownTagComparators:void 0};if(e&&(n=Object.assign({},n,e(n))),t){const a=$h(n.areArraysEqual),i=$h(n.areMapsEqual),o=$h(n.areObjectsEqual),s=$h(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:o,areSetsEqual:s})}return n}function xZ(t){return function(e,r,n,a,i,o,s){return t(e,r,s)}}function wZ({circular:t,comparator:e,createState:r,equals:n,strict:a}){if(r)return function(s,u){const{cache:l=t?new WeakMap:void 0,meta:f}=r();return e(s,u,{cache:l,equals:n,meta:f,strict:a})};if(t)return function(s,u){return e(s,u,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};const i={cache:void 0,equals:n,meta:void 0,strict:a};return function(s,u){return e(s,u,i)}}const _Z=go();go({strict:!0});go({circular:!0});go({circular:!0,strict:!0});go({createInternalComparator:()=>bs});go({strict:!0,createInternalComparator:()=>bs});go({circular:!0,createInternalComparator:()=>bs});go({circular:!0,createInternalComparator:()=>bs,strict:!0});function go(t={}){const{circular:e=!1,createInternalComparator:r,createState:n,strict:a=!1}=t,i=bZ(t),o=yZ(i),s=r?r(o):xZ(o);return wZ({circular:e,comparator:o,createState:n,equals:s,strict:a})}function SZ(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function gI(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>e?(t(i),r=-1):SZ(a)};requestAnimationFrame(n)}function c_(t){"@babel/helpers - typeof";return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c_(t)}function EZ(t){return OZ(t)||AZ(t)||kZ(t)||CZ()}function CZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kZ(t,e){if(t){if(typeof t=="string")return yI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yI(t,e)}}function yI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function AZ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function OZ(t){if(Array.isArray(t))return t}function TZ(){var t={},e=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,s=EZ(o),u=s[0],l=s.slice(1);if(typeof u=="number"){gI(a.bind(null,l),u);return}a(u),gI(a.bind(null,l));return}c_(i)==="object"&&(t=i,e(t)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return e=i,function(){e=function(){return null}}}}}function Af(t){"@babel/helpers - typeof";return Af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Af(t)}function bI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function xI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bI(Object(r),!0).forEach(function(n){U3(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function U3(t,e,r){return e=PZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PZ(t){var e=NZ(t,"string");return Af(e)==="symbol"?e:String(e)}function NZ(t,e){if(Af(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var RZ=function(e,r){return[Object.keys(e),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},IZ=function(e){return e},jZ=function(e){return e.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},zc=function(e,r){return Object.keys(r).reduce(function(n,a){return xI(xI({},n),{},U3({},a,e(a,r[a])))},{})},wI=function(e,r,n){return e.map(function(a){return"".concat(jZ(a)," ").concat(r,"ms ").concat(n)}).join(",")};function DZ(t,e){return LZ(t)||FZ(t,e)||W3(t,e)||MZ()}function MZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FZ(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function LZ(t){if(Array.isArray(t))return t}function BZ(t){return WZ(t)||UZ(t)||W3(t)||$Z()}function $Z(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W3(t,e){if(t){if(typeof t=="string")return f_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f_(t,e)}}function UZ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function WZ(t){if(Array.isArray(t))return f_(t)}function f_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var zp=1e-4,z3=function(e,r){return[0,3*e,3*r-6*e,3*e-3*r+1]},q3=function(e,r){return e.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},_I=function(e,r){return function(n){var a=z3(e,r);return q3(a,n)}},zZ=function(e,r){return function(n){var a=z3(e,r),i=[].concat(BZ(a.map(function(o,s){return o*s}).slice(1)),[0]);return q3(i,n)}},SI=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],s=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,s=1;break;case"ease":a=.25,i=.1,o=.25,s=1;break;case"ease-in":a=.42,i=0,o=1,s=1;break;case"ease-out":a=.42,i=0,o=.58,s=1;break;case"ease-in-out":a=0,i=0,o=.58,s=1;break;default:{var u=r[0].split("(");if(u[0]==="cubic-bezier"&&u[1].split(")")[0].split(",").length===4){var l=u[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),f=DZ(l,4);a=f[0],i=f[1],o=f[2],s=f[3]}}}var d=_I(a,o),p=_I(i,s),v=zZ(a,o),g=function(x){return x>1?1:x<0?0:x},b=function(x){for(var S=x>1?1:x,E=S,C=0;C<8;++C){var k=d(E)-S,A=v(E);if(Math.abs(k-S)<zp||A<zp)return p(E);E=g(E-k/A)}return p(E)};return b.isStepper=!1,b},qZ=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.stiff,n=r===void 0?100:r,a=e.damping,i=a===void 0?8:a,o=e.dt,s=o===void 0?17:o,u=function(f,d,p){var v=-(f-d)*n,g=p*i,b=p+(v-g)*s/1e3,y=p*s/1e3+f;return Math.abs(y-d)<zp&&Math.abs(b)<zp?[d,0]:[y,b]};return u.isStepper=!0,u.dt=s,u},VZ=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return SI(a);case"spring":return qZ();default:if(a.split("(")[0]==="cubic-bezier")return SI(a)}return typeof a=="function"?a:null};function Of(t){"@babel/helpers - typeof";return Of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Of(t)}function EI(t){return KZ(t)||GZ(t)||V3(t)||HZ()}function HZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GZ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function KZ(t){if(Array.isArray(t))return h_(t)}function CI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Tr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CI(Object(r),!0).forEach(function(n){d_(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function d_(t,e,r){return e=XZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XZ(t){var e=YZ(t,"string");return Of(e)==="symbol"?e:String(e)}function YZ(t,e){if(Of(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Of(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JZ(t,e){return eee(t)||ZZ(t,e)||V3(t,e)||QZ()}function QZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V3(t,e){if(t){if(typeof t=="string")return h_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h_(t,e)}}function h_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ZZ(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function eee(t){if(Array.isArray(t))return t}var qp=function(e,r,n){return e+(r-e)*n},p_=function(e){var r=e.from,n=e.to;return r!==n},tee=function t(e,r,n){var a=zc(function(i,o){if(p_(o)){var s=e(o.from,o.to,o.velocity),u=JZ(s,2),l=u[0],f=u[1];return Tr(Tr({},o),{},{from:l,velocity:f})}return o},r);return n<1?zc(function(i,o){return p_(o)?Tr(Tr({},o),{},{velocity:qp(o.velocity,a[i].velocity,n),from:qp(o.from,a[i].from,n)}):o},r):t(e,a,n-1)};const ree=(function(t,e,r,n,a){var i=RZ(t,e),o=i.reduce(function(y,x){return Tr(Tr({},y),{},d_({},x,[t[x],e[x]]))},{}),s=i.reduce(function(y,x){return Tr(Tr({},y),{},d_({},x,{from:t[x],velocity:0,to:e[x]}))},{}),u=-1,l,f,d=function(){return null},p=function(){return zc(function(x,S){return S.from},s)},v=function(){return!Object.values(s).filter(p_).length},g=function(x){l||(l=x);var S=x-l,E=S/r.dt;s=tee(r,s,E),a(Tr(Tr(Tr({},t),e),p())),l=x,v()||(u=requestAnimationFrame(d))},b=function(x){f||(f=x);var S=(x-f)/n,E=zc(function(k,A){return qp.apply(void 0,EI(A).concat([r(S)]))},o);if(a(Tr(Tr(Tr({},t),e),E)),S<1)u=requestAnimationFrame(d);else{var C=zc(function(k,A){return qp.apply(void 0,EI(A).concat([r(1)]))},o);a(Tr(Tr(Tr({},t),e),C))}};return d=r.isStepper?g:b,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(u)}}});function Qu(t){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qu(t)}var nee=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function aee(t,e){if(t==null)return{};var r=iee(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function iee(t,e){if(t==null)return{};var r={},n=Object.keys(t),a,i;for(i=0;i<n.length;i++)a=n[i],!(e.indexOf(a)>=0)&&(r[a]=t[a]);return r}function lw(t){return lee(t)||uee(t)||see(t)||oee()}function oee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function see(t,e){if(t){if(typeof t=="string")return v_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v_(t,e)}}function uee(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lee(t){if(Array.isArray(t))return v_(t)}function v_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ra(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kI(Object(r),!0).forEach(function(n){jc(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jc(t,e,r){return e=H3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H3(n.key),n)}}function dee(t,e,r){return e&&fee(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function H3(t){var e=hee(t,"string");return Qu(e)==="symbol"?e:String(e)}function hee(t,e){if(Qu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pee(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m_(t,e)}function m_(t,e){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},m_(t,e)}function vee(t){var e=mee();return function(){var n=Vp(t),a;if(e){var i=Vp(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return g_(this,a)}}function g_(t,e){if(e&&(Qu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y_(t)}function y_(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vp(t){return Vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vp(t)}var Fa=(function(t){pee(r,t);var e=vee(r);function r(n,a){var i;cee(this,r),i=e.call(this,n,a);var o=i.props,s=o.isActive,u=o.attributeName,l=o.from,f=o.to,d=o.steps,p=o.children,v=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(y_(i)),i.changeStyle=i.changeStyle.bind(y_(i)),!s||v<=0)return i.state={style:{}},typeof p=="function"&&(i.state={style:f}),g_(i);if(d&&d.length)i.state={style:d[0].style};else if(l){if(typeof p=="function")return i.state={style:l},g_(i);i.state={style:u?jc({},u,l):l}}else i.state={style:{}};return i}return dee(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,s=i.canBegin,u=i.attributeName,l=i.shouldReAnimate,f=i.to,d=i.from,p=this.state.style;if(s){if(!o){var v={style:u?jc({},u,f):f};this.state&&p&&(u&&p[u]!==f||!u&&p!==f)&&this.setState(v);return}if(!(_Z(a.to,f)&&a.canBegin&&a.isActive)){var g=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var b=g||l?d:a.to;if(this.state&&p){var y={style:u?jc({},u,b):b};(u&&p[u]!==b||!u&&p!==b)&&this.setState(y)}this.runAnimation(ra(ra({},this.props),{},{from:b,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,s=a.to,u=a.duration,l=a.easing,f=a.begin,d=a.onAnimationEnd,p=a.onAnimationStart,v=ree(o,s,VZ(l),u,this.changeStyle),g=function(){i.stopJSAnimation=v()};this.manager.start([p,f,g,u,d])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,s=a.begin,u=a.onAnimationStart,l=o[0],f=l.style,d=l.duration,p=d===void 0?0:d,v=function(b,y,x){if(x===0)return b;var S=y.duration,E=y.easing,C=E===void 0?"ease":E,k=y.style,A=y.properties,T=y.onAnimationEnd,N=x>0?o[x-1]:y,R=A||Object.keys(k);if(typeof C=="function"||C==="spring")return[].concat(lw(b),[i.runJSAnimation.bind(i,{from:N.style,to:k,duration:S,easing:C}),S]);var I=wI(R,S,C),D=ra(ra(ra({},N.style),k),{},{transition:I});return[].concat(lw(b),[D,S,T]).filter(IZ)};return this.manager.start([u].concat(lw(o.reduce(v,[f,Math.max(p,s)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=TZ());var i=a.begin,o=a.duration,s=a.attributeName,u=a.to,l=a.easing,f=a.onAnimationStart,d=a.onAnimationEnd,p=a.steps,v=a.children,g=this.manager;if(this.unSubscribe=g.subscribe(this.handleStyleChange),typeof l=="function"||typeof v=="function"||l==="spring"){this.runJSAnimation(a);return}if(p.length>1){this.runStepAnimation(a);return}var b=s?jc({},s,u):u,y=wI(Object.keys(b),o,l);g.start([f,i,ra(ra({},b),{},{transition:y}),o,d])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var s=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var u=aee(a,nee),l=V.Children.count(i),f=this.state.style;if(typeof i=="function")return i(f);if(!s||l===0||o<=0)return i;var d=function(v){var g=v.props,b=g.style,y=b===void 0?{}:b,x=g.className,S=V.cloneElement(v,ra(ra({},u),{},{style:ra(ra({},y),f),className:x}));return S};return l===1?d(V.Children.only(i)):Z.createElement("div",null,V.Children.map(i,function(p){return d(p)}))}}]),r})(V.PureComponent);Fa.displayName="Animate";Fa.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Fa.propTypes={from:pt.oneOfType([pt.object,pt.string]),to:pt.oneOfType([pt.object,pt.string]),attributeName:pt.string,duration:pt.number,begin:pt.number,easing:pt.oneOfType([pt.string,pt.func]),steps:pt.arrayOf(pt.shape({duration:pt.number.isRequired,style:pt.object.isRequired,easing:pt.oneOfType([pt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),pt.func]),properties:pt.arrayOf("string"),onAnimationEnd:pt.func})),children:pt.oneOfType([pt.node,pt.func]),isActive:pt.bool,canBegin:pt.bool,onAnimationEnd:pt.func,shouldReAnimate:pt.bool,onAnimationStart:pt.func,onAnimationReStart:pt.func};function Tf(t){"@babel/helpers - typeof";return Tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tf(t)}function Hp(){return Hp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hp.apply(this,arguments)}function gee(t,e){return wee(t)||xee(t,e)||bee(t,e)||yee()}function yee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bee(t,e){if(t){if(typeof t=="string")return AI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AI(t,e)}}function AI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xee(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function wee(t){if(Array.isArray(t))return t}function OI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function TI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OI(Object(r),!0).forEach(function(n){_ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _ee(t,e,r){return e=See(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function See(t){var e=Eee(t,"string");return Tf(e)=="symbol"?e:e+""}function Eee(t,e){if(Tf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Tf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PI=function(e,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),s=a>=0?1:-1,u=n>=0?1:-1,l=a>=0&&n>=0||a<0&&n<0?1:0,f;if(o>0&&i instanceof Array){for(var d=[0,0,0,0],p=0,v=4;p<v;p++)d[p]=i[p]>o?o:i[p];f="M".concat(e,",").concat(r+s*d[0]),d[0]>0&&(f+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(l,",").concat(e+u*d[0],",").concat(r)),f+="L ".concat(e+n-u*d[1],",").concat(r),d[1]>0&&(f+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(l,`,
        `).concat(e+n,",").concat(r+s*d[1])),f+="L ".concat(e+n,",").concat(r+a-s*d[2]),d[2]>0&&(f+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(l,`,
        `).concat(e+n-u*d[2],",").concat(r+a)),f+="L ".concat(e+u*d[3],",").concat(r+a),d[3]>0&&(f+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(l,`,
        `).concat(e,",").concat(r+a-s*d[3])),f+="Z"}else if(o>0&&i===+i&&i>0){var g=Math.min(o,i);f="M ".concat(e,",").concat(r+s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(l,",").concat(e+u*g,",").concat(r,`
            L `).concat(e+n-u*g,",").concat(r,`
            A `).concat(g,",").concat(g,",0,0,").concat(l,",").concat(e+n,",").concat(r+s*g,`
            L `).concat(e+n,",").concat(r+a-s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(l,",").concat(e+n-u*g,",").concat(r+a,`
            L `).concat(e+u*g,",").concat(r+a,`
            A `).concat(g,",").concat(g,",0,0,").concat(l,",").concat(e,",").concat(r+a-s*g," Z")}else f="M ".concat(e,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return f},Cee=function(e,r){if(!e||!r)return!1;var n=e.x,a=e.y,i=r.x,o=r.y,s=r.width,u=r.height;if(Math.abs(s)>0&&Math.abs(u)>0){var l=Math.min(i,i+s),f=Math.max(i,i+s),d=Math.min(o,o+u),p=Math.max(o,o+u);return n>=l&&n<=f&&a>=d&&a<=p}return!1},kee={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hS=function(e){var r=TI(TI({},kee),e),n=V.useRef(),a=V.useState(-1),i=gee(a,2),o=i[0],s=i[1];V.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var C=n.current.getTotalLength();C&&s(C)}catch{}},[]);var u=r.x,l=r.y,f=r.width,d=r.height,p=r.radius,v=r.className,g=r.animationEasing,b=r.animationDuration,y=r.animationBegin,x=r.isAnimationActive,S=r.isUpdateAnimationActive;if(u!==+u||l!==+l||f!==+f||d!==+d||f===0||d===0)return null;var E=st("recharts-rectangle",v);return S?Z.createElement(Fa,{canBegin:o>0,from:{width:f,height:d,x:u,y:l},to:{width:f,height:d,x:u,y:l},duration:b,animationEasing:g,isActive:S},function(C){var k=C.width,A=C.height,T=C.x,N=C.y;return Z.createElement(Fa,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:b,isActive:x,easing:g},Z.createElement("path",Hp({},rt(r,!0),{className:E,d:PI(T,N,k,A,p),ref:n})))}):Z.createElement("path",Hp({},rt(r,!0),{className:E,d:PI(u,l,f,d,p)}))};function b_(){return b_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},b_.apply(this,arguments)}var um=function(e){var r=e.cx,n=e.cy,a=e.r,i=e.className,o=st("recharts-dot",i);return r===+r&&n===+n&&a===+a?V.createElement("circle",b_({},rt(e,!1),fp(e),{className:o,cx:r,cy:n,r:a})):null};function Pf(t){"@babel/helpers - typeof";return Pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pf(t)}var Aee=["x","y","top","left","width","height","className"];function x_(){return x_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},x_.apply(this,arguments)}function NI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Oee(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NI(Object(r),!0).forEach(function(n){Tee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Tee(t,e,r){return e=Pee(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pee(t){var e=Nee(t,"string");return Pf(e)=="symbol"?e:e+""}function Nee(t,e){if(Pf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Pf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ree(t,e){if(t==null)return{};var r=Iee(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Iee(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var jee=function(e,r,n,a,i,o){return"M".concat(e,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},Dee=function(e){var r=e.x,n=r===void 0?0:r,a=e.y,i=a===void 0?0:a,o=e.top,s=o===void 0?0:o,u=e.left,l=u===void 0?0:u,f=e.width,d=f===void 0?0:f,p=e.height,v=p===void 0?0:p,g=e.className,b=Ree(e,Aee),y=Oee({x:n,y:i,top:s,left:l,width:d,height:v},b);return!be(n)||!be(i)||!be(d)||!be(v)||!be(s)||!be(l)?null:Z.createElement("path",x_({},rt(y,!0),{className:st("recharts-cross",g),d:jee(n,i,d,v,s,l)}))},cw,RI;function Mee(){if(RI)return cw;RI=1;var t=d4(),e=t(Object.getPrototypeOf,Object);return cw=e,cw}var fw,II;function Fee(){if(II)return fw;II=1;var t=mi(),e=Mee(),r=gi(),n="[object Object]",a=Function.prototype,i=Object.prototype,o=a.toString,s=i.hasOwnProperty,u=o.call(Object);function l(f){if(!r(f)||t(f)!=n)return!1;var d=e(f);if(d===null)return!0;var p=s.call(d,"constructor")&&d.constructor;return typeof p=="function"&&p instanceof p&&o.call(p)==u}return fw=l,fw}var Lee=Fee();const Bee=yt(Lee);var dw,jI;function $ee(){if(jI)return dw;jI=1;var t=mi(),e=gi(),r="[object Boolean]";function n(a){return a===!0||a===!1||e(a)&&t(a)==r}return dw=n,dw}var Uee=$ee();const Wee=yt(Uee);function Nf(t){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nf(t)}function Gp(){return Gp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gp.apply(this,arguments)}function zee(t,e){return Gee(t)||Hee(t,e)||Vee(t,e)||qee()}function qee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vee(t,e){if(t){if(typeof t=="string")return DI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DI(t,e)}}function DI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Hee(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function Gee(t){if(Array.isArray(t))return t}function MI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function FI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MI(Object(r),!0).forEach(function(n){Kee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Kee(t,e,r){return e=Xee(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xee(t){var e=Yee(t,"string");return Nf(e)=="symbol"?e:e+""}function Yee(t,e){if(Nf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LI=function(e,r,n,a,i){var o=n-a,s;return s="M ".concat(e,",").concat(r),s+="L ".concat(e+n,",").concat(r),s+="L ".concat(e+n-o/2,",").concat(r+i),s+="L ".concat(e+n-o/2-a,",").concat(r+i),s+="L ".concat(e,",").concat(r," Z"),s},Jee={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Qee=function(e){var r=FI(FI({},Jee),e),n=V.useRef(),a=V.useState(-1),i=zee(a,2),o=i[0],s=i[1];V.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var E=n.current.getTotalLength();E&&s(E)}catch{}},[]);var u=r.x,l=r.y,f=r.upperWidth,d=r.lowerWidth,p=r.height,v=r.className,g=r.animationEasing,b=r.animationDuration,y=r.animationBegin,x=r.isUpdateAnimationActive;if(u!==+u||l!==+l||f!==+f||d!==+d||p!==+p||f===0&&d===0||p===0)return null;var S=st("recharts-trapezoid",v);return x?Z.createElement(Fa,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:p,x:u,y:l},to:{upperWidth:f,lowerWidth:d,height:p,x:u,y:l},duration:b,animationEasing:g,isActive:x},function(E){var C=E.upperWidth,k=E.lowerWidth,A=E.height,T=E.x,N=E.y;return Z.createElement(Fa,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:b,easing:g},Z.createElement("path",Gp({},rt(r,!0),{className:S,d:LI(T,N,C,k,A),ref:n})))}):Z.createElement("g",null,Z.createElement("path",Gp({},rt(r,!0),{className:S,d:LI(u,l,f,d,p)})))},Zee=["option","shapeType","propTransformer","activeClassName","isActive"];function Rf(t){"@babel/helpers - typeof";return Rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rf(t)}function ete(t,e){if(t==null)return{};var r=tte(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function tte(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function BI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Kp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BI(Object(r),!0).forEach(function(n){rte(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rte(t,e,r){return e=nte(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nte(t){var e=ate(t,"string");return Rf(e)=="symbol"?e:e+""}function ate(t,e){if(Rf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Rf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ite(t,e){return Kp(Kp({},e),t)}function ote(t,e){return t==="symbols"}function $I(t){var e=t.shapeType,r=t.elementProps;switch(e){case"rectangle":return Z.createElement(hS,r);case"trapezoid":return Z.createElement(Qee,r);case"sector":return Z.createElement(B3,r);case"symbols":if(ote(e))return Z.createElement(R2,r);break;default:return null}}function ste(t){return V.isValidElement(t)?t.props:t}function ute(t){var e=t.option,r=t.shapeType,n=t.propTransformer,a=n===void 0?ite:n,i=t.activeClassName,o=i===void 0?"recharts-active-shape":i,s=t.isActive,u=ete(t,Zee),l;if(V.isValidElement(e))l=V.cloneElement(e,Kp(Kp({},u),ste(e)));else if(et(e))l=e(u);else if(Bee(e)&&!Wee(e)){var f=a(e,u);l=Z.createElement($I,{shapeType:r,elementProps:f})}else{var d=u;l=Z.createElement($I,{shapeType:r,elementProps:d})}return s?Z.createElement(Et,{className:o},l):l}function lm(t,e){return e!=null&&"trapezoids"in t.props}function cm(t,e){return e!=null&&"sectors"in t.props}function If(t,e){return e!=null&&"points"in t.props}function lte(t,e){var r,n,a=t.x===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.x)||t.x===e.x,i=t.y===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.y)||t.y===e.y;return a&&i}function cte(t,e){var r=t.endAngle===e.endAngle,n=t.startAngle===e.startAngle;return r&&n}function fte(t,e){var r=t.x===e.x,n=t.y===e.y,a=t.z===e.z;return r&&n&&a}function dte(t,e){var r;return lm(t,e)?r=lte:cm(t,e)?r=cte:If(t,e)&&(r=fte),r}function hte(t,e){var r;return lm(t,e)?r="trapezoids":cm(t,e)?r="sectors":If(t,e)&&(r="points"),r}function pte(t,e){if(lm(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(cm(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return If(t,e)?e.payload:{}}function vte(t){var e=t.activeTooltipItem,r=t.graphicalItem,n=t.itemData,a=hte(r,e),i=pte(r,e),o=n.filter(function(u,l){var f=Yu(i,u),d=r.props[a].filter(function(g){var b=dte(r,e);return b(g,e)}),p=r.props[a].indexOf(d[d.length-1]),v=l===p;return f&&v}),s=n.indexOf(o[o.length-1]);return s}var hw,UI;function mte(){if(UI)return hw;UI=1;var t=Math.ceil,e=Math.max;function r(n,a,i,o){for(var s=-1,u=e(t((a-n)/(i||1)),0),l=Array(u);u--;)l[o?u:++s]=n,n+=i;return l}return hw=r,hw}var pw,WI;function G3(){if(WI)return pw;WI=1;var t=O4(),e=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=t(a),a===e||a===-e){var i=a<0?-1:1;return i*r}return a===a?a:0}return pw=n,pw}var vw,zI;function gte(){if(zI)return vw;zI=1;var t=mte(),e=Qv(),r=G3();function n(a){return function(i,o,s){return s&&typeof s!="number"&&e(i,o,s)&&(o=s=void 0),i=r(i),o===void 0?(o=i,i=0):o=r(o),s=s===void 0?i<o?1:-1:r(s),t(i,o,s,a)}}return vw=n,vw}var mw,qI;function yte(){if(qI)return mw;qI=1;var t=gte(),e=t();return mw=e,mw}var bte=yte();const Xp=yt(bte);function jf(t){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jf(t)}function VI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function HI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?VI(Object(r),!0).forEach(function(n){K3(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function K3(t,e,r){return e=xte(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xte(t){var e=wte(t,"string");return jf(e)=="symbol"?e:e+""}function wte(t,e){if(jf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _te=["Webkit","Moz","O","ms"],Ste=function(e,r){var n=e.replace(/(\w)/,function(i){return i.toUpperCase()}),a=_te.reduce(function(i,o){return HI(HI({},i),{},K3({},o+n,r))},{});return a[e]=r,a};function Zu(t){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zu(t)}function Yp(){return Yp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Yp.apply(this,arguments)}function GI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function gw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GI(Object(r),!0).forEach(function(n){wn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ete(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Y3(n.key),n)}}function Cte(t,e,r){return e&&KI(t.prototype,e),r&&KI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kte(t,e,r){return e=Jp(e),Ate(t,X3()?Reflect.construct(e,r||[],Jp(t).constructor):e.apply(t,r))}function Ate(t,e){if(e&&(Zu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ote(t)}function Ote(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X3(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(X3=function(){return!!t})()}function Jp(t){return Jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jp(t)}function Tte(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w_(t,e)}function w_(t,e){return w_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},w_(t,e)}function wn(t,e,r){return e=Y3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y3(t){var e=Pte(t,"string");return Zu(e)=="symbol"?e:e+""}function Pte(t,e){if(Zu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Zu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Nte=function(e){var r=e.data,n=e.startIndex,a=e.endIndex,i=e.x,o=e.width,s=e.travellerWidth;if(!r||!r.length)return{};var u=r.length,l=Uc().domain(Xp(0,u)).range([i,i+o-s]),f=l.domain().map(function(d){return l(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:l(n),endX:l(a),scale:l,scaleValues:f}},XI=function(e){return e.changedTouches&&!!e.changedTouches.length},el=(function(t){function e(r){var n;return Ete(this,e),n=kte(this,e,[r]),wn(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),wn(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),wn(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,s=a.startIndex;o?.({endIndex:i,startIndex:s})}),n.detachDragEndListener()}),wn(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),wn(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),wn(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),wn(n,"handleSlideDragStart",function(a){var i=XI(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return Tte(e,t),Cte(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,s=this.props,u=s.gap,l=s.data,f=l.length-1,d=Math.min(a,i),p=Math.max(a,i),v=e.getIndexInRange(o,d),g=e.getIndexInRange(o,p);return{startIndex:v-v%u,endIndex:g===f?f:g-g%u}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,s=a.dataKey,u=en(i[n],s,n);return et(o)?o(u,n):u}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,s=a.endX,u=this.props,l=u.x,f=u.width,d=u.travellerWidth,p=u.startIndex,v=u.endIndex,g=u.onChange,b=n.pageX-i;b>0?b=Math.min(b,l+f-d-s,l+f-d-o):b<0&&(b=Math.max(b,l-o,l-s));var y=this.getIndex({startX:o+b,endX:s+b});(y.startIndex!==p||y.endIndex!==v)&&g&&g(y),this.setState({startX:o+b,endX:s+b,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=XI(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,s=a.endX,u=a.startX,l=this.state[o],f=this.props,d=f.x,p=f.width,v=f.travellerWidth,g=f.onChange,b=f.gap,y=f.data,x={startX:this.state.startX,endX:this.state.endX},S=n.pageX-i;S>0?S=Math.min(S,d+p-v-l):S<0&&(S=Math.max(S,d-l)),x[o]=l+S;var E=this.getIndex(x),C=E.startIndex,k=E.endIndex,A=function(){var N=y.length-1;return o==="startX"&&(s>u?C%b===0:k%b===0)||s<u&&k===N||o==="endX"&&(s>u?k%b===0:C%b===0)||s>u&&k===N};this.setState(wn(wn({},o,l+S),"brushMoveStartX",n.pageX),function(){g&&A()&&g(E)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,s=o.scaleValues,u=o.startX,l=o.endX,f=this.state[a],d=s.indexOf(f);if(d!==-1){var p=d+n;if(!(p===-1||p>=s.length)){var v=s[p];a==="startX"&&v>=l||a==="endX"&&v<=u||this.setState(wn({},a,v),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,u=n.fill,l=n.stroke;return Z.createElement("rect",{stroke:l,fill:u,x:a,y:i,width:o,height:s})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,u=n.data,l=n.children,f=n.padding,d=V.Children.only(l);return d?Z.cloneElement(d,{x:a,y:i,width:o,height:s,margin:f,compact:!0,data:u}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,s=this,u=this.props,l=u.y,f=u.travellerWidth,d=u.height,p=u.traveller,v=u.ariaLabel,g=u.data,b=u.startIndex,y=u.endIndex,x=Math.max(n,this.props.x),S=gw(gw({},rt(this.props,!1)),{},{x,y:l,width:f,height:d}),E=v||"Min value: ".concat((i=g[b])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=g[y])===null||o===void 0?void 0:o.name);return Z.createElement(Et,{tabIndex:0,role:"slider","aria-label":E,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(k){["ArrowLeft","ArrowRight"].includes(k.key)&&(k.preventDefault(),k.stopPropagation(),s.handleTravellerMoveKeyboard(k.key==="ArrowRight"?1:-1,a))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(p,S))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,s=i.height,u=i.stroke,l=i.travellerWidth,f=Math.min(n,a)+l,d=Math.max(Math.abs(a-n)-l,0);return Z.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:u,fillOpacity:.2,x:f,y:o,width:d,height:s})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,s=n.height,u=n.travellerWidth,l=n.stroke,f=this.state,d=f.startX,p=f.endX,v=5,g={pointerEvents:"none",fill:l};return Z.createElement(Et,{className:"recharts-brush-texts"},Z.createElement(Sp,Yp({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,p)-v,y:o+s/2},g),this.getTextOfTick(a)),Z.createElement(Sp,Yp({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,p)+u+v,y:o+s/2},g),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,s=n.x,u=n.y,l=n.width,f=n.height,d=n.alwaysShowText,p=this.state,v=p.startX,g=p.endX,b=p.isTextActive,y=p.isSlideMoving,x=p.isTravellerMoving,S=p.isTravellerFocused;if(!a||!a.length||!be(s)||!be(u)||!be(l)||!be(f)||l<=0||f<=0)return null;var E=st("recharts-brush",i),C=Z.Children.count(o)===1,k=Ste("userSelect","none");return Z.createElement(Et,{className:E,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:k},this.renderBackground(),C&&this.renderPanorama(),this.renderSlide(v,g),this.renderTravellerLayer(v,"startX"),this.renderTravellerLayer(g,"endX"),(b||y||x||S||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,s=n.height,u=n.stroke,l=Math.floor(i+s/2)-1;return Z.createElement(Z.Fragment,null,Z.createElement("rect",{x:a,y:i,width:o,height:s,fill:u,stroke:"none"}),Z.createElement("line",{x1:a+1,y1:l,x2:a+o-1,y2:l,fill:"none",stroke:"#fff"}),Z.createElement("line",{x1:a+1,y1:l+2,x2:a+o-1,y2:l+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return Z.isValidElement(n)?i=Z.cloneElement(n,a):et(n)?i=n(a):i=e.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,s=n.x,u=n.travellerWidth,l=n.updateId,f=n.startIndex,d=n.endIndex;if(i!==a.prevData||l!==a.prevUpdateId)return gw({prevData:i,prevTravellerWidth:u,prevUpdateId:l,prevX:s,prevWidth:o},i&&i.length?Nte({data:i,width:o,x:s,travellerWidth:u,startIndex:f,endIndex:d}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||s!==a.prevX||u!==a.prevTravellerWidth)){a.scale.range([s,s+o-u]);var p=a.scale.domain().map(function(v){return a.scale(v)});return{prevData:i,prevTravellerWidth:u,prevUpdateId:l,prevX:s,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:p}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,s=i-1;s-o>1;){var u=Math.floor((o+s)/2);n[u]>a?s=u:o=u}return a>=n[s]?s:o}}])})(V.PureComponent);wn(el,"displayName","Brush");wn(el,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var yw,YI;function Rte(){if(YI)return yw;YI=1;var t=B2();function e(r,n){var a;return t(r,function(i,o,s){return a=n(i,o,s),!a}),!!a}return yw=e,yw}var bw,JI;function Ite(){if(JI)return bw;JI=1;var t=i4(),e=po(),r=Rte(),n=pn(),a=Qv();function i(o,s,u){var l=n(o)?t:r;return u&&a(o,s,u)&&(s=void 0),l(o,e(s,3))}return bw=i,bw}var jte=Ite();const Dte=yt(jte);var Ra=function(e,r){var n=e.alwaysShow,a=e.ifOverflow;return n&&(a="extendDomain"),a===r},xw,QI;function Mte(){if(QI)return xw;QI=1;var t=S4();function e(r,n,a){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return xw=e,xw}var ww,ZI;function Fte(){if(ZI)return ww;ZI=1;var t=Mte(),e=w4(),r=po();function n(a,i){var o={};return i=r(i,3),e(a,function(s,u,l){t(o,u,i(s,u,l))}),o}return ww=n,ww}var Lte=Fte();const Bte=yt(Lte);var _w,ej;function $te(){if(ej)return _w;ej=1;function t(e,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(!r(e[n],n,e))return!1;return!0}return _w=t,_w}var Sw,tj;function Ute(){if(tj)return Sw;tj=1;var t=B2();function e(r,n){var a=!0;return t(r,function(i,o,s){return a=!!n(i,o,s),a}),a}return Sw=e,Sw}var Ew,rj;function Wte(){if(rj)return Ew;rj=1;var t=$te(),e=Ute(),r=po(),n=pn(),a=Qv();function i(o,s,u){var l=n(o)?t:e;return u&&a(o,s,u)&&(s=void 0),l(o,r(s,3))}return Ew=i,Ew}var zte=Wte();const J3=yt(zte);var qte=["x","y"];function Df(t){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Df(t)}function __(){return __=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},__.apply(this,arguments)}function nj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function kc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nj(Object(r),!0).forEach(function(n){Vte(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Vte(t,e,r){return e=Hte(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hte(t){var e=Gte(t,"string");return Df(e)=="symbol"?e:e+""}function Gte(t,e){if(Df(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Df(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kte(t,e){if(t==null)return{};var r=Xte(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Xte(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Yte(t,e){var r=t.x,n=t.y,a=Kte(t,qte),i="".concat(r),o=parseInt(i,10),s="".concat(n),u=parseInt(s,10),l="".concat(e.height||a.height),f=parseInt(l,10),d="".concat(e.width||a.width),p=parseInt(d,10);return kc(kc(kc(kc(kc({},e),a),o?{x:o}:{}),u?{y:u}:{}),{},{height:f,width:p,name:e.name,radius:e.radius})}function aj(t){return Z.createElement(ute,__({shapeType:"rectangle",propTransformer:Yte,activeClassName:"recharts-active-bar"},t))}var Jte=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof e=="number")return e;var i=be(n)||aV(n);return i?e(n,a):(i||cs(),r)}},Qte=["value","background"],Q3;function tl(t){"@babel/helpers - typeof";return tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tl(t)}function Zte(t,e){if(t==null)return{};var r=ere(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ere(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Qp(){return Qp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qp.apply(this,arguments)}function ij(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Qt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ij(Object(r),!0).forEach(function(n){eo(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ij(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tre(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eF(n.key),n)}}function rre(t,e,r){return e&&oj(t.prototype,e),r&&oj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nre(t,e,r){return e=Zp(e),are(t,Z3()?Reflect.construct(e,r||[],Zp(t).constructor):e.apply(t,r))}function are(t,e){if(e&&(tl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ire(t)}function ire(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Z3(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Z3=function(){return!!t})()}function Zp(t){return Zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zp(t)}function ore(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S_(t,e)}function S_(t,e){return S_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},S_(t,e)}function eo(t,e,r){return e=eF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eF(t){var e=sre(t,"string");return tl(e)=="symbol"?e:e+""}function sre(t,e){if(tl(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(tl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var rd=(function(t){function e(){var r;tre(this,e);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=nre(this,e,[].concat(a)),eo(r,"state",{isAnimationFinished:!1}),eo(r,"id",_l("recharts-bar-")),eo(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),eo(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return ore(e,t),rre(e,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,s=i.dataKey,u=i.activeIndex,l=i.activeBar,f=rt(this.props,!1);return n&&n.map(function(d,p){var v=p===u,g=v?l:o,b=Qt(Qt(Qt({},f),d),{},{isActive:v,option:g,index:p,dataKey:s,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Z.createElement(Et,Qp({className:"recharts-bar-rectangle"},dp(a.props,d,p),{key:"rectangle-".concat(d?.x,"-").concat(d?.y,"-").concat(d?.value,"-").concat(p)}),Z.createElement(aj,b))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,s=a.isAnimationActive,u=a.animationBegin,l=a.animationDuration,f=a.animationEasing,d=a.animationId,p=this.state.prevData;return Z.createElement(Fa,{begin:u,duration:l,isActive:s,easing:f,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(v){var g=v.t,b=i.map(function(y,x){var S=p&&p[x];if(S){var E=Ir(S.x,y.x),C=Ir(S.y,y.y),k=Ir(S.width,y.width),A=Ir(S.height,y.height);return Qt(Qt({},y),{},{x:E(g),y:C(g),width:k(g),height:A(g)})}if(o==="horizontal"){var T=Ir(0,y.height),N=T(g);return Qt(Qt({},y),{},{y:y.y+y.height-N,height:N})}var R=Ir(0,y.width),I=R(g);return Qt(Qt({},y),{},{width:I})});return Z.createElement(Et,null,n.renderRectanglesStatically(b))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!Yu(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,s=a.activeIndex,u=rt(this.props.background,!1);return i.map(function(l,f){l.value;var d=l.background,p=Zte(l,Qte);if(!d)return null;var v=Qt(Qt(Qt(Qt(Qt({},p),{},{fill:"#eee"},d),u),dp(n.props,l,f)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:f,className:"recharts-bar-background-rectangle"});return Z.createElement(aj,Qp({key:"background-bar-".concat(f),option:n.props.background,isActive:f===s},v))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,s=i.xAxis,u=i.yAxis,l=i.layout,f=i.children,d=Vn(f,td);if(!d)return null;var p=l==="vertical"?o[0].height/2:o[0].width/2,v=function(y,x){var S=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:S,errorVal:en(y,x)}},g={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Z.createElement(Et,g,d.map(function(b){return Z.cloneElement(b,{key:"error-bar-".concat(a,"-").concat(b.props.dataKey),data:o,xAxis:s,yAxis:u,layout:l,offset:p,dataPointFormatter:v})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,s=n.xAxis,u=n.yAxis,l=n.left,f=n.top,d=n.width,p=n.height,v=n.isAnimationActive,g=n.background,b=n.id;if(a||!i||!i.length)return null;var y=this.state.isAnimationFinished,x=st("recharts-bar",o),S=s&&s.allowDataOverflow,E=u&&u.allowDataOverflow,C=S||E,k=nt(b)?this.id:b;return Z.createElement(Et,{className:x},S||E?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(k)},Z.createElement("rect",{x:S?l:l-d/2,y:E?f:f-p/2,width:S?d:d*2,height:E?p:p*2}))):null,Z.createElement(Et,{className:"recharts-bar-rectangles",clipPath:C?"url(#clipPath-".concat(k,")"):null},g?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(C,k),(!v||y)&&ci.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])})(V.PureComponent);Q3=rd;eo(rd,"displayName","Bar");eo(rd,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!ms.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});eo(rd,"getComposedData",function(t){var e=t.props,r=t.item,n=t.barPosition,a=t.bandSize,i=t.xAxis,o=t.yAxis,s=t.xAxisTicks,u=t.yAxisTicks,l=t.stackedData,f=t.dataStartIndex,d=t.displayedData,p=t.offset,v=_J(n,r);if(!v)return null;var g=e.layout,b=r.type.defaultProps,y=b!==void 0?Qt(Qt({},b),r.props):r.props,x=y.dataKey,S=y.children,E=y.minPointSize,C=g==="horizontal"?o:i,k=l?C.scale.domain():null,A=PJ({numericAxis:C}),T=Vn(S,N4),N=d.map(function(R,I){var D,j,$,W,q,X;l?D=SJ(l[f+I],k):(D=en(R,x),Array.isArray(D)||(D=[A,D]));var Y=Jte(E,Q3.defaultProps.minPointSize)(D[1],I);if(g==="horizontal"){var z,B=[o.scale(D[0]),o.scale(D[1])],G=B[0],L=B[1];j=HR({axis:i,ticks:s,bandSize:a,offset:v.offset,entry:R,index:I}),$=(z=L??G)!==null&&z!==void 0?z:void 0,W=v.size;var K=G-L;if(q=Number.isNaN(K)?0:K,X={x:j,y:o.y,width:W,height:o.height},Math.abs(Y)>0&&Math.abs(q)<Math.abs(Y)){var oe=ca(q||Y)*(Math.abs(Y)-Math.abs(q));$-=oe,q+=oe}}else{var he=[i.scale(D[0]),i.scale(D[1])],ge=he[0],xe=he[1];if(j=ge,$=HR({axis:o,ticks:u,bandSize:a,offset:v.offset,entry:R,index:I}),W=xe-ge,q=v.size,X={x:i.x,y:$,width:i.width,height:q},Math.abs(Y)>0&&Math.abs(W)<Math.abs(Y)){var ke=ca(W||Y)*(Math.abs(Y)-Math.abs(W));W+=ke}}return Qt(Qt(Qt({},R),{},{x:j,y:$,width:W,height:q,value:l?D:D[1],payload:R,background:X},T&&T[I]&&T[I].props),{},{tooltipPayload:[M3(r,R)],tooltipPosition:{x:j+W/2,y:$+q/2}})});return Qt({data:N,layout:g},p)});function Mf(t){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mf(t)}function ure(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tF(n.key),n)}}function lre(t,e,r){return e&&sj(t.prototype,e),r&&sj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function oa(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uj(Object(r),!0).forEach(function(n){fm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fm(t,e,r){return e=tF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tF(t){var e=cre(t,"string");return Mf(e)=="symbol"?e:e+""}function cre(t,e){if(Mf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rF=function(e,r,n,a,i){var o=e.width,s=e.height,u=e.layout,l=e.children,f=Object.keys(r),d={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:s-n.bottom,bottomMirror:s-n.bottom},p=!!_n(l,rd);return f.reduce(function(v,g){var b=r[g],y=b.orientation,x=b.domain,S=b.padding,E=S===void 0?{}:S,C=b.mirror,k=b.reversed,A="".concat(y).concat(C?"Mirror":""),T,N,R,I,D;if(b.type==="number"&&(b.padding==="gap"||b.padding==="no-gap")){var j=x[1]-x[0],$=1/0,W=b.categoricalDomain.sort(sV);if(W.forEach(function(he,ge){ge>0&&($=Math.min((he||0)-(W[ge-1]||0),$))}),Number.isFinite($)){var q=$/j,X=b.layout==="vertical"?n.height:n.width;if(b.padding==="gap"&&(T=q*X/2),b.padding==="no-gap"){var Y=us(e.barCategoryGap,q*X),z=q*X/2;T=z-Y-(z-Y)/X*Y}}}a==="xAxis"?N=[n.left+(E.left||0)+(T||0),n.left+n.width-(E.right||0)-(T||0)]:a==="yAxis"?N=u==="horizontal"?[n.top+n.height-(E.bottom||0),n.top+(E.top||0)]:[n.top+(E.top||0)+(T||0),n.top+n.height-(E.bottom||0)-(T||0)]:N=b.range,k&&(N=[N[1],N[0]]);var B=xJ(b,i,p),G=B.scale,L=B.realScaleType;G.domain(x).range(N),wJ(G);var K=TJ(G,oa(oa({},b),{},{realScaleType:L}));a==="xAxis"?(D=y==="top"&&!C||y==="bottom"&&C,R=n.left,I=d[A]-D*b.height):a==="yAxis"&&(D=y==="left"&&!C||y==="right"&&C,R=d[A]-D*b.width,I=n.top);var oe=oa(oa(oa({},b),K),{},{realScaleType:L,x:R,y:I,scale:G,width:a==="xAxis"?n.width:b.width,height:a==="yAxis"?n.height:b.height});return oe.bandSize=Bp(oe,K),!b.hide&&a==="xAxis"?d[A]+=(D?-1:1)*oe.height:b.hide||(d[A]+=(D?-1:1)*oe.width),oa(oa({},v),{},fm({},g,oe))},{})},nF=function(e,r){var n=e.x,a=e.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},fre=function(e){var r=e.x1,n=e.y1,a=e.x2,i=e.y2;return nF({x:r,y:n},{x:a,y:i})},aF=(function(){function t(e){ure(this,t),this.scale=e}return lre(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(a){var u=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+u}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new t(r)}}])})();fm(aF,"EPS",1e-4);var pS=function(e){var r=Object.keys(e).reduce(function(n,a){return oa(oa({},n),{},fm({},a,aF.create(e[a])))},{});return oa(oa({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,s=i.position;return Bte(a,function(u,l){return r[l].apply(u,{bandAware:o,position:s})})},isInRange:function(a){return J3(a,function(i,o){return r[o].isInRange(i)})}})};function dre(t){return(t%180+180)%180}var hre=function(e){var r=e.width,n=e.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=dre(a),o=i*Math.PI/180,s=Math.atan(n/r),u=o>s&&o<Math.PI-s?n/Math.sin(o):r/Math.cos(o);return Math.abs(u)},Cw,lj;function pre(){if(lj)return Cw;lj=1;var t=po(),e=Yf(),r=Yv();function n(a){return function(i,o,s){var u=Object(i);if(!e(i)){var l=t(o,3);i=r(i),o=function(d){return l(u[d],d,u)}}var f=a(i,o,s);return f>-1?u[l?i[f]:f]:void 0}}return Cw=n,Cw}var kw,cj;function vre(){if(cj)return kw;cj=1;var t=G3();function e(r){var n=t(r),a=n%1;return n===n?a?n-a:n:0}return kw=e,kw}var Aw,fj;function mre(){if(fj)return Aw;fj=1;var t=m4(),e=po(),r=vre(),n=Math.max;function a(i,o,s){var u=i==null?0:i.length;if(!u)return-1;var l=s==null?0:r(s);return l<0&&(l=n(u+l,0)),t(i,e(o,3),l)}return Aw=a,Aw}var Ow,dj;function gre(){if(dj)return Ow;dj=1;var t=pre(),e=mre(),r=t(e);return Ow=r,Ow}var yre=gre();const bre=yt(yre);var xre=NM();const wre=yt(xre);var _re=wre(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),vS=V.createContext(void 0),mS=V.createContext(void 0),iF=V.createContext(void 0),oF=V.createContext({}),sF=V.createContext(void 0),uF=V.createContext(0),lF=V.createContext(0),hj=function(e){var r=e.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=e.clipPathId,s=e.children,u=e.width,l=e.height,f=_re(i);return Z.createElement(vS.Provider,{value:n},Z.createElement(mS.Provider,{value:a},Z.createElement(oF.Provider,{value:i},Z.createElement(iF.Provider,{value:f},Z.createElement(sF.Provider,{value:o},Z.createElement(uF.Provider,{value:l},Z.createElement(lF.Provider,{value:u},s)))))))},Sre=function(){return V.useContext(sF)},cF=function(e){var r=V.useContext(vS);r==null&&cs();var n=r[e];return n==null&&cs(),n},Ere=function(){var e=V.useContext(vS);return Yi(e)},Cre=function(){var e=V.useContext(mS),r=bre(e,function(n){return J3(n.domain,Number.isFinite)});return r||Yi(e)},fF=function(e){var r=V.useContext(mS);r==null&&cs();var n=r[e];return n==null&&cs(),n},kre=function(){var e=V.useContext(iF);return e},Are=function(){return V.useContext(oF)},gS=function(){return V.useContext(lF)},yS=function(){return V.useContext(uF)};function rl(t){"@babel/helpers - typeof";return rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rl(t)}function Ore(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tre(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hF(n.key),n)}}function Pre(t,e,r){return e&&Tre(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nre(t,e,r){return e=ev(e),Rre(t,dF()?Reflect.construct(e,r||[],ev(t).constructor):e.apply(t,r))}function Rre(t,e){if(e&&(rl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ire(t)}function Ire(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dF=function(){return!!t})()}function ev(t){return ev=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ev(t)}function jre(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E_(t,e)}function E_(t,e){return E_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},E_(t,e)}function pj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function vj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pj(Object(r),!0).forEach(function(n){bS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bS(t,e,r){return e=hF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hF(t){var e=Dre(t,"string");return rl(e)=="symbol"?e:e+""}function Dre(t,e){if(rl(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(rl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Mre(t,e){return $re(t)||Bre(t,e)||Lre(t,e)||Fre()}function Fre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lre(t,e){if(t){if(typeof t=="string")return mj(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mj(t,e)}}function mj(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bre(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function $re(t){if(Array.isArray(t))return t}function C_(){return C_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},C_.apply(this,arguments)}var Ure=function(e,r){var n;return Z.isValidElement(e)?n=Z.cloneElement(e,r):et(e)?n=e(r):n=Z.createElement("line",C_({},r,{className:"recharts-reference-line-line"})),n},Wre=function(e,r,n,a,i,o,s,u,l){var f=i.x,d=i.y,p=i.width,v=i.height;if(n){var g=l.y,b=e.y.apply(g,{position:o});if(Ra(l,"discard")&&!e.y.isInRange(b))return null;var y=[{x:f+p,y:b},{x:f,y:b}];return u==="left"?y.reverse():y}if(r){var x=l.x,S=e.x.apply(x,{position:o});if(Ra(l,"discard")&&!e.x.isInRange(S))return null;var E=[{x:S,y:d+v},{x:S,y:d}];return s==="top"?E.reverse():E}if(a){var C=l.segment,k=C.map(function(A){return e.apply(A,{position:o})});return Ra(l,"discard")&&Dte(k,function(A){return!e.isInRange(A)})?null:k}return null};function zre(t){var e=t.x,r=t.y,n=t.segment,a=t.xAxisId,i=t.yAxisId,o=t.shape,s=t.className,u=t.alwaysShow,l=Sre(),f=cF(a),d=fF(i),p=kre();if(!l||!p)return null;ui(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var v=pS({x:f.scale,y:d.scale}),g=ur(e),b=ur(r),y=n&&n.length===2,x=Wre(v,g,b,y,p,t.position,f.orientation,d.orientation,t);if(!x)return null;var S=Mre(x,2),E=S[0],C=E.x,k=E.y,A=S[1],T=A.x,N=A.y,R=Ra(t,"hidden")?"url(#".concat(l,")"):void 0,I=vj(vj({clipPath:R},rt(t,!0)),{},{x1:C,y1:k,x2:T,y2:N});return Z.createElement(Et,{className:st("recharts-reference-line",s)},Ure(o,I),zr.renderCallByParent(t,fre({x1:C,y1:k,x2:T,y2:N})))}var xS=(function(t){function e(){return Ore(this,e),Nre(this,e,arguments)}return jre(e,t),Pre(e,[{key:"render",value:function(){return Z.createElement(zre,this.props)}}])})(Z.Component);bS(xS,"displayName","ReferenceLine");bS(xS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function k_(){return k_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},k_.apply(this,arguments)}function nl(t){"@babel/helpers - typeof";return nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nl(t)}function gj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function yj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gj(Object(r),!0).forEach(function(n){dm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qre(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vre(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vF(n.key),n)}}function Hre(t,e,r){return e&&Vre(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gre(t,e,r){return e=tv(e),Kre(t,pF()?Reflect.construct(e,r||[],tv(t).constructor):e.apply(t,r))}function Kre(t,e){if(e&&(nl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xre(t)}function Xre(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pF=function(){return!!t})()}function tv(t){return tv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tv(t)}function Yre(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A_(t,e)}function A_(t,e){return A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},A_(t,e)}function dm(t,e,r){return e=vF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vF(t){var e=Jre(t,"string");return nl(e)=="symbol"?e:e+""}function Jre(t,e){if(nl(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(nl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Qre=function(e){var r=e.x,n=e.y,a=e.xAxis,i=e.yAxis,o=pS({x:a.scale,y:i.scale}),s=o.apply({x:r,y:n},{bandAware:!0});return Ra(e,"discard")&&!o.isInRange(s)?null:s},hm=(function(t){function e(){return qre(this,e),Gre(this,e,arguments)}return Yre(e,t),Hre(e,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,s=n.alwaysShow,u=n.clipPathId,l=ur(a),f=ur(i);if(ui(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!l||!f)return null;var d=Qre(this.props);if(!d)return null;var p=d.x,v=d.y,g=this.props,b=g.shape,y=g.className,x=Ra(this.props,"hidden")?"url(#".concat(u,")"):void 0,S=yj(yj({clipPath:x},rt(this.props,!0)),{},{cx:p,cy:v});return Z.createElement(Et,{className:st("recharts-reference-dot",y)},e.renderDot(b,S),zr.renderCallByParent(this.props,{x:p-o,y:v-o,width:2*o,height:2*o}))}}])})(Z.Component);dm(hm,"displayName","ReferenceDot");dm(hm,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});dm(hm,"renderDot",function(t,e){var r;return Z.isValidElement(t)?r=Z.cloneElement(t,e):et(t)?r=t(e):r=Z.createElement(um,k_({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),r});function O_(){return O_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},O_.apply(this,arguments)}function al(t){"@babel/helpers - typeof";return al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},al(t)}function bj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function xj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bj(Object(r),!0).forEach(function(n){pm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zre(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ene(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gF(n.key),n)}}function tne(t,e,r){return e&&ene(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function rne(t,e,r){return e=rv(e),nne(t,mF()?Reflect.construct(e,r||[],rv(t).constructor):e.apply(t,r))}function nne(t,e){if(e&&(al(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ane(t)}function ane(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mF=function(){return!!t})()}function rv(t){return rv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rv(t)}function ine(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T_(t,e)}function T_(t,e){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},T_(t,e)}function pm(t,e,r){return e=gF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gF(t){var e=one(t,"string");return al(e)=="symbol"?e:e+""}function one(t,e){if(al(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(al(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var sne=function(e,r,n,a,i){var o=i.x1,s=i.x2,u=i.y1,l=i.y2,f=i.xAxis,d=i.yAxis;if(!f||!d)return null;var p=pS({x:f.scale,y:d.scale}),v={x:e?p.x.apply(o,{position:"start"}):p.x.rangeMin,y:n?p.y.apply(u,{position:"start"}):p.y.rangeMin},g={x:r?p.x.apply(s,{position:"end"}):p.x.rangeMax,y:a?p.y.apply(l,{position:"end"}):p.y.rangeMax};return Ra(i,"discard")&&(!p.isInRange(v)||!p.isInRange(g))?null:nF(v,g)},vm=(function(t){function e(){return Zre(this,e),rne(this,e,arguments)}return ine(e,t),tne(e,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,s=n.y2,u=n.className,l=n.alwaysShow,f=n.clipPathId;ui(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=ur(a),p=ur(i),v=ur(o),g=ur(s),b=this.props.shape;if(!d&&!p&&!v&&!g&&!b)return null;var y=sne(d,p,v,g,this.props);if(!y&&!b)return null;var x=Ra(this.props,"hidden")?"url(#".concat(f,")"):void 0;return Z.createElement(Et,{className:st("recharts-reference-area",u)},e.renderRect(b,xj(xj({clipPath:x},rt(this.props,!0)),y)),zr.renderCallByParent(this.props,y))}}])})(Z.Component);pm(vm,"displayName","ReferenceArea");pm(vm,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});pm(vm,"renderRect",function(t,e){var r;return Z.isValidElement(t)?r=Z.cloneElement(t,e):et(t)?r=t(e):r=Z.createElement(hS,O_({},e,{className:"recharts-reference-area-rect"})),r});function yF(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],a=0;a<t.length;a+=e)n.push(t[a]);return n}function une(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return hre(n,r)}function lne(t,e,r){var n=r==="width",a=t.x,i=t.y,o=t.width,s=t.height;return e===1?{start:n?a:i,end:n?a+o:i+s}:{start:n?a+o:i+s,end:n?a:i}}function nv(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var i=r();return t*(e-t*i/2-n)>=0&&t*(e+t*i/2-a)<=0}function cne(t,e){return yF(t,e+1)}function fne(t,e,r,n,a){for(var i=(n||[]).slice(),o=e.start,s=e.end,u=0,l=1,f=o,d=function(){var g=n?.[u];if(g===void 0)return{v:yF(n,l)};var b=u,y,x=function(){return y===void 0&&(y=r(g,b)),y},S=g.coordinate,E=u===0||nv(t,S,x,f,s);E||(u=0,f=o,l+=1),E&&(f=S+t*(x()/2+a),u+=l)},p;l<=i.length;)if(p=d(),p)return p.v;return[]}function Ff(t){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ff(t)}function wj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ur(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wj(Object(r),!0).forEach(function(n){dne(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dne(t,e,r){return e=hne(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hne(t){var e=pne(t,"string");return Ff(e)=="symbol"?e:e+""}function pne(t,e){if(Ff(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vne(t,e,r,n,a){for(var i=(n||[]).slice(),o=i.length,s=e.start,u=e.end,l=function(p){var v=i[p],g,b=function(){return g===void 0&&(g=r(v,p)),g};if(p===o-1){var y=t*(v.coordinate+t*b()/2-u);i[p]=v=Ur(Ur({},v),{},{tickCoord:y>0?v.coordinate-y*t:v.coordinate})}else i[p]=v=Ur(Ur({},v),{},{tickCoord:v.coordinate});var x=nv(t,v.tickCoord,b,s,u);x&&(u=v.tickCoord-t*(b()/2+a),i[p]=Ur(Ur({},v),{},{isShow:!0}))},f=o-1;f>=0;f--)l(f);return i}function mne(t,e,r,n,a,i){var o=(n||[]).slice(),s=o.length,u=e.start,l=e.end;if(i){var f=n[s-1],d=r(f,s-1),p=t*(f.coordinate+t*d/2-l);o[s-1]=f=Ur(Ur({},f),{},{tickCoord:p>0?f.coordinate-p*t:f.coordinate});var v=nv(t,f.tickCoord,function(){return d},u,l);v&&(l=f.tickCoord-t*(d/2+a),o[s-1]=Ur(Ur({},f),{},{isShow:!0}))}for(var g=i?s-1:s,b=function(S){var E=o[S],C,k=function(){return C===void 0&&(C=r(E,S)),C};if(S===0){var A=t*(E.coordinate-t*k()/2-u);o[S]=E=Ur(Ur({},E),{},{tickCoord:A<0?E.coordinate-A*t:E.coordinate})}else o[S]=E=Ur(Ur({},E),{},{tickCoord:E.coordinate});var T=nv(t,E.tickCoord,k,u,l);T&&(u=E.tickCoord+t*(k()/2+a),o[S]=Ur(Ur({},E),{},{isShow:!0}))},y=0;y<g;y++)b(y);return o}function wS(t,e,r){var n=t.tick,a=t.ticks,i=t.viewBox,o=t.minTickGap,s=t.orientation,u=t.interval,l=t.tickFormatter,f=t.unit,d=t.angle;if(!a||!a.length||!n)return[];if(be(u)||ms.isSsr)return cne(a,typeof u=="number"&&be(u)?u:0);var p=[],v=s==="top"||s==="bottom"?"width":"height",g=f&&v==="width"?$c(f,{fontSize:e,letterSpacing:r}):{width:0,height:0},b=function(E,C){var k=et(l)?l(E.value,C):E.value;return v==="width"?une($c(k,{fontSize:e,letterSpacing:r}),g,d):$c(k,{fontSize:e,letterSpacing:r})[v]},y=a.length>=2?ca(a[1].coordinate-a[0].coordinate):1,x=lne(i,y,v);return u==="equidistantPreserveStart"?fne(y,x,b,a,o):(u==="preserveStart"||u==="preserveStartEnd"?p=mne(y,x,b,a,o,u==="preserveStartEnd"):p=vne(y,x,b,a,o),p.filter(function(S){return S.isShow}))}var gne=["viewBox"],yne=["viewBox"],bne=["ticks"];function il(t){"@babel/helpers - typeof";return il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},il(t)}function _u(){return _u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_u.apply(this,arguments)}function _j(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ar(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_j(Object(r),!0).forEach(function(n){_S(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_j(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Tw(t,e){if(t==null)return{};var r=xne(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function xne(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function wne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xF(n.key),n)}}function _ne(t,e,r){return e&&Sj(t.prototype,e),r&&Sj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sne(t,e,r){return e=av(e),Ene(t,bF()?Reflect.construct(e,r||[],av(t).constructor):e.apply(t,r))}function Ene(t,e){if(e&&(il(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cne(t)}function Cne(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bF=function(){return!!t})()}function av(t){return av=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},av(t)}function kne(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P_(t,e)}function P_(t,e){return P_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},P_(t,e)}function _S(t,e,r){return e=xF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xF(t){var e=Ane(t,"string");return il(e)=="symbol"?e:e+""}function Ane(t,e){if(il(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(il(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Al=(function(t){function e(r){var n;return wne(this,e),n=Sne(this,e,[r]),n.state={fontSize:"",letterSpacing:""},n}return kne(e,t),_ne(e,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=Tw(n,gne),s=this.props,u=s.viewBox,l=Tw(s,yne);return!Cu(i,u)||!Cu(o,l)||!Cu(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,s=a.width,u=a.height,l=a.orientation,f=a.tickSize,d=a.mirror,p=a.tickMargin,v,g,b,y,x,S,E=d?-1:1,C=n.tickSize||f,k=be(n.tickCoord)?n.tickCoord:n.coordinate;switch(l){case"top":v=g=n.coordinate,y=o+ +!d*u,b=y-E*C,S=b-E*p,x=k;break;case"left":b=y=n.coordinate,g=i+ +!d*s,v=g-E*C,x=v-E*p,S=k;break;case"right":b=y=n.coordinate,g=i+ +d*s,v=g+E*C,x=v+E*p,S=k;break;default:v=g=n.coordinate,y=o+ +d*u,b=y+E*C,S=b+E*p,x=k;break}return{line:{x1:v,y1:b,x2:g,y2:y},tick:{x,y:S}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,u=n.orientation,l=n.mirror,f=n.axisLine,d=ar(ar(ar({},rt(this.props,!1)),rt(f,!1)),{},{fill:"none"});if(u==="top"||u==="bottom"){var p=+(u==="top"&&!l||u==="bottom"&&l);d=ar(ar({},d),{},{x1:a,y1:i+p*s,x2:a+o,y2:i+p*s})}else{var v=+(u==="left"&&!l||u==="right"&&l);d=ar(ar({},d),{},{x1:a+v*o,y1:i,x2:a+v*o,y2:i+s})}return Z.createElement("line",_u({},d,{className:st("recharts-cartesian-axis-line",qn(f,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,s=this.props,u=s.tickLine,l=s.stroke,f=s.tick,d=s.tickFormatter,p=s.unit,v=wS(ar(ar({},this.props),{},{ticks:n}),a,i),g=this.getTickTextAnchor(),b=this.getTickVerticalAnchor(),y=rt(this.props,!1),x=rt(f,!1),S=ar(ar({},y),{},{fill:"none"},rt(u,!1)),E=v.map(function(C,k){var A=o.getTickLineCoord(C),T=A.line,N=A.tick,R=ar(ar(ar(ar({textAnchor:g,verticalAnchor:b},y),{},{stroke:"none",fill:l},x),N),{},{index:k,payload:C,visibleTicksCount:v.length,tickFormatter:d});return Z.createElement(Et,_u({className:"recharts-cartesian-axis-tick",key:"tick-".concat(C.value,"-").concat(C.coordinate,"-").concat(C.tickCoord)},dp(o.props,C,k)),u&&Z.createElement("line",_u({},S,T,{className:st("recharts-cartesian-axis-tick-line",qn(u,"className"))})),f&&e.renderTickItem(f,R,"".concat(et(d)?d(C.value,k):C.value).concat(p||"")))});return Z.createElement("g",{className:"recharts-cartesian-axis-ticks"},E)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,s=a.height,u=a.ticksGenerator,l=a.className,f=a.hide;if(f)return null;var d=this.props,p=d.ticks,v=Tw(d,bne),g=p;return et(u)&&(g=p&&p.length>0?u(this.props):u(v)),o<=0||s<=0||!g||!g.length?null:Z.createElement(Et,{className:st("recharts-cartesian-axis",l),ref:function(y){n.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(g,this.state.fontSize,this.state.letterSpacing),zr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,s=st(a.className,"recharts-cartesian-axis-tick-value");return Z.isValidElement(n)?o=Z.cloneElement(n,ar(ar({},a),{},{className:s})):et(n)?o=n(ar(ar({},a),{},{className:s})):o=Z.createElement(Sp,_u({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])})(V.Component);_S(Al,"displayName","CartesianAxis");_S(Al,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var One=["x1","y1","x2","y2","key"],Tne=["offset"];function fs(t){"@babel/helpers - typeof";return fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fs(t)}function Ej(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ej(Object(r),!0).forEach(function(n){Pne(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ej(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Pne(t,e,r){return e=Nne(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nne(t){var e=Rne(t,"string");return fs(e)=="symbol"?e:e+""}function Rne(t,e){if(fs(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(fs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zo(){return Zo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zo.apply(this,arguments)}function Cj(t,e){if(t==null)return{};var r=Ine(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Ine(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var jne=function(e){var r=e.fill;if(!r||r==="none")return null;var n=e.fillOpacity,a=e.x,i=e.y,o=e.width,s=e.height,u=e.ry;return Z.createElement("rect",{x:a,y:i,ry:u,width:o,height:s,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function wF(t,e){var r;if(Z.isValidElement(t))r=Z.cloneElement(t,e);else if(et(t))r=t(e);else{var n=e.x1,a=e.y1,i=e.x2,o=e.y2,s=e.key,u=Cj(e,One),l=rt(u,!1);l.offset;var f=Cj(l,Tne);r=Z.createElement("line",Zo({},f,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:s}))}return r}function Dne(t){var e=t.x,r=t.width,n=t.horizontal,a=n===void 0?!0:n,i=t.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(s,u){var l=qr(qr({},t),{},{x1:e,y1:s,x2:e+r,y2:s,key:"line-".concat(u),index:u});return wF(a,l)});return Z.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function Mne(t){var e=t.y,r=t.height,n=t.vertical,a=n===void 0?!0:n,i=t.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(s,u){var l=qr(qr({},t),{},{x1:s,y1:e,x2:s,y2:e+r,key:"line-".concat(u),index:u});return wF(a,l)});return Z.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function Fne(t){var e=t.horizontalFill,r=t.fillOpacity,n=t.x,a=t.y,i=t.width,o=t.height,s=t.horizontalPoints,u=t.horizontal,l=u===void 0?!0:u;if(!l||!e||!e.length)return null;var f=s.map(function(p){return Math.round(p+a-a)}).sort(function(p,v){return p-v});a!==f[0]&&f.unshift(0);var d=f.map(function(p,v){var g=!f[v+1],b=g?a+o-p:f[v+1]-p;if(b<=0)return null;var y=v%e.length;return Z.createElement("rect",{key:"react-".concat(v),y:p,x:n,height:b,width:i,stroke:"none",fill:e[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function Lne(t){var e=t.vertical,r=e===void 0?!0:e,n=t.verticalFill,a=t.fillOpacity,i=t.x,o=t.y,s=t.width,u=t.height,l=t.verticalPoints;if(!r||!n||!n.length)return null;var f=l.map(function(p){return Math.round(p+i-i)}).sort(function(p,v){return p-v});i!==f[0]&&f.unshift(0);var d=f.map(function(p,v){var g=!f[v+1],b=g?i+s-p:f[v+1]-p;if(b<=0)return null;var y=v%n.length;return Z.createElement("rect",{key:"react-".concat(v),x:p,y:o,width:b,height:u,stroke:"none",fill:n[y],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Bne=function(e,r){var n=e.xAxis,a=e.width,i=e.height,o=e.offset;return j3(wS(qr(qr(qr({},Al.defaultProps),n),{},{ticks:oi(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},$ne=function(e,r){var n=e.yAxis,a=e.width,i=e.height,o=e.offset;return j3(wS(qr(qr(qr({},Al.defaultProps),n),{},{ticks:oi(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},su={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function SS(t){var e,r,n,a,i,o,s=gS(),u=yS(),l=Are(),f=qr(qr({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:su.stroke,fill:(r=t.fill)!==null&&r!==void 0?r:su.fill,horizontal:(n=t.horizontal)!==null&&n!==void 0?n:su.horizontal,horizontalFill:(a=t.horizontalFill)!==null&&a!==void 0?a:su.horizontalFill,vertical:(i=t.vertical)!==null&&i!==void 0?i:su.vertical,verticalFill:(o=t.verticalFill)!==null&&o!==void 0?o:su.verticalFill,x:be(t.x)?t.x:l.left,y:be(t.y)?t.y:l.top,width:be(t.width)?t.width:l.width,height:be(t.height)?t.height:l.height}),d=f.x,p=f.y,v=f.width,g=f.height,b=f.syncWithTicks,y=f.horizontalValues,x=f.verticalValues,S=Ere(),E=Cre();if(!be(v)||v<=0||!be(g)||g<=0||!be(d)||d!==+d||!be(p)||p!==+p)return null;var C=f.verticalCoordinatesGenerator||Bne,k=f.horizontalCoordinatesGenerator||$ne,A=f.horizontalPoints,T=f.verticalPoints;if((!A||!A.length)&&et(k)){var N=y&&y.length,R=k({yAxis:E?qr(qr({},E),{},{ticks:N?y:E.ticks}):void 0,width:s,height:u,offset:l},N?!0:b);ui(Array.isArray(R),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(fs(R),"]")),Array.isArray(R)&&(A=R)}if((!T||!T.length)&&et(C)){var I=x&&x.length,D=C({xAxis:S?qr(qr({},S),{},{ticks:I?x:S.ticks}):void 0,width:s,height:u,offset:l},I?!0:b);ui(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(fs(D),"]")),Array.isArray(D)&&(T=D)}return Z.createElement("g",{className:"recharts-cartesian-grid"},Z.createElement(jne,{fill:f.fill,fillOpacity:f.fillOpacity,x:f.x,y:f.y,width:f.width,height:f.height,ry:f.ry}),Z.createElement(Dne,Zo({},f,{offset:l,horizontalPoints:A,xAxis:S,yAxis:E})),Z.createElement(Mne,Zo({},f,{offset:l,verticalPoints:T,xAxis:S,yAxis:E})),Z.createElement(Fne,Zo({},f,{horizontalPoints:A})),Z.createElement(Lne,Zo({},f,{verticalPoints:T})))}SS.displayName="CartesianGrid";var Une=["type","layout","connectNulls","ref"],Wne=["key"];function ol(t){"@babel/helpers - typeof";return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ol(t)}function kj(t,e){if(t==null)return{};var r=zne(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function zne(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function qc(){return qc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qc.apply(this,arguments)}function Aj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function xn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Aj(Object(r),!0).forEach(function(n){sa(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Aj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function uu(t){return Gne(t)||Hne(t)||Vne(t)||qne()}function qne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vne(t,e){if(t){if(typeof t=="string")return N_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N_(t,e)}}function Hne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Gne(t){if(Array.isArray(t))return N_(t)}function N_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Kne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,SF(n.key),n)}}function Xne(t,e,r){return e&&Oj(t.prototype,e),r&&Oj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Yne(t,e,r){return e=iv(e),Jne(t,_F()?Reflect.construct(e,r||[],iv(t).constructor):e.apply(t,r))}function Jne(t,e){if(e&&(ol(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qne(t)}function Qne(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _F(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_F=function(){return!!t})()}function iv(t){return iv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iv(t)}function Zne(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R_(t,e)}function R_(t,e){return R_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},R_(t,e)}function sa(t,e,r){return e=SF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SF(t){var e=eae(t,"string");return ol(e)=="symbol"?e:e+""}function eae(t,e){if(ol(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ol(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var nd=(function(t){function e(){var r;Kne(this,e);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Yne(this,e,[].concat(a)),sa(r,"state",{isAnimationFinished:!0,totalLength:0}),sa(r,"generateSimpleStrokeDasharray",function(o,s){return"".concat(s,"px ").concat(o-s,"px")}),sa(r,"getStrokeDasharray",function(o,s,u){var l=u.reduce(function(x,S){return x+S});if(!l)return r.generateSimpleStrokeDasharray(s,o);for(var f=Math.floor(o/l),d=o%l,p=s-o,v=[],g=0,b=0;g<u.length;b+=u[g],++g)if(b+u[g]>d){v=[].concat(uu(u.slice(0,g)),[d-b]);break}var y=v.length%2===0?[0,p]:[p];return[].concat(uu(e.repeat(u,f)),uu(v),y).map(function(x){return"".concat(x,"px")}).join(", ")}),sa(r,"id",_l("recharts-line-")),sa(r,"pathRef",function(o){r.mainCurve=o}),sa(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),sa(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Zne(e,t),Xne(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,s=i.xAxis,u=i.yAxis,l=i.layout,f=i.children,d=Vn(f,td);if(!d)return null;var p=function(b,y){return{x:b.x,y:b.y,value:b.value,errorVal:en(b.payload,y)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Z.createElement(Et,v,d.map(function(g){return Z.cloneElement(g,{key:"bar-".concat(g.props.dataKey),data:o,xAxis:s,yAxis:u,layout:l,dataPointFormatter:p})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var s=this.props,u=s.dot,l=s.points,f=s.dataKey,d=rt(this.props,!1),p=rt(u,!0),v=l.map(function(b,y){var x=xn(xn(xn({key:"dot-".concat(y),r:3},d),p),{},{index:y,cx:b.x,cy:b.y,value:b.value,dataKey:f,payload:b.payload,points:l});return e.renderDotItem(u,x)}),g={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return Z.createElement(Et,qc({className:"recharts-line-dots",key:"dots"},g),v)}},{key:"renderCurveStatically",value:function(n,a,i,o){var s=this.props,u=s.type,l=s.layout,f=s.connectNulls;s.ref;var d=kj(s,Une),p=xn(xn(xn({},rt(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:u,layout:l,connectNulls:f});return Z.createElement(Tu,qc({},p,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,s=o.points,u=o.strokeDasharray,l=o.isAnimationActive,f=o.animationBegin,d=o.animationDuration,p=o.animationEasing,v=o.animationId,g=o.animateNewValues,b=o.width,y=o.height,x=this.state,S=x.prevPoints,E=x.totalLength;return Z.createElement(Fa,{begin:f,duration:d,isActive:l,easing:p,from:{t:0},to:{t:1},key:"line-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(C){var k=C.t;if(S){var A=S.length/s.length,T=s.map(function(j,$){var W=Math.floor($*A);if(S[W]){var q=S[W],X=Ir(q.x,j.x),Y=Ir(q.y,j.y);return xn(xn({},j),{},{x:X(k),y:Y(k)})}if(g){var z=Ir(b*2,j.x),B=Ir(y/2,j.y);return xn(xn({},j),{},{x:z(k),y:B(k)})}return xn(xn({},j),{},{x:j.x,y:j.y})});return i.renderCurveStatically(T,n,a)}var N=Ir(0,E),R=N(k),I;if(u){var D="".concat(u).split(/[,\s]+/gim).map(function(j){return parseFloat(j)});I=i.getStrokeDasharray(R,E,D)}else I=i.generateSimpleStrokeDasharray(E,R);return i.renderCurveStatically(s,n,a,{strokeDasharray:I})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,s=i.isAnimationActive,u=this.state,l=u.prevPoints,f=u.totalLength;return s&&o&&o.length&&(!l&&f>0||!Yu(l,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,s=a.points,u=a.className,l=a.xAxis,f=a.yAxis,d=a.top,p=a.left,v=a.width,g=a.height,b=a.isAnimationActive,y=a.id;if(i||!s||!s.length)return null;var x=this.state.isAnimationFinished,S=s.length===1,E=st("recharts-line",u),C=l&&l.allowDataOverflow,k=f&&f.allowDataOverflow,A=C||k,T=nt(y)?this.id:y,N=(n=rt(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},R=N.r,I=R===void 0?3:R,D=N.strokeWidth,j=D===void 0?2:D,$=MM(o)?o:{},W=$.clipDot,q=W===void 0?!0:W,X=I*2+j;return Z.createElement(Et,{className:E},C||k?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(T)},Z.createElement("rect",{x:C?p:p-v/2,y:k?d:d-g/2,width:C?v:v*2,height:k?g:g*2})),!q&&Z.createElement("clipPath",{id:"clipPath-dots-".concat(T)},Z.createElement("rect",{x:p-X/2,y:d-X/2,width:v+X,height:g+X}))):null,!S&&this.renderCurve(A,T),this.renderErrorBar(A,T),(S||o)&&this.renderDots(A,q,T),(!b||x)&&ci.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(uu(n),[0]):n,o=[],s=0;s<a;++s)o=[].concat(uu(o),uu(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(Z.isValidElement(n))i=Z.cloneElement(n,a);else if(et(n))i=n(a);else{var o=a.key,s=kj(a,Wne),u=st("recharts-line-dot",typeof n!="boolean"?n.className:"");i=Z.createElement(um,qc({key:o},s,{className:u}))}return i}}])})(V.PureComponent);sa(nd,"displayName","Line");sa(nd,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ms.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});sa(nd,"getComposedData",function(t){var e=t.props,r=t.xAxis,n=t.yAxis,a=t.xAxisTicks,i=t.yAxisTicks,o=t.dataKey,s=t.bandSize,u=t.displayedData,l=t.offset,f=e.layout,d=u.map(function(p,v){var g=en(p,o);return f==="horizontal"?{x:Lp({axis:r,ticks:a,bandSize:s,entry:p,index:v}),y:nt(g)?null:n.scale(g),value:g,payload:p}:{x:nt(g)?null:r.scale(g),y:Lp({axis:n,ticks:i,bandSize:s,entry:p,index:v}),value:g,payload:p}});return xn({points:d,layout:f},l)});var tae=["layout","type","stroke","connectNulls","isRange","ref"],rae=["key"],EF;function sl(t){"@babel/helpers - typeof";return sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sl(t)}function CF(t,e){if(t==null)return{};var r=nae(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function nae(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function es(){return es=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},es.apply(this,arguments)}function Tj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Hi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Tj(Object(r),!0).forEach(function(n){Ta(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,AF(n.key),n)}}function iae(t,e,r){return e&&Pj(t.prototype,e),r&&Pj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oae(t,e,r){return e=ov(e),sae(t,kF()?Reflect.construct(e,r||[],ov(t).constructor):e.apply(t,r))}function sae(t,e){if(e&&(sl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uae(t)}function uae(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kF=function(){return!!t})()}function ov(t){return ov=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ov(t)}function lae(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I_(t,e)}function I_(t,e){return I_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},I_(t,e)}function Ta(t,e,r){return e=AF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AF(t){var e=cae(t,"string");return sl(e)=="symbol"?e:e+""}function cae(t,e){if(sl(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(sl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var yo=(function(t){function e(){var r;aae(this,e);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=oae(this,e,[].concat(a)),Ta(r,"state",{isAnimationFinished:!0}),Ta(r,"id",_l("recharts-area-")),Ta(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),et(o)&&o()}),Ta(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),et(o)&&o()}),r}return lae(e,t),iae(e,[{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive,s=this.state.isAnimationFinished;if(o&&!s)return null;var u=this.props,l=u.dot,f=u.points,d=u.dataKey,p=rt(this.props,!1),v=rt(l,!0),g=f.map(function(y,x){var S=Hi(Hi(Hi({key:"dot-".concat(x),r:3},p),v),{},{index:x,cx:y.x,cy:y.y,dataKey:d,value:y.value,payload:y.payload,points:f});return e.renderDotItem(l,S)}),b={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return Z.createElement(Et,es({className:"recharts-area-dots"},b),g)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,s=a.strokeWidth,u=o[0].x,l=o[o.length-1].x,f=n*Math.abs(u-l),d=Zi(o.map(function(p){return p.y||0}));return be(i)&&typeof i=="number"?d=Math.max(i,d):i&&Array.isArray(i)&&i.length&&(d=Math.max(Zi(i.map(function(p){return p.y||0})),d)),be(d)?Z.createElement("rect",{x:u<l?u:u-f,y:0,width:f,height:Math.floor(d+(s?parseInt("".concat(s),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,s=a.strokeWidth,u=o[0].y,l=o[o.length-1].y,f=n*Math.abs(u-l),d=Zi(o.map(function(p){return p.x||0}));return be(i)&&typeof i=="number"?d=Math.max(i,d):i&&Array.isArray(i)&&i.length&&(d=Math.max(Zi(i.map(function(p){return p.x||0})),d)),be(d)?Z.createElement("rect",{x:0,y:u<l?u:u-f,width:d+(s?parseInt("".concat(s),10):1),height:Math.floor(f)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,o){var s=this.props,u=s.layout,l=s.type,f=s.stroke,d=s.connectNulls,p=s.isRange;s.ref;var v=CF(s,tae);return Z.createElement(Et,{clipPath:i?"url(#clipPath-".concat(o,")"):null},Z.createElement(Tu,es({},rt(v,!0),{points:n,connectNulls:d,type:l,baseLine:a,layout:u,stroke:"none",className:"recharts-area-area"})),f!=="none"&&Z.createElement(Tu,es({},rt(this.props,!1),{className:"recharts-area-curve",layout:u,type:l,connectNulls:d,fill:"none",points:n})),f!=="none"&&p&&Z.createElement(Tu,es({},rt(this.props,!1),{className:"recharts-area-curve",layout:u,type:l,connectNulls:d,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,o=this.props,s=o.points,u=o.baseLine,l=o.isAnimationActive,f=o.animationBegin,d=o.animationDuration,p=o.animationEasing,v=o.animationId,g=this.state,b=g.prevPoints,y=g.prevBaseLine;return Z.createElement(Fa,{begin:f,duration:d,isActive:l,easing:p,from:{t:0},to:{t:1},key:"area-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var S=x.t;if(b){var E=b.length/s.length,C=s.map(function(N,R){var I=Math.floor(R*E);if(b[I]){var D=b[I],j=Ir(D.x,N.x),$=Ir(D.y,N.y);return Hi(Hi({},N),{},{x:j(S),y:$(S)})}return N}),k;if(be(u)&&typeof u=="number"){var A=Ir(y,u);k=A(S)}else if(nt(u)||wl(u)){var T=Ir(y,0);k=T(S)}else k=u.map(function(N,R){var I=Math.floor(R*E);if(y[I]){var D=y[I],j=Ir(D.x,N.x),$=Ir(D.y,N.y);return Hi(Hi({},N),{},{x:j(S),y:$(S)})}return N});return i.renderAreaStatically(C,k,n,a)}return Z.createElement(Et,null,Z.createElement("defs",null,Z.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(S))),Z.createElement(Et,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(s,u,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,o=i.points,s=i.baseLine,u=i.isAnimationActive,l=this.state,f=l.prevPoints,d=l.prevBaseLine,p=l.totalLength;return u&&o&&o.length&&(!f&&p>0||!Yu(f,o)||!Yu(d,s))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(o,s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,s=a.points,u=a.className,l=a.top,f=a.left,d=a.xAxis,p=a.yAxis,v=a.width,g=a.height,b=a.isAnimationActive,y=a.id;if(i||!s||!s.length)return null;var x=this.state.isAnimationFinished,S=s.length===1,E=st("recharts-area",u),C=d&&d.allowDataOverflow,k=p&&p.allowDataOverflow,A=C||k,T=nt(y)?this.id:y,N=(n=rt(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},R=N.r,I=R===void 0?3:R,D=N.strokeWidth,j=D===void 0?2:D,$=MM(o)?o:{},W=$.clipDot,q=W===void 0?!0:W,X=I*2+j;return Z.createElement(Et,{className:E},C||k?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(T)},Z.createElement("rect",{x:C?f:f-v/2,y:k?l:l-g/2,width:C?v:v*2,height:k?g:g*2})),!q&&Z.createElement("clipPath",{id:"clipPath-dots-".concat(T)},Z.createElement("rect",{x:f-X/2,y:l-X/2,width:v+X,height:g+X}))):null,S?null:this.renderArea(A,T),(o||S)&&this.renderDots(A,q,T),(!b||x)&&ci.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])})(V.PureComponent);EF=yo;Ta(yo,"displayName","Area");Ta(yo,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!ms.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Ta(yo,"getBaseValue",function(t,e,r,n){var a=t.layout,i=t.baseValue,o=e.props.baseValue,s=o??i;if(be(s)&&typeof s=="number")return s;var u=a==="horizontal"?n:r,l=u.scale.domain();if(u.type==="number"){var f=Math.max(l[0],l[1]),d=Math.min(l[0],l[1]);return s==="dataMin"?d:s==="dataMax"||f<0?f:Math.max(Math.min(l[0],l[1]),0)}return s==="dataMin"?l[0]:s==="dataMax"?l[1]:l[0]});Ta(yo,"getComposedData",function(t){var e=t.props,r=t.item,n=t.xAxis,a=t.yAxis,i=t.xAxisTicks,o=t.yAxisTicks,s=t.bandSize,u=t.dataKey,l=t.stackedData,f=t.dataStartIndex,d=t.displayedData,p=t.offset,v=e.layout,g=l&&l.length,b=EF.getBaseValue(e,r,n,a),y=v==="horizontal",x=!1,S=d.map(function(C,k){var A;g?A=l[f+k]:(A=en(C,u),Array.isArray(A)?x=!0:A=[b,A]);var T=A[1]==null||g&&en(C,u)==null;return y?{x:Lp({axis:n,ticks:i,bandSize:s,entry:C,index:k}),y:T?null:a.scale(A[1]),value:A,payload:C}:{x:T?null:n.scale(A[1]),y:Lp({axis:a,ticks:o,bandSize:s,entry:C,index:k}),value:A,payload:C}}),E;return g||x?E=S.map(function(C){var k=Array.isArray(C.value)?C.value[0]:null;return y?{x:C.x,y:k!=null&&C.y!=null?a.scale(k):null}:{x:k!=null?n.scale(k):null,y:C.y}}):E=y?a.scale(b):n.scale(b),Hi({points:S,baseLine:E,layout:v,isRange:x},p)});Ta(yo,"renderDotItem",function(t,e){var r;if(Z.isValidElement(t))r=Z.cloneElement(t,e);else if(et(t))r=t(e);else{var n=st("recharts-area-dot",typeof t!="boolean"?t.className:""),a=e.key,i=CF(e,rae);r=Z.createElement(um,es({},i,{key:a,className:n}))}return r});function ul(t){"@babel/helpers - typeof";return ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ul(t)}function fae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PF(n.key),n)}}function hae(t,e,r){return e&&dae(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function pae(t,e,r){return e=sv(e),vae(t,OF()?Reflect.construct(e,r||[],sv(t).constructor):e.apply(t,r))}function vae(t,e){if(e&&(ul(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mae(t)}function mae(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OF=function(){return!!t})()}function sv(t){return sv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sv(t)}function gae(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j_(t,e)}function j_(t,e){return j_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},j_(t,e)}function TF(t,e,r){return e=PF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PF(t){var e=yae(t,"string");return ul(e)=="symbol"?e:e+""}function yae(t,e){if(ul(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ul(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function D_(){return D_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},D_.apply(this,arguments)}function bae(t){var e=t.xAxisId,r=gS(),n=yS(),a=cF(e);return a==null?null:V.createElement(Al,D_({},a,{className:st("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return oi(o,!0)}}))}var Ol=(function(t){function e(){return fae(this,e),pae(this,e,arguments)}return gae(e,t),hae(e,[{key:"render",value:function(){return V.createElement(bae,this.props)}}])})(V.Component);TF(Ol,"displayName","XAxis");TF(Ol,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function ll(t){"@babel/helpers - typeof";return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ll(t)}function xae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IF(n.key),n)}}function _ae(t,e,r){return e&&wae(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sae(t,e,r){return e=uv(e),Eae(t,NF()?Reflect.construct(e,r||[],uv(t).constructor):e.apply(t,r))}function Eae(t,e){if(e&&(ll(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cae(t)}function Cae(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NF=function(){return!!t})()}function uv(t){return uv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uv(t)}function kae(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M_(t,e)}function M_(t,e){return M_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},M_(t,e)}function RF(t,e,r){return e=IF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IF(t){var e=Aae(t,"string");return ll(e)=="symbol"?e:e+""}function Aae(t,e){if(ll(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ll(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function F_(){return F_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},F_.apply(this,arguments)}var Oae=function(e){var r=e.yAxisId,n=gS(),a=yS(),i=fF(r);return i==null?null:V.createElement(Al,F_({},i,{className:st("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(s){return oi(s,!0)}}))},Tl=(function(t){function e(){return xae(this,e),Sae(this,e,arguments)}return kae(e,t),_ae(e,[{key:"render",value:function(){return V.createElement(Oae,this.props)}}])})(V.Component);RF(Tl,"displayName","YAxis");RF(Tl,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function Nj(t){return Rae(t)||Nae(t)||Pae(t)||Tae()}function Tae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pae(t,e){if(t){if(typeof t=="string")return L_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L_(t,e)}}function Nae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Rae(t){if(Array.isArray(t))return L_(t)}function L_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var B_=function(e,r,n,a,i){var o=Vn(e,xS),s=Vn(e,hm),u=[].concat(Nj(o),Nj(s)),l=Vn(e,vm),f="".concat(a,"Id"),d=a[0],p=r;if(u.length&&(p=u.reduce(function(b,y){if(y.props[f]===n&&Ra(y.props,"extendDomain")&&be(y.props[d])){var x=y.props[d];return[Math.min(b[0],x),Math.max(b[1],x)]}return b},p)),l.length){var v="".concat(d,"1"),g="".concat(d,"2");p=l.reduce(function(b,y){if(y.props[f]===n&&Ra(y.props,"extendDomain")&&be(y.props[v])&&be(y.props[g])){var x=y.props[v],S=y.props[g];return[Math.min(b[0],x,S),Math.max(b[1],x,S)]}return b},p)}return i&&i.length&&(p=i.reduce(function(b,y){return be(y)?[Math.min(b[0],y),Math.max(b[1],y)]:b},p)),p},Pw={exports:{}},Rj;function Iae(){return Rj||(Rj=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(u,l,f){this.fn=u,this.context=l,this.once=f||!1}function i(u,l,f,d,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new a(f,d||u,p),g=r?r+l:l;return u._events[g]?u._events[g].fn?u._events[g]=[u._events[g],v]:u._events[g].push(v):(u._events[g]=v,u._eventsCount++),u}function o(u,l){--u._eventsCount===0?u._events=new n:delete u._events[l]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],f,d;if(this._eventsCount===0)return l;for(d in f=this._events)e.call(f,d)&&l.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(f)):l},s.prototype.listeners=function(l){var f=r?r+l:l,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,v=d.length,g=new Array(v);p<v;p++)g[p]=d[p].fn;return g},s.prototype.listenerCount=function(l){var f=r?r+l:l,d=this._events[f];return d?d.fn?1:d.length:0},s.prototype.emit=function(l,f,d,p,v,g){var b=r?r+l:l;if(!this._events[b])return!1;var y=this._events[b],x=arguments.length,S,E;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,f),!0;case 3:return y.fn.call(y.context,f,d),!0;case 4:return y.fn.call(y.context,f,d,p),!0;case 5:return y.fn.call(y.context,f,d,p,v),!0;case 6:return y.fn.call(y.context,f,d,p,v,g),!0}for(E=1,S=new Array(x-1);E<x;E++)S[E-1]=arguments[E];y.fn.apply(y.context,S)}else{var C=y.length,k;for(E=0;E<C;E++)switch(y[E].once&&this.removeListener(l,y[E].fn,void 0,!0),x){case 1:y[E].fn.call(y[E].context);break;case 2:y[E].fn.call(y[E].context,f);break;case 3:y[E].fn.call(y[E].context,f,d);break;case 4:y[E].fn.call(y[E].context,f,d,p);break;default:if(!S)for(k=1,S=new Array(x-1);k<x;k++)S[k-1]=arguments[k];y[E].fn.apply(y[E].context,S)}}return!0},s.prototype.on=function(l,f,d){return i(this,l,f,d,!1)},s.prototype.once=function(l,f,d){return i(this,l,f,d,!0)},s.prototype.removeListener=function(l,f,d,p){var v=r?r+l:l;if(!this._events[v])return this;if(!f)return o(this,v),this;var g=this._events[v];if(g.fn)g.fn===f&&(!p||g.once)&&(!d||g.context===d)&&o(this,v);else{for(var b=0,y=[],x=g.length;b<x;b++)(g[b].fn!==f||p&&!g[b].once||d&&g[b].context!==d)&&y.push(g[b]);y.length?this._events[v]=y.length===1?y[0]:y:o(this,v)}return this},s.prototype.removeAllListeners=function(l){var f;return l?(f=r?r+l:l,this._events[f]&&o(this,f)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s})(Pw)),Pw.exports}var jae=Iae();const Dae=yt(jae);var Nw=new Dae,Rw="recharts.syncMouseEvents";function Lf(t){"@babel/helpers - typeof";return Lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lf(t)}function Mae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jF(n.key),n)}}function Lae(t,e,r){return e&&Fae(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Iw(t,e,r){return e=jF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jF(t){var e=Bae(t,"string");return Lf(e)=="symbol"?e:e+""}function Bae(t,e){if(Lf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Lf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var $ae=(function(){function t(){Mae(this,t),Iw(this,"activeIndex",0),Iw(this,"coordinateList",[]),Iw(this,"layout","horizontal")}return Lae(t,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,s=o===void 0?null:o,u=r.layout,l=u===void 0?null:u,f=r.offset,d=f===void 0?null:f,p=r.mouseHandlerCallback,v=p===void 0?null:p;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=s??this.container,this.layout=l??this.layout,this.offset=d??this.offset,this.mouseHandlerCallback=v??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,s=a.height,u=this.coordinateList[this.activeIndex].coordinate,l=((r=window)===null||r===void 0?void 0:r.scrollX)||0,f=((n=window)===null||n===void 0?void 0:n.scrollY)||0,d=i+u+l,p=o+this.offset.top+s/2+f;this.mouseHandlerCallback({pageX:d,pageY:p})}}}])})();function Uae(t,e,r){if(r==="number"&&e===!0&&Array.isArray(t)){var n=t?.[0],a=t?.[1];if(n&&a&&be(n)&&be(a))return!0}return!1}function Wae(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function DF(t){var e=t.cx,r=t.cy,n=t.radius,a=t.startAngle,i=t.endAngle,o=jr(e,r,n,a),s=jr(e,r,n,i);return{points:[o,s],cx:e,cy:r,radius:n,startAngle:a,endAngle:i}}function zae(t,e,r){var n,a,i,o;if(t==="horizontal")n=e.x,i=n,a=r.top,o=r.top+r.height;else if(t==="vertical")a=e.y,o=a,n=r.left,i=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var s=e.cx,u=e.cy,l=e.innerRadius,f=e.outerRadius,d=e.angle,p=jr(s,u,l,d),v=jr(s,u,f,d);n=p.x,a=p.y,i=v.x,o=v.y}else return DF(e);return[{x:n,y:a},{x:i,y:o}]}function Bf(t){"@babel/helpers - typeof";return Bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bf(t)}function Ij(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Uh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ij(Object(r),!0).forEach(function(n){qae(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ij(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qae(t,e,r){return e=Vae(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vae(t){var e=Hae(t,"string");return Bf(e)=="symbol"?e:e+""}function Hae(t,e){if(Bf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Bf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gae(t){var e,r,n=t.element,a=t.tooltipEventType,i=t.isActive,o=t.activeCoordinate,s=t.activePayload,u=t.offset,l=t.activeTooltipIndex,f=t.tooltipAxisBandSize,d=t.layout,p=t.chartName,v=(e=n.props.cursor)!==null&&e!==void 0?e:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!v||!i||!o||p!=="ScatterChart"&&a!=="axis")return null;var g,b=Tu;if(p==="ScatterChart")g=o,b=Dee;else if(p==="BarChart")g=Wae(d,o,u,f),b=hS;else if(d==="radial"){var y=DF(o),x=y.cx,S=y.cy,E=y.radius,C=y.startAngle,k=y.endAngle;g={cx:x,cy:S,startAngle:C,endAngle:k,innerRadius:E,outerRadius:E},b=B3}else g={points:zae(d,o,u)},b=Tu;var A=Uh(Uh(Uh(Uh({stroke:"#ccc",pointerEvents:"none"},u),g),rt(v,!1)),{},{payload:s,payloadIndex:l,className:st("recharts-tooltip-cursor",v.className)});return V.isValidElement(v)?V.cloneElement(v,A):V.createElement(b,A)}var Kae=["item"],Xae=["children","className","width","height","style","compact","title","desc"];function cl(t){"@babel/helpers - typeof";return cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cl(t)}function Su(){return Su=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Su.apply(this,arguments)}function jj(t,e){return Qae(t)||Jae(t,e)||FF(t,e)||Yae()}function Yae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jae(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,i,o,s=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(f){l=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function Qae(t){if(Array.isArray(t))return t}function Dj(t,e){if(t==null)return{};var r=Zae(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Zae(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function eie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LF(n.key),n)}}function rie(t,e,r){return e&&tie(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function nie(t,e,r){return e=lv(e),aie(t,MF()?Reflect.construct(e,r||[],lv(t).constructor):e.apply(t,r))}function aie(t,e){if(e&&(cl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iie(t)}function iie(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MF=function(){return!!t})()}function lv(t){return lv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lv(t)}function oie(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$_(t,e)}function $_(t,e){return $_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$_(t,e)}function fl(t){return lie(t)||uie(t)||FF(t)||sie()}function sie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FF(t,e){if(t){if(typeof t=="string")return U_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U_(t,e)}}function uie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lie(t){if(Array.isArray(t))return U_(t)}function U_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function fe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mj(Object(r),!0).forEach(function(n){qe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qe(t,e,r){return e=LF(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LF(t){var e=cie(t,"string");return cl(e)=="symbol"?e:e+""}function cie(t,e){if(cl(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(cl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fie={xAxis:["bottom","top"],yAxis:["left","right"]},die={width:"100%",height:"100%"},BF={x:0,y:0};function Wh(t){return t}var hie=function(e,r){return r==="horizontal"?e.x:r==="vertical"?e.y:r==="centric"?e.angle:e.radius},pie=function(e,r,n,a){var i=r.find(function(f){return f&&f.index===n});if(i){if(e==="horizontal")return{x:i.coordinate,y:a.y};if(e==="vertical")return{x:a.x,y:i.coordinate};if(e==="centric"){var o=i.coordinate,s=a.radius;return fe(fe(fe({},a),jr(a.cx,a.cy,s,o)),{},{angle:o,radius:s})}var u=i.coordinate,l=a.angle;return fe(fe(fe({},a),jr(a.cx,a.cy,u,l)),{},{angle:l,radius:u})}return BF},mm=function(e,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n??[]).reduce(function(s,u){var l=u.props.data;return l&&l.length?[].concat(fl(s),fl(l)):s},[]);return o.length>0?o:e&&e.length&&be(a)&&be(i)?e.slice(a,i+1):[]};function $F(t){return t==="number"?[0,"auto"]:void 0}var W_=function(e,r,n,a){var i=e.graphicalItems,o=e.tooltipAxis,s=mm(r,e);return n<0||!i||!i.length||n>=s.length?null:i.reduce(function(u,l){var f,d=(f=l.props.data)!==null&&f!==void 0?f:r;d&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(d=d.slice(e.dataStartIndex,e.dataEndIndex+1));var p;if(o.dataKey&&!o.allowDuplicatedCategory){var v=d===void 0?s:d;p=cp(v,o.dataKey,a)}else p=d&&d[n]||s[n];return p?[].concat(fl(u),[M3(l,p)]):u},[])},Fj=function(e,r,n,a){var i=a||{x:e.chartX,y:e.chartY},o=hie(i,n),s=e.orderedTooltipTicks,u=e.tooltipAxis,l=e.tooltipTicks,f=pJ(o,s,l,u);if(f>=0&&l){var d=l[f]&&l[f].value,p=W_(e,r,f,d),v=pie(n,s,f,i);return{activeTooltipIndex:f,activeLabel:d,activePayload:p,activeCoordinate:v}}return null},vie=function(e,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,s=r.stackGroups,u=r.dataStartIndex,l=r.dataEndIndex,f=e.layout,d=e.children,p=e.stackOffset,v=I3(f,i);return n.reduce(function(g,b){var y,x=b.type.defaultProps!==void 0?fe(fe({},b.type.defaultProps),b.props):b.props,S=x.type,E=x.dataKey,C=x.allowDataOverflow,k=x.allowDuplicatedCategory,A=x.scale,T=x.ticks,N=x.includeHidden,R=x[o];if(g[R])return g;var I=mm(e.data,{graphicalItems:a.filter(function(K){var oe,he=o in K.props?K.props[o]:(oe=K.type.defaultProps)===null||oe===void 0?void 0:oe[o];return he===R}),dataStartIndex:u,dataEndIndex:l}),D=I.length,j,$,W;Uae(x.domain,C,S)&&(j=i_(x.domain,null,C),v&&(S==="number"||A!=="auto")&&(W=Wc(I,E,"category")));var q=$F(S);if(!j||j.length===0){var X,Y=(X=x.domain)!==null&&X!==void 0?X:q;if(E){if(j=Wc(I,E,S),S==="category"&&v){var z=oV(j);k&&z?($=j,j=Xp(0,D)):k||(j=XR(Y,j,b).reduce(function(K,oe){return K.indexOf(oe)>=0?K:[].concat(fl(K),[oe])},[]))}else if(S==="category")k?j=j.filter(function(K){return K!==""&&!nt(K)}):j=XR(Y,j,b).reduce(function(K,oe){return K.indexOf(oe)>=0||oe===""||nt(oe)?K:[].concat(fl(K),[oe])},[]);else if(S==="number"){var B=bJ(I,a.filter(function(K){var oe,he,ge=o in K.props?K.props[o]:(oe=K.type.defaultProps)===null||oe===void 0?void 0:oe[o],xe="hide"in K.props?K.props.hide:(he=K.type.defaultProps)===null||he===void 0?void 0:he.hide;return ge===R&&(N||!xe)}),E,i,f);B&&(j=B)}v&&(S==="number"||A!=="auto")&&(W=Wc(I,E,"category"))}else v?j=Xp(0,D):s&&s[R]&&s[R].hasStack&&S==="number"?j=p==="expand"?[0,1]:D3(s[R].stackGroups,u,l):j=R3(I,a.filter(function(K){var oe=o in K.props?K.props[o]:K.type.defaultProps[o],he="hide"in K.props?K.props.hide:K.type.defaultProps.hide;return oe===R&&(N||!he)}),S,f,!0);if(S==="number")j=B_(d,j,R,i,T),Y&&(j=i_(Y,j,C));else if(S==="category"&&Y){var G=Y,L=j.every(function(K){return G.indexOf(K)>=0});L&&(j=G)}}return fe(fe({},g),{},qe({},R,fe(fe({},x),{},{axisType:i,domain:j,categoricalDomain:W,duplicateDomain:$,originalDomain:(y=x.domain)!==null&&y!==void 0?y:q,isCategorical:v,layout:f})))},{})},mie=function(e,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,s=r.stackGroups,u=r.dataStartIndex,l=r.dataEndIndex,f=e.layout,d=e.children,p=mm(e.data,{graphicalItems:n,dataStartIndex:u,dataEndIndex:l}),v=p.length,g=I3(f,i),b=-1;return n.reduce(function(y,x){var S=x.type.defaultProps!==void 0?fe(fe({},x.type.defaultProps),x.props):x.props,E=S[o],C=$F("number");if(!y[E]){b++;var k;return g?k=Xp(0,v):s&&s[E]&&s[E].hasStack?(k=D3(s[E].stackGroups,u,l),k=B_(d,k,E,i)):(k=i_(C,R3(p,n.filter(function(A){var T,N,R=o in A.props?A.props[o]:(T=A.type.defaultProps)===null||T===void 0?void 0:T[o],I="hide"in A.props?A.props.hide:(N=A.type.defaultProps)===null||N===void 0?void 0:N.hide;return R===E&&!I}),"number",f),a.defaultProps.allowDataOverflow),k=B_(d,k,E,i)),fe(fe({},y),{},qe({},E,fe(fe({axisType:i},a.defaultProps),{},{hide:!0,orientation:qn(fie,"".concat(i,".").concat(b%2),null),domain:k,originalDomain:C,isCategorical:g,layout:f})))}return y},{})},gie=function(e,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,s=r.stackGroups,u=r.dataStartIndex,l=r.dataEndIndex,f=e.children,d="".concat(a,"Id"),p=Vn(f,i),v={};return p&&p.length?v=vie(e,{axes:p,graphicalItems:o,axisType:a,axisIdKey:d,stackGroups:s,dataStartIndex:u,dataEndIndex:l}):o&&o.length&&(v=mie(e,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:d,stackGroups:s,dataStartIndex:u,dataEndIndex:l})),v},yie=function(e){var r=Yi(e),n=oi(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:$2(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Bp(r,n)}},Lj=function(e){var r=e.children,n=e.defaultShowTooltip,a=_n(r,el),i=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},bie=function(e){return!e||!e.length?!1:e.some(function(r){var n=si(r&&r.type);return n&&n.indexOf("Bar")>=0})},Bj=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},xie=function(e,r){var n=e.props,a=e.graphicalItems,i=e.xAxisMap,o=i===void 0?{}:i,s=e.yAxisMap,u=s===void 0?{}:s,l=n.width,f=n.height,d=n.children,p=n.margin||{},v=_n(d,el),g=_n(d,ku),b=Object.keys(u).reduce(function(k,A){var T=u[A],N=T.orientation;return!T.mirror&&!T.hide?fe(fe({},k),{},qe({},N,k[N]+T.width)):k},{left:p.left||0,right:p.right||0}),y=Object.keys(o).reduce(function(k,A){var T=o[A],N=T.orientation;return!T.mirror&&!T.hide?fe(fe({},k),{},qe({},N,qn(k,"".concat(N))+T.height)):k},{top:p.top||0,bottom:p.bottom||0}),x=fe(fe({},y),b),S=x.bottom;v&&(x.bottom+=v.props.height||el.defaultProps.height),g&&r&&(x=gJ(x,a,n,r));var E=l-x.left-x.right,C=f-x.top-x.bottom;return fe(fe({brushBottom:S},x),{},{width:Math.max(E,0),height:Math.max(C,0)})},wie=function(e,r){if(r==="xAxis")return e[r].width;if(r==="yAxis")return e[r].height},UF=function(e){var r=e.chartName,n=e.GraphicalChild,a=e.defaultTooltipEventType,i=a===void 0?"axis":a,o=e.validateTooltipEventTypes,s=o===void 0?["axis"]:o,u=e.axisComponents,l=e.legendContent,f=e.formatAxisMap,d=e.defaultProps,p=function(x,S){var E=S.graphicalItems,C=S.stackGroups,k=S.offset,A=S.updateId,T=S.dataStartIndex,N=S.dataEndIndex,R=x.barSize,I=x.layout,D=x.barGap,j=x.barCategoryGap,$=x.maxBarSize,W=Bj(I),q=W.numericAxisName,X=W.cateAxisName,Y=bie(E),z=[];return E.forEach(function(B,G){var L=mm(x.data,{graphicalItems:[B],dataStartIndex:T,dataEndIndex:N}),K=B.type.defaultProps!==void 0?fe(fe({},B.type.defaultProps),B.props):B.props,oe=K.dataKey,he=K.maxBarSize,ge=K["".concat(q,"Id")],xe=K["".concat(X,"Id")],ke={},we=u.reduce(function(Nt,Yt){var Mr=S["".concat(Yt.axisType,"Map")],Pn=K["".concat(Yt.axisType,"Id")];Mr&&Mr[Pn]||Yt.axisType==="zAxis"||cs();var Xr=Mr[Pn];return fe(fe({},Nt),{},qe(qe({},Yt.axisType,Xr),"".concat(Yt.axisType,"Ticks"),oi(Xr)))},ke),ue=we[X],Se=we["".concat(X,"Ticks")],_e=C&&C[ge]&&C[ge].hasStack&&NJ(B,C[ge].stackGroups),le=si(B.type).indexOf("Bar")>=0,$e=Bp(ue,Se),Fe=[],Xe=Y&&vJ({barSize:R,stackGroups:C,totalSize:wie(we,X)});if(le){var Ye,mt,Ut=nt(he)?$:he,Pt=(Ye=(mt=Bp(ue,Se,!0))!==null&&mt!==void 0?mt:Ut)!==null&&Ye!==void 0?Ye:0;Fe=mJ({barGap:D,barCategoryGap:j,bandSize:Pt!==$e?Pt:$e,sizeList:Xe[xe],maxBarSize:Ut}),Pt!==$e&&(Fe=Fe.map(function(Nt){return fe(fe({},Nt),{},{position:fe(fe({},Nt.position),{},{offset:Nt.position.offset-Pt/2})})}))}var Er=B&&B.type&&B.type.getComposedData;Er&&z.push({props:fe(fe({},Er(fe(fe({},we),{},{displayedData:L,props:x,dataKey:oe,item:B,bandSize:$e,barPosition:Fe,offset:k,stackedData:_e,layout:I,dataStartIndex:T,dataEndIndex:N}))),{},qe(qe(qe({key:B.key||"item-".concat(G)},q,we[q]),X,we[X]),"animationId",A)),childIndex:yV(B,x.children),item:B})}),z},v=function(x,S){var E=x.props,C=x.dataStartIndex,k=x.dataEndIndex,A=x.updateId;if(!cT({props:E}))return null;var T=E.children,N=E.layout,R=E.stackOffset,I=E.data,D=E.reverseStackOrder,j=Bj(N),$=j.numericAxisName,W=j.cateAxisName,q=Vn(T,n),X=OJ(I,q,"".concat($,"Id"),"".concat(W,"Id"),R,D),Y=u.reduce(function(K,oe){var he="".concat(oe.axisType,"Map");return fe(fe({},K),{},qe({},he,gie(E,fe(fe({},oe),{},{graphicalItems:q,stackGroups:oe.axisType===$&&X,dataStartIndex:C,dataEndIndex:k}))))},{}),z=xie(fe(fe({},Y),{},{props:E,graphicalItems:q}),S?.legendBBox);Object.keys(Y).forEach(function(K){Y[K]=f(E,Y[K],z,K.replace("Map",""),r)});var B=Y["".concat(W,"Map")],G=yie(B),L=p(E,fe(fe({},Y),{},{dataStartIndex:C,dataEndIndex:k,updateId:A,graphicalItems:q,stackGroups:X,offset:z}));return fe(fe({formattedGraphicalItems:L,graphicalItems:q,offset:z,stackGroups:X},G),Y)},g=(function(y){function x(S){var E,C,k;return eie(this,x),k=nie(this,x,[S]),qe(k,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),qe(k,"accessibilityManager",new $ae),qe(k,"handleLegendBBoxUpdate",function(A){if(A){var T=k.state,N=T.dataStartIndex,R=T.dataEndIndex,I=T.updateId;k.setState(fe({legendBBox:A},v({props:k.props,dataStartIndex:N,dataEndIndex:R,updateId:I},fe(fe({},k.state),{},{legendBBox:A}))))}}),qe(k,"handleReceiveSyncEvent",function(A,T,N){if(k.props.syncId===A){if(N===k.eventEmitterSymbol&&typeof k.props.syncMethod!="function")return;k.applySyncEvent(T)}}),qe(k,"handleBrushChange",function(A){var T=A.startIndex,N=A.endIndex;if(T!==k.state.dataStartIndex||N!==k.state.dataEndIndex){var R=k.state.updateId;k.setState(function(){return fe({dataStartIndex:T,dataEndIndex:N},v({props:k.props,dataStartIndex:T,dataEndIndex:N,updateId:R},k.state))}),k.triggerSyncEvent({dataStartIndex:T,dataEndIndex:N})}}),qe(k,"handleMouseEnter",function(A){var T=k.getMouseInfo(A);if(T){var N=fe(fe({},T),{},{isTooltipActive:!0});k.setState(N),k.triggerSyncEvent(N);var R=k.props.onMouseEnter;et(R)&&R(N,A)}}),qe(k,"triggeredAfterMouseMove",function(A){var T=k.getMouseInfo(A),N=T?fe(fe({},T),{},{isTooltipActive:!0}):{isTooltipActive:!1};k.setState(N),k.triggerSyncEvent(N);var R=k.props.onMouseMove;et(R)&&R(N,A)}),qe(k,"handleItemMouseEnter",function(A){k.setState(function(){return{isTooltipActive:!0,activeItem:A,activePayload:A.tooltipPayload,activeCoordinate:A.tooltipPosition||{x:A.cx,y:A.cy}}})}),qe(k,"handleItemMouseLeave",function(){k.setState(function(){return{isTooltipActive:!1}})}),qe(k,"handleMouseMove",function(A){A.persist(),k.throttleTriggeredAfterMouseMove(A)}),qe(k,"handleMouseLeave",function(A){k.throttleTriggeredAfterMouseMove.cancel();var T={isTooltipActive:!1};k.setState(T),k.triggerSyncEvent(T);var N=k.props.onMouseLeave;et(N)&&N(T,A)}),qe(k,"handleOuterEvent",function(A){var T=gV(A),N=qn(k.props,"".concat(T));if(T&&et(N)){var R,I;/.*touch.*/i.test(T)?I=k.getMouseInfo(A.changedTouches[0]):I=k.getMouseInfo(A),N((R=I)!==null&&R!==void 0?R:{},A)}}),qe(k,"handleClick",function(A){var T=k.getMouseInfo(A);if(T){var N=fe(fe({},T),{},{isTooltipActive:!0});k.setState(N),k.triggerSyncEvent(N);var R=k.props.onClick;et(R)&&R(N,A)}}),qe(k,"handleMouseDown",function(A){var T=k.props.onMouseDown;if(et(T)){var N=k.getMouseInfo(A);T(N,A)}}),qe(k,"handleMouseUp",function(A){var T=k.props.onMouseUp;if(et(T)){var N=k.getMouseInfo(A);T(N,A)}}),qe(k,"handleTouchMove",function(A){A.changedTouches!=null&&A.changedTouches.length>0&&k.throttleTriggeredAfterMouseMove(A.changedTouches[0])}),qe(k,"handleTouchStart",function(A){A.changedTouches!=null&&A.changedTouches.length>0&&k.handleMouseDown(A.changedTouches[0])}),qe(k,"handleTouchEnd",function(A){A.changedTouches!=null&&A.changedTouches.length>0&&k.handleMouseUp(A.changedTouches[0])}),qe(k,"handleDoubleClick",function(A){var T=k.props.onDoubleClick;if(et(T)){var N=k.getMouseInfo(A);T(N,A)}}),qe(k,"handleContextMenu",function(A){var T=k.props.onContextMenu;if(et(T)){var N=k.getMouseInfo(A);T(N,A)}}),qe(k,"triggerSyncEvent",function(A){k.props.syncId!==void 0&&Nw.emit(Rw,k.props.syncId,A,k.eventEmitterSymbol)}),qe(k,"applySyncEvent",function(A){var T=k.props,N=T.layout,R=T.syncMethod,I=k.state.updateId,D=A.dataStartIndex,j=A.dataEndIndex;if(A.dataStartIndex!==void 0||A.dataEndIndex!==void 0)k.setState(fe({dataStartIndex:D,dataEndIndex:j},v({props:k.props,dataStartIndex:D,dataEndIndex:j,updateId:I},k.state)));else if(A.activeTooltipIndex!==void 0){var $=A.chartX,W=A.chartY,q=A.activeTooltipIndex,X=k.state,Y=X.offset,z=X.tooltipTicks;if(!Y)return;if(typeof R=="function")q=R(z,A);else if(R==="value"){q=-1;for(var B=0;B<z.length;B++)if(z[B].value===A.activeLabel){q=B;break}}var G=fe(fe({},Y),{},{x:Y.left,y:Y.top}),L=Math.min($,G.x+G.width),K=Math.min(W,G.y+G.height),oe=z[q]&&z[q].value,he=W_(k.state,k.props.data,q),ge=z[q]?{x:N==="horizontal"?z[q].coordinate:L,y:N==="horizontal"?K:z[q].coordinate}:BF;k.setState(fe(fe({},A),{},{activeLabel:oe,activeCoordinate:ge,activePayload:he,activeTooltipIndex:q}))}else k.setState(A)}),qe(k,"renderCursor",function(A){var T,N=k.state,R=N.isTooltipActive,I=N.activeCoordinate,D=N.activePayload,j=N.offset,$=N.activeTooltipIndex,W=N.tooltipAxisBandSize,q=k.getTooltipEventType(),X=(T=A.props.active)!==null&&T!==void 0?T:R,Y=k.props.layout,z=A.key||"_recharts-cursor";return Z.createElement(Gae,{key:z,activeCoordinate:I,activePayload:D,activeTooltipIndex:$,chartName:r,element:A,isActive:X,layout:Y,offset:j,tooltipAxisBandSize:W,tooltipEventType:q})}),qe(k,"renderPolarAxis",function(A,T,N){var R=qn(A,"type.axisType"),I=qn(k.state,"".concat(R,"Map")),D=A.type.defaultProps,j=D!==void 0?fe(fe({},D),A.props):A.props,$=I&&I[j["".concat(R,"Id")]];return V.cloneElement(A,fe(fe({},$),{},{className:st(R,$.className),key:A.key||"".concat(T,"-").concat(N),ticks:oi($,!0)}))}),qe(k,"renderPolarGrid",function(A){var T=A.props,N=T.radialLines,R=T.polarAngles,I=T.polarRadius,D=k.state,j=D.radiusAxisMap,$=D.angleAxisMap,W=Yi(j),q=Yi($),X=q.cx,Y=q.cy,z=q.innerRadius,B=q.outerRadius;return V.cloneElement(A,{polarAngles:Array.isArray(R)?R:oi(q,!0).map(function(G){return G.coordinate}),polarRadius:Array.isArray(I)?I:oi(W,!0).map(function(G){return G.coordinate}),cx:X,cy:Y,innerRadius:z,outerRadius:B,key:A.key||"polar-grid",radialLines:N})}),qe(k,"renderLegend",function(){var A=k.state.formattedGraphicalItems,T=k.props,N=T.children,R=T.width,I=T.height,D=k.props.margin||{},j=R-(D.left||0)-(D.right||0),$=P3({children:N,formattedGraphicalItems:A,legendWidth:j,legendContent:l});if(!$)return null;var W=$.item,q=Dj($,Kae);return V.cloneElement(W,fe(fe({},q),{},{chartWidth:R,chartHeight:I,margin:D,onBBoxUpdate:k.handleLegendBBoxUpdate}))}),qe(k,"renderTooltip",function(){var A,T=k.props,N=T.children,R=T.accessibilityLayer,I=_n(N,ia);if(!I)return null;var D=k.state,j=D.isTooltipActive,$=D.activeCoordinate,W=D.activePayload,q=D.activeLabel,X=D.offset,Y=(A=I.props.active)!==null&&A!==void 0?A:j;return V.cloneElement(I,{viewBox:fe(fe({},X),{},{x:X.left,y:X.top}),active:Y,label:q,payload:Y?W:[],coordinate:$,accessibilityLayer:R})}),qe(k,"renderBrush",function(A){var T=k.props,N=T.margin,R=T.data,I=k.state,D=I.offset,j=I.dataStartIndex,$=I.dataEndIndex,W=I.updateId;return V.cloneElement(A,{key:A.key||"_recharts-brush",onChange:Fh(k.handleBrushChange,A.props.onChange),data:R,x:be(A.props.x)?A.props.x:D.left,y:be(A.props.y)?A.props.y:D.top+D.height+D.brushBottom-(N.bottom||0),width:be(A.props.width)?A.props.width:D.width,startIndex:j,endIndex:$,updateId:"brush-".concat(W)})}),qe(k,"renderReferenceElement",function(A,T,N){if(!A)return null;var R=k,I=R.clipPathId,D=k.state,j=D.xAxisMap,$=D.yAxisMap,W=D.offset,q=A.type.defaultProps||{},X=A.props,Y=X.xAxisId,z=Y===void 0?q.xAxisId:Y,B=X.yAxisId,G=B===void 0?q.yAxisId:B;return V.cloneElement(A,{key:A.key||"".concat(T,"-").concat(N),xAxis:j[z],yAxis:$[G],viewBox:{x:W.left,y:W.top,width:W.width,height:W.height},clipPathId:I})}),qe(k,"renderActivePoints",function(A){var T=A.item,N=A.activePoint,R=A.basePoint,I=A.childIndex,D=A.isRange,j=[],$=T.props.key,W=T.item.type.defaultProps!==void 0?fe(fe({},T.item.type.defaultProps),T.item.props):T.item.props,q=W.activeDot,X=W.dataKey,Y=fe(fe({index:I,dataKey:X,cx:N.x,cy:N.y,r:4,fill:dS(T.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value},rt(q,!1)),fp(q));return j.push(x.renderActiveDot(q,Y,"".concat($,"-activePoint-").concat(I))),R?j.push(x.renderActiveDot(q,fe(fe({},Y),{},{cx:R.x,cy:R.y}),"".concat($,"-basePoint-").concat(I))):D&&j.push(null),j}),qe(k,"renderGraphicChild",function(A,T,N){var R=k.filterFormatItem(A,T,N);if(!R)return null;var I=k.getTooltipEventType(),D=k.state,j=D.isTooltipActive,$=D.tooltipAxis,W=D.activeTooltipIndex,q=D.activeLabel,X=k.props.children,Y=_n(X,ia),z=R.props,B=z.points,G=z.isRange,L=z.baseLine,K=R.item.type.defaultProps!==void 0?fe(fe({},R.item.type.defaultProps),R.item.props):R.item.props,oe=K.activeDot,he=K.hide,ge=K.activeBar,xe=K.activeShape,ke=!!(!he&&j&&Y&&(oe||ge||xe)),we={};I!=="axis"&&Y&&Y.props.trigger==="click"?we={onClick:Fh(k.handleItemMouseEnter,A.props.onClick)}:I!=="axis"&&(we={onMouseLeave:Fh(k.handleItemMouseLeave,A.props.onMouseLeave),onMouseEnter:Fh(k.handleItemMouseEnter,A.props.onMouseEnter)});var ue=V.cloneElement(A,fe(fe({},R.props),we));function Se(Yt){return typeof $.dataKey=="function"?$.dataKey(Yt.payload):null}if(ke)if(W>=0){var _e,le;if($.dataKey&&!$.allowDuplicatedCategory){var $e=typeof $.dataKey=="function"?Se:"payload.".concat($.dataKey.toString());_e=cp(B,$e,q),le=G&&L&&cp(L,$e,q)}else _e=B?.[W],le=G&&L&&L[W];if(xe||ge){var Fe=A.props.activeIndex!==void 0?A.props.activeIndex:W;return[V.cloneElement(A,fe(fe(fe({},R.props),we),{},{activeIndex:Fe})),null,null]}if(!nt(_e))return[ue].concat(fl(k.renderActivePoints({item:R,activePoint:_e,basePoint:le,childIndex:W,isRange:G})))}else{var Xe,Ye=(Xe=k.getItemByXY(k.state.activeCoordinate))!==null&&Xe!==void 0?Xe:{graphicalItem:ue},mt=Ye.graphicalItem,Ut=mt.item,Pt=Ut===void 0?A:Ut,Er=mt.childIndex,Nt=fe(fe(fe({},R.props),we),{},{activeIndex:Er});return[V.cloneElement(Pt,Nt),null,null]}return G?[ue,null,null]:[ue,null]}),qe(k,"renderCustomized",function(A,T,N){return V.cloneElement(A,fe(fe({key:"recharts-customized-".concat(N)},k.props),k.state))}),qe(k,"renderMap",{CartesianGrid:{handler:Wh,once:!0},ReferenceArea:{handler:k.renderReferenceElement},ReferenceLine:{handler:Wh},ReferenceDot:{handler:k.renderReferenceElement},XAxis:{handler:Wh},YAxis:{handler:Wh},Brush:{handler:k.renderBrush,once:!0},Bar:{handler:k.renderGraphicChild},Line:{handler:k.renderGraphicChild},Area:{handler:k.renderGraphicChild},Radar:{handler:k.renderGraphicChild},RadialBar:{handler:k.renderGraphicChild},Scatter:{handler:k.renderGraphicChild},Pie:{handler:k.renderGraphicChild},Funnel:{handler:k.renderGraphicChild},Tooltip:{handler:k.renderCursor,once:!0},PolarGrid:{handler:k.renderPolarGrid,once:!0},PolarAngleAxis:{handler:k.renderPolarAxis},PolarRadiusAxis:{handler:k.renderPolarAxis},Customized:{handler:k.renderCustomized}}),k.clipPathId="".concat((E=S.id)!==null&&E!==void 0?E:_l("recharts"),"-clip"),k.throttleTriggeredAfterMouseMove=T4(k.triggeredAfterMouseMove,(C=S.throttleDelay)!==null&&C!==void 0?C:1e3/60),k.state={},k}return oie(x,y),rie(x,[{key:"componentDidMount",value:function(){var E,C;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(E=this.props.margin.left)!==null&&E!==void 0?E:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var E=this.props,C=E.children,k=E.data,A=E.height,T=E.layout,N=_n(C,ia);if(N){var R=N.props.defaultIndex;if(!(typeof R!="number"||R<0||R>this.state.tooltipTicks.length-1)){var I=this.state.tooltipTicks[R]&&this.state.tooltipTicks[R].value,D=W_(this.state,k,R,I),j=this.state.tooltipTicks[R].coordinate,$=(this.state.offset.top+A)/2,W=T==="horizontal",q=W?{x:j,y:$}:{y:j,x:$},X=this.state.formattedGraphicalItems.find(function(z){var B=z.item;return B.type.name==="Scatter"});X&&(q=fe(fe({},q),X.props.points[R].tooltipPosition),D=X.props.points[R].tooltipPayload);var Y={activeTooltipIndex:R,isTooltipActive:!0,activeLabel:I,activePayload:D,activeCoordinate:q};this.setState(Y),this.renderCursor(N),this.accessibilityManager.setIndex(R)}}}},{key:"getSnapshotBeforeUpdate",value:function(E,C){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==C.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==E.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==E.margin){var k,A;this.accessibilityManager.setDetails({offset:{left:(k=this.props.margin.left)!==null&&k!==void 0?k:0,top:(A=this.props.margin.top)!==null&&A!==void 0?A:0}})}return null}},{key:"componentDidUpdate",value:function(E){A1([_n(E.children,ia)],[_n(this.props.children,ia)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var E=_n(this.props.children,ia);if(E&&typeof E.props.shared=="boolean"){var C=E.props.shared?"axis":"item";return s.indexOf(C)>=0?C:i}return i}},{key:"getMouseInfo",value:function(E){if(!this.container)return null;var C=this.container,k=C.getBoundingClientRect(),A=a9(k),T={chartX:Math.round(E.pageX-A.left),chartY:Math.round(E.pageY-A.top)},N=k.width/C.offsetWidth||1,R=this.inRange(T.chartX,T.chartY,N);if(!R)return null;var I=this.state,D=I.xAxisMap,j=I.yAxisMap,$=this.getTooltipEventType(),W=Fj(this.state,this.props.data,this.props.layout,R);if($!=="axis"&&D&&j){var q=Yi(D).scale,X=Yi(j).scale,Y=q&&q.invert?q.invert(T.chartX):null,z=X&&X.invert?X.invert(T.chartY):null;return fe(fe({},T),{},{xValue:Y,yValue:z},W)}return W?fe(fe({},T),W):null}},{key:"inRange",value:function(E,C){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=this.props.layout,T=E/k,N=C/k;if(A==="horizontal"||A==="vertical"){var R=this.state.offset,I=T>=R.left&&T<=R.left+R.width&&N>=R.top&&N<=R.top+R.height;return I?{x:T,y:N}:null}var D=this.state,j=D.angleAxisMap,$=D.radiusAxisMap;if(j&&$){var W=Yi(j);return QR({x:T,y:N},W)}return null}},{key:"parseEventsOfWrapper",value:function(){var E=this.props.children,C=this.getTooltipEventType(),k=_n(E,ia),A={};k&&C==="axis"&&(k.props.trigger==="click"?A={onClick:this.handleClick}:A={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var T=fp(this.props,this.handleOuterEvent);return fe(fe({},T),A)}},{key:"addListener",value:function(){Nw.on(Rw,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Nw.removeListener(Rw,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(E,C,k){for(var A=this.state.formattedGraphicalItems,T=0,N=A.length;T<N;T++){var R=A[T];if(R.item===E||R.props.key===E.key||C===si(R.item.type)&&k===R.childIndex)return R}return null}},{key:"renderClipPath",value:function(){var E=this.clipPathId,C=this.state.offset,k=C.left,A=C.top,T=C.height,N=C.width;return Z.createElement("defs",null,Z.createElement("clipPath",{id:E},Z.createElement("rect",{x:k,y:A,height:T,width:N})))}},{key:"getXScales",value:function(){var E=this.state.xAxisMap;return E?Object.entries(E).reduce(function(C,k){var A=jj(k,2),T=A[0],N=A[1];return fe(fe({},C),{},qe({},T,N.scale))},{}):null}},{key:"getYScales",value:function(){var E=this.state.yAxisMap;return E?Object.entries(E).reduce(function(C,k){var A=jj(k,2),T=A[0],N=A[1];return fe(fe({},C),{},qe({},T,N.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(E){var C;return(C=this.state.xAxisMap)===null||C===void 0||(C=C[E])===null||C===void 0?void 0:C.scale}},{key:"getYScaleByAxisId",value:function(E){var C;return(C=this.state.yAxisMap)===null||C===void 0||(C=C[E])===null||C===void 0?void 0:C.scale}},{key:"getItemByXY",value:function(E){var C=this.state,k=C.formattedGraphicalItems,A=C.activeItem;if(k&&k.length)for(var T=0,N=k.length;T<N;T++){var R=k[T],I=R.props,D=R.item,j=D.type.defaultProps!==void 0?fe(fe({},D.type.defaultProps),D.props):D.props,$=si(D.type);if($==="Bar"){var W=(I.data||[]).find(function(z){return Cee(E,z)});if(W)return{graphicalItem:R,payload:W}}else if($==="RadialBar"){var q=(I.data||[]).find(function(z){return QR(E,z)});if(q)return{graphicalItem:R,payload:q}}else if(lm(R,A)||cm(R,A)||If(R,A)){var X=vte({graphicalItem:R,activeTooltipItem:A,itemData:j.data}),Y=j.activeIndex===void 0?X:j.activeIndex;return{graphicalItem:fe(fe({},R),{},{childIndex:Y}),payload:If(R,A)?j.data[X]:R.props.data[X]}}}return null}},{key:"render",value:function(){var E=this;if(!cT(this))return null;var C=this.props,k=C.children,A=C.className,T=C.width,N=C.height,R=C.style,I=C.compact,D=C.title,j=C.desc,$=Dj(C,Xae),W=rt($,!1);if(I)return Z.createElement(hj,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement(T1,Su({},W,{width:T,height:N,title:D,desc:j}),this.renderClipPath(),dT(k,this.renderMap)));if(this.props.accessibilityLayer){var q,X;W.tabIndex=(q=this.props.tabIndex)!==null&&q!==void 0?q:0,W.role=(X=this.props.role)!==null&&X!==void 0?X:"application",W.onKeyDown=function(z){E.accessibilityManager.keyboardEvent(z)},W.onFocus=function(){E.accessibilityManager.focus()}}var Y=this.parseEventsOfWrapper();return Z.createElement(hj,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement("div",Su({className:st("recharts-wrapper",A),style:fe({position:"relative",cursor:"default",width:T,height:N},R)},Y,{ref:function(B){E.container=B}}),Z.createElement(T1,Su({},W,{width:T,height:N,title:D,desc:j,style:die}),this.renderClipPath(),dT(k,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(V.Component);qe(g,"displayName",r),qe(g,"defaultProps",fe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),qe(g,"getDerivedStateFromProps",function(y,x){var S=y.dataKey,E=y.data,C=y.children,k=y.width,A=y.height,T=y.layout,N=y.stackOffset,R=y.margin,I=x.dataStartIndex,D=x.dataEndIndex;if(x.updateId===void 0){var j=Lj(y);return fe(fe(fe({},j),{},{updateId:0},v(fe(fe({props:y},j),{},{updateId:0}),x)),{},{prevDataKey:S,prevData:E,prevWidth:k,prevHeight:A,prevLayout:T,prevStackOffset:N,prevMargin:R,prevChildren:C})}if(S!==x.prevDataKey||E!==x.prevData||k!==x.prevWidth||A!==x.prevHeight||T!==x.prevLayout||N!==x.prevStackOffset||!Cu(R,x.prevMargin)){var $=Lj(y),W={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},q=fe(fe({},Fj(x,E,T)),{},{updateId:x.updateId+1}),X=fe(fe(fe({},$),W),q);return fe(fe(fe({},X),v(fe({props:y},X),x)),{},{prevDataKey:S,prevData:E,prevWidth:k,prevHeight:A,prevLayout:T,prevStackOffset:N,prevMargin:R,prevChildren:C})}if(!A1(C,x.prevChildren)){var Y,z,B,G,L=_n(C,el),K=L&&(Y=(z=L.props)===null||z===void 0?void 0:z.startIndex)!==null&&Y!==void 0?Y:I,oe=L&&(B=(G=L.props)===null||G===void 0?void 0:G.endIndex)!==null&&B!==void 0?B:D,he=K!==I||oe!==D,ge=!nt(E),xe=ge&&!he?x.updateId:x.updateId+1;return fe(fe({updateId:xe},v(fe(fe({props:y},x),{},{updateId:xe,dataStartIndex:K,dataEndIndex:oe}),x)),{},{prevChildren:C,dataStartIndex:K,dataEndIndex:oe})}return null}),qe(g,"renderActiveDot",function(y,x,S){var E;return V.isValidElement(y)?E=V.cloneElement(y,x):et(y)?E=y(x):E=Z.createElement(um,x),Z.createElement(Et,{className:"recharts-active-dot",key:S},E)});var b=V.forwardRef(function(x,S){return Z.createElement(g,Su({},x,{ref:S}))});return b.displayName=g.displayName,b},_ie=UF({chartName:"LineChart",GraphicalChild:nd,axisComponents:[{axisType:"xAxis",AxisComp:Ol},{axisType:"yAxis",AxisComp:Tl}],formatAxisMap:rF}),Sie=UF({chartName:"AreaChart",GraphicalChild:yo,axisComponents:[{axisType:"xAxis",AxisComp:Ol},{axisType:"yAxis",AxisComp:Tl}],formatAxisMap:rF});const Eie=[{month:"Jan",users:120},{month:"Feb",users:180},{month:"Mar",users:260},{month:"Apr",users:320},{month:"May",users:410}];function WF(){const[t]=tM(),e=t.get("tab")||"overview",[r,n]=V.useState({totalUsers:0,activeDevices:14,attendance:"94.3%"}),[a,i]=V.useState([]),[o,s]=V.useState([]),[u,l]=V.useState(!0);V.useEffect(()=>{f(),d(),p()},[]);const f=async()=>{try{const b=await(await fetch("http://localhost:5000/api/admin/stats")).json();b.totalUsers&&n(y=>({...y,totalUsers:b.totalUsers}))}catch(g){console.error("Failed to fetch stats:",g)}finally{l(!1)}},d=async()=>{try{const b=await(await fetch("http://localhost:5000/api/admin/departments")).json();b.departments&&i(b.departments)}catch(g){console.error("Failed to fetch departments:",g)}},p=async()=>{try{const b=await(await fetch("http://localhost:5000/api/admin/staff")).json();b.staff&&s(b.staff)}catch(g){console.error("Failed to fetch staff:",g)}},v=[{id:"overview",label:"Overview",icon:nf},{id:"users",label:"All Users",icon:uo},{id:"departments",label:"Departments",icon:Kf},{id:"manage-roles",label:"Manage Roles",icon:Bc},{id:"add-student",label:"Add Student/Class",icon:Uu},{id:"add-course",label:"Add Course",icon:os},{id:"timetable",label:"Timetable",icon:Bu},{id:"add-staff",label:"Add Staff",icon:bM},{id:"promote",label:"Promote Students",icon:Uu}];return w.jsxs("div",{className:"p-6 md:p-10 space-y-8 max-w-7xl mx-auto w-full",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:v.find(g=>g.id===e)?.label||"Dashboard"}),w.jsxs("p",{className:"text-slate-500 mt-1",children:[e==="overview"&&"Real-time overview of your campus operations.",e==="users"&&"Manage all students and staff members in one place.",e==="departments"&&"Organize and manage faculty departments.",e==="manage-roles"&&"Assign HOD and Principal roles to staff.",e==="add-student"&&"Manage departments, classes and student registration.",e==="add-course"&&"Define academic courses and subjects per department.",e==="timetable"&&"Construct and manage weekly schedules for classes.",e==="add-staff"&&"Onboard new faculty and administrative staff.",e==="promote"&&"Perform bulk semester promotion for students."]})]}),w.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500 ease-in-out",children:[e==="overview"&&w.jsx(Cie,{stats:r}),e==="users"&&w.jsx(kie,{}),e==="departments"&&w.jsx(Tie,{departments:a,onUpdate:d}),e==="manage-roles"&&w.jsx(Pie,{departments:a}),e==="add-student"&&w.jsx(Aie,{departments:a,staffList:o}),e==="add-course"&&w.jsx(Rie,{departments:a}),e==="timetable"&&w.jsx(Iie,{departments:a,staffList:o}),e==="add-staff"&&w.jsx(Oie,{departments:a}),e==="promote"&&w.jsx(Nie,{})]})]})}function Cie({stats:t}){return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[w.jsx(jw,{title:"Total Users",value:t.totalUsers,icon:uo,trend:"+12% from last month",color:"bg-blue-500"}),w.jsx(jw,{title:"Active Devices",value:t.activeDevices,icon:Bc,trend:"+2 new this week",color:"bg-emerald-500"}),w.jsx(jw,{title:"Avg. Attendance",value:t.attendance,icon:wM,trend:"Consistent",color:"bg-purple-500"})]}),w.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[w.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"User Growth"}),w.jsx("p",{className:"text-sm text-slate-500",children:"New joins over the last 5 months"})]}),w.jsx("button",{className:"text-sm font-medium text-primary-600 hover:text-primary-700",children:"View Report"})]}),w.jsx("div",{className:"h-80 w-full",children:w.jsx(P4,{width:"100%",height:"100%",children:w.jsxs(_ie,{data:Eie,children:[w.jsx(SS,{strokeDasharray:"3 3",vertical:!1,stroke:"#E2E8F0"}),w.jsx(Ol,{dataKey:"month",tickLine:!1,axisLine:!1,dy:10,tick:{fill:"#64748B",fontSize:12}}),w.jsx(Tl,{tickLine:!1,axisLine:!1,tick:{fill:"#64748B",fontSize:12}}),w.jsx(ia,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"},cursor:{stroke:"#cbd5e1"}}),w.jsx(nd,{type:"monotone",dataKey:"users",stroke:"#2563eb",strokeWidth:3,dot:{r:4,fill:"#2563eb",strokeWidth:2,stroke:"#fff"},activeDot:{r:6,strokeWidth:0}})]})})})]})]})}function jw({title:t,value:e,icon:r,trend:n,color:a}){return w.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white p-6 shadow-sm border border-slate-100 transition-all hover:shadow-md",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("div",{className:`rounded-xl p-3 ${a} bg-opacity-10`,children:w.jsx(r,{className:`h-6 w-6 ${a.replace("bg-","text-")}`})}),w.jsx("span",{className:"text-xs font-semibold text-slate-400 bg-slate-50 px-2 py-1 rounded-full",children:"30 Days"})]}),w.jsxs("div",{children:[w.jsx("div",{className:"text-3xl font-bold text-slate-900",children:e}),w.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:t})]}),w.jsx("div",{className:"mt-4 flex items-center text-xs text-emerald-600 font-medium",children:n})]})}function kie(){const[t,e]=V.useState([]),[r,n]=V.useState(!0),[a,i]=V.useState("");V.useEffect(()=>{o()},[]);const o=async()=>{try{const f=await(await fetch("http://localhost:5000/api/admin/users")).json();f.users&&e(f.users)}catch(l){console.error("Failed to fetch users:",l)}finally{n(!1)}},s=t.filter(l=>l.name.toLowerCase().includes(a.toLowerCase())||l.email.toLowerCase().includes(a.toLowerCase())||l.dept.toLowerCase().includes(a.toLowerCase())),u=async(l,f)=>{if(window.confirm(`Are you sure you want to remove ${f}? This will permanently delete their account.`))try{const d=await fetch(`http://localhost:5000/api/admin/users/${l}`,{method:"DELETE"});if(d.ok)alert("User removed successfully"),o();else{const p=await d.json();alert("Error: "+p.error)}}catch{alert("Failed to delete user")}};return r?w.jsx("div",{className:"text-center py-10 text-slate-500",children:"Loading users..."}):w.jsxs("div",{className:"space-y-6",children:[w.jsx("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:w.jsxs("div",{className:"relative max-w-md flex-1",children:[w.jsx(b2,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 h-5 w-5"}),w.jsx("input",{type:"text",placeholder:"Search users...",value:a,onChange:l=>i(l.target.value),className:"w-full pl-10 pr-4 py-2 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-primary-100 focus:border-primary-500 transition-all"})]})}),w.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:w.jsxs("table",{className:"w-full text-left text-sm",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 font-semibold",children:"Name"}),w.jsx("th",{className:"px-6 py-4 font-semibold",children:"Official ID"}),w.jsx("th",{className:"px-6 py-4 font-semibold",children:"Role"}),w.jsx("th",{className:"px-6 py-4 font-semibold",children:"Department"}),w.jsx("th",{className:"px-6 py-4 font-semibold",children:"Status"}),w.jsx("th",{className:"px-6 py-4 font-semibold text-right",children:"Actions"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:s.map(l=>w.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[w.jsx("td",{className:"px-6 py-4",children:w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"h-9 w-9 rounded-full bg-primary-100 text-primary-600 flex items-center justify-center font-bold text-xs",children:l.name.charAt(0)}),w.jsxs("div",{children:[w.jsx("div",{className:"font-medium text-slate-900",children:l.name}),w.jsx("div",{className:"text-xs text-slate-500",children:l.email})]})]})}),w.jsx("td",{className:"px-6 py-4",children:w.jsx("span",{className:"font-mono text-xs font-bold text-slate-600 bg-slate-100 px-2 py-1 rounded",children:l.officialId||"N/A"})}),w.jsx("td",{className:"px-6 py-4",children:w.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${l.role==="STUDENT"?"bg-blue-50 text-blue-700":"bg-purple-50 text-purple-700"}`,children:l.role})}),w.jsx("td",{className:"px-6 py-4 text-slate-600",children:l.dept}),w.jsx("td",{className:"px-6 py-4",children:w.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium ${l.status==="Active"?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[w.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${l.status==="Active"?"bg-emerald-500":"bg-slate-400"}`}),l.status]})}),w.jsx("td",{className:"px-6 py-4 text-right",children:w.jsxs("div",{className:"flex justify-end gap-2",children:[w.jsx("button",{onClick:()=>u(l.id,l.name),className:"text-red-400 hover:text-red-600 p-1.5 rounded-lg hover:bg-red-50 transition-colors",children:w.jsx(_M,{size:18})}),w.jsx("button",{className:"text-slate-400 hover:text-slate-600 p-1.5 rounded-lg hover:bg-slate-100 transition-colors",children:w.jsx(jq,{size:18})})]})})]},l.id))})]})})]})}function Aie({departments:t,staffList:e}){const[r,n]=V.useState("depts"),[a,i]=V.useState(null),[o,s]=V.useState(null),[u,l]=V.useState([]),[f,d]=V.useState([]),[p,v]=V.useState(!1),[g,b]=V.useState({email:"",name:"",dob:"",admissionNo:""}),y=async T=>{v(!0);try{const R=await(await fetch(`http://localhost:5000/api/admin/classes?departmentCode=${T}`)).json();l(R.classes||[])}catch(N){console.error(N)}finally{v(!1)}},x=async T=>{try{const R=await(await fetch(`http://localhost:5000/api/admin/classes/${T}/students`)).json();R.students&&d(R.students)}catch(N){console.error(N)}},S=async T=>{T.preventDefault();const N=T.currentTarget.classNameInput.value,R=T.currentTarget.tutorId.value,I=T.currentTarget.semester.value,D=T.currentTarget.batch.value;try{const j=await fetch("http://localhost:5000/api/admin/classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:N,department_code:a.code,tutor_id:R||null,semester:I,batch:D})});if(j.ok)alert("Class created successfully"),T.target.reset(),y(a.code);else{const $=await j.json();alert("Error: "+$.error)}}catch{alert("Failed to create class")}},E=async(T,N)=>{if(window.confirm(`Are you sure you want to delete class ${N}? All student enrollments for this class will be cleared.`))try{const R=await fetch(`http://localhost:5000/api/admin/classes/${T}`,{method:"DELETE"});if(R.ok)alert("Class deleted successfully"),y(a.code);else{const I=await R.json();alert("Error: "+I.error)}}catch{alert("Failed to delete class")}},C=async T=>{try{(await fetch(`http://localhost:5000/api/admin/classes/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...o,tutor_id:T||null})})).ok&&(alert("Tutor updated"),y(a.code))}catch{alert("Failed to update tutor")}},k=async(T,N)=>{if(window.confirm(`Remove ${N} from ${o.name}?`))try{(await fetch(`http://localhost:5000/api/admin/classes/students/${T}`,{method:"DELETE"})).ok&&(alert("Student removed"),x(o.id))}catch{alert("Failed to remove student")}},A=async T=>{T.preventDefault(),v(!0);try{const N=await fetch("http://localhost:5000/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:g.email,name:g.name,role:"STUDENT",metadata:{departmentCode:a.code,class_id:o.id,dob:g.dob,semester:g.semester||o.semester,admissionNo:g.admissionNo}})});if(N.ok)alert("Student added successfully"),b({...g,email:"",name:"",dob:"",admissionNo:"",semester:""}),x(o.id);else{const R=await N.json();alert("Error: "+R.error)}}catch{alert("Failed to add student")}finally{v(!1)}};if(r==="depts")return w.jsx("div",{className:"space-y-6",children:w.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:t.map(T=>w.jsxs("div",{onClick:()=>{i(T),y(T.code),n("classes")},className:"group cursor-pointer rounded-2xl border border-slate-200 bg-white p-6 shadow-sm hover:border-primary-500 hover:shadow-md transition-all text-center",children:[w.jsx("div",{className:"mx-auto h-16 w-16 rounded-2xl bg-primary-50 text-primary-600 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:w.jsx(Kf,{size:32})}),w.jsx("h3",{className:"font-bold text-slate-900",children:T.name}),w.jsx("p",{className:"text-xs text-slate-500 mt-1 uppercase font-semibold",children:T.code})]},T.id))})});if(r==="classes")return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-4",children:[w.jsx("button",{onClick:()=>n("depts"),className:"hover:text-primary-600",children:"Departments"}),w.jsx(Qi,{size:14}),w.jsx("span",{className:"font-bold text-slate-900",children:a.name})]}),w.jsxs("div",{className:"grid gap-8 lg:grid-cols-2",children:[w.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[w.jsx("h3",{className:"mb-6 text-xl font-bold text-slate-900",children:"Create New Class"}),w.jsxs("form",{onSubmit:S,className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Class Name"}),w.jsx("input",{name:"classNameInput",required:!0,className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-primary-500",placeholder:"e.g. CS S7 A batch"})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Semester"}),w.jsx("select",{name:"semester",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none",children:[1,2,3,4,5,6,7,8].map(T=>w.jsxs("option",{value:T,children:["S",T]},T))})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Batch"}),w.jsx("input",{name:"batch",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none",placeholder:"e.g. A",defaultValue:"A"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Assigned Tutor"}),w.jsxs("select",{name:"tutorId",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none bg-white",children:[w.jsx("option",{value:"",children:"Select a Tutor"}),e.map(T=>w.jsx("option",{value:T.id,children:T.name},T.id))]})]}),w.jsx("button",{type:"submit",className:"w-full rounded-xl bg-slate-900 py-3 text-sm font-bold text-white hover:bg-slate-800",children:"Create Class"})]})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Existing Classes"}),w.jsxs("div",{className:"grid gap-4",children:[u.map(T=>w.jsxs("div",{className:"group flex items-center justify-between p-4 rounded-xl border border-slate-100 bg-slate-50 hover:border-primary-400 transition-all",children:[w.jsxs("div",{onClick:()=>{s(T),x(T.id),n("management")},className:"flex-1 cursor-pointer",children:[w.jsxs("div",{className:"font-bold text-slate-900",children:["S",T.semester," - ",T.name]}),w.jsxs("div",{className:"text-xs text-slate-500",children:["Tutor: ",T.tutor?.full_name||"Not assigned"]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("button",{onClick:N=>{N.stopPropagation(),E(T.id,T.name)},className:"p-2 text-slate-400 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",children:w.jsx(tO,{size:18})}),w.jsx(Qi,{size:18,className:"text-slate-400"})]})]},T.id)),u.length===0&&w.jsx("p",{className:"text-center py-10 text-slate-400 italic",children:"No classes found in this department."})]})]})]})]});if(r==="management")return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-4",children:[w.jsx("button",{onClick:()=>n("depts"),className:"hover:text-primary-600",children:"Departments"}),w.jsx(Qi,{size:14}),w.jsx("button",{onClick:()=>n("classes"),className:"hover:text-primary-600",children:a.name}),w.jsx(Qi,{size:14}),w.jsx("span",{className:"font-bold text-slate-900",children:o.name})]}),w.jsxs("div",{className:"grid gap-8 lg:grid-cols-3",children:[w.jsxs("div",{className:"col-span-1 space-y-6",children:[w.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[w.jsx("h3",{className:"mb-4 text-lg font-bold text-slate-900",children:"Class Details"}),w.jsx("div",{className:"space-y-4",children:w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-semibold text-slate-400 uppercase mb-1",children:"Assigned Tutor"}),w.jsxs("select",{value:o.tutor_id||"",onChange:T=>C(T.target.value),className:"w-full rounded-xl border border-slate-200 px-3 py-2 text-sm outline-none bg-slate-50",children:[w.jsx("option",{value:"",children:"No Tutor"}),e.map(T=>w.jsx("option",{value:T.id,children:T.name},T.id))]})]})})]}),w.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[w.jsx("h3",{className:"mb-4 text-lg font-bold text-slate-900",children:"Add Student"}),w.jsxs("form",{onSubmit:A,className:"space-y-4",children:[w.jsx("input",{required:!0,value:g.name,onChange:T=>b({...g,name:T.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none",placeholder:"Full Name"}),w.jsx("input",{required:!0,value:g.admissionNo,onChange:T=>b({...g,admissionNo:T.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none",placeholder:"Admission Number"}),w.jsx("input",{type:"email",required:!0,value:g.email,onChange:T=>b({...g,email:T.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none",placeholder:"Email"}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsx("input",{type:"date",required:!0,value:g.dob,onChange:T=>b({...g,dob:T.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none"}),w.jsx("input",{type:"number",min:"1",max:"8",placeholder:"Sem (Opt)",value:g.semester||"",onChange:T=>b({...g,semester:T.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none",title:"Override default class semester if needed"})]}),w.jsx("button",{type:"submit",disabled:p,className:"w-full rounded-xl bg-primary-600 py-3 text-sm font-bold text-white hover:bg-primary-700",children:"Add Student"})]})]})]}),w.jsxs("div",{className:"col-span-1 lg:col-span-2 rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:[w.jsx("div",{className:"p-6 border-b border-slate-100 flex items-center justify-between",children:w.jsxs("h3",{className:"text-lg font-bold text-slate-900",children:["Enrolled Students (",f.length,")"]})}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-left text-sm",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 font-semibold",children:"Name"}),w.jsx("th",{className:"px-6 py-4 font-semibold",children:"Admission #"}),w.jsx("th",{className:"px-6 py-4 font-semibold text-right",children:"Actions"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[f.map(T=>w.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[w.jsxs("td",{className:"px-6 py-4",children:[w.jsx("div",{className:"font-medium text-slate-900",children:T.name}),w.jsx("div",{className:"text-xs text-slate-500",children:T.email})]}),w.jsx("td",{className:"px-6 py-4 font-mono text-xs",children:T.admission_number}),w.jsx("td",{className:"px-6 py-4 text-right",children:w.jsx("button",{onClick:()=>k(T.id,T.name),className:"text-red-400 hover:text-red-600 p-2 rounded-lg hover:bg-red-50 transition-colors",children:w.jsx(tO,{size:16})})})]},T.id)),f.length===0&&w.jsx("tr",{children:w.jsx("td",{colSpan:"3",className:"px-6 py-10 text-center text-slate-400 italic",children:"No students enrolled in this class."})})]})]})})]})]})]})}function Oie({departments:t}){const[e,r]=V.useState(!1),[n,a]=V.useState({email:"",name:"",departmentCode:t[0]?.code||"",role:"LECTURER",dob:"",employeeId:""});V.useEffect(()=>{t.length>0&&!n.departmentCode&&a(o=>({...o,departmentCode:t[0].code}))},[t]);const i=async o=>{o.preventDefault(),r(!0);try{if(!(await fetch("http://localhost:5000/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.email,name:n.name,role:n.role,metadata:{departmentCode:n.departmentCode,dob:n.dob,employeeId:n.employeeId}})})).ok)throw new Error("Failed to add staff");alert("Staff added successfully!"),a({...n,email:"",name:"",dob:"",employeeId:""})}catch(s){alert("Error: "+s.message)}finally{r(!1)}};return w.jsx("div",{className:"grid gap-8 lg:grid-cols-2",children:w.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[w.jsx("h3",{className:"mb-6 text-xl font-bold text-slate-900",children:"Add New Staff Member"}),w.jsxs("form",{onSubmit:i,className:"space-y-5",children:[w.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-2",children:[w.jsxs("div",{className:"col-span-1 md:col-span-2",children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Full Name"}),w.jsx("input",{type:"text",required:!0,className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-primary-500",value:n.name,onChange:o=>a({...n,name:o.target.value}),placeholder:"e.g. Dr. Sarah Connor"})]}),w.jsxs("div",{className:"col-span-1 md:col-span-2",children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Staff Employee ID"}),w.jsx("input",{type:"text",required:!0,className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-primary-500",value:n.employeeId,onChange:o=>a({...n,employeeId:o.target.value}),placeholder:"e.g. EMP123"})]}),w.jsxs("div",{className:"col-span-1 md:col-span-2",children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Date of Birth"}),w.jsxs("div",{className:"relative",children:[w.jsx(Bu,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 h-4 w-4"}),w.jsx("input",{type:"date",required:!0,className:"w-full rounded-xl border border-slate-200 pl-10 pr-4 py-2.5 text-sm outline-none focus:border-primary-500",value:n.dob,onChange:o=>a({...n,dob:o.target.value})})]})]}),w.jsxs("div",{className:"col-span-1 md:col-span-2",children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Email Address"}),w.jsx("input",{type:"email",required:!0,className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-primary-500",value:n.email,onChange:o=>a({...n,email:o.target.value}),placeholder:"staff@college.edu"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Department"}),w.jsx("select",{className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none",value:n.departmentCode,onChange:o=>a({...n,departmentCode:o.target.value}),children:t.map(o=>w.jsx("option",{value:o.code,children:o.name},o.id))})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Designation"}),w.jsxs("select",{className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none",value:n.role,onChange:o=>a({...n,role:o.target.value}),children:[w.jsx("option",{value:"LECTURER",children:"Lecturer"}),w.jsx("option",{value:"ASST_PROF",children:"Asst. Professor"}),w.jsx("option",{value:"HOD",children:"HOD"}),w.jsx("option",{value:"PRINCIPAL",children:"Principal"})]})]})]}),w.jsx("button",{type:"submit",disabled:e,className:"w-full rounded-xl bg-slate-900 py-3 text-sm font-bold text-white disabled:opacity-70",children:e?"Processing...":"Add Staff Member"})]})]})})}function Tie({departments:t,onUpdate:e}){const[r,n]=V.useState(!1),[a,i]=V.useState(!1),[o,s]=V.useState({name:"",code:""}),u=async f=>{f.preventDefault(),n(!0);try{(await fetch("http://localhost:5000/api/admin/departments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok&&(e(),i(!1),s({name:"",code:""}))}catch(d){console.error(d)}finally{n(!1)}},l=async(f,d)=>{if(window.confirm(`Delete department ${d}? This will remove all linked data.`))try{await fetch(`http://localhost:5000/api/admin/departments/${f}`,{method:"DELETE"}),e()}catch(p){console.error(p)}};return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Manage Departments"}),w.jsxs("button",{onClick:()=>i(!a),className:"flex items-center gap-2 rounded-xl bg-primary-600 px-4 py-2 text-sm font-bold text-white shadow-lg shadow-primary-200 transition-all hover:bg-primary-700",children:[w.jsx(EM,{size:18}),a?"Cancel":"Add Department"]})]}),a&&w.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm animate-in fade-in slide-in-from-top-4",children:w.jsxs("form",{onSubmit:u,className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Department Name"}),w.jsx("input",{required:!0,value:o.name,onChange:f=>s({...o,name:f.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-primary-500",placeholder:"e.g. Mechanical Engineering"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Code"}),w.jsx("input",{required:!0,value:o.code,onChange:f=>s({...o,code:f.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-primary-500",placeholder:"e.g. ME"})]}),w.jsx("button",{type:"submit",disabled:r,className:"rounded-xl bg-slate-900 py-2.5 text-sm font-bold text-white hover:bg-slate-800 disabled:opacity-70",children:r?"Creating...":"Create Department"})]})}),w.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:t.map(f=>w.jsxs("div",{className:"group relative rounded-2xl border border-slate-200 bg-white p-6 shadow-sm hover:border-primary-500 hover:shadow-md transition-all",children:[w.jsx("button",{onClick:()=>l(f.id,f.name),className:"absolute top-4 right-4 text-slate-300 hover:text-red-500 transition-colors",children:w.jsx(_M,{size:18})}),w.jsx("div",{className:"mx-auto h-16 w-16 rounded-2xl bg-slate-50 text-slate-600 flex items-center justify-center mb-4",children:w.jsx(Kf,{size:32})}),w.jsx("h3",{className:"font-bold text-slate-900 text-center",children:f.name}),w.jsx("p",{className:"text-xs text-slate-500 mt-1 uppercase font-semibold text-center",children:f.code})]},f.id))})]})}function Pie({departments:t}){const[e,r]=V.useState(!1),[n,a]=V.useState({userId:"",role:"HOD",departmentCode:""}),[i,o]=V.useState([]);V.useEffect(()=>{s()},[]);const s=async()=>{try{const f=await(await fetch("http://localhost:5000/api/admin/staff")).json();o(f.staff||[])}catch(l){console.error(l)}},u=async l=>{if(l.preventDefault(),!n.userId)return alert("Select a staff member");r(!0);try{(await fetch("http://localhost:5000/api/admin/assign-role",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok&&alert("Role assigned successfully")}catch(f){console.error(f)}finally{r(!1)}};return w.jsxs("div",{className:"max-w-2xl mx-auto rounded-2xl border border-slate-200 bg-white p-8 shadow-sm",children:[w.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-6 text-center",children:"Assign Administrative Roles"}),w.jsxs("form",{onSubmit:u,className:"space-y-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select Staff Member"}),w.jsxs("select",{value:n.userId,onChange:l=>a({...n,userId:l.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-3 text-sm outline-none focus:border-primary-500 bg-slate-50",children:[w.jsx("option",{value:"",children:"Select Staff"}),i.map(l=>w.jsx("option",{value:l.id,children:l.name},l.id))]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Role"}),w.jsxs("select",{value:n.role,onChange:l=>a({...n,role:l.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-3 text-sm outline-none focus:border-primary-500 bg-slate-50",children:[w.jsx("option",{value:"HOD",children:"Department Head (HOD)"}),w.jsx("option",{value:"PRINCIPAL",children:"College Principal"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Target Department"}),w.jsxs("select",{disabled:n.role==="PRINCIPAL",value:n.departmentCode,onChange:l=>a({...n,departmentCode:l.target.value}),className:"w-full rounded-xl border border-slate-200 px-4 py-3 text-sm outline-none focus:border-primary-500 bg-slate-50 disabled:opacity-50",children:[w.jsx("option",{value:"",children:"Select Dept (for HOD)"}),t.map(l=>w.jsx("option",{value:l.code,children:l.name},l.id))]})]})]}),w.jsx("button",{type:"submit",disabled:e,className:"w-full rounded-xl bg-slate-900 py-4 text-sm font-bold text-white hover:bg-slate-800 shadow-xl shadow-slate-200 transition-all active:scale-[0.98]",children:e?"Processing...":"Assign Role & Grant Permissions"})]})]})}function Nie(){const[t,e]=V.useState(!1),[r,n]=V.useState(null),a=async()=>{if(window.confirm("CRITICAL: This will promote every student to the next semester and graduate S8 students. This cannot be undone. Proceed?")){e(!0);try{const o=await(await fetch("http://localhost:5000/api/admin/promote",{method:"POST"})).json();n(o)}catch(i){alert("Promotion failed: "+i.message)}finally{e(!1)}}};return w.jsxs("div",{className:"max-w-3xl mx-auto text-center space-y-8 py-10",children:[w.jsx("div",{className:"mx-auto h-24 w-24 rounded-3xl bg-amber-50 text-amber-600 flex items-center justify-center shadow-inner",children:w.jsx(os,{size:48})}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:"Academic Year Promotion"}),w.jsx("p",{className:"max-w-md mx-auto text-slate-500 mt-2",children:"Bulk promote all students to the next semester. Students in S8 will be automatically graduated and archived."})]}),w.jsx("button",{onClick:a,disabled:t,className:"px-8 py-4 rounded-2xl bg-slate-900 text-white font-bold text-lg shadow-2xl shadow-slate-200 hover:bg-slate-800 transition-all active:scale-95 disabled:opacity-70",children:t?"Processing Promotion...":"Start Promotion Process"}),r&&w.jsxs("div",{className:"p-6 rounded-2xl bg-emerald-50 border border-emerald-100 text-emerald-800 animate-in fade-in duration-500",children:[w.jsx("h4",{className:"font-bold text-lg mb-2",children:"Promotion Successful!"}),w.jsxs("p",{className:"text-sm",children:["Classes Updated: ",w.jsx("span",{className:"font-bold",children:r.promotedClasses})]}),w.jsxs("p",{className:"text-sm",children:["Students Graduated: ",w.jsx("span",{className:"font-bold",children:r.graduatedStudents})]})]})]})}function Rie({departments:t}){const[e,r]=V.useState([]),[n,a]=V.useState(!1),[i,o]=V.useState({code:"",name:"",department:t[0]?.code||"",semester:""}),[s,u]=V.useState(null),[l,f]=V.useState({name:"",semester:""});V.useEffect(()=>{d()},[]);const d=async()=>{try{const S=await(await fetch("http://localhost:5000/api/admin/subjects")).json();r(S.subjects||[])}catch(x){console.error(x)}},p=async x=>{x.preventDefault(),a(!0);try{(await fetch("http://localhost:5000/api/admin/subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok&&(alert("Course added"),o({...i,code:"",name:"",semester:""}),d())}catch{alert("Failed to add course")}finally{a(!1)}},v=async x=>{if(window.confirm("Delete this course?"))try{await fetch(`http://localhost:5000/api/admin/subjects/${x}`,{method:"DELETE"}),d()}catch(S){console.error(S)}},g=x=>{u(x.id),f({name:x.name,semester:x.semester||""})},b=()=>{u(null),f({name:"",semester:""})},y=async x=>{try{(await fetch(`http://localhost:5000/api/admin/subjects/${x}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).ok?(alert("Updated successfully"),u(null),d()):alert("Update failed")}catch{alert("Update failed")}};return w.jsxs("div",{className:"space-y-8",children:[w.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-8 shadow-sm max-w-2xl mx-auto",children:[w.jsx("h3",{className:"text-xl font-bold mb-6",children:"Add New Course"}),w.jsxs("form",{onSubmit:p,className:"space-y-4",children:[w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsx("input",{required:!0,placeholder:"Course Code (e.g. CS301)",className:"p-3 rounded-xl border border-slate-200 outline-none focus:border-primary-500",value:i.code,onChange:x=>o({...i,code:x.target.value})}),w.jsx("input",{required:!0,placeholder:"Course Name",className:"p-3 rounded-xl border border-slate-200 outline-none focus:border-primary-500",value:i.name,onChange:x=>o({...i,name:x.target.value})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsx("select",{className:"p-3 rounded-xl border border-slate-200 outline-none",value:i.department,onChange:x=>o({...i,department:x.target.value}),children:t.map(x=>w.jsx("option",{value:x.code,children:x.name},x.id))}),w.jsx("input",{type:"number",placeholder:"Semester (Optional)",className:"p-3 rounded-xl border border-slate-200 outline-none focus:border-primary-500",value:i.semester,onChange:x=>o({...i,semester:x.target.value})})]}),w.jsx("button",{disabled:n,className:"w-full py-3 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800",children:"Add Course"})]})]}),w.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:w.jsxs("table",{className:"w-full text-left text-sm",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 font-semibold uppercase text-xs",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4",children:"Code"}),w.jsx("th",{className:"px-6 py-4",children:"Name"}),w.jsx("th",{className:"px-6 py-4",children:"Dept"}),w.jsx("th",{className:"px-6 py-4",children:"Sem"}),w.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:e.map(x=>w.jsxs("tr",{className:"hover:bg-slate-50",children:[w.jsx("td",{className:"px-6 py-4 font-bold",children:x.code}),w.jsx("td",{className:"px-6 py-4",children:s===x.id?w.jsx("input",{value:l.name,onChange:S=>f({...l,name:S.target.value}),className:"w-full p-1 border rounded"}):x.name}),w.jsx("td",{className:"px-6 py-4 text-xs font-semibold",children:x.department}),w.jsx("td",{className:"px-6 py-4 text-xs font-semibold",children:s===x.id?w.jsx("input",{type:"number",value:l.semester,onChange:S=>f({...l,semester:S.target.value}),className:"w-16 p-1 border rounded"}):x.semester||"NA"}),w.jsx("td",{className:"px-6 py-4 text-right",children:s===x.id?w.jsxs("div",{className:"flex justify-end gap-2",children:[w.jsx("button",{onClick:()=>y(x.id),className:"text-emerald-600 font-bold hover:underline",children:"Save"}),w.jsx("button",{onClick:b,className:"text-slate-400 hover:text-slate-600",children:"Cancel"})]}):w.jsxs("div",{className:"flex justify-end gap-2",children:[w.jsx("button",{onClick:()=>g(x),className:"text-blue-500 hover:text-blue-700 font-medium",children:"Edit"}),w.jsx("button",{onClick:()=>v(x.id),className:"text-red-400 hover:text-red-600",children:"Delete"})]})})]},x.id))})]})})]})}function Iie({departments:t,staffList:e}){const[r,n]=V.useState("depts"),[a,i]=V.useState(null),[o,s]=V.useState(null),[u,l]=V.useState([]),[f,d]=V.useState({}),[p,v]=V.useState([]),[g,b]=V.useState(null),y=["Monday","Tuesday","Wednesday","Thursday","Friday"],x=[{id:1,time:"09:10 - 10:10"},{id:2,time:"10:10 - 11:10"},{id:"break1",label:"Break",duration:"10m"},{id:3,time:"11:20 - 12:20"},{id:"lunch",label:"Lunch",duration:"40m"},{id:4,time:"13:00 - 14:00"},{id:5,time:"14:00 - 15:00"},{id:"break2",label:"Break",duration:"10m"},{id:6,time:"15:10 - 16:00"}],S=async T=>{const R=await(await fetch(`http://localhost:5000/api/admin/classes?departmentCode=${T}`)).json();l(R.classes||[])},E=async T=>{const R=await(await fetch(`http://localhost:5000/api/admin/timetable?classId=${T}`)).json(),I={};(R.timetable||[]).forEach(D=>{I[`${D.day_of_week}-${D.period}`]=D}),d(I)},C=async T=>{const R=await(await fetch(`http://localhost:5000/api/admin/subjects?departmentCode=${T}`)).json();v(R.subjects||[])},k=async(T,N)=>{if(g)try{(await fetch("http://localhost:5000/api/admin/timetable",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({class_id:o.id,day_of_week:g.day,period:g.period,subject_id:T,staff_id:N})})).ok&&(E(o.id),b(null))}catch{alert("Update failed")}},A=async()=>{window.confirm("Reset entire timetable for this class?")&&(await fetch(`http://localhost:5000/api/admin/timetable/${o.id}`,{method:"DELETE"}),E(o.id))};return r==="depts"?w.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:t.map(T=>w.jsxs("div",{onClick:()=>{i(T),S(T.code),n("classes")},className:"cursor-pointer rounded-2xl border border-slate-200 bg-white p-8 shadow-sm hover:border-primary-500 transition-all text-center group",children:[w.jsx(Kf,{size:40,className:"mx-auto mb-4 text-slate-400 group-hover:text-primary-500"}),w.jsx("h3",{className:"font-bold text-slate-900",children:T.name}),w.jsx("p",{className:"text-xs text-slate-500 mt-2",children:T.code})]},T.id))}):r==="classes"?w.jsxs("div",{className:"space-y-6",children:[w.jsxs("button",{onClick:()=>n("depts"),className:"flex items-center gap-2 text-primary-600 font-bold",children:[w.jsx(Qi,{className:"rotate-180",size:18})," Back to Departments"]}),w.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:u.map(T=>w.jsxs("div",{onClick:()=>{s(T),E(T.id),C(a.code),n("grid")},className:"cursor-pointer p-6 rounded-2xl border border-slate-200 bg-white shadow-sm hover:shadow-md transition-all",children:[w.jsxs("div",{className:"font-bold",children:["S",T.semester," - ",T.name]}),w.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Class Timetable"})]},T.id))})]}):w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsxs("button",{onClick:()=>n("classes"),className:"flex items-center gap-2 text-primary-600 font-bold",children:[w.jsx(Qi,{className:"rotate-180",size:18})," Back to Classes"]}),w.jsxs("div",{className:"flex gap-4",children:[w.jsx("button",{onClick:A,className:"px-4 py-2 rounded-xl border border-red-200 text-red-600 font-bold text-sm hover:bg-red-50",children:"Reset Timetable"}),w.jsx("button",{className:"px-6 py-2 rounded-xl bg-slate-900 text-white font-bold text-sm shadow-xl shadow-slate-200",children:"Save Changes"})]})]}),w.jsx("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-xl overflow-hidden",children:w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full border-collapse",children:[w.jsx("thead",{children:w.jsxs("tr",{className:"bg-slate-900 text-white",children:[w.jsx("th",{className:"px-4 py-6 text-left font-bold uppercase text-xs tracking-wider border-r border-slate-800",children:"Day / Period"}),x.map((T,N)=>w.jsx("th",{className:`px-4 py-6 text-center text-xs font-bold uppercase tracking-wider ${T.label?"bg-slate-800/50 w-20":""}`,children:T.time||T.label},N))]})}),w.jsx("tbody",{children:y.map((T,N)=>w.jsxs("tr",{className:"border-b border-slate-100",children:[w.jsx("td",{className:"px-4 py-8 bg-slate-50 font-bold text-slate-900 border-r border-slate-200",children:T}),x.map((R,I)=>{if(R.label)return w.jsx("td",{className:"bg-slate-50/50 text-center text-[10px] font-bold text-slate-400 uppercase tracking-widest px-2",children:R.label},I);const D=f[`${N}-${R.id}`];return w.jsx("td",{className:"p-2 border-r border-slate-100 min-w-[160px]",children:w.jsx("div",{onClick:()=>b({day:N,period:R.id}),className:`h-full min-h-[100px] rounded-2xl border-2 border-dashed flex flex-col items-center justify-center p-3 transition-all cursor-pointer ${D?"border-primary-100 bg-primary-50/30":"border-slate-100 hover:border-primary-200 hover:bg-slate-50"}`,children:D?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"font-bold text-slate-900 text-sm text-center",children:D.subject?.name}),w.jsx("div",{className:"text-xs text-primary-600 font-bold mt-1 bg-white px-2 py-0.5 rounded-full shadow-sm",children:D.staff?.full_name}),w.jsx("div",{className:"text-[10px] text-slate-400 font-medium mt-2 uppercase tracking-tighter",children:D.subject?.code})]}):w.jsx(EM,{size:20,className:"text-slate-300"})})},I)})]},N))})]})})}),g&&w.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:w.jsxs("div",{className:"bg-white rounded-3xl p-8 w-full max-w-md shadow-2xl animate-in zoom-in-95 duration-200",children:[w.jsx("h4",{className:"text-xl font-bold mb-6 text-slate-900",children:"Assign Slot"}),w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Subject"}),w.jsxs("select",{id:"subSelect",className:"w-full p-4 rounded-2xl bg-slate-50 border-none outline-none focus:ring-2 focus:ring-primary-500 font-medium",children:[w.jsx("option",{value:"",children:"Select Subject"}),p.map(T=>w.jsxs("option",{value:T.id,children:[T.code," - ",T.name]},T.id))]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Lecturer"}),w.jsxs("select",{id:"staffSelect",className:"w-full p-4 rounded-2xl bg-slate-50 border-none outline-none focus:ring-2 focus:ring-primary-500 font-medium",children:[w.jsx("option",{value:"",children:"Select Lecturer"}),e.filter(T=>T.deptCode===a.code).map(T=>w.jsx("option",{value:T.id,children:T.name},T.id))]})]}),w.jsxs("div",{className:"flex gap-4 pt-4",children:[w.jsx("button",{onClick:()=>b(null),className:"flex-1 py-4 font-bold text-slate-500 rounded-2xl hover:bg-slate-50",children:"Cancel"}),w.jsx("button",{onClick:()=>k(document.getElementById("subSelect").value,document.getElementById("staffSelect").value),className:"flex-1 py-4 bg-slate-900 text-white font-bold rounded-2xl shadow-xl shadow-slate-200 hover:bg-slate-800",children:"Assign"})]})]})]})})]})}const jie=["Monday","Tuesday","Wednesday","Thursday","Friday"],$j=[1,2,3,4,5,6],Die=[{day:"Mon",attendance:93},{day:"Tue",attendance:95},{day:"Wed",attendance:91},{day:"Thu",attendance:96},{day:"Fri",attendance:94}];function Mie(){const{user:t,roles:e}=ha(),r=ps(),[n,a]=V.useState({tutorship:null,timetable:[],students:[]}),[i,o]=V.useState(!0),[s,u]=V.useState(null),[l,f]=V.useState(""),d=e[0],p=e.includes("HOD")||e.includes("PRINCIPAL");V.useEffect(()=>{v()},[t]);const v=async()=>{try{o(!0);const y=await fetch(`http://localhost:5000/api/admin/staff-dashboard-data?staffId=${t.id}`);if(!y.ok)throw new Error("Failed to fetch dashboard data");const x=await y.json();a(x)}catch(y){u(y.message)}finally{o(!1)}},g=(y,x)=>n.timetable.find(S=>S.day_of_week===y&&S.period===x),b=n.students.filter(y=>y.name?.toLowerCase().includes(l.toLowerCase())||y.admission?.toLowerCase().includes(l.toLowerCase()));return i?w.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:w.jsxs("div",{className:"flex flex-col items-center gap-3",children:[w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-slate-200 border-t-primary-600"}),w.jsx("p",{className:"text-sm font-medium text-slate-500 font-sans",children:"Syncing your workspace..."})]})}):w.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 font-sans",children:[w.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[w.jsxs("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:["Welcome back, ",t?.user_metadata?.full_name||"Faculty Member"]}),w.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold uppercase tracking-wider border ${p?"bg-indigo-50 text-indigo-700 border-indigo-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,children:d})]}),w.jsxs("p",{className:"text-sm text-slate-500 flex items-center gap-2 font-medium",children:[w.jsx(Bu,{size:14,className:"text-primary-500"}),new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})]}),p&&w.jsx("div",{className:"flex items-center gap-3",children:w.jsxs("div",{className:"text-right hidden sm:block",children:[w.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Department Status"}),w.jsxs("div",{className:"text-sm font-bold text-emerald-600 flex items-center justify-end gap-1",children:[w.jsx(lp,{size:14})," 94% Capacity"]})]})})]}),p&&w.jsx("section",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Classes Today",val:"18",icon:Lc,color:"blue"},{label:"Active Faculty",val:"42",icon:o8,color:"indigo"},{label:"Avg Attendance",val:"92%",icon:kM,color:"emerald"},{label:"Pending Apps",val:"7",icon:SM,color:"orange"}].map(y=>w.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm hover:shadow-md transition-all flex items-center gap-4",children:[w.jsx("div",{className:`h-12 w-12 rounded-xl flex items-center justify-center bg-${y.color}-50 text-${y.color}-600`,children:w.jsx(y.icon,{size:22})}),w.jsxs("div",{children:[w.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest leading-none mb-1",children:y.label}),w.jsx("div",{className:"text-xl font-bold text-slate-900",children:y.val})]})]},y.label))}),d==="PRINCIPAL"&&w.jsxs("section",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[w.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Weekly Attendance Overview"}),w.jsx("p",{className:"text-[11px] text-slate-500 font-medium uppercase tracking-tight",children:"Interactive Trend Analysis"})]}),w.jsx("button",{className:"text-xs font-bold text-primary-600 hover:text-primary-700 transition-colors",children:"Export Report"})]}),w.jsx("div",{className:"h-64",children:w.jsx(P4,{width:"100%",height:"100%",children:w.jsxs(Sie,{data:Die,margin:{left:-20,top:10},children:[w.jsx("defs",{children:w.jsxs("linearGradient",{id:"attGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[w.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.15}),w.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),w.jsx(SS,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),w.jsx(Ol,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:600,fill:"#94a3b8"}}),w.jsx(Tl,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:600,fill:"#94a3b8"}}),w.jsx(ia,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)",fontSize:"12px",fontWeight:"bold"},cursor:{stroke:"#6366f1",strokeWidth:2}}),w.jsx(yo,{type:"monotone",dataKey:"attendance",stroke:"#6366f1",strokeWidth:3,fill:"url(#attGrad)"})]})})})]}),n.tutorship&&w.jsxs("section",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden ring-1 ring-slate-100/50",children:[w.jsxs("div",{className:"bg-slate-50/80 border-b border-slate-200 px-6 py-4 flex items-center justify-between backdrop-blur-sm",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-xl bg-white border border-slate-200 text-primary-600 shadow-sm ring-4 ring-primary-50",children:w.jsx(uo,{size:20})}),w.jsxs("div",{children:[w.jsxs("h2",{className:"font-bold text-slate-900 leading-none",children:["Tutorship: ",n.tutorship.name]}),w.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[w.jsx("span",{className:"text-[10px] font-extrabold text-primary-600 tracking-tighter uppercase",children:n.tutorship.batch}),w.jsx("span",{className:"h-1 w-1 rounded-full bg-slate-300"}),w.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-tighter",children:["Sem ",n.tutorship.semester]})]})]})]}),w.jsxs("div",{className:"relative hidden sm:block",children:[w.jsx(b2,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),w.jsx("input",{type:"text",placeholder:"Find student...",value:l,onChange:y=>f(y.target.value),className:"pl-9 pr-4 py-2 text-xs rounded-xl border border-slate-200 focus:ring-4 focus:ring-primary-500/10 outline-none w-56 transition-all font-medium"})]})]}),w.jsx("div",{className:"p-4 overflow-x-auto whitespace-nowrap scrollbar-hide bg-slate-50/20",children:w.jsxs("div",{className:"flex gap-4 min-w-min px-2 py-1",children:[b.map(y=>w.jsxs("div",{className:"inline-flex items-center gap-3 bg-white border border-slate-200 px-4 py-3 rounded-2xl min-w-[210px] group hover:border-primary-200 hover:ring-4 hover:ring-primary-50 transition-all cursor-pointer shadow-sm active:scale-95",children:[w.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-50 border border-slate-100 flex items-center justify-center text-primary-600 font-bold text-sm shadow-inner group-hover:bg-primary-600 group-hover:text-white transition-colors",children:y.name?.[0]}),w.jsxs("div",{className:"min-w-0",children:[w.jsx("div",{className:"text-xs font-bold text-slate-900 group-hover:text-primary-700 transition-colors truncate",children:y.name}),w.jsx("div",{className:"text-[10px] text-slate-500 font-bold tracking-tight uppercase",children:y.admission})]})]},y.id)),b.length===0&&w.jsx("div",{className:"text-xs text-slate-400 py-4 italic px-4 font-semibold",children:"No students found matching your search."})]})})]}),w.jsxs("section",{className:"space-y-4",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"h-8 w-8 rounded-lg bg-primary-50 text-primary-600 flex items-center justify-center",children:w.jsx($u,{size:18})}),w.jsx("h2",{className:"text-lg font-bold text-slate-900 tracking-tight",children:"Teaching Schedule"})]})}),w.jsx("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden ring-1 ring-slate-100/50",children:w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-left border-collapse",children:[w.jsx("thead",{children:w.jsxs("tr",{className:"bg-slate-50/50 border-b border-slate-100",children:[w.jsx("th",{className:"p-5 text-[10px] font-bold uppercase tracking-widest text-slate-400 w-28 border-r border-slate-100",children:"Day"}),$j.map(y=>w.jsxs("th",{className:"p-5 text-[10px] font-bold uppercase tracking-widest text-slate-500 text-center border-r border-slate-100 last:border-r-0",children:["Period ",y]},y))]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:jie.map((y,x)=>w.jsxs("tr",{className:"group hover:bg-slate-50/50 transition-colors",children:[w.jsx("td",{className:"p-5 font-bold text-slate-600 text-[11px] uppercase tracking-wider border-r border-slate-100 bg-slate-50/20",children:y}),$j.map(S=>{const E=g(x,S);return w.jsx("td",{className:"p-3 border-r border-slate-100 last:border-r-0 h-28 min-w-[160px]",children:E?w.jsxs("button",{onClick:()=>r(`/mark-attendance?classId=${E.class_id}&period=${S}&subjectId=${E.subject_id}&day=${x}`),className:"w-full h-full p-4 rounded-2xl bg-white text-left border border-slate-200 hover:border-primary-400 hover:shadow-xl hover:shadow-primary-100 hover:scale-[1.03] transition-all group/slot relative overflow-hidden ring-0 hover:ring-2 hover:ring-primary-100",children:[w.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-0 group-hover/slot:opacity-100 transition-all translate-x-2 group-hover/slot:translate-x-0",children:w.jsx(y2,{size:14,className:"text-primary-600"})}),w.jsxs("div",{className:"text-[9px] font-black text-primary-600 uppercase tracking-tighter mb-1.5 flex items-center gap-1",children:[w.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-primary-500"}),E.subject?.code]}),w.jsx("div",{className:"text-xs font-bold text-slate-900 line-clamp-2 leading-snug mb-2 min-h-[2.5rem]",children:E.subject?.name}),w.jsxs("div",{className:"flex items-center justify-between text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:[w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(Lc,{size:11,className:"text-slate-300"}),E.class?.name]}),E.class?.semester&&w.jsxs("span",{className:"bg-slate-100 px-1.5 py-0.5 rounded text-[9px] text-slate-500",children:["S",E.class.semester]})]})]}):w.jsx("div",{className:"w-full h-full border-2 border-dashed border-slate-100 rounded-2xl flex items-center justify-center opacity-40 group-hover:opacity-100 transition-opacity",children:w.jsx("span",{className:"text-[9px] font-black text-slate-300 uppercase letter-spacing-2",children:"Free"})})},S)})]},y))})]})})})]})]})}var rp={exports:{}},Fie=rp.exports,Uj;function Lie(){return Uj||(Uj=1,(function(t,e){(function(n,a){t.exports=a(Iv())})(Fie,function(r){return(function(n){var a={};function i(o){if(a[o])return a[o].exports;var s=a[o]={i:o,l:!1,exports:{}};return n[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=n,i.c=a,i.d=function(o,s,u){i.o(o,s)||Object.defineProperty(o,s,{enumerable:!0,get:u})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,s){if(s&1&&(o=i(o)),s&8||s&4&&typeof o=="object"&&o&&o.__esModule)return o;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:o}),s&2&&typeof o!="string")for(var l in o)i.d(u,l,(function(f){return o[f]}).bind(null,l));return u},i.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(s,"a",s),s},i.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},i.p="",i(i.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(n,a,i){i.r(a);var o=i("react"),s=(function(){var p=function(v,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,y){b.__proto__=y}||function(b,y){for(var x in y)y.hasOwnProperty(x)&&(b[x]=y[x])},p(v,g)};return function(v,g){p(v,g);function b(){this.constructor=v}v.prototype=g===null?Object.create(g):(b.prototype=g.prototype,new b)}})(),u=function(){return u=Object.assign||function(p){for(var v,g=1,b=arguments.length;g<b;g++){v=arguments[g];for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(p[y]=v[y])}return p},u.apply(this,arguments)},l=function(p,v){var g={};for(var b in p)Object.prototype.hasOwnProperty.call(p,b)&&v.indexOf(b)<0&&(g[b]=p[b]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,b=Object.getOwnPropertySymbols(p);y<b.length;y++)v.indexOf(b[y])<0&&Object.prototype.propertyIsEnumerable.call(p,b[y])&&(g[b[y]]=p[b[y]]);return g};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(v){var g=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return g?new Promise(function(b,y){g.call(navigator,v,b,y)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function f(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var d=(function(p){s(v,p);function v(g){var b=p.call(this,g)||this;return b.canvas=null,b.ctx=null,b.requestUserMediaId=0,b.unmounted=!1,b.state={hasUserMedia:!1},b}return v.prototype.componentDidMount=function(){var g=this,b=g.state,y=g.props;if(this.unmounted=!1,!f()){y.onUserMediaError("getUserMedia not supported");return}b.hasUserMedia||this.requestUserMedia(),y.children&&typeof y.children!="function"&&console.warn("children must be a function")},v.prototype.componentDidUpdate=function(g){var b=this.props;if(!f()){b.onUserMediaError("getUserMedia not supported");return}var y=JSON.stringify(g.audioConstraints)!==JSON.stringify(b.audioConstraints),x=JSON.stringify(g.videoConstraints)!==JSON.stringify(b.videoConstraints),S=g.minScreenshotWidth!==b.minScreenshotWidth,E=g.minScreenshotHeight!==b.minScreenshotHeight;(x||S||E)&&(this.canvas=null,this.ctx=null),(y||x)&&(this.stopAndCleanup(),this.requestUserMedia())},v.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},v.stopMediaStream=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().map(function(b){g.removeTrack(b),b.stop()}),g.getAudioTracks().map(function(b){g.removeTrack(b),b.stop()})):g.stop())},v.prototype.stopAndCleanup=function(){var g=this.state;g.hasUserMedia&&(v.stopMediaStream(this.stream),g.src&&window.URL.revokeObjectURL(g.src))},v.prototype.getScreenshot=function(g){var b=this,y=b.state,x=b.props;if(!y.hasUserMedia)return null;var S=this.getCanvas(g);return S&&S.toDataURL(x.screenshotFormat,x.screenshotQuality)},v.prototype.getCanvas=function(g){var b=this,y=b.state,x=b.props;if(!this.video||!y.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var S=this.video.videoWidth,E=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var C=S/E;S=x.minScreenshotWidth||this.video.clientWidth,E=S/C,x.minScreenshotHeight&&E<x.minScreenshotHeight&&(E=x.minScreenshotHeight,S=E*C)}this.canvas=document.createElement("canvas"),this.canvas.width=g?.width||S,this.canvas.height=g?.height||E,this.ctx=this.canvas.getContext("2d")}var k=this,A=k.ctx,T=k.canvas;return A&&T&&(T.width=g?.width||T.width,T.height=g?.height||T.height,x.mirrored&&(A.translate(T.width,0),A.scale(-1,1)),A.imageSmoothingEnabled=x.imageSmoothing,A.drawImage(this.video,0,0,g?.width||T.width,g?.height||T.height),x.mirrored&&(A.scale(-1,1),A.translate(-T.width,0))),T},v.prototype.requestUserMedia=function(){var g=this,b=this.props,y=function(E,C){var k={video:typeof C<"u"?C:!0};b.audio&&(k.audio=typeof E<"u"?E:!0),g.requestUserMediaId++;var A=g.requestUserMediaId;navigator.mediaDevices.getUserMedia(k).then(function(T){g.unmounted||A!==g.requestUserMediaId?v.stopMediaStream(T):g.handleUserMedia(null,T)}).catch(function(T){g.handleUserMedia(T)})};if("mediaDevices"in navigator)y(b.audioConstraints,b.videoConstraints);else{var x=function(E){return{optional:[{sourceId:E}]}},S=function(E){var C=E.deviceId;return typeof C=="string"?C:Array.isArray(C)&&C.length>0?C[0]:typeof C=="object"&&C.ideal?C.ideal:null};MediaStreamTrack.getSources(function(E){var C=null,k=null;E.forEach(function(N){N.kind==="audio"?C=N.id:N.kind==="video"&&(k=N.id)});var A=S(b.audioConstraints);A&&(C=A);var T=S(b.videoConstraints);T&&(k=T),y(x(C),x(k))})}},v.prototype.handleUserMedia=function(g,b){var y=this.props;if(g||!b){this.setState({hasUserMedia:!1}),y.onUserMediaError(g);return}this.stream=b;try{this.video&&(this.video.srcObject=b),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(b)})}y.onUserMedia(b)},v.prototype.render=function(){var g=this,b=this,y=b.state,x=b.props,S=x.audio;x.forceScreenshotSourceSize;var E=x.disablePictureInPicture;x.onUserMedia,x.onUserMediaError,x.screenshotFormat,x.screenshotQuality,x.minScreenshotWidth,x.minScreenshotHeight,x.audioConstraints,x.videoConstraints,x.imageSmoothing;var C=x.mirrored,k=x.style,A=k===void 0?{}:k,T=x.children,N=l(x,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),R=C?u(u({},A),{transform:(A.transform||"")+" scaleX(-1)"}):A,I={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",u({autoPlay:!0,disablePictureInPicture:E,src:y.src,muted:!S,playsInline:!0,ref:function(D){g.video=D},style:R},N)),T&&T(I))},v.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},v})(o.Component);a.default=d}),react:(function(n,a){n.exports=r})}).default})})(rp)),rp.exports}var Bie=Lie();const zF=yt(Bie);var qF=function(t,e){return(qF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])})(t,e)};function va(t,e){function r(){this.constructor=t}qF(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function Ne(t,e,r,n){return new(r||(r=Promise))((function(a,i){function o(l){try{u(n.next(l))}catch(f){i(f)}}function s(l){try{u(n.throw(l))}catch(f){i(f)}}function u(l){l.done?a(l.value):new r((function(f){f(l.value)})).then(o,s)}u((n=n.apply(t,[])).next())}))}function Re(t,e){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return(function(f){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&f[0]?n.return:f[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,f[1])).done)return a;switch(n=0,a&&(f=[2&f[0],a.value]),f[0]){case 0:case 1:a=f;break;case 4:return o.label++,{value:f[1],done:!1};case 5:o.label++,n=f[1],f=[0];continue;case 7:f=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(f[0]===6||f[0]===2)){o=0;continue}if(f[0]===3&&(!a||f[1]>a[0]&&f[1]<a[3])){o.label=f[1];break}if(f[0]===6&&o.label<a[1]){o.label=a[1],a=f;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(f);break}a[2]&&o.ops.pop(),o.trys.pop();continue}f=e.call(t,o)}catch(d){f=[6,d],n=0}finally{r=a=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}})([u,l])}}}var $ie=(function(){function t(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(e,r){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+r+"."),this.platformName=e,this.platform=r},t.prototype.registerFlag=function(e,r,n){if(this.flagRegistry[e]={evaluationFn:r,setHook:n},this.urlFlags[e]!=null){var a=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+a+"."),this.set(e,a)}},t.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},t.prototype.getNumber=function(e){return this.get(e)},t.prototype.getBool=function(e){return this.get(e)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(e,r){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=r,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(r)},t.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},t.prototype.setFlags=function(e){this.flags=Object.assign({},e)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var r,n,a=(r=this.global.location.search,n={},r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(i){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];return Uie(n,o[0],o[1]),o.join("=")})),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach((function(i){var o=i.split(":"),s=o[0],u=o[1];e.urlFlags[s]=(function(l,f){if((f=f.toLowerCase())==="true"||f==="false")return f==="true";if(""+ +f===f)return+f;throw new Error("Could not parse value flag value "+f+" for flag "+l+".")})(s,u)}))}},t})();function Uie(t,e,r){t[decodeURIComponent(e)]=decodeURIComponent(r||"")}function ce(){return VF}var VF=null,cv=new Map,z_=new Map;function HF(t,e){var r=KF(t,e);return cv.get(r)}function Wie(t){return z_.get(t)}function Wj(t){for(var e=cv.entries(),r=[];;){var n=e.next(),a=n.done,i=n.value;if(a)break;var o=i[0],s=i[1];o.split("_")[0]===t&&r.push(s)}return r}function GF(t){var e=t.kernelName,r=t.backendName,n=KF(e,r);if(cv.has(n))throw new Error("The kernel '"+e+"' for backend '"+r+"' is already registered");cv.set(n,t)}function zie(t){var e=t.kernelName;z_.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),z_.set(e,t)}function KF(t,e){return e+"_"+t}function q_(t,e,r){return Math.max(t,Math.min(e,r))}function XF(t){return t%2==0?t:t+1}function qie(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return e}function U(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function vt(t,e,r){r===void 0&&(r=""),U(wr(t,e),(function(){return r+" Shapes "+t+" and "+e+" must match"}))}function Pl(t){U(t!=null,(function(){return"The input to the tensor constructor must be a non-null value."}))}function dl(t,e,r){if(e===void 0&&(e=[]),r===void 0&&(r=!1),e==null&&(e=[]),Array.isArray(t)||Ia(t)&&!r)for(var n=0;n<t.length;++n)dl(t[n],e,r);else e.push(t);return e}function je(t){if(t.length===0)return 1;for(var e=t[0],r=1;r<t.length;r++)e*=t[r];return e}function wr(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Xt(t){return t%1==0}function Vie(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function V_(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Pu(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function zj(t,e,r){return e===void 0&&(e=function(n){return 0}),new Promise((function(n,a){var i=0,o=function(){if(t())n();else{i++;var s=e(i);r!=null&&i>=r?a():setTimeout(o,s)}};o()}))}function Hie(t,e){for(var r=1,n=-1,a=0;a<t.length;++a)if(t[a]>=0)r*=t[a];else if(t[a]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+a);n=a}else if(t[a]<0)throw Error("Shapes can not be < 0. Found "+t[a]+" at dim "+a);if(n===-1){if(e>0&&e!==r)throw Error("Size("+e+") must match the product of shape "+t);return t}if(r===0)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%r!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+r);var i=t.slice();return i[n]=e/r,i}function vr(t,e){var r=e.length;return U((t=t==null?e.map((function(n,a){return a})):[].concat(t)).every((function(n){return n>=-r&&n<r})),(function(){return"All values in axis param must be in range [-"+r+", "+r+") but got axis "+t})),U(t.every((function(n){return Xt(n)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(n){return n<0?r+n:n}))}function Ko(t,e){for(var r=[],n=[],a=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||a?null:vr(e,t).sort(),o=0,s=0;s<t.length;++s){if(i!=null){if(i[o]===s&&t[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(i[o]==null||i[o]>s)&&t[s]===1&&(r.push(t[s]),n.push(s)),i[o]<=s&&o++}t[s]!==1&&(r.push(t[s]),n.push(s))}return{newShape:r,keptDims:n}}function $f(t,e){var r=null;if(t==null||t==="float32")r=new Float32Array(e);else if(t==="int32")r=new Int32Array(e);else{if(t!=="bool")throw new Error("Unknown data type "+t);r=new Uint8Array(e)}return r}function fv(t,e){var r=null;if(t==null||t==="float32")r=new Float32Array(e);else if(t==="int32")r=new Int32Array(e);else if(t==="bool")r=new Uint8Array(e);else{if(t!=="string")throw new Error("Unknown data type "+t);r=new Array(e)}return r}function Gie(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+e+" being uploaded contains "+n+".")}}function Kie(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function Xie(t,e){return e!=="complex64"&&(e!=="float32"||t==="complex64")&&(e!=="int32"||t==="float32"||t==="complex64")&&(e!=="bool"||t!=="bool")}function Ia(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function YF(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error("Unknown dtype "+t)}function Yie(t){if(t==null)return 0;var e=0;return t.forEach((function(r){return e+=r.length})),e}function ES(t){return typeof t=="string"||t instanceof String}function Jie(t){return typeof t=="boolean"}function Qie(t){return typeof t=="number"}function ad(t){return Array.isArray(t)?ad(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":Qie(t)?"float32":ES(t)?"string":Jie(t)?"bool":"float32"}function H_(t){return!!(t&&t.constructor&&t.call&&t.apply)}function G_(t,e){for(var r=e;r<t;++r)if(t%r==0)return r;return t}function ja(t){var e=t.length;if(e<2)return[];var r=new Array(e-1);r[e-2]=t[e-1];for(var n=e-3;n>=0;--n)r[n]=r[n+1]*t[n+1];return r}function JF(t,e,r){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=dl(t)),r&&Gie(t,e),(function(i,o){return i instanceof Float32Array&&o==="float32"||i instanceof Int32Array&&o==="int32"||i instanceof Uint8Array&&o==="bool"})(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){for(var n=new Uint8Array(t.length),a=0;a<n.length;++a)Math.round(t[a])!==0&&(n[a]=1);return n}throw new Error("Unknown data type "+e)}function qj(t,e){if(t.length===0)return e[0];var r=t.reduce((function(n,a){return n*a}));if(r===0)return[];if(r!==e.length)throw new Error("["+t+"] does not match the input size.");return(function n(a,i,o){var s=new Array;if(i.length===1)for(var u=i[0],l=0;l<u;l++)s[l]=o[a+l];else{u=i[0];var f=i.slice(1),d=f.reduce((function(p,v){return p*v}));for(l=0;l<u;l++)s[l]=n(a+l*d,f,o)}return s})(0,t,e)}function QF(t,e){for(var r=id(t,e),n=0;n<r.length;n++)r[n]=1;return r}function id(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error("Unknown data type "+e)}function Ca(){return ce().platform.now()}function ZF(t){t.forEach((function(e){U(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function Zie(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",ce().platform.encode(t,e)}function dv(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",ce().platform.decode(t,e)}function Vj(t,e,r){if(e===0)return 0;if(e===1)return t[0];for(var n=t[t.length-1],a=0;a<t.length-1;++a)n+=r[a]*t[a];return n}function eoe(t,e,r){if(e===0)return[];if(e===1)return[t];for(var n=new Array(e),a=0;a<n.length-1;++a)n[a]=Math.floor(t/r[a]),t-=n[a]*r[a];return n[n.length-1]=t,n}var toe=(function(){function t(e,r){this.backendTimer=e,this.logger=r,r==null&&(this.logger=new roe)}return t.prototype.profileKernel=function(e,r,n){var a,i=this,o=this.backendTimer.time((function(){a=n()}));return a.forEach((function(s){s.data().then((function(u){(function(l,f,d){if(f!=="float32")return!1;for(var p=0;p<l.length;p++){var v=l[p];if(isNaN(v)||!isFinite(v))return console.warn("Found "+v+" in the result of '"+d+"'"),!0}})(u,s.dtype,e),o.then((function(l){var f="";l.getExtraProfileInfo!=null&&(f=l.getExtraProfileInfo()),i.logger.logKernelProfile(e,s,u,l.kernelMs,r,f)}))}))})),a},t})(),roe=(function(){function t(){}return t.prototype.logKernelProfile=function(e,r,n,a,i,o){var s=typeof a=="number"?Pu(a+"ms",9):a.error,u=Pu(e,25),l=r.rank,f=r.size,d=Pu(r.shape.toString(),14),p="";for(var v in i){var g=i[v].shape||r.shape,b=g.length;p+=v+": "+b+"D "+(b>0?g:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+d+"	%c"+f+"	%c"+p+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t})(),Hj=20,Ac=3,Dw=7;function noe(t,e,r,n){var a=ja(e),i=(function(l,f,d,p){var v=je(f),g=p[p.length-1],b=new Array(g).fill(0),y=f.length,x=d==="complex64"?Tc(l):l;if(y>1)for(var S=0;S<v/g;S++)for(var E=S*g,C=0;C<g;C++)b[C]=Math.max(b[C],Oc(x[E+C],0,d).length);return b})(t,e,r,a),o=e.length,s=(function l(f,d,p,v,g,b){b===void 0&&(b=!0);var y=p==="complex64"?2:1,x=d[0],S=d.length;if(S===0)return p==="complex64"?[Oc(Tc(f)[0],0,p)]:p==="bool"?[eL(f[0])]:[f[0].toString()];if(S===1){if(x>Hj){var E=Ac*y,C=Array.from(f.slice(0,E)),k=Array.from(f.slice((x-Ac)*y,x*y));return p==="complex64"&&(C=Tc(C),k=Tc(k)),["["+C.map((function(q,X){return Oc(q,g[X],p)})).join(", ")+", ..., "+k.map((function(q,X){return Oc(q,g[x-Ac+X],p)})).join(", ")+"]"]}return["["+(p==="complex64"?Tc(f):Array.from(f)).map((function(q,X){return Oc(q,g[X],p)})).join(", ")+"]"]}var A=d.slice(1),T=v.slice(1),N=v[0]*y,R=[];if(x>Hj){for(var I=0;I<Ac;I++){var D=(j=I*N)+N;R.push.apply(R,l(f.slice(j,D),A,p,T,g,!1))}for(R.push("..."),I=x-Ac;I<x;I++)D=(j=I*N)+N,R.push.apply(R,l(f.slice(j,D),A,p,T,g,I===x-1))}else for(I=0;I<x;I++){var j;D=(j=I*N)+N,R.push.apply(R,l(f.slice(j,D),A,p,T,g,I===x-1))}var $=S===2?",":"";for(R[0]="["+R[0]+$,I=1;I<R.length-1;I++)R[I]=" "+R[I]+$;var W=`,
`;for(I=2;I<S;I++)W+=`
`;return R[R.length-1]=" "+R[R.length-1]+"]"+(b?"":W),R})(t,e,r,a,i),u=["Tensor"];return n&&(u.push("  dtype: "+r),u.push("  rank: "+o),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map((function(l){return"    "+l})).join(`
`)),u.join(`
`)}function Oc(t,e,r){return Pu(Array.isArray(t)?parseFloat(t[0].toFixed(Dw))+" + "+parseFloat(t[1].toFixed(Dw))+"j":ES(t)?"'"+t+"'":r==="bool"?eL(t):parseFloat(t.toFixed(Dw)).toString(),e)}function eL(t){return t===0?"false":"true"}function Tc(t){for(var e=[],r=0;r<t.length;r+=2)e.push([t[r],t[r+1]]);return e}var Uf=(function(){function t(e,r,n){var a=this;if(this.dtype=r,this.shape=e.slice(),this.size=je(e),n!=null){var i=n.length;U(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."}))}if(r==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||fv(r,this.size),this.strides=ja(e)}return t.prototype.set=function(e){for(var r=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];n.length===0&&(n=[0]),U(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+r.rank+")"}));var i=this.locToIndex(n);this.values[i]=e},t.prototype.get=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];e.length===0&&(e=[0]);for(var n=0,a=0,i=e;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[n]){var s="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(s)}n++}for(var u=e[e.length-1],l=0;l<e.length-1;++l)u+=this.strides[l]*e[l];return this.values[u]},t.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var r=e[e.length-1],n=0;n<e.length-1;++n)r+=this.strides[n]*e[n];return r},t.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var r=new Array(this.shape.length),n=0;n<r.length-1;++n)r[n]=Math.floor(e/this.strides[n]),e-=r[n]*this.strides[n];return r[r.length-1]=e,r},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return ka().makeTensor(this.values,this.shape,this.dtype)},t})(),ka=null,se=null,tL=null,Ft=(function(){function t(e,r,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=r||"float32",this.size=je(e),this.strides=ja(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),U(this.size===1,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(e,r){return this.throwIfDisposed(),this.reshape([e,r])},t.prototype.as3D=function(e,r,n){return this.throwIfDisposed(),this.reshape([e,r,n])},t.prototype.as4D=function(e,r,n,a){return this.throwIfDisposed(),this.reshape([e,r,n,a])},t.prototype.as5D=function(e,r,n,a,i){return this.throwIfDisposed(),this.reshape([e,r,n,a,i])},t.prototype.asType=function(e){return this.throwIfDisposed(),se.cast(this,e)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return Ne(this,void 0,void 0,(function(){var e;return Re(this,(function(r){switch(r.label){case 0:return[4,this.data()];case 1:return e=r.sent(),[2,se.buffer(this.shape,this.dtype,e)]}}))}))},t.prototype.bufferSync=function(){return se.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return Ne(this,void 0,void 0,(function(){var e;return Re(this,(function(r){switch(r.label){case 0:return[4,this.data()];case 1:return e=r.sent(),[2,qj(this.shape,e)]}}))}))},t.prototype.arraySync=function(){return qj(this.shape,this.dataSync())},t.prototype.data=function(){return Ne(this,void 0,void 0,(function(){var e,r;return Re(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=ka().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:r=n.sent();try{return[2,r.map((function(a){return dv(a)}))]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var e=ka().readSync(this.dataId);if(this.dtype==="string")try{return e.map((function(r){return dv(r)}))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},t.prototype.bytes=function(){return Ne(this,void 0,void 0,(function(){var e;return Re(this,(function(r){switch(r.label){case 0:return this.throwIfDisposed(),[4,ka().read(this.dataId)];case 1:return e=r.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(ka().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(e){return e===void 0&&(e=!1),se.print(this,e)},t.prototype.reshape=function(e){return this.throwIfDisposed(),se.reshape(this,e)},t.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},t.prototype.expandDims=function(e){return e===void 0&&(e=0),se.expandDims(this,e)},t.prototype.cumsum=function(e,r,n){return e===void 0&&(e=0),r===void 0&&(r=!1),n===void 0&&(n=!1),se.cumsum(this,e,r,n)},t.prototype.squeeze=function(e){return this.throwIfDisposed(),se.squeeze(this,e)},t.prototype.clone=function(){return this.throwIfDisposed(),se.clone(this)},t.prototype.oneHot=function(e,r,n){return this.throwIfDisposed(),se.oneHot(this,e,r,n)},t.prototype.toString=function(e){return e===void 0&&(e=!1),noe(this.dataSync(),this.shape,this.dtype,e)},t.prototype.tile=function(e){return this.throwIfDisposed(),se.tile(this,e)},t.prototype.gather=function(e,r){return r===void 0&&(r=0),this.throwIfDisposed(),se.gather(this,e,r)},t.prototype.matMul=function(e,r,n){return r===void 0&&(r=!1),n===void 0&&(n=!1),this.throwIfDisposed(),se.matMul(this,e,r,n)},t.prototype.dot=function(e){return this.throwIfDisposed(),se.dot(this,e)},t.prototype.norm=function(e,r,n){return e===void 0&&(e="euclidean"),r===void 0&&(r=null),n===void 0&&(n=!1),this.throwIfDisposed(),se.norm(this,e,r,n)},t.prototype.slice=function(e,r){return this.throwIfDisposed(),se.slice(this,e,r)},t.prototype.reverse=function(e){return this.throwIfDisposed(),se.reverse(this,e)},t.prototype.concat=function(e,r){return r===void 0&&(r=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),se.concat([this].concat(e),r)},t.prototype.split=function(e,r){return r===void 0&&(r=0),this.throwIfDisposed(),se.split(this,e,r)},t.prototype.stack=function(e,r){return r===void 0&&(r=0),se.stack([this,e],r)},t.prototype.unstack=function(e){return e===void 0&&(e=0),se.unstack(this,e)},t.prototype.pad=function(e,r){return r===void 0&&(r=0),se.pad(this,e,r)},t.prototype.batchNormalization=function(e,r,n,a,i){return n===void 0&&(n=.001),tL("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,r,i,a,n)},t.prototype.batchNorm=function(e,r,n,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),se.batchNorm(this,e,r,n,a,i)},t.prototype.all=function(e,r){return e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.all(this,e,r)},t.prototype.any=function(e,r){return e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.any(this,e,r)},t.prototype.logSumExp=function(e,r){return e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.logSumExp(this,e,r)},t.prototype.sum=function(e,r){return e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.sum(this,e,r)},t.prototype.prod=function(e,r){return e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.prod(this,e,r)},t.prototype.mean=function(e,r){return e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.mean(this,e,r)},t.prototype.min=function(e,r){return e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.min(this,e,r)},t.prototype.max=function(e,r){return e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.max(this,e,r)},t.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),se.argMin(this,e)},t.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),se.argMax(this,e)},t.prototype.cast=function(e){return this.throwIfDisposed(),se.cast(this,e)},t.prototype.add=function(e){return this.throwIfDisposed(),se.add(this,e)},t.prototype.addStrict=function(e){return this.throwIfDisposed(),se.addStrict(this,e)},t.prototype.atan2=function(e){return this.throwIfDisposed(),se.atan2(this,e)},t.prototype.sub=function(e){return this.throwIfDisposed(),se.sub(this,e)},t.prototype.subStrict=function(e){return this.throwIfDisposed(),se.subStrict(this,e)},t.prototype.pow=function(e){return this.throwIfDisposed(),se.pow(this,e)},t.prototype.powStrict=function(e){return this.throwIfDisposed(),se.powStrict(this,e)},t.prototype.mul=function(e){return this.throwIfDisposed(),se.mul(this,e)},t.prototype.mulStrict=function(e){return this.throwIfDisposed(),se.mulStrict(this,e)},t.prototype.div=function(e){return this.throwIfDisposed(),se.div(this,e)},t.prototype.divNoNan=function(e){return this.throwIfDisposed(),se.divNoNan(this,e)},t.prototype.floorDiv=function(e){return this.throwIfDisposed(),se.floorDiv(this,e)},t.prototype.divStrict=function(e){return this.throwIfDisposed(),se.divStrict(this,e)},t.prototype.minimum=function(e){return this.throwIfDisposed(),se.minimum(this,e)},t.prototype.minimumStrict=function(e){return this.throwIfDisposed(),se.minimumStrict(this,e)},t.prototype.maximum=function(e){return this.throwIfDisposed(),se.maximum(this,e)},t.prototype.maximumStrict=function(e){return this.throwIfDisposed(),se.maximumStrict(this,e)},t.prototype.mod=function(e){return this.throwIfDisposed(),se.mod(this,e)},t.prototype.modStrict=function(e){return this.throwIfDisposed(),se.modStrict(this,e)},t.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),se.squaredDifferenceStrict(this,e)},t.prototype.transpose=function(e){return this.throwIfDisposed(),se.transpose(this,e)},t.prototype.notEqual=function(e){return this.throwIfDisposed(),se.notEqual(this,e)},t.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),se.notEqualStrict(this,e)},t.prototype.less=function(e){return this.throwIfDisposed(),se.less(this,e)},t.prototype.lessStrict=function(e){return this.throwIfDisposed(),se.lessStrict(this,e)},t.prototype.equal=function(e){return this.throwIfDisposed(),se.equal(this,e)},t.prototype.equalStrict=function(e){return this.throwIfDisposed(),se.equalStrict(this,e)},t.prototype.lessEqual=function(e){return this.throwIfDisposed(),se.lessEqual(this,e)},t.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),se.lessEqualStrict(this,e)},t.prototype.greater=function(e){return this.throwIfDisposed(),se.greater(this,e)},t.prototype.greaterStrict=function(e){return this.throwIfDisposed(),se.greaterStrict(this,e)},t.prototype.greaterEqual=function(e){return this.throwIfDisposed(),se.greaterEqual(this,e)},t.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),se.greaterEqualStrict(this,e)},t.prototype.logicalAnd=function(e){return this.throwIfDisposed(),se.logicalAnd(this,e)},t.prototype.logicalOr=function(e){return this.throwIfDisposed(),se.logicalOr(this,e)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),se.logicalNot(this)},t.prototype.logicalXor=function(e){return this.throwIfDisposed(),se.logicalXor(this,e)},t.prototype.where=function(e,r){return this.throwIfDisposed(),se.where(e,this,r)},t.prototype.neg=function(){return this.throwIfDisposed(),se.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),se.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),se.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),se.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),se.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),se.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),se.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),se.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),se.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),se.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),se.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),se.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),se.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),se.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),se.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),se.abs(this)},t.prototype.clipByValue=function(e,r){return this.throwIfDisposed(),se.clipByValue(this,e,r)},t.prototype.relu=function(){return this.throwIfDisposed(),se.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),se.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),se.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),se.selu(this)},t.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),se.leakyRelu(this,e)},t.prototype.prelu=function(e){return this.throwIfDisposed(),se.prelu(this,e)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),se.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),se.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),se.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),se.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),se.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),se.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),se.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),se.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),se.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),se.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),se.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),se.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),se.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),se.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),se.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),se.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),se.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),se.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),se.round(this)},t.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),se.step(this,e)},t.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),se.softmax(this,e)},t.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),se.logSoftmax(this,e)},t.prototype.resizeBilinear=function(e,r){return r===void 0&&(r=!1),this.throwIfDisposed(),se.image.resizeBilinear(this,e,r)},t.prototype.resizeNearestNeighbor=function(e,r){return r===void 0&&(r=!1),this.throwIfDisposed(),se.image.resizeNearestNeighbor(this,e,r)},t.prototype.conv1d=function(e,r,n,a,i,o){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),se.conv1d(this,e,r,n,a,i,o)},t.prototype.conv2d=function(e,r,n,a,i,o){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),se.conv2d(this,e,r,n,a,i,o)},t.prototype.conv2dTranspose=function(e,r,n,a,i){return this.throwIfDisposed(),se.conv2dTranspose(this,e,r,n,a,i)},t.prototype.depthwiseConv2D=function(e,r,n,a,i,o){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),se.depthwiseConv2d(this,e,r,n,a,i,o)},t.prototype.separableConv2d=function(e,r,n,a,i,o){return i===void 0&&(i=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),se.separableConv2d(this,e,r,n,a,i,o)},t.prototype.avgPool=function(e,r,n,a){return this.throwIfDisposed(),se.avgPool(this,e,r,n,a)},t.prototype.maxPool=function(e,r,n,a){return this.throwIfDisposed(),se.maxPool(this,e,r,n,a)},t.prototype.localResponseNormalization=function(e,r,n,a){return e===void 0&&(e=5),r===void 0&&(r=1),n===void 0&&(n=1),a===void 0&&(a=.5),se.localResponseNormalization(this,e,r,n,a)},t.prototype.pool=function(e,r,n,a,i){return this.throwIfDisposed(),se.pool(this,e,r,n,a,i)},t.prototype.variable=function(e,r,n){return e===void 0&&(e=!0),this.throwIfDisposed(),ka().makeVariable(this,e,r,n)},t.prototype.unsortedSegmentSum=function(e,r){return this.throwIfDisposed(),se.unsortedSegmentSum(this,e,r)},t.prototype.batchToSpaceND=function(e,r){return this.throwIfDisposed(),se.batchToSpaceND(this,e,r)},t.prototype.spaceToBatchND=function(e,r){return this.throwIfDisposed(),se.spaceToBatchND(this,e,r)},t.prototype.topk=function(e,r){return e===void 0&&(e=1),r===void 0&&(r=!0),this.throwIfDisposed(),se.topk(this,e,r)},t.prototype.stridedSlice=function(e,r,n,a,i,o,s,u){return a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),se.stridedSlice(this,e,r,n,a,i,o,s,u)},t.prototype.depthToSpace=function(e,r){return this.throwIfDisposed(),se.depthToSpace(this,e,r)},t.prototype.fft=function(){return this.throwIfDisposed(),se.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),se.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),se.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),se.spectral.irfft(this)},t})();Object.defineProperty(Ft,Symbol.hasInstance,{value:function(t){return!!t&&t.dataId!=null&&t.shape!=null&&t.dtype!=null}});var Gj,K_,X_,Y_,J_,hl=(function(t){function e(r,n,a,i){var o=t.call(this,r.shape,r.dtype,r.dataId,i)||this;return o.trainable=n,o.name=a,o}return va(e,t),e.prototype.assign=function(r){if(r.dtype!==this.dtype)throw new Error("dtype of the new value ("+r.dtype+") and previous value ("+this.dtype+") must match");if(!wr(r.shape,this.shape))throw new Error("shape of the new value ("+r.shape+") and previous value ("+this.shape+") must match");ka().disposeTensor(this),this.dataId=r.dataId,ka().incRef(this,null)},e.prototype.dispose=function(){ka().disposeVariable(this),this.isDisposedInternal=!0},e})(Ft);Object.defineProperty(hl,Symbol.hasInstance,{value:function(t){return t instanceof Ft&&t.assign!=null&&t.assign instanceof Function}}),(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(Gj||(Gj={})),(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(K_||(K_={})),(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(X_||(X_={})),(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Y_||(Y_={})),(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(J_||(J_={}));var aoe={float32:Y_,int32:K_,bool:X_,complex64:J_};function Nr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error("Can not upcast "+t+" with "+e)}return aoe[t][e]}function Mw(t){return Nr(t,"int32")}function $t(t,e){if(t.dtype===e.dtype)return[t,e];var r=Nr(t.dtype,e.dtype);return[t.cast(r),e.cast(r)]}function ioe(t,e){U(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function rL(t){var e=[];return(function r(n,a,i){if(n!=null){if(n instanceof Ft)return void a.push(n);if(o=n,!(!Array.isArray(o)&&typeof o!="object")){var o,s=n;for(var u in s){var l=s[u];i.has(l)||(i.add(l),r(l,a,i))}}}})(t,e,new Set),e}var Fw,Kj=(function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},t})(),ooe=(function(){function t(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Kj}return t.prototype.ready=function(){return Ne(this,void 0,void 0,(function(){var e,r,n;return Re(this,(function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then((function(){}))];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),r=0,a.label=1;case 1:return r<e.length?(n=e[r],[4,this.initializeBackend(n).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return r++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),r=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+r+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(r)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},t.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},t.prototype.registerBackend=function(e,r,n){return n===void 0&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:r,priority:n},!0)},t.prototype.setBackend=function(e){return Ne(this,void 0,void 0,(function(){var r,n,a;return Re(this,(function(i){switch(i.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,r=this.initializeBackend(e),n=r.success,r.asyncInit?[4,n]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=n,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new toe(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var e=this;Wj(this.backendName).forEach((function(r){r.setupFunc!=null&&r.setupFunc(e.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(e){var r=this;Wj(e).forEach((function(n){n.disposeFunc!=null&&n.disposeFunc(r.registry[e])}))},t.prototype.initializeBackend=function(e){var r=this,n=this.registryFactory[e];if(n==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,o=a.then((function(s){return!(i<r.pendingBackendInitId)&&(r.registry[e]=s,r.pendingBackendInit=null,!0)})).catch((function(s){return!(i<r.pendingBackendInitId)&&(r.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),!1)}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[e]=a,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(r,n){return e.registryFactory[n].priority-e.registryFactory[r].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),r=0;r<e.length;r++){var n=e[r],a=this.initializeBackend(n),i=a.success,o=a.asyncInit;if(o||i)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(e,r){var n=this.state.tensorInfo.get(r),a=n.backend,i=this.readSync(r);a.disposeData(r),n.backend=e,e.move(r,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(e,r){var n,a=this,i=null;if(r==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");r=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof r!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun((function(){return a.startScope(i)}),(function(){return a.endScope(n)}),(function(){return(n=r())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(e,r,n){e();try{var a=n();return r(),a}catch(i){throw r(),i}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(e){var r=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[r],(function(a){return{x:function(){return a.toFloat()}}}),[]),r},t.prototype.runKernel=function(e,r,n,a,i){return this.runKernelFunc(null,r,null,e,n,a,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(e,r,n){var a=this.backend.numDataIds(),i=0;n.forEach((function(u){i+=u.dtype==="complex64"?3:1}));var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=a-r-i-o;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+e+"'")},t.prototype.runKernelFunc=function(e,r,n,a,i,o,s){var u,l=this;o===void 0&&(o=[]),s===void 0&&(s=[]);var f=[],d=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var p,v=function(S){d&&(f=S.map((function(E){return l.keep(l.clone(E))})))},g=this.state.numBytes,b=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var y,x=HF(a,this.backendName);return p=x!=null?function(){var S=l.backend.numDataIds();y=x.kernelFunc({inputs:r,attrs:i,backend:l.backend});var E=Array.isArray(y)?y:[y];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(a,S,E);var C=E.map((function(A){var T=A.dataId,N=A.shape,R=A.dtype;return l.makeTensorFromDataId(T,N,R)})),k=C.filter((function(A,T){return s[T]}));return v((o||[]).slice().concat(k)),C}:function(){var S=l.backend.numDataIds();y=l.tidy((function(){return e(l.backend,v)}));var E=Array.isArray(y)?y:[y];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(a,S,E),E},this.scopedRun((function(){return l.state.kernelDepth++}),(function(){return l.state.kernelDepth--}),(function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(a,r,(function(){return p()})):p()})),d&&this.addTapeNode(a,r,u,n,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-g,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-b,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(r).map((function(S){return r[S].shape})),outputShapes:u.map((function(S){return S.shape}))}),Array.isArray(y)?u:u[0]},t.prototype.makeTensor=function(e,r,n,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;var i=e;n==="string"&&ES(e[0])&&(i=e.map((function(f){return Zie(f)})));var o=a.write(i,r,n),s=new Ft(r,n,o,this.nextTensorId());if(this.incRef(s,a),n==="string"){var u=this.state.tensorInfo.get(o),l=Yie(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},t.prototype.makeTensorFromDataId=function(e,r,n,a){var i=new Ft(r,n=n||"float32",e,this.nextTensorId());return this.incRef(i,a),i},t.prototype.makeVariable=function(e,r,n,a){r===void 0&&(r=!0),n=n||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.asType(a));var i=new hl(e,r,n,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(e,r){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,n===0){this.state.numDataBuffers++;var a=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(a=e.size*YF(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:r||this.backend,dtype:e.dtype,shape:e.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof hl||this.track(e)},t.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var r=this.state.tensorInfo.get(e.dataId);r.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=r.bytes),this.state.numDataBuffers--,r.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var r=this.state.registeredVariables[e];this.disposeVariable(r)}},t.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},t.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},t.prototype.profile=function(e){return Ne(this,void 0,void 0,(function(){var r,n;return Re(this,(function(a){return this.state.profiling=!0,r=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(i){return i.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-r,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},t.prototype.addTapeNode=function(e,r,n,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:r,outputs:n,saved:i},u=Wie(e);u!=null&&(a=u.gradFunc),a!=null&&(s.gradient=function(l){return l=l.map((function(f,d){if(f==null){var p=n[d],v=id(p.size,p.dtype);return o.makeTensor(v,p.shape,p.dtype)}return f})),a(l.length>1?l:l[0],i)}),this.state.activeTape.push(s)},t.prototype.keep=function(e){return e.kept=!0,e},t.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(e){var r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(r.name=e),this.state.scopeStack.push(r),this.state.activeScope=r},t.prototype.endScope=function(e){for(var r=this,n=rL(e),a=new Set(n.map((function(u){return u.id}))),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||a.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(u){u.kept||u.scopeId!==s.id||r.track(u)}))},t.prototype.gradients=function(e,r,n,a){var i=this;if(a===void 0&&(a=!1),U(r.length>0,(function(){return"gradients() received an empty list of xs."})),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",e)}));U(o instanceof Ft,(function(){return"The result y returned by f() must be a tensor."}));var s=(function(u,l,f){for(var d={},p={},v=0;v<l.length;v++)d[l[v].id]=!0;for(v=0;v<u.length;v++){var g=(A=u[v]).inputs;for(var b in g){for(var y=g[b],x=!1,S=0;S<l.length;S++)if(d[y.id]){A.outputs.forEach((function(I){return d[I.id]=!0})),x=!0,p[A.id]=!0;break}if(x)break}}var E={};E[f.id]=!0;var C={};for(v=u.length-1;v>=0;v--)for(g=(A=u[v]).inputs,S=0;S<A.outputs.length;S++)if(E[A.outputs[S].id]){for(var b in g)E[g[b].id]=!0,C[A.id]=!0;break}var k=[];for(v=0;v<u.length;v++){var A;if(p[(A=u[v]).id]&&C[A.id]){var T={};for(var b in A.inputs){var N=A.inputs[b];d[N.id]&&(T[b]=N)}var R=Object.assign({},A);R.inputs=T,R.outputs=A.outputs,k.push(R)}}return k})(this.state.activeTape,r,o);if(!a&&s.length===0&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var u,l,f={};f[o.id]=n??(u=o.shape,l=QF(je(u),"float32"),ee.makeTensor(l,u,"float32")),(function(p,v,g){for(var b=function(x){var S=v[x],E=[];if(S.outputs.forEach((function(T){var N=p[T.id];N!=null?E.push(N):E.push(null)})),S.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+S.kernelName+".");var C=S.gradient(E),k=function(T){if(!(T in C))throw new Error("Cannot backprop through input "+T+". Available gradients found: "+Object.keys(C)+".");var N=g((function(){return C[T]()}));if(N.dtype!=="float32")throw new Error("Error in gradient for op "+S.kernelName+". The gradient of input "+T+" must have 'float32' dtype, but has '"+N.dtype+"'");var R=S.inputs[T];if(!wr(N.shape,R.shape))throw new Error("Error in gradient for op "+S.kernelName+". The gradient of input '"+T+"' has shape '"+N.shape+"', which does not match the shape of the input '"+R.shape+"'");if(p[R.id]==null)p[R.id]=N;else{var I=p[R.id];p[R.id]=I.add(N),I.dispose()}};for(var A in S.inputs)k(A)},y=v.length-1;y>=0;y--)b(y)})(f,s,(function(p){return i.tidy(p)}));var d=r.map((function(p){return f[p.id]}));return i.state.gradientDepth===0&&(i.state.activeTape.forEach((function(p){for(var v=0,g=p.saved;v<g.length;v++)g[v].dispose()})),i.state.activeTape=null),{value:o,grads:d}}))},t.prototype.customGrad=function(e){var r=this;return U(H_(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];U(a.every((function(s){return s instanceof Ft})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return a.forEach((function(s,u){o[u]=s})),r.runKernelFunc((function(s,u){return U((n=e.apply(void 0,a.concat([u]))).value instanceof Ft,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),U(H_(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),o,(function(s,u){var l=n.gradFunc(s,u),f=Array.isArray(l)?l:[l];U(f.length===a.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),U(f.every((function(p){return p instanceof Ft})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var d={};return f.forEach((function(p,v){d[v]=function(){return p}})),d}))}},t.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},t.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},t.prototype.time=function(e){return Ne(this,void 0,void 0,(function(){var r,n;return Re(this,(function(a){switch(a.label){case 0:return r=Ca(),[4,this.backend.time(e)];case 1:return(n=a.sent()).wallMs=Ca()-r,[2,n]}}))}))},t.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Kj,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t})(),ee=(function(){var t=(function(){if(Fw==null){var r=void 0;if(typeof window<"u")r=window;else if(typeof global<"u")r=global;else if(typeof process<"u")r=process;else{if(typeof self>"u")throw new Error("Could not find a global object");r=self}Fw=r}return Fw})();if(t._tfengine==null){var e=new $ie(t);t._tfengine=new ooe(e)}return(function(r){VF=r})(t._tfengine.ENV),ka=function(){return t._tfengine},t._tfengine})();function nL(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var ei=ce();ei.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),ei.registerFlag("IS_BROWSER",(function(){return nL()})),ei.registerFlag("IS_NODE",(function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0})),ei.registerFlag("IS_CHROME",(function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),ei.registerFlag("PROD",(function(){return!1})),ei.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return ei.getBool("DEBUG")})),ei.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),ei.registerFlag("IS_TEST",(function(){return!1}));var Wf,kn,En,qo={},Lw={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function soe(t,e){qo[t]=e}function Ua(t){t in qo||(qo[t]=(function(r){if(r!==1&&r!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=(function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")})(r);return n.addEventListener("webglcontextlost",(function(a){a.preventDefault(),delete qo[r]}),!1),r===1?n.getContext("webgl",Lw)||n.getContext("experimental-webgl",Lw):n.getContext("webgl2",Lw)})(t));var e=qo[t];return e.isContextLost()?(delete qo[t],Ua(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),qo[t])}function gm(t,e){return[e,t]}function Vc(t){var e=je(t);return V_(Math.ceil(e/4))}function od(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function CS(t,e){var r,n,a,i,o,s,u,l,f,d=t;return ce().getNumber("WEBGL_VERSION")===2?(r=d.R32F,n=d.R16F,a=d.RGBA16F,i=d.RGBA32F,o=d.RED,s=4,u=1,l=d.HALF_FLOAT,f=d.FLOAT):(r=t.RGBA,n=t.RGBA,a=t.RGBA,i=d.RGBA,o=t.RGBA,s=4,u=4,l=e!=null?e.HALF_FLOAT_OES:null,f=t.FLOAT),{internalFormatFloat:r,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:f}}function Be(t,e,r){var n=r();return e&&(function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+foe(a,i))})(t),n}(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Wf||(Wf={})),(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(kn||(kn={})),(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(En||(En={}));var uoe=596e-10,loe=65504;function coe(t){return!!(ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||uoe<Math.abs(t)&&Math.abs(t)<loe)}function foe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function zh(t,e,r){return bi(t,e,(function(){return t.getExtension(r)}),'Extension "'+r+'" not supported on this browser.')}function doe(t,e,r){var n=bi(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Be(t,e,(function(){return t.shaderSource(n,r)})),Be(t,e,(function(){return t.compileShader(n)})),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function hoe(t,e,r){var n=bi(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Be(t,e,(function(){return t.shaderSource(n,r)})),Be(t,e,(function(){return t.compileShader(n)})),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw(function(a,i){var o=poe.exec(i);if(o==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var s=+o[1],u=a.split(`
`),l=u.length.toString().length+2,f=u.map((function(y,x){return Pu((x+1).toString(),l)+y})),d=0,p=0;p<f.length;p++)d=Math.max(f[p].length,d);var v=f.slice(0,s-1),g=f.slice(s-1,s),b=f.slice(s);console.log(v.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+Pu(g[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(b.join(`
`))})(r,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var Bw,$w,poe=/ERROR: [0-9]+:([0-9]+):/g;function voe(t,e){return bi(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function moe(t,e,r){if(Be(t,e,(function(){return t.linkProgram(r)})),t.getProgramParameter(r,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(r)),new Error("Failed to link vertex and fragment shaders.")}function Uw(t,e,r){if(Be(t,e,(function(){return t.validateProgram(r)})),t.getProgramParameter(r,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(r)),new Error("Shader program validation failed.")}function goe(t,e,r){var n=bi(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Be(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,n)})),Be(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)})),n}function yoe(t,e,r){var n=bi(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Be(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)})),Be(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,r,t.STATIC_DRAW)})),n}function boe(t,e){return bi(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function xoe(t,e){var r=ce().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var n="["+t+"x"+e+"]";throw new Error("Requested texture size "+n+" is invalid.")}if(t>r||e>r)throw n="["+t+"x"+e+"]",new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+("["+r+"x"+r+"]")+".")}function woe(t,e){return bi(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function Xj(t,e,r,n,a,i,o,s){var u=t.getAttribLocation(r,n);return u!==-1&&(Be(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,a)})),Be(t,e,(function(){return t.vertexAttribPointer(u,i,t.FLOAT,!1,o,s)})),Be(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function _oe(t,e,r,n){Aoe(t,n),Be(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),Be(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,r)}))}function Soe(t,e,r,n){return bi(t,e,(function(){return t.getUniformLocation(r,n)}),'uniform "'+n+'" not present in program.')}function Eoe(t,e,r){return t.getUniformLocation(e,r)}function Coe(t,e,r,n,a,i){Be(t,e,(function(){return _oe(t,e,n,i)})),Be(t,e,(function(){return t.uniform1i(a,i)}))}function Ww(t,e,r,n){Be(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),Be(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0)}))}function Yj(t,e,r){Be(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),Be(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function qh(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+koe(t,e))}function koe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function bi(t,e,r,n){var a=Be(t,e,(function(){return r()}));if(a==null)throw new Error(n);return a}function Aoe(t,e){var r=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=e+t.TEXTURE0;if(n<t.TEXTURE0||n>r)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+r+"]")+".")}function hv(t,e){return e===void 0&&(e=2),je(t.slice(0,t.length-e))}function pv(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function zw(t){var e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[hv(t)].concat(pv(t))),e}function Ooe(t,e){var r;e===void 0&&(e=!1);var n=ce().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,(t=t.map((function(l,f){return f>=t.length-2?XF(t[f]):t[f]}))).length===1&&(t=[2,t[0]])),t.length!==2){var a=Ko(t);t=a.newShape}var i=je(t);if(t.length<=1&&i<=n)return[1,i];if(t.length===2&&t[0]<=n&&t[1]<=n)return t;if(t.length===3&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(t.length===3&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){var o=hv(t),s=2,u=2;return t.length&&(s=(r=pv(t))[0],u=r[1]),V_(i=o*(s/2)*(u/2)).map((function(l){return 2*l}))}return V_(i)}function Vh(t){return t%2==0}function Hh(t,e){if(wr(t=t.slice(-2),e=e.slice(-2))||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){var r=t.slice(-1)[0],n=e.slice(-1)[0];if(r===n||Vh(r)&&Vh(n)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Vh(t[0])&&Vh(e[0])}function Toe(t){if(Bw==null){var e=Ua(t);Bw=e.getParameter(e.MAX_TEXTURE_SIZE)}return Bw}function Poe(t){if($w==null){var e=Ua(t);$w=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,$w)}function Noe(t){if(t===0)return 0;var e=Ua(t);return zn(e,"EXT_disjoint_timer_query_webgl2")&&t===2?2:zn(e,"EXT_disjoint_timer_query")?1:0}function zn(t,e){return t.getExtension(e)!=null}function Jj(t){try{if(Ua(t)!=null)return!0}catch{return!1}return!1}function Roe(t){if(t===0)return!1;var e=Ua(t);if(t===1){if(!zn(e,"OES_texture_float"))return!1}else if(!zn(e,"EXT_color_buffer_float"))return!1;return Q_(e)}function Ioe(t){if(t===0)return!1;var e=Ua(t);if(t!==1){if(zn(e,"EXT_color_buffer_float"))return Q_(e);if(zn(e,"EXT_color_buffer_half_float")){var r=e.getExtension("EXT_color_buffer_half_float");return(function(n,a){var i=CS(n,a),o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,s),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o,0);var u=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(o),n.deleteFramebuffer(s),u})(e,r)}return!1}return!!zn(e,"OES_texture_float")&&!!zn(e,"WEBGL_color_buffer_float")&&Q_(e)}function Q_(t){var e=CS(t),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(n),a}function joe(t){return t===2&&Ua(t).fenceSync!=null}var Ke=ce();function aL(t){ce().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ae(t,e){return ee.tidy(t,e)}function fn(t){rL(t).forEach((function(e){return e.dispose()}))}function Doe(t){return ee.keep(t)}function vv(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ce().getBool("IS_TEST")||console.warn.apply(console,t)}function bo(t,e){var r=t;if(Ia(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];for(var n=[];Array.isArray(r)||Ia(r)&&e!=="string";)n.push(r.length),r=r[0];return Array.isArray(t)&&ce().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&(function a(i,o,s){if(s=s||[],!Array.isArray(i)&&!Ia(i))return void U(o.length===0,(function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"}));U(o.length>0,(function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"})),U(i.length===o[0],(function(){return"Element arr["+s.join("][")+"] should have "+o[0]+" elements, but has "+i.length+" elements"}));for(var u=o.slice(1),l=0;l<i.length;++l)a(i[l],u,s.concat(l))})(t,n,[]),n}function Qj(t,e,r,n){if(t!=null&&(t!=="numeric"&&t!==e||t==="numeric"&&e==="string"))throw new Error("Argument '"+r+"' passed to '"+n+"' must be "+t+" tensor, but got "+e+" tensor")}function F(t,e,r,n){if(n===void 0&&(n="numeric"),t instanceof Ft)return Qj(n,t.dtype,e,r),t;var a=ad(t);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),Qj(n,a,e,r),t==null||!Ia(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){var i=t==null?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+r+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=bo(t,a);Ia(t)||Array.isArray(t)||(t=[t]);var s=a!=="string"?JF(t,a,ce().getBool("DEBUG")):dl(t,[],!0);return ee.makeTensor(s,o,a)}function mv(t,e,r,n){if(n===void 0&&(n="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+r+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(a,i){return F(a,e+"["+i+"]",r)}),n)}function iL(t,e){for(var r=0;r<t.length;++r)if(t[t.length-r-1]!==e-1-r)return!1;return!0}function Moe(t,e,r){for(var n=t.length+e.length,a=[],i=0,o=0,s=0;s<n;s++)r.indexOf(s)===-1?a.push(t[i++]):a.push(e[o++]);return a}function Wr(t,e){for(var r=[],n=t.length,a=0;a<n;a++)e.indexOf(a)===-1&&r.push(t[a]);return[r,e.map((function(i){return t[i]}))]}function dn(t,e){return Moe(t,e.map((function(r){return 1})),e)}function Sn(t,e,r){U(iL(e,r),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+r+" input."}))}function Wa(t,e){if(iL(t,e))return null;for(var r=[],n=0;n<e;++n)t.indexOf(n)===-1&&r.push(n);return t.forEach((function(a){return r.push(a)})),r}function kS(t){return t.map((function(e,r){return[r,e]})).sort((function(e,r){return e[1]-r[1]})).map((function(e){return e[0]}))}function za(t,e){for(var r=[],n=e-t;n<e;++n)r.push(n);return r}function Foe(t,e){var r=t[0].length;t.forEach((function(a,i){U(a.length===r,(function(){return"Error in concat"+r+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+r+")"}))})),U(e>=0&&e<r,(function(){return"Error in concat"+r+"D: axis must be between 0 and "+(r-1)+"."}));var n=t[0];t.forEach((function(a,i){for(var o=0;o<r;o++)U(o===e||a[o]===n[o],(function(){return"Error in concat"+r+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+n+") along the non-concatenated axis "+i+"."}))}))}function pl(t,e){for(var r=t[0].slice(),n=1;n<t.length;n++)r[e]+=t[n][e];return r}function J(t){var e=Object.keys(t);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var r=e[0],n=t[r];r.endsWith("_")&&(r=r.substring(0,r.length-1));var a=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ee.startScope(r);try{var s=n.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),ee.endScope(s),s}catch(u){throw ee.endScope(null),u}};return Object.defineProperty(a,"name",{value:r,configurable:!0}),a}Ke.registerFlag("HAS_WEBGL",(function(){return Ke.getNumber("WEBGL_VERSION")>0})),Ke.registerFlag("WEBGL_VERSION",(function(){return Jj(2)?2:Jj(1)?1:0})),Ke.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return Ke.get("WEBGL_VERSION")===2})),Ke.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Ke.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Ke.registerFlag("WEBGL_PACK",(function(){return Ke.getBool("HAS_WEBGL")})),Ke.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_PACK_CLIP",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Ke.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_PACK_REDUCE",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_CONV_IM2COL",(function(){return Ke.getBool("WEBGL_PACK")})),Ke.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return Toe(Ke.getNumber("WEBGL_VERSION"))})),Ke.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return Poe(Ke.getNumber("WEBGL_VERSION"))})),Ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=Ke.getNumber("WEBGL_VERSION");return t===0?0:Noe(t)})),Ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Ke.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),Ke.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return Roe(Ke.getNumber("WEBGL_VERSION"))})),Ke.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Ke.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ke.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Ke.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Ioe(Ke.getNumber("WEBGL_VERSION"))})),Ke.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return joe(Ke.getNumber("WEBGL_VERSION"))})),Ke.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Ke.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),tL=aL;var Pr=J({complex_:function(t,e){var r=F(t,"real","complex"),n=F(e,"imag","complex");return vt(r.shape,n.shape,"real and imag shapes, "+r.shape+" and "+n.shape+", must match in call to tf.complex()."),ee.runKernelFunc((function(a){return a.complex(r,n)}),{$real:r,$imag:n})}}),Un=J({real_:function(t){var e=F(t,"input","real");return ee.runKernelFunc((function(r){return r.real(e)}),{$input:e})}}),Aa=J({imag_:function(t){var e=F(t,"input","imag");return ee.runKernelFunc((function(r){return r.imag(e)}),{$input:e})}});function Rr(t,e,r){return xo(t,e,bo(t,r),r)}function xo(t,e,r,n){if(n==null&&(n=ad(t)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ia(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ZF(e);var a=je(e),i=je(r);U(a===i,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+a+" values but has "+i}));for(var o=0;o<r.length;++o){var s=r[o],u=o!==r.length-1||s!==je(e.slice(o));U(r[o]===e[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+r+") does not match the provided shape ("+e+"). "}))}}return Ia(t)||Array.isArray(t)||(t=[t]),e=e||r,t=n!=="string"?JF(t,n,ce().getBool("DEBUG")):dl(t,[],!0),ee.makeTensor(t,e,n)}function Ee(t,e){if((Ia(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ia(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return xo(t,[],[],e)}function er(t,e){Pl(t);var r=bo(t,e);if(r.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return xo(t,null,r,e)}function io(t,e,r){if(Pl(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=bo(t,r);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return xo(t,e,n,r)}function AS(t,e,r){if(Pl(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=bo(t,r);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return xo(t,e,n,r)}function un(t,e,r){if(Pl(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=bo(t,r);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return xo(t,e,n,r)}function Loe(t,e,r){if(Pl(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=bo(t,r);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return xo(t,e,n,r)}function Boe(t,e,r){if(Pl(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=bo(t,r);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return xo(t,e=e||n,n,r)}function $oe(t,e,r,n){return e===void 0&&(e=!0),ee.makeVariable(t,e,r,n)}function Nl(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var r=Nl(t,"float32"),n=Ot(t,"float32");return Pr(r,n)}var a=QF(je(t),e);return ee.makeTensor(a,t,e)}function Ot(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var r=Ot(t,"float32"),n=Ot(t,"float32");return Pr(r,n)}var a=id(je(t),e);return ee.makeTensor(a,t,e)}function Da(t,e,r){return ee.runKernelFunc((function(n){return n.fill(t,e,r)}),{})}function Uoe(t,e,r){if(r<=0)throw new Error("The number of values should be positive.");return ee.runKernelFunc((function(n){return n.linspace(t,e,r)}),{})}function gv(t,e,r,n){if(r===void 0&&(r=1),n===void 0&&(n="float32"),r===0)throw new Error("Cannot have a step of zero");if(t===e||t<e&&r<0||e<t&&r>1)return Ot([0],n);var a=id(Math.abs(Math.ceil((e-t)/r)),n);e<t&&r===1&&(r=-1),a[0]=t;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return er(a,n)}var oL=J({onesLike_:function(t){var e=F(t,"x","onesLike");if(e.dtype==="complex64"){var r=oL(Un(e)),n=ut(Aa(e));return Pr(r,n)}return ee.runKernelFunc((function(a){return a.onesLike(e)}),{$x:e},(function(a,i){return{$x:function(){return ut(a)}}}))}}),ut=J({zerosLike_:function(t){var e=F(t,"x","zerosLike");return ee.runKernelFunc((function(r){return r.zerosLike(e)}),{$x:e},(function(r,n){return{$x:function(){return ut(r)}}}))}}),cr=J({concat_:function(t,e){e===void 0&&(e=0),U(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var r=mv(t,"tensors","concat");r[0].dtype==="complex64"&&r.forEach((function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")})),e=vr(e,r[0].shape)[0];var n=pl(r.map((function(s){return s.shape})),e);if(je(n)===0)return Rr([],n);if((r=r.filter((function(s){return s.size>0}))).length===1)return r[0];var a=r.map((function(s){return s.shape}));Foe(a,e);var i=r,o={axis:e};return ee.runKernelFunc((function(s){return s.concat(r,e)}),i,(function(s){var u=a.map((function(l){return l[e]}));return OS(s,u,e).map((function(l){return function(){return l}}))}),"Concat",o)}}),Woe=J({concat1d_:function(t){return cr(t,0)}}),zoe=J({concat2d_:function(t,e){return cr(t,e)}}),qoe=J({concat3d_:function(t,e){return cr(t,e)}}),Voe=J({concat4d_:function(t,e){return cr(t,e)}}),OS=J({split_:function(t,e,r){r===void 0&&(r=0);var n,a=F(t,"x","split");return r=vr(r,a.shape)[0],typeof e=="number"?(U(a.shape[r]%e==0,(function(){return"Number of splits must evenly divide the axis."})),n=new Array(e).fill(a.shape[r]/e)):(U(a.shape[r]===e.reduce((function(i,o){return i+o})),(function(){return"The sum of sizes must match the size of the axis dimension."})),n=e),ee.runKernelFunc((function(i){return i.split(a,n,r)}),{$x:a},(function(i){return{$x:function(){return cr(i,r)}}}))}});function xs(t,e){return t(e={exports:{}},e.exports),e.exports}var Hoe=xs((function(t){(function(e,r,n){function a(s){var u,l=this,f=(u=4022871197,function(d){d=d.toString();for(var p=0;p<d.length;p++){var v=.02519603282416938*(u+=d.charCodeAt(p));v-=u=v>>>0,u=(v*=u)>>>0,u+=4294967296*(v-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=f(" "),l.s1=f(" "),l.s2=f(" "),l.s0-=f(s),l.s0<0&&(l.s0+=1),l.s1-=f(s),l.s1<0&&(l.s1+=1),l.s2-=f(s),l.s2<0&&(l.s2+=1),f=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function o(s,u){var l=new a(s),f=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,f&&(typeof f=="object"&&i(f,l),d.state=function(){return i(l,{})}),d}r&&r.exports?r.exports=o:this.alea=o})(0,t)})),Goe=xs((function(t){(function(e,r,n){function a(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:l+=s;for(var f=0;f<l.length+64;f++)u.x^=0|l.charCodeAt(f),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function o(s,u){var l=new a(s),f=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,f&&(typeof f=="object"&&i(f,l),d.state=function(){return i(l,{})}),d}r&&r.exports?r.exports=o:this.xor128=o})(0,t)})),Koe=xs((function(t){(function(e,r,n){function a(s){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var f=0;f<l.length+64;f++)u.x^=0|l.charCodeAt(f),f==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function o(s,u){var l=new a(s),f=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,f&&(typeof f=="object"&&i(f,l),d.state=function(){return i(l,{})}),d}r&&r.exports?r.exports=o:this.xorwow=o})(0,t)})),Xoe=xs((function(t){(function(e,r,n){function a(s){var u=this;u.next=function(){var l,f,d=u.x,p=u.i;return l=d[p],f=(l^=l>>>7)^l<<24,f^=(l=d[p+1&7])^l>>>10,f^=(l=d[p+3&7])^l>>>3,f^=(l=d[p+4&7])^l<<7,l=d[p+7&7],f^=(l^=l<<13)^l<<9,d[p]=f,u.i=p+1&7,f},(function(l,f){var d,p=[];if(f===(0|f))p[0]=f;else for(f=""+f,d=0;d<f.length;++d)p[7&d]=p[7&d]<<15^f.charCodeAt(d)+p[d+1&7]<<13;for(;p.length<8;)p.push(0);for(d=0;d<8&&p[d]===0;++d);for(d==8?p[7]=-1:p[d],l.x=p,l.i=0,d=256;d>0;--d)l.next()})(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function o(s,u){s==null&&(s=+new Date);var l=new a(s),f=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,f&&(f.x&&i(f,l),d.state=function(){return i(l,{})}),d}r&&r.exports?r.exports=o:this.xorshift7=o})(0,t)})),Yoe=xs((function(t){(function(e,r,n){function a(s){var u=this;u.next=function(){var l,f,d=u.w,p=u.X,v=u.i;return u.w=d=d+1640531527|0,f=p[v+34&127],l=p[v=v+1&127],f^=f<<13,l^=l<<17,f^=f>>>15,l^=l>>>12,f=p[v]=f^l,u.i=v,f+(d^d>>>16)|0},(function(l,f){var d,p,v,g,b,y=[],x=128;for(f===(0|f)?(p=f,f=null):(f+="\0",p=0,x=Math.max(x,f.length)),v=0,g=-32;g<x;++g)f&&(p^=f.charCodeAt((g+32)%f.length)),g===0&&(b=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,g>=0&&(b=b+1640531527|0,v=(d=y[127&g]^=p+b)==0?v+1:0);for(v>=128&&(y[127&(f&&f.length||0)]=-1),v=127,g=512;g>0;--g)p=y[v+34&127],d=y[v=v+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,y[v]=p^d;l.w=b,l.X=y,l.i=v})(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function o(s,u){s==null&&(s=+new Date);var l=new a(s),f=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,f&&(f.X&&i(f,l),d.state=function(){return i(l,{})}),d}r&&r.exports?r.exports=o:this.xor4096=o})(0,t)})),Joe=xs((function(t){(function(e,r,n){function a(s){var u=this,l="";u.next=function(){var d=u.b,p=u.c,v=u.d,g=u.a;return d=d<<25^d>>>7^p,p=p-v|0,v=v<<24^v>>>8^g,g=g-d|0,u.b=d=d<<20^d>>>12^p,u.c=p=p-v|0,u.d=v<<16^p>>>16^g,u.a=g-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var f=0;f<l.length+20;f++)u.b^=0|l.charCodeAt(f),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function o(s,u){var l=new a(s),f=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,f&&(typeof f=="object"&&i(f,l),d.state=function(){return i(l,{})}),d}r&&r.exports?r.exports=o:this.tychei=o})(0,t)})),Vo=xs((function(t){(function(e,r){var n,a=this,i=256,o=6,s="random",u=r.pow(i,o),l=r.pow(2,52),f=2*l,d=i-1;function p(x,S,E){var C=[],k=b((function N(R,I){var D,j=[],$=typeof R;if(I&&$=="object")for(D in R)try{j.push(N(R[D],I-1))}catch{}return j.length?j:$=="string"?R:R+"\0"})((S=S==1?{entropy:!0}:S||{}).entropy?[x,y(e)]:x??(function(){try{var N;return n&&(N=n.randomBytes)?N=N(i):(N=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(N)),y(N)}catch{var R=a.navigator,I=R&&R.plugins;return[+new Date,a,I,a.screen,y(e)]}})(),3),C),A=new v(C),T=function(){for(var N=A.g(o),R=u,I=0;N<l;)N=(N+I)*i,R*=i,I=A.g(1);for(;N>=f;)N/=2,R/=2,I>>>=1;return(N+I)/R};return T.int32=function(){return 0|A.g(4)},T.quick=function(){return A.g(4)/4294967296},T.double=T,b(y(A.S),e),(S.pass||E||function(N,R,I,D){return D&&(D.S&&g(D,A),N.state=function(){return g(A,{})}),I?(r[s]=N,R):N})(T,k,"global"in S?S.global:this==r,S.state)}function v(x){var S,E=x.length,C=this,k=0,A=C.i=C.j=0,T=C.S=[];for(E||(x=[E++]);k<i;)T[k]=k++;for(k=0;k<i;k++)T[k]=T[A=d&A+x[k%E]+(S=T[k])],T[A]=S;(C.g=function(N){for(var R,I=0,D=C.i,j=C.j,$=C.S;N--;)R=$[D=d&D+1],I=I*i+$[d&($[D]=$[j=d&j+R])+($[j]=R)];return C.i=D,C.j=j,I})(i)}function g(x,S){return S.i=x.i,S.j=x.j,S.S=x.S.slice(),S}function b(x,S){for(var E,C=x+"",k=0;k<C.length;)S[d&k]=d&(E^=19*S[d&k])+C.charCodeAt(k++);return y(S)}function y(x){return String.fromCharCode.apply(0,x)}if(r["seed"+s]=p,b(r.random(),e),t.exports){t.exports=p;try{n=require("crypto")}catch{}}})([],Math)}));Vo.alea=Hoe,Vo.xor128=Goe,Vo.xorwow=Koe,Vo.xorshift7=Xoe,Vo.xor4096=Yoe,Vo.tychei=Joe;var ym=Vo.alea,TS=(function(){function t(e,r,n,a,i){this.mean=e,this.stdDev=r,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=ym(o.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var r,n,a=!1;!a;){var i=void 0,o=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);r=this.mean+this.stdDev*i*u,n=this.mean+this.stdDev*o*u,this.truncated&&!this.isValidTruncated(r)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(r)},t.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},t.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},t})(),Qoe=(function(){function t(e,r,n,a){this.alpha=e,this.beta=1/r,this.dtype=n;var i=a||Math.random();this.randu=ym(i.toString()),this.randn=new TS(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var e,r,n,a,i,o;;){do a=this.randn.nextValue(),o=1+this.c*a;while(o<=0);if(o*=o*o,r=1-.331*(e=a*a)*e,n=.5*e+this.d*(1-o+Math.log(o)),(i=this.randu())<r||Math.log(i)<n)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},t.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},t})(),Zoe=(function(){function t(e,r,n,a){var i=this;if(e===void 0&&(e=0),r===void 0&&(r=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=e,this.range=r-e,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+r+" <= 1 and dtype is not float");this.random=ym(a)}return t.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t})();function Ze(t,e,r){return e===void 0&&(e="float32"),e=e||"float32",ZF(t),new Uf(t,e,r)}function ese(t,e){e===void 0&&(e=!1),console.log(t.toString(e))}var sL=J({batchToSpaceND_:function(t,e,r){var n=F(t,"x","batchToSpaceND"),a=e.reduce((function(i,o){return i*o}));return U(n.rank>=1+e.length,(function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+e.length})),U(r.length===e.length,(function(){return"crops.length is "+r.length+" but should be equal to blockShape.length  "+e.length})),U(n.shape[0]%a==0,(function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+a})),ee.runKernelFunc((function(i){return i.batchToSpaceND(n,e,r)}),{$x:n},(function(i){return{$x:function(){return i.spaceToBatchND(e,r)}}}))}}),tse=J({broadcastTo_:function(t,e){var r=F(t,"broadcastTo","x"),n=r.shape;if(e.some((function(u){return!(u>0)||u%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<r.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+r.rank+".");if(e.length>r.rank){for(var a=r.shape.slice();a.length<e.length;)a.unshift(1);r=r.reshape(a)}for(var i=Array.from(e),o=e.length-1;o>=0;o--)if(r.shape[o]===e[o])i[o]=1;else if(r.shape[o]!==1)throw new Error("broadcastTo(): ["+n+"] cannot be broadcast to ["+e+"].");var s=i.map((function(u,l){return u>1?l:-1})).filter((function(u){return u>=0}));return s.length===0?r.clone():ee.runKernelFunc((function(u){return u.tile(r,i)}),{input:r},(function(u){return{input:function(){return u.sum(s,!0)}}}))}}),rse=J({cast_:function(t,e){var r=F(t,"x","cast");if(!Kie(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&r.dtype!=="string"||e!=="string"&&r.dtype==="string")throw new Error("Only strings can be casted to strings");var n={dtype:e};return ee.runKernelFunc((function(a){return a.cast(r,e)}),{x:r},(function(a){return{x:function(){return a.clone()}}}),"Cast",n)}}),nse=J({clone_:function(t){var e=F(t,"x","clone",null);return ee.runKernelFunc((function(){return ee.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{$x:e},(function(r){return{$x:function(){return r.toFloat()}}}))}}),ase=J({cumsum_:function(t,e,r,n){e===void 0&&(e=0),r===void 0&&(r=!1),n===void 0&&(n=!1);var a=F(t,"x","cumsum"),i=Wa([e|=0],a.rank),o=a;i!=null&&(o=a.transpose(i));var s=za(1,a.rank)[0],u=ee.runKernelFunc((function(l){return l.cumsum(o,s,r,n)}),{permutedX:o},(function(l){return{permutedX:function(){return l.cumsum(e,r,!n)}}}));return i!=null&&(u=u.transpose(i)),u}}),ise=J({depthToSpace_:function(t,e,r){r===void 0&&(r="NHWC");var n=F(t,"x","depthToSpace"),a=r==="NHWC"?n.shape[1]:n.shape[2],i=r==="NHWC"?n.shape[2]:n.shape[3],o=r==="NHWC"?n.shape[3]:n.shape[1];return U(a*e>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+e+`  for depthToSpace with input shape
      `+n.shape})),U(i*e>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+` for depthToSpace with input shape
          `+n.shape})),U(o%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+o+" for depthToSpace with input shape "+n.shape})),ee.runKernelFunc((function(s){return s.depthToSpace(n,e,r)}),{$x:n})}}),$n=J({expandDims_:function(t,e){e===void 0&&(e=0);var r=F(t,"x","expandDims",null);U(e<=r.rank,(function(){return"Axis must be <= rank of the tensor"}));var n=r.shape.slice();return e<0&&(U(-(r.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(r.rank+1)+", "+r.rank+"]"})),e=r.rank+e+1),n.splice(e,0,1),fa(r,n)}}),uL=J({eye_:function(t,e,r,n){n===void 0&&(n="float32"),e==null&&(e=t);for(var a=Ze([t,e],n),i=t<=e?t:e,o=0;o<i;++o)a.set(1,o,o);var s=a.toTensor().as2D(t,e);if(r==null)return s;if(r.length===1)return Nu($n(s,0),[r[0],1,1]);if(r.length===2)return Nu($n($n(s,0),0),[r[0],r[1],1,1]);if(r.length===3)return Nu($n($n($n(s,0),0),0),[r[0],r[1],r[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+r.length+"D.")}}),ose=J({multinomial_:function(t,e,r,n){n===void 0&&(n=!1);var a=F(t,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);r=r||Math.random();var s=o===1?a.as2D(1,-1):a,u=ee.runKernelFunc((function(l){return l.multinomial(s,n,e,r)}),{logits2D:s});return o===1?u.as1D():u}}),Z_=J({oneHot_:function(t,e,r,n){if(r===void 0&&(r=1),n===void 0&&(n=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var a=F(t,"indices","oneHot","int32"),i=a.shape.concat([e]);return a=a.flatten(),ee.runKernelFunc((function(o){return o.oneHot(a,e,r,n)}),{$indices:a},(function(o){return{$indices:function(){return Ot(a.shape,"float32")}}})).reshape(i)}}),ws=J({pad_:function(t,e,r){r===void 0&&(r=0);var n=F(t,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:e,constantValue:r};return ee.runKernelFunc((function(i){return i.pad(n,e,r)}),{x:n},(function(i){var o=e.map((function(s){return s[0]}));return{x:function(){return i.slice(o,n.shape)}}}),"PadV2",a)}}),sse=J({pad1d_:function(t,e,r){return r===void 0&&(r=0),U(e.length===2,(function(){return"Invalid number of paddings. Must be length of 2."})),ws(t,[e],r)}}),use=J({pad2d_:function(t,e,r){return r===void 0&&(r=0),U(e.length===2&&e[0].length===2&&e[1].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),ws(t,e,r)}}),lse=J({pad3d_:function(t,e,r){return r===void 0&&(r=0),U(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),ws(t,e,r)}}),cse=J({pad4d_:function(t,e,r){return r===void 0&&(r=0),U(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),ws(t,e,r)}}),fse=J({rand_:function(t,e,r){var n=je(t),a=null;if(r==null||r==="float32")a=new Float32Array(n);else if(r==="int32")a=new Int32Array(n);else{if(r!=="bool")throw new Error("Unknown data type "+r);a=new Uint8Array(n)}for(var i=0;i<n;i++)a[i]=e();return ee.makeTensor(a,t,r)}}),dse=J({randomNormal_:function(t,e,r,n,a){if(e===void 0&&(e=0),r===void 0&&(r=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new TS(e,r,n,!1,a),o=Ze(t,n),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),hse=J({randomGamma_:function(t,e,r,n,a){if(r===void 0&&(r=1),n===void 0&&(n="float32"),r==null&&(r=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var i=new Qoe(e,r,n,a),o=Ze(t,n),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),lL=J({randomUniform_:function(t,e,r,n,a){e===void 0&&(e=0),r===void 0&&(r=1),n===void 0&&(n="float32");for(var i=Ze(t,n),o=new Zoe(e,r,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),fa=J({reshape_:function(t,e){var r=F(t,"x","reshape",null);e=Hie(e,r.size),U(r.size===je(e),(function(){return"new shape and old shape must have the same number of elements."}));var n={shape:e};return ee.runKernelFunc((function(a){return a.reshape(r,e)}),{x:r},(function(a){return{x:function(){return a.reshape(r.shape)}}}),"Reshape",n)}}),cL=J({spaceToBatchND_:function(t,e,r){var n=F(t,"x","spaceToBatchND");return U(n.rank>=1+e.length,(function(){return"input rank "+n.rank+" should be > than [blockShape] "+e.length})),U(r.length===e.length,(function(){return"paddings.shape[0] "+r.length+" must be equal to [blockShape] "+e.length})),U(n.shape.reduce((function(a,i,o){return o>0&&o<=e.length?a&&(i+r[o-1][0]+r[o-1][1])%e[o-1]==0:a}),!0),(function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+r.toString()+" must be divisible by blockShapes "+e.toString()})),ee.runKernelFunc((function(a){return a.spaceToBatchND(n,e,r)}),{$x:n},(function(a){return{$x:function(){return a.batchToSpaceND(e,r)}}}))}}),fL=J({squeeze_:function(t,e){var r=F(t,"x","squeeze");return fa(r,Ko(r.shape,e).newShape)}}),Tn=J({stack_:function(t,e){e===void 0&&(e=0);var r=mv(t,"tensors","stack");if(U(r.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),r.length===1)return r[0].expandDims(e);var n=r[0].rank,a=r[0].shape,i=r[0].dtype;U(e<=n,(function(){return"Axis must be <= rank of the tensor"})),r.forEach((function(s){vt(a,s.shape,"All tensors passed to stack must have matching shapes")})),r.forEach((function(s){U(i===s.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=r.map((function(s){return s.expandDims(e)}));return cr(o,e)}}),Nu=J({tile_:function(t,e){var r=F(t,"x","tile",null);U(r.rank===e.length,(function(){return"Error in transpose: rank of input "+r.rank+" must match length of reps "+e+"."}));var n=[r],a={reps:e};return ee.runKernelFunc((function(i,o){var s=i.tile(r,e);return o([r]),s}),{x:r},(function(i,o){var s=o[0];return{x:function(){var u=ut(s);if(s.rank===1)for(var l=0;l<e[0];++l)u=u.add(i.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<e[0];++l)for(var f=0;f<e[1];++f)u=u.add(i.slice([l*s.shape[0],f*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<e[0];++l)for(f=0;f<e[1];++f)for(var d=0;d<e[2];++d)u=u.add(i.slice([l*s.shape[0],f*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<e[0];++l)for(f=0;f<e[1];++f)for(d=0;d<e[2];++d)for(var p=0;p<e[3];++p)u=u.add(i.slice([l*s.shape[0],f*s.shape[1],d*s.shape[2],p*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}}),"Tile",a,n)}}),pse=J({truncatedNormal_:function(t,e,r,n,a){if(e===void 0&&(e=0),r===void 0&&(r=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new TS(e,r,n,!0,a),o=Ze(t,n),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),fr=J({unstack_:function(t,e){e===void 0&&(e=0),e=e||0;var r=F(t,"x","unstack");U(e>=-r.shape.length&&e<r.shape.length,(function(){return"Axis = "+e+" is not in [-"+r.shape.length+", "+r.shape.length+")"})),e<0&&(e+=r.shape.length);var n={axis:e};return ee.runKernelFunc((function(a){return a.unstack(r,e)}),{x:r},(function(a){return{x:function(){return Tn(a,e)}}}),"Unpack",n)}}),vse=function(t,e){return Ne(this,void 0,void 0,(function(){var r,n,a,i,o,s,u,l,f,d;return Re(this,(function(p){switch(p.label){case 0:return r=F(t,"x","setdiff1d"),n=F(e,"y","setdiff1d"),U(r.dtype===n.dtype,(function(){return"x and y should have the same dtype, but got x ("+r.dtype+") and y ("+n.dtype+")."})),U(r.rank===1,(function(){return"x should be 1D tensor, but got x ("+r.shape+")."})),U(n.rank===1,(function(){return"y should be 1D tensor, but got y ("+n.shape+")."})),[4,r.data()];case 1:return a=p.sent(),[4,n.data()];case 2:for(i=p.sent(),o=new Set(i),s=0,f=0;f<a.length;f++)o.has(a[f])||s++;for(u=new Uf([s],r.dtype),l=new Uf([s],"int32"),f=0,d=0;f<a.length;f++)o.has(a[f])||(u.values[d]=a[f],l.values[d]=f,d++);return[2,[u.toTensor(),l.toTensor()]]}}))}))};function yv(t,e,r,n){n===void 0&&(n=!0);var a=[];if(n)(a=a.concat(e.slice(0))).push(t[0]/r),a=a.concat(t.slice(1));else{a=a.concat(t[0]);for(var i=e.length,o=0;o<i;++o)a=a.concat([t[o+1]/e[o],e[o]]);a=a.concat(t.slice(i+1))}return a}function bv(t,e,r){r===void 0&&(r=!0);var n=[];if(r){n.push(e);for(var a=e+1;a<t;++a)a<=2*e?(n.push(a),n.push(a-(e+1))):n.push(a)}else{var i=[],o=[];for(a=1;a<t;++a)a>=2*e+1||a%2==1?o.push(a):i.push(a);n.push.apply(n,i),n.push(0),n.push.apply(n,o)}return n}function xv(t,e,r,n){n===void 0&&(n=!0);var a=[];n?a.push(t[0]/r):a.push(t[0]*r);for(var i=1;i<t.length;++i)i<=e.length?n?a.push(e[i-1]*t[i]):a.push(t[i]/e[i-1]):a.push(t[i]);return a}function dL(t,e){for(var r=[0],n=0;n<e;++n)r.push(t[n][0]);return r}function hL(t,e,r){for(var n=t.slice(0,1),a=0;a<r;++a)n.push(t[a+1]-e[a][0]-e[a][1]);return n}function pL(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(t.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var r=e.shape,n=r[r.length-1],a=1,i=0;i<r.length-1;++i)a*=r[i];var o=t.shape,s=r.slice();s.pop();var u=1;for(i=n;i<t.rank;++i)u*=o[i],s.push(o[i]);var l=ja(t.shape).map((function(f){return f/u})).concat([1]).slice(0,n);return[s,a,u,l]}var vL=30;function qw(t){return t<=vL?t:G_(t,Math.floor(Math.sqrt(t)))}function mse(t,e,r){var n=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+r.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+n+", and batchDim: "+a+".";if(r.rank<a)throw new Error(i+" update.rank < "+a+". ");if(t.length<n+(r.rank-a))throw new Error(i+" Output shape length < "+(n+(r.rank-a)));if(r.rank!==a+t.length-n)throw new Error(i+" update.rank != "+(a+t.length-n));for(var o=0;o<a;++o)if(r.shape[o]!==e.shape[o])throw new Error(i+" updates.shape["+o+"] ("+r.shape[o]+") != indices.shape["+o+"] ("+e.shape[o]+").");for(o=0;o<r.rank-a;++o)if(r.shape[o+a]!==t[o+n])throw new Error(i+" updates.shape["+(o+a)+"] ("+r.shape[o+a]+") != shape["+(o+a)+"] ("+t[o+a]+")")}function gse(t,e,r){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(r.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+r);if(r.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(t.size===0)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}mse(r,e,t)}function wv(t,e,r){for(var n=e.shape.length,a=n>1?e.shape[n-1]:1,i=r.length,o=1,s=a;s<i;++s)o*=r[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:je(e.shape)/u,sliceSize:o,strides:ja(r.slice(0,a)).concat([1]),outputSize:je(r)}}function yse(t,e,r){U(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),U(t.rank===r.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+r+" must match the rank of the array ("+t.rank+")."}));for(var n=function(i){U(e[i]+r[i]<=t.shape[i],(function(){return"Error in slice"+t.rank+"D: begin["+i+"] + size["+i+"] ("+(e[i]+r[i])+") would overflow input.shape["+i+"] ("+t.shape[i]+")"}))},a=0;a<t.rank;++a)n(a)}function Zj(t){for(var e=[],r=0;t>0;)1&t&&e.push(r),t/=2,r++;return e}function PS(t,e,r){for(var n=[],a=0;a<t.length;a++)n[a]=Math.ceil((e[a]-t[a])/r[a]);return n}function bse(t,e,r,n,a){var i=e[a],o=r[a]||1;(t&1<<a||i==null)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=n[a];return i<0&&(i+=s),i=q_(0,i,s-1)}function xse(t,e,r,n,a){var i=e[a],o=r[a]||1;(t&1<<a||i==null)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=n[a];return i<0&&(i+=s),i=o>0?q_(0,i,s):q_(-1,i,s-1)}function mL(t,e,r){for(var n=r.length,a=0;a<r.length;a++)if(r[a]>1){n=a;break}for(a=n+1;a<r.length;a++)if(e[a]>0||r[a]!==t[a])return!1;return!0}function gL(t,e){for(var r=t.length>0?t[t.length-1]:1,n=0;n<t.length-1;n++)r+=t[n]*e[n];return r}function wse(t,e){U(H_(t),(function(){return"The f passed in variableGrads(f) must be a function"})),U(e==null||Array.isArray(e)&&e.every((function(f){return f instanceof hl})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var r=e!=null;if(!r)for(var n in e=[],ee.registeredVariables)e.push(ee.registeredVariables[n]);var a=r?e.filter((function(f){return!f.trainable})):null,i=e.length;U((e=e.filter((function(f){return f.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var o=ee.gradients(t,e,null,!0),s=o.value,u=o.grads;U(u.some((function(f){return f!=null})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),U(s.rank===0,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var l={};return e.forEach((function(f,d){u[d]!=null&&(l[f.name]=u[d])})),a?.forEach((function(f){return l[f.name]=null})),{value:s,grads:l}}function bm(t){return ee.customGrad(t)}var xi=J({softmax_:function(t,e){e===void 0&&(e=-1);var r=F(t,"logits","softmax","float32");if(e===-1&&(e=r.rank-1),e!==r.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+r.rank+" and dim was "+e);return ee.runKernelFunc((function(n,a){var i=n.softmax(r,e);return a([i]),i}),{logits:r},(function(n,a){var i=a[0],o=n.mul(i);return{logits:function(){return o.sub(o.sum([e],!0).mul(i))}}}),"Softmax",{dim:e},[],[!0])}}),_se=J({logSoftmax_:function(t,e){e===void 0&&(e=-1);var r=F(t,"logits","logSoftmax");if(e===-1&&(e=r.rank-1),e!==r.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+r.rank+" and axis was "+e);return bm((function(n,a){var i=n.max(e,!0),o=n.sub(i),s=o.toFloat().sub(o.exp().sum(e,!0).log());return a([s]),{value:s,gradFunc:function(u,l){var f=l[0].exp();return u.sub(u.sum(e,!0).mul(f))}}}))(r)}}),yL=(function(){function t(e,r){this.backend=e,this.dataMover=r,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},t.prototype.set=function(e,r){this.dataIdsCount++,this.data.set(e,r)},t.prototype.has=function(e){return this.data.has(e)},t.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},t.prototype.numDataIds=function(){return this.dataIdsCount},t})(),bL=(function(){function t(){}return t.prototype.time=function(e){return ae("time")},t.prototype.read=function(e){return ae("read")},t.prototype.readSync=function(e){return ae("readSync")},t.prototype.numDataIds=function(){return ae("numDataIds")},t.prototype.disposeData=function(e){return ae("disposeData")},t.prototype.write=function(e,r,n){return ae("write")},t.prototype.move=function(e,r,n,a){return ae("move")},t.prototype.memory=function(){return ae("memory")},t.prototype.floatPrecision=function(){return ae("floatPrecision")},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.batchMatMul=function(e,r,n,a){return ae("batchMatMul")},t.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,ae("fusedBatchMatMul")},t.prototype.slice=function(e,r,n){return ae("slice")},t.prototype.stridedSlice=function(e,r,n,a){return ae("stridedSlice")},t.prototype.unstack=function(e,r){return ae("unstack")},t.prototype.reverse=function(e,r){return ae("reverse")},t.prototype.concat=function(e,r){return ae("concat")},t.prototype.neg=function(e){return ae("neg")},t.prototype.add=function(e,r){return ae("add")},t.prototype.addN=function(e){return ae("addN")},t.prototype.subtract=function(e,r){return ae("subtract")},t.prototype.multiply=function(e,r){return ae("multiply")},t.prototype.realDivide=function(e,r){return ae("realDivide")},t.prototype.floorDiv=function(e,r){return ae("floorDiv")},t.prototype.sum=function(e,r){return ae("sum")},t.prototype.prod=function(e,r){return ae("prod")},t.prototype.unsortedSegmentSum=function(e,r,n){return ae("unsortedSegmentSum")},t.prototype.argMin=function(e,r){return ae("argMin")},t.prototype.argMax=function(e,r){return ae("argMax")},t.prototype.equal=function(e,r){return ae("equal")},t.prototype.notEqual=function(e,r){return ae("notEqual")},t.prototype.less=function(e,r){return ae("less")},t.prototype.lessEqual=function(e,r){return ae("lessEqual")},t.prototype.greater=function(e,r){return ae("greater")},t.prototype.greaterEqual=function(e,r){return ae("greaterEqual")},t.prototype.logicalNot=function(e){return ae("logicalNot")},t.prototype.logicalAnd=function(e,r){return ae("logicalAnd")},t.prototype.logicalOr=function(e,r){return ae("logicalOr")},t.prototype.where=function(e){return ae("where")},t.prototype.select=function(e,r,n){return ae("select")},t.prototype.topk=function(e,r,n){return ae("topk")},t.prototype.min=function(e,r){return ae("min")},t.prototype.minimum=function(e,r){return ae("minimum")},t.prototype.mod=function(e,r){return ae("mod")},t.prototype.max=function(e,r){return ae("max")},t.prototype.maximum=function(e,r){return ae("maximum")},t.prototype.all=function(e,r){return ae("all")},t.prototype.any=function(e,r){return ae("any")},t.prototype.squaredDifference=function(e,r){return ae("squaredDifference")},t.prototype.ceil=function(e){return ae("ceil")},t.prototype.floor=function(e){return ae("floor")},t.prototype.round=function(e){return ae("round")},t.prototype.sign=function(e){return ae("sign")},t.prototype.isNaN=function(e){return ae("isNaN")},t.prototype.isInf=function(e){return ae("isInf")},t.prototype.isFinite=function(e){return ae("isFinite")},t.prototype.pow=function(e,r){return ae("pow")},t.prototype.exp=function(e){return ae("exp")},t.prototype.expm1=function(e){return ae("expm1")},t.prototype.softmax=function(e,r){return ae("softmax")},t.prototype.log=function(e){return ae("log")},t.prototype.log1p=function(e){return ae("log1p")},t.prototype.sqrt=function(e){return ae("sqrt")},t.prototype.rsqrt=function(e){return ae("rsqrt")},t.prototype.square=function(e){return ae("square")},t.prototype.reciprocal=function(e){return ae("reciprocal")},t.prototype.relu=function(e){return ae("relu")},t.prototype.relu6=function(e){return ae("relu6")},t.prototype.prelu=function(e,r){return ae("prelu")},t.prototype.elu=function(e){return ae("elu")},t.prototype.eluDer=function(e,r){return ae("eluDer")},t.prototype.selu=function(e){return ae("selu")},t.prototype.int=function(e){return ae("int")},t.prototype.clip=function(e,r,n){return ae("clip")},t.prototype.abs=function(e){return ae("abs")},t.prototype.complexAbs=function(e){return ae("complexAbs")},t.prototype.sigmoid=function(e){return ae("sigmoid")},t.prototype.softplus=function(e){return ae("softplus")},t.prototype.sin=function(e){return ae("sin")},t.prototype.cos=function(e){return ae("cos")},t.prototype.tan=function(e){return ae("tan")},t.prototype.asin=function(e){return ae("asin")},t.prototype.acos=function(e){return ae("acos")},t.prototype.atan=function(e){return ae("atan")},t.prototype.atan2=function(e,r){return ae("atan2")},t.prototype.sinh=function(e){return ae("sinh")},t.prototype.cosh=function(e){return ae("cosh")},t.prototype.tanh=function(e){return ae("tanh")},t.prototype.asinh=function(e){return ae("asinh")},t.prototype.acosh=function(e){return ae("acosh")},t.prototype.atanh=function(e){return ae("atanh")},t.prototype.erf=function(e){return ae("erf")},t.prototype.step=function(e,r){return ae("step")},t.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,ae("fusedConv2d")},t.prototype.conv2d=function(e,r,n){return ae("conv2d")},t.prototype.conv2dDerInput=function(e,r,n){return ae("conv2dDerInput")},t.prototype.conv2dDerFilter=function(e,r,n){return ae("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,ae("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(e,r,n){return ae("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(e,r,n){return ae("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(e,r,n){return ae("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(e,r,n){return ae("conv3d")},t.prototype.conv3dDerInput=function(e,r,n){return ae("conv3dDerInput")},t.prototype.conv3dDerFilter=function(e,r,n){return ae("conv3dDerFilter")},t.prototype.maxPool=function(e,r){return ae("maxPool")},t.prototype.maxPoolBackprop=function(e,r,n,a){return ae("maxPoolBackprop")},t.prototype.avgPool=function(e,r){return ae("avgPool")},t.prototype.avgPoolBackprop=function(e,r,n){return ae("avgPoolBackprop")},t.prototype.avgPool3d=function(e,r){return ae("avgPool3d")},t.prototype.avgPool3dBackprop=function(e,r,n){return ae("avgPool3dBackprop")},t.prototype.maxPool3d=function(e,r){return ae("maxPool3d")},t.prototype.maxPool3dBackprop=function(e,r,n,a){return ae("maxPool3dBackprop")},t.prototype.reshape=function(e,r){return ae("reshape")},t.prototype.cast=function(e,r){return ae("cast")},t.prototype.tile=function(e,r){return ae("tile")},t.prototype.pad=function(e,r,n){return ae("pad")},t.prototype.transpose=function(e,r){return ae("transpose")},t.prototype.gather=function(e,r,n){return ae("gather")},t.prototype.gatherND=function(e,r){return ae("gatherND")},t.prototype.scatterND=function(e,r,n){return ae("scatterND")},t.prototype.batchToSpaceND=function(e,r,n){return ae("batchToSpaceND")},t.prototype.spaceToBatchND=function(e,r,n){return ae("spaceToBatchND")},t.prototype.resizeBilinear=function(e,r,n,a){return ae("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(e,r,n){return ae("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(e,r,n,a){return ae("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(e,r,n){return ae("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(e,r,n,a,i,o){return ae("batchNormalization")},t.prototype.localResponseNormalization4D=function(e,r,n,a,i){return ae("localResponseNormalization4D")},t.prototype.LRNGrad=function(e,r,n,a,i,o,s){return ae("LRNGrad")},t.prototype.multinomial=function(e,r,n,a){return ae("multinomial")},t.prototype.oneHot=function(e,r,n,a){return ae("oneHot")},t.prototype.cumsum=function(e,r,n,a){return ae("cumsum")},t.prototype.nonMaxSuppression=function(e,r,n,a,i){return ae("nonMaxSuppression")},t.prototype.fft=function(e){return ae("fft")},t.prototype.ifft=function(e){return ae("ifft")},t.prototype.complex=function(e,r){return ae("complex")},t.prototype.real=function(e){return ae("real")},t.prototype.imag=function(e){return ae("imag")},t.prototype.cropAndResize=function(e,r,n,a,i,o){return ae("cropAndResize")},t.prototype.depthToSpace=function(e,r,n){return ae("depthToSpace")},t.prototype.split=function(e,r,n){return ae("split")},t.prototype.sparseToDense=function(e,r,n,a){return ae("sparseToDense")},t.prototype.diag=function(e){return ae("diag")},t.prototype.fill=function(e,r,n){return ae("fill")},t.prototype.onesLike=function(e){return ae("onesLike")},t.prototype.zerosLike=function(e){return ae("zerosLike")},t.prototype.linspace=function(e,r,n){return ae("linspace")},t.prototype.dispose=function(){return ae("dispose")},t})();function ae(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function to(t,e){for(var r=t.length,n=[],a=0;a<r;a++){var i=r-1-a,o=t[i]||1;(e[e.length-1-a]||1)>1&&o===1&&n.unshift(i)}return n}function dr(t,e){for(var r=[],n=0;n<e.length;n++){var a=t[t.length-n-1],i=e.length-n-1,o=e[i];(a==null||a===1&&o>1)&&r.unshift(i)}return r}function ot(t,e){for(var r=[],n=Math.max(t.length,e.length),a=0;a<n;a++){var i=t[t.length-a-1];i==null&&(i=1);var o=e[e.length-a-1];if(o==null&&(o=1),i===1)r.unshift(o);else if(o===1)r.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");r.unshift(i)}}return r}function zf(t,e,r,n,a,i,o){o===void 0&&(o="channelsLast");var s,u=Ev(e),l=u[0],f=u[1];if(o==="channelsLast")s=[l,f,t[3],t[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);s=[l,f,t[1],t[1]]}return _s(t,s,r,n,a,i,!1,o)}function _v(t,e,r,n,a,i,o){o===void 0&&(o="NDHWC");var s,u,l=e2(e),f=l[0],d=l[1],p=l[2];if(o==="NDHWC")u="channelsLast",s=[f,d,p,t[4],t[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[f,d,p,t[1],t[1]]}return Sv(t,s,r,n,a,!1,u,i)}function _s(t,e,r,n,a,i,o,s){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],f=u[1],d=u[2],p=u[3];if(s==="channelsLast")l=t[0],f=t[1],d=t[2],p=t[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=t[0],p=t[1],f=t[2],d=t[3]}var v,g=e[0],b=e[1],y=e[3],x=Ev(r),S=x[0],E=x[1],C=Ev(n),k=C[0],A=C[1],T=Ru(g,k),N=Ru(b,A),R=(function(W,q,X,Y,z,B,G,L){var K,oe,he;if(typeof W=="number"){K={top:W,bottom:W,left:W,right:W,type:W===0?"VALID":"NUMBER"};var ge=(function(_e,le,$e,Fe,Xe){Fe==null&&(Fe=xL(_e,le,$e));var Ye=_e[0],mt=_e[1],Ut=Hc((Ye-le+2*Fe)/$e+1,Xe);U(Xt(Ut),(function(){return"The output # of rows ("+Ut+") must be an integer. Change the stride and/or zero pad parameters"}));var Pt=Hc((mt-le+2*Fe)/$e+1,Xe);return U(Xt(Pt),(function(){return"The output # of columns ("+Pt+") must be an integer. Change the stride and/or zero pad parameters"})),[Ut,Pt]})([q,X],B,Y,W,L);oe=ge[0],he=ge[1]}else if(W==="same"){oe=Math.ceil(q/Y),he=Math.ceil(X/z);var xe=Math.max(0,(oe-1)*Y+B-q),ke=Math.max(0,(he-1)*z+G-X),we=Math.floor(xe/2),ue=xe-we,Se=Math.floor(ke/2);K={top:we,bottom:ue,left:Se,right:ke-Se,type:"SAME"}}else{if(W!=="valid")throw Error("Unknown padding parameter: "+W);K={top:0,bottom:0,left:0,right:0,type:"VALID"},oe=Math.ceil((q-B+1)/Y),he=Math.ceil((X-G+1)/z)}return{padInfo:K,outHeight:oe,outWidth:he}})(a,f,d,S,E,T,N,i),I=R.padInfo,D=R.outHeight,j=R.outWidth,$=o?y*p:y;return s==="channelsFirst"?v=[l,$,D,j]:s==="channelsLast"&&(v=[l,D,j,$]),{batchSize:l,dataFormat:s,inHeight:f,inWidth:d,inChannels:p,outHeight:D,outWidth:j,outChannels:$,padInfo:I,strideHeight:S,strideWidth:E,filterHeight:g,filterWidth:b,effectiveFilterHeight:T,effectiveFilterWidth:N,dilationHeight:k,dilationWidth:A,inShape:t,outShape:v,filterShape:e}}function Sv(t,e,r,n,a,i,o,s){i===void 0&&(i=!1),o===void 0&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],f=u[1],d=u[2],p=u[3],v=u[4];if(o==="channelsLast")l=t[0],f=t[1],d=t[2],p=t[3],v=t[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);l=t[0],v=t[1],f=t[2],d=t[3],p=t[4]}var g,b=e[0],y=e[1],x=e[2],S=e[4],E=e2(r),C=E[0],k=E[1],A=E[2],T=e2(n),N=T[0],R=T[1],I=T[2],D=Ru(b,N),j=Ru(y,R),$=Ru(x,I),W=(function(G,L,K,oe,he,ge,xe,ke,we,ue,Se){var _e,le,$e,Fe;if(typeof G=="number"){_e={top:G,bottom:G,left:G,right:G,front:G,back:G,type:G===0?"VALID":"NUMBER"};var Xe=(function(Pn,Xr,Cs,ga,Yr,ks){Yr==null&&(Yr=xL(Pn,Xr,ga));var _o=Pn[0],So=Pn[1],Rm=Pn[2],As=Hc((_o-Xr+2*Yr)/ga+1,ks);U(Xt(As),(function(){return"The output # of depths ("+As+") must be an integer. Change the stride and/or zero pad parameters"}));var Os=Hc((So-Xr+2*Yr)/ga+1,ks);U(Xt(Os),(function(){return"The output # of rows ("+Os+") must be an integer. Change the stride and/or zero pad parameters"}));var Rl=Hc((Rm-Xr+2*Yr)/ga+1,ks);return U(Xt(Rl),(function(){return"The output # of columns ("+Rl+") must be an integer. Change the stride and/or zero pad parameters"})),[As,Os,Rl,Cs]})([L,K,oe,1],ke,1,he,G,Se);le=Xe[0],$e=Xe[1],Fe=Xe[2]}else if(G==="same"){le=Math.ceil(L/he),$e=Math.ceil(K/ge),Fe=Math.ceil(oe/xe);var Ye=(le-1)*he+ke-L,mt=($e-1)*ge+we-K,Ut=(Fe-1)*xe+ue-oe,Pt=Math.floor(Ye/2),Er=Ye-Pt,Nt=Math.floor(mt/2),Yt=mt-Nt,Mr=Math.floor(Ut/2);_e={top:Nt,bottom:Yt,left:Mr,right:Ut-Mr,front:Pt,back:Er,type:"SAME"}}else{if(G!=="valid")throw Error("Unknown padding parameter: "+G);_e={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},le=Math.ceil((L-ke+1)/he),$e=Math.ceil((K-we+1)/ge),Fe=Math.ceil((oe-ue+1)/xe)}return{padInfo:_e,outDepth:le,outHeight:$e,outWidth:Fe}})(a,f,d,p,C,k,A,D,j,$,s),q=W.padInfo,X=W.outDepth,Y=W.outHeight,z=W.outWidth,B=i?S*v:S;return o==="channelsFirst"?g=[l,B,X,Y,z]:o==="channelsLast"&&(g=[l,X,Y,z,B]),{batchSize:l,dataFormat:o,inDepth:f,inHeight:d,inWidth:p,inChannels:v,outDepth:X,outHeight:Y,outWidth:z,outChannels:B,padInfo:q,strideDepth:C,strideHeight:k,strideWidth:A,filterDepth:b,filterHeight:y,filterWidth:x,effectiveFilterDepth:D,effectiveFilterHeight:j,effectiveFilterWidth:$,dilationDepth:N,dilationHeight:R,dilationWidth:I,inShape:t,outShape:g,filterShape:e}}function xL(t,e,r,n){n===void 0&&(n=1);var a=Ru(e,n);return Math.floor((t[0]*(r-1)-r+a)/2)}function Ev(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function e2(t){return typeof t=="number"?[t,t,t]:t}function Ru(t,e){return e<=1?t:t+(t-1)*(e-1)}function Hc(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function vl(t){var e=Ev(t),r=e[0],n=e[1],a=e[2];return r===1&&n===1&&a===1}function hn(t,e){return vl(t)||vl(e)}function NS(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function wL(t,e,r){if(e==="complex64"){if(t.dtype==="complex64")return t.clone();var n=Ot(t.shape),a=t.toFloat(),i=r.complex(a,n);return n.dispose(),a.dispose(),i}if(!Xie(t.dtype,e))return ee.makeTensorFromDataId(t.dataId,t.shape,e);if(t.dtype==="complex64"){var o=r.real(t);return i=o.cast(e),o.dispose(),i}if(e==="int32")return r.int(t);if(e==="bool"){var s=Ee(0,t.dtype);return i=r.notEqual(t,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function t2(t,e){return ee.makeTensorFromDataId(t.dataId,e,t.dtype)}function _L(t,e,r){var n=(e-t)/(r-1),a=id(r,"float32");a[0]=t;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return er(a,"float32")}function r2(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var r=new Float32Array(2*t.length),n=0;n<r.length;n+=2)r[n]=t[n/2],r[n+1]=e[n/2];return r}function eD(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Sse(t,e,r,n){t[2*n]=e,t[2*n+1]=r}function Ese(t,e,r){var n=(r?2:-2)*Math.PI*(t/e);return{real:Math.cos(n),imag:Math.sin(n)}}function Cse(t,e,r){var n=(function(i,o,s){return(function(u,l,f){for(var d=0,p=u.length,v=0,g=!1;d<p;){var b=f(l,u[v=d+(p-d>>>1)]);b>0?d=v+1:(p=v,g=!b)}return g?d:-d-1})(i,o,s||kse)})(t,e,r),a=n<0?-(n+1):n;t.splice(a,0,e)}function kse(t,e){return t>e?1:t<e?-1:0}function RS(t,e,r,n,a){return SL(t,e,r,n,a,0).selectedIndices}function IS(t,e,r,n,a,i){var o=SL(t,e,r,n,a,i);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function SL(t,e,r,n,a,i,o,s){s===void 0&&(s=!1);for(var u=Array.from(e).map((function(C,k){return{score:C,boxIndex:k,suppressBeginIndex:0}})).filter((function(C){return C.score>a})).sort(tD),l=i>0?-.5/i:0,f=[],d=[];f.length<r&&u.length>0;){var p=u.pop(),v=p.score,g=p.boxIndex,b=p.suppressBeginIndex;if(v<a)break;for(var y=!1,x=f.length-1;x>=b;--x){var S=Ase(t,g,f[x]);if(S>=n){y=!0;break}if(p.score=p.score*Ose(n,l,S),p.score<=a)break}p.suppressBeginIndex=f.length,y||(p.score===v?(f.push(g),d.push(p.score)):p.score>a&&Cse(u,p,tD))}var E=f.length;return s&&(f.fill(0,E),d.fill(0,E)),{selectedIndices:er(f,"int32"),selectedScores:er(d,"float32"),numValidOutputs:Ee(E,"int32")}}function Ase(t,e,r){var n=t.subarray(4*e,4*e+4),a=t.subarray(4*r,4*r+4),i=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]),l=Math.min(a[0],a[2]),f=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),v=(s-i)*(u-o),g=(d-l)*(p-f);if(v<=0||g<=0)return 0;var b=Math.max(i,l),y=Math.max(o,f),x=Math.min(s,d),S=Math.min(u,p),E=Math.max(x-b,0)*Math.max(S-y,0);return E/(v+g-E)}function Ose(t,e,r){var n=Math.exp(e*r*r);return r<=t?n:0}function tD(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function EL(t,e,r){var n=new Array(t.rank).fill(0),a=t.shape.slice();return e.map((function(i){a[r]=i;var o=t.slice(n,a);return n[r]+=i,o}))}function CL(t,e){for(var r=new Array(t.rank),n=0;n<r.length;n++)r[n]=t.shape[n]*e[n];var a=Ze(r,t.dtype);for(n=0;n<a.values.length;++n){for(var i=a.indexToLoc(n),o=new Array(t.rank),s=0;s<o.length;s++)o[s]=i[s]%t.shape[s];var u=t.locToIndex(o);a.values[n]=t.values[u]}return a.toTensor()}function kL(t,e,r,n,a){for(var i=e[e.length-1],o=[t.length/i,i],s=o[0],u=o[1],l=$f(r,s*n),f=$f("int32",s*n),d=0;d<s;d++){for(var p=d*u,v=t.subarray(p,p+u),g=[],b=0;b<v.length;b++)g.push({value:v[b],index:b});g.sort((function(C,k){return k.value-C.value}));var y=d*n,x=l.subarray(y,y+n),S=f.subarray(y,y+n);for(b=0;b<n;b++)x[b]=g[b].value,S[b]=g[b].index}var E=e.slice();return E[E.length-1]=n,[Rr(l,E,r),Rr(f,E,"int32")]}function jS(t,e){for(var r=[],n=0;n<e.length;n++)e[n]&&r.push(n);var a=Ze(t,"int32"),i=Ze([r.length,t.length],"int32");for(n=0;n<r.length;n++){var o=a.indexToLoc(r[n]),s=n*t.length;i.values.set(o,s)}return i.toTensor()}var Tse=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(a,i){return"T"+i}));var r=[];this.variableNames.forEach((function(a){r.push("float v"+a+" = get"+a+"AtOutCoords();")}));var n=this.variableNames.map((function(a){return"v"+a})).join(" + ");this.userCode=`
      void main() {
        `+r.join(`
        `)+`

        float result = `+n+`;
        setOutput(result);
      }
    `},Pse=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((function(a,i){return"T"+i}));var r=[];this.variableNames.forEach((function(a){r.push("vec4 v"+a+" = get"+a+"AtOutCoords();")}));var n=this.variableNames.map((function(a){return"v"+a})).join(" + ");this.userCode=`
      void main() {
        `+r.join(`
        `)+`

        vec4 result = `+n+`;
        setOutput(result);
      }
    `},Nse=function(t,e,r){this.variableNames=["A"];var n=t.windowSize,a=t.batchSize,i=t.inSize,o=Math.ceil(i/n);r||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];var s=e==="max"?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+n+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function AL(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(r){return t+"."+r}))}function ln(t,e){return e===1?[t]:AL(t,e)}function Hr(){var t,e,r,n,a,i,o,s,u,l;return ce().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",r="out",n="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",r="varying",n="varying",a="texture2D",i="gl_FragColor",o="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:r,varyingFs:n,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function ts(t,e,r){r===void 0&&(r="index");var n=ja(e);return n.map((function(a,i){return"int "+t[i]+" = "+r+" / "+a+"; "+(i===n.length-1?"int "+t[i+1]+" = "+r+" - "+t[i]+" * "+a:"index -= "+t[i]+" * "+a)+";"})).join("")}function DS(t){var e=ja(t).map((function(r){return r.toString()}));return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var OL=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function Rse(t,e,r,n){var a=[];t.forEach((function(v){var g=je(v.shapeInfo.logicalShape);v.shapeInfo.isUniform?a.push("uniform float "+v.name+(g>1?"["+g+"]":"")+";"):(a.push("uniform sampler2D "+v.name+";"),a.push("uniform int offset"+v.name+";"))}));var i,o,s=a.join(`
`),u=t.map((function(v){return(function(g,b,y){y===void 0&&(y=!1);var x="";x+=y?TL(g):mu(g);var S=g.shapeInfo.logicalShape,E=b.logicalShape;return S.length<=E.length&&(x+=y?(function(C,k){var A,T=C.name,N=T.charAt(0).toUpperCase()+T.slice(1),R="get"+N+"AtOutCoords",I=C.shapeInfo.logicalShape.length,D=k.logicalShape.length,j=to(C.shapeInfo.logicalShape,k.logicalShape),$=Ct(D),W=D-I,q=["x","y","z","w","u","v"];A=I===0?"":D<2&&j.length>=1?"coords = 0;":j.map((function(K){return"coords."+q[K+W]+" = 0;"})).join(`
`);var X="";X=D<2&&I>0?"coords":C.shapeInfo.logicalShape.map((function(K,oe){return"coords."+q[oe+W]})).join(", ");var Y="return outputValue;",z=je(C.shapeInfo.logicalShape)===1,B=je(k.logicalShape)===1;if(I!==1||z||B){if(z&&!B)Y=D===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(j.length){var G=I-2,L=I-1;j.indexOf(G)>-1&&j.indexOf(L)>-1?Y="return vec4(outputValue.x);":j.indexOf(G)>-1?Y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":j.indexOf(L)>-1&&(Y="return vec4(outputValue.xx, outputValue.zz);")}}else Y=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+R+`() {
      `+$+` coords = getOutputCoords();
      `+A+`
      vec4 outputValue = get`+N+"("+X+`);
      `+Y+`
    }
  `})(g,b):(function(C,k){var A=C.name,T=A.charAt(0).toUpperCase()+A.slice(1),N="get"+T+"AtOutCoords",R=k.texShape,I=C.shapeInfo.texShape,D=C.shapeInfo.logicalShape.length,j=k.logicalShape.length;if(!C.shapeInfo.isUniform&&D===j&&C.shapeInfo.flatOffset==null&&wr(I,R))return`
      float `+N+`() {
        return sampleTexture(`+A+`, resultUV);
      }
    `;var $,W=Ct(j),q=to(C.shapeInfo.logicalShape,k.logicalShape),X=j-D,Y=["x","y","z","w","u","v"];$=D===0?"":j<2&&q.length>=1?"coords = 0;":q.map((function(B){return"coords."+Y[B+X]+" = 0;"})).join(`
`);var z="";return z=j<2&&D>0?"coords":C.shapeInfo.logicalShape.map((function(B,G){return"coords."+Y[G+X]})).join(", "),`
    float `+N+`() {
      `+W+` coords = getOutputCoords();
      `+$+`
      return get`+T+"("+z+`);
    }
  `})(g,b)),x})(v,e,n)})).join(`
`),l=e.texShape,f=Hr(),d=(function(v){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+v.texture2D+`(textureSampler, uv).r;
    }
  `})(f),p=(function(v){return v.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+v.varyingFs+` vec2 resultUV;
    `+v.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+v.defineSpecialNaN+`
    `+v.defineSpecialInf+`
    `+v.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+Ise+`
    `+jse+`
    `+Dse+`
  `})(f);return e.isPacked?(i=(function(v,g){switch(v.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(C,k){var A=[Math.ceil(k[0]/2),Math.ceil(k[1]/2)];return A[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+A[1]+`.0);
      }
    `:A[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+A[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+A[0]+", "+A[1]+`));
      return 2 * (resTexRC.x * `+A[1]+` + resTexRC.y);
    }
  `})(0,g);case 2:return(function(C,k){var A=[Math.ceil(k[0]/2),Math.ceil(k[1]/2)];if(wr(C,k))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+A[0]+", "+A[1]+`));
      }
    `;var T=Math.ceil(C[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+A[0]+", "+A[1]+`));

      int index = resTexRC.x * `+A[1]+` + resTexRC.y;
      int r = 2 * (index / `+T+`);
      int c = imod(index, `+T+`) * 2;

      return ivec2(r, c);
    }
  `})(v,g);case 3:return b=v,y=g,x=[Math.ceil(y[0]/2),Math.ceil(y[1]/2)],S=Math.ceil(b[2]/2),E=S*Math.ceil(b[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      int b = index / `+E+`;
      index -= b * `+E+`;

      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return(function(C,k){for(var A=[Math.ceil(k[0]/2),Math.ceil(k[1]/2)],T=Math.ceil(C[C.length-1]/2),N=T*Math.ceil(C[C.length-2]/2),R=N,I="",D="b, r, c",j=2;j<C.length-1;j++)R*=C[C.length-j-1],I=`
      int b`+j+" = index / "+R+`;
      index -= b`+j+" * "+R+`;
    `+I,D="b"+j+", "+D;return`
    ivec`+C.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+A[0]+", "+A[1]+`));
      int index = resTexRC.x * `+A[1]+` + resTexRC.y;

      `+I+`

      int b = index / `+N+`;
      index -= b * `+N+`;

      int r = 2 * (index / `+T+`);
      int c = imod(index, `+T+`) * 2;

      return ivec`+C.length+"("+D+`);
    }
  `})(v,g)}var b,y,x,S,E})(e.logicalShape,l),o=(function(v){return`
    void setOutput(vec4 val) {
      `+v.output+` = val;
    }
  `})(f)):(i=(function(v,g){switch(v.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(x,S){return S[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+S[1]+`.0);
      }
    `:S[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+S[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      return resTexRC.x * `+S[1]+` + resTexRC.y;
    }
  `})(0,g);case 2:return(function(x,S){return wr(x,S)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+S[0]+", "+S[1]+`));
      }
    `:x[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+S[0]+", "+S[1]+`));
        int index = resTexRC.x * `+S[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:x[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+S[0]+", "+S[1]+`));
        int index = resTexRC.x * `+S[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      int r = index / `+x[1]+`;
      int c = index - r * `+x[1]+`;
      return ivec2(r, c);
    }
  `})(v,g);case 3:return b=g,y=ts(["r","c","d"],v),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      int index = resTexRC.x * `+b[1]+` + resTexRC.y;
      `+y+`
      return ivec3(r, c, d);
    }
  `;case 4:return(function(x,S){var E=ts(["r","c","d","d2"],x);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      `+E+`
      return ivec4(r, c, d, d2);
    }
  `})(v,g);case 5:return(function(x,S){var E=ts(["r","c","d","d2","d3"],x);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+S[0]+`,
                             `+S[1]+`));

      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+E+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `})(v,g);case 6:return(function(x,S){var E=ts(["r","c","d","d2","d3","d4"],x);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+E+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `})(v,g);default:throw new Error(v.length+"-D output sampling is not yet supported")}var b,y})(e.logicalShape,l),o=(function(v){return`
    void setOutput(float val) {
      `+v.output+` = vec4(val, 0, 0, 0);
    }
  `})(f)),n&&(p+=Mse),[p,d,o,s,i,u,r].join(`
`)}function mu(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return(function(r){var n=r.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(r.shapeInfo.isUniform)return"float "+a+"() {return "+n+";}";var i=r.shapeInfo.texShape,o=i[0],s=i[1];if(o===1&&s===1)return`
      float `+a+`() {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var u=r.shapeInfo.texShape,l=u[0],f=u[1],d=$o(n);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+l+", "+f+", "+d+`);
      return sampleTexture(`+n+`, uv);
    }
  `})(t);case 1:return(function(r){var n=r.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(r.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+lu(r)+`
      }
    `;var i=r.shapeInfo.texShape,o=i[0],s=i[1];if(s===1&&o===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var u=$o(n);return s===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+o+`.0);
        return sampleTexture(`+n+`, uv);
      }
    `:o===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+n+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+s+", index + "+u+`);
      return sampleTexture(`+n+`, uv);
    }
  `})(t);case 2:return(function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=r.shapeInfo.texShape;if(o!=null&&wr(n,o)){var s=o[0],u=o[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var l=Ko(n),f=l.newShape,d=l.keptDims,p=f;if(p.length<n.length){var v=gu(r,p);return`
      `+mu(v)+`
      float `+i+`(int row, int col) {
        return `+i+"("+yu(["row","col"],d)+`);
      }
    `}if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+n[1]+`, 1)));
        `+lu(r)+`
      }
    `;var g=o[0],b=o[1],y=$o(a);return b===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+g+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:g===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+b+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+n[1]+" + col + "+y+`;
    vec2 uv = uvFromFlat(`+g+", "+b+`, index);
    return sampleTexture(`+a+`, uv);
  }
`})(t);case 3:return(function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[1]*n[2],s=n[2],u=Ko(n),l=u.newShape,f=u.keptDims,d=l;if(d.length<n.length){var p=gu(r,d);return`
        `+mu(p)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+yu(["row","col","depth"],f)+`);
        }
      `}if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+s+`, 1)));
        `+lu(r)+`
      }
    `;var v=r.shapeInfo.texShape,g=v[0],b=v[1],y=r.shapeInfo.flatOffset;if(b===o&&y==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+b+".0, "+g+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(b===s&&y==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+n[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+b+".0, "+g+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var x=$o(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+s+" + depth + "+x+`;
        vec2 uv = uvFromFlat(`+g+", "+b+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `})(t);case 4:return(function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[3],s=n[2]*o,u=n[1]*s,l=Ko(n),f=l.newShape,d=l.keptDims;if(f.length<n.length){var p=gu(r,f);return`
      `+mu(p)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+yu(["row","col","depth","depth2"],d)+`);
      }
    `}if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+o+`, 1)));
        `+lu(r)+`
      }
    `;var v=r.shapeInfo.flatOffset,g=r.shapeInfo.texShape,b=g[0],y=g[1];if(y===u&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+b+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(y===o&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+n[1]*n[2]+", "+n[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+b+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var x=$o(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+b+", "+y+", index + "+x+`);
      return sampleTexture(`+a+`, uv);
    }
  `})(t);case 5:return(function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[4],s=n[3]*o,u=n[2]*s,l=n[1]*u,f=Ko(n),d=f.newShape,p=f.keptDims;if(d.length<n.length){var v=gu(r,d);return`
      `+mu(v)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+yu(["row","col","depth","depth2","depth3"],p)+`);
      }
    `}if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+o+`)) +
          depth3;
        `+lu(r)+`
      }
    `;var g=r.shapeInfo.flatOffset,b=r.shapeInfo.texShape,y=b[0],x=b[1];if(x===l&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+y+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(x===o&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]+`,
               `+n[2]*n[3]+", "+n[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+y+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var S=$o(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+o+" + depth3 + "+S+`;
      vec2 uv = uvFromFlat(`+y+", "+x+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `})(t);case 6:return(function(r){var n=r.shapeInfo.logicalShape,a=r.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=Ko(n),s=o.newShape,u=o.keptDims;if(s.length<n.length){var l=gu(r,s);return`
      `+mu(l)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+yu(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var f=n[5],d=n[4]*f,p=n[3]*d,v=n[2]*p,g=n[1]*v;if(r.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+g+", "+v+", "+p+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+f+`, 1)));
        `+lu(r)+`
      }
    `;var b=r.shapeInfo.flatOffset,y=r.shapeInfo.texShape,x=y[0],S=y[1];if(S===g&&b==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+v+", "+p+", "+d+", "+f+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+S+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(S===f&&b==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]*n[4]+`,
               `+n[2]*n[3]*n[4]+`,
               `+n[3]*n[4]+`,
               `+n[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+S+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var E=$o(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+g+" + col * "+v+" + depth * "+p+` +
          depth2 * `+d+" + depth3 * "+f+" + depth4 + "+E+`;
      vec2 uv = uvFromFlat(`+x+", "+S+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `})(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function TL(t){var e,r,n;switch(t.shapeInfo.logicalShape.length){case 0:return e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),n=Hr(),`
    vec4 `+r+`() {
      return `+n.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return(function(a){var i=a.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=a.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Hr();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+i+`, uv);
    }
  `})(t);case 2:return(function(a){var i=a.shapeInfo.logicalShape,o=a.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=a.shapeInfo.texShape,l=u[0],f=u[1],d=Hr();if(u!=null&&wr(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+f+".0, "+l+`.0);

        return `+d.texture2D+"("+o+`, uv);
      }
    `;var p=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],v=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+v+", "+p[0]+", "+p[1]+`, row, col);
      return `+d.texture2D+"("+o+`, uv);
    }
  `})(t);case 3:return(function(a){var i=a.shapeInfo.logicalShape,o=a.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=a.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var f=i.slice(1),d=gu(a,f);return`
        `+TL(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+yu(["b","row","col"],[1,2])+`);
        }
      `}var p=l[0],v=l[1],g=Math.ceil(i[2]/2),b=g*Math.ceil(i[1]/2),y=Hr();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+p+", "+v+", "+b+", "+g+`, b, row, col);
      return `+y.texture2D+"("+o+`, uv);
    }
  `})(t);default:return(function(a){for(var i=a.shapeInfo.logicalShape,o=i.length,s=a.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=a.shapeInfo.texShape,f=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=f[0],p=f[1],v=Math.ceil(i[o-1]/2),g=v*Math.ceil(i[o-2]/2),b="int b, int row, int col",y="b * "+g+" + (row / 2) * "+v+" + (col / 2)",x=2;x<o-1;x++)b="int b"+x+", "+b,g*=i[o-x-1],y="b"+x+" * "+g+" + "+y;var S=Hr();return`
    vec4 `+u+"("+b+`) {
      int index = `+y+`;
      int texR = index / `+p+`;
      int texC = index - texR * `+p+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+", "+d+`);
      return `+S.texture2D+"("+s+`, uv);
    }
  `})(t)}}var Ise=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jse=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Dse=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Mse=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function $o(t){return"offset"+t}function lu(t){var e=t.name,r=je(t.shapeInfo.logicalShape);return r<2?"return "+e+";":`
    for (int i = 0; i < `+r+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function Ct(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function gu(t,e){var r=JSON.parse(JSON.stringify(t));return r.shapeInfo.logicalShape=e,r}function yu(t,e){return e.map((function(r){return t[r]})).join(", ")}var Fse=function(t,e,r,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,U(t.length>2,(function(){return"Packed arg"+(r.charAt(0).toUpperCase()+r.slice(1))+" supports only inputs with rank above 2."}));var a=t[t.length-1],i=Math.ceil(a/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),n||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,l=u.length,f=Ct(l),d=ln("coords",l);if(i===1){var p=Ct(s=l+1);o=`
        `+p+" sourceLocR = "+p+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+p+" sourceLocG = "+p+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+p+" sourceLocA = "+p+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+p+" sourceLocB = "+p+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else s=l,o=`
        `+f+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+f+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+f+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+f+` sourceLocB = coords;
        --`+d[l-2]+";";var v=["x","y","z","w","u","v"].slice(0,s),g="."+v[s-1],b=v.map((function(N){return"int "+N})),y=ln("sourceLocR",s-1).concat("inIdx.r"),x=ln("sourceLocG",s-1).concat("inIdx.g"),S=ln("sourceLocB",s-1).concat("inIdx.b"),E=ln("sourceLocA",s-1).concat("inIdx.a"),C=r==="max"?"greaterThan":"lessThan",k=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+S.join()+`),
                             getBestIndicesAChannel(`+E.join()+")));",A=`vec4(
            getAChannel(`+y.join()+`),
            hasNextCol ? getAChannel(`+x.join()+`) : 0.,
            hasNextRow ? getAChannel(`+S.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+E.join()+") : 0.)",T=n?"":`
      float getBestIndicesAChannel(`+b.join()+`) {
        return getChannel(getBestIndicesA(`+v.join()+`),
                                          vec2(`+v.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+b.join()+`) {
        return getChannel(getA(`+v.join()+`),
                               vec2(`+v.slice(-2).join()+`));
      }
      `+T+`
      void main() {
        `+f+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+g+", sourceLocG"+g+`,
          sourceLocB`+g+", sourceLocA"+g+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+A+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+k+`
          vec4 candidate = `+A+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+C+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},Lse=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,r=t.filterWidth,n=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=s-1-t.padInfo.top,f=u-1-t.padInfo.left,d=1/(e*r);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+f+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},Bse=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,r=t.filterHeight,n=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth,v=f-1-t.padInfo.front,g=d-1-t.padInfo.top,b=p-1-t.padInfo.left,y=1/(e*r*n);this.userCode=`
      const ivec3 pads = ivec3(`+v+", "+g+", "+b+`);
      const float avgMultiplier = float(`+y+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+f+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+p+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},$se=function(t,e,r,n,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],ot(t,e),ot(t,r);var o="0.0";n!=null&&(ot(t,n),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";a!=null&&(ot(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},Use=function(t,e,r,n,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ot(t,e),ot(t,r);var o="vec4(0.0)";n!=null&&(ot(t,n),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";a!=null&&(ot(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},Wse="return areal * breal - aimag * bimag;",zse="return areal * bimag + aimag * breal;",rD=function(t,e,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ot(e,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+t+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Vw="return a + b;",Hw="return a - b;",nD="return a * b;",PL="return (a < 0.) ? b * a : a;",qt=function(t,e,r){this.variableNames=["A","B"],this.outputShape=ot(e,r),this.userCode=`
      float binaryOperation(float a, float b) {
        `+t+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},NL=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,ti=function(t,e,r,n){n===void 0&&(n=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ot(e,r);var a=this.outputShape.length,i="";if(n)if(a===0||je(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Ct(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=ln("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+o[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+o[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+t+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},qse=(function(){function t(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,r){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,e),a.gl.uniform1f(n.maxLoc,r)}},t})(),Vse=(function(){function t(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,r){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,e),a.gl.uniform1f(n.maxLoc,r)}},t})(),Hse=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},Gse=function(t){this.outputShape=[],this.outputShape=pl(t,1),this.variableNames=t.map((function(s,u){return"T"+u}));var e=new Array(t.length-1);e[0]=t[0][1];for(var r=1;r<e.length;r++)e[r]=e[r-1]+t[r][1];var n=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(r=1;r<e.length;r++){var a=e[r-1];n.push("else if (yC < "+e[r]+") setOutput(getT"+r+"(yR, yC-"+a+"));")}var i=e.length,o=e[e.length-1];n.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+n.join(`
        `)+`
      }
    `},Kse=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=pl(t,e);var r=this.outputShape,n=r.length,a=Ct(n),i=ln("coords",n),o=["x","y","z","w","u","v"].slice(0,n);this.variableNames=t.map((function(y,x){return"T"+x}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var l=o[e],f=o.slice(-2),d=o.join(),p="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+f.join()+`));
        }`;for(u=1;u<s.length;u++){var v=s[u-1];p+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+Gh(o,l,v)+`),
            vec2(`+Gh(f,l,v)+`));
        }`}var g=s.length,b=s[s.length-1];p+=`
        return getChannel(
          getT`+g+"("+Gh(o,l,b)+`),
          vec2(`+Gh(f,l,b)+"));",this.userCode=`
      float getValue(`+o.map((function(y){return"int "+y}))+`) {
        `+p+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[n-1]+" = "+i[n-1]+` + 1;
        if (`+i[n-1]+" < "+r[n-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[n-2]+" = "+i[n-2]+` + 1;
        if (`+i[n-2]+" < "+r[n-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[n-1]+" = "+i[n-1]+` - 1;
        if (`+i[n-2]+" < "+r[n-2]+` &&
            `+i[n-1]+" < "+r[n-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Gh(t,e,r){var n=t.indexOf(e);return t.map((function(a,i){return i===n?a+" - "+r:a})).join()}var Xse=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,r=t.strideWidth,n=t.padInfo.top,a=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+n+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+r+" - "+a+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},Yse=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,r=t.filterWidth,n=t.strideHeight,a=t.strideWidth,i=t.dataFormat==="channelsLast",o=e-1-t.padInfo.top,s=r-1-t.padInfo.left,u=i?1:2,l=i?2:3,f=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+f+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+r+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+r+` - 1 - wC;

            for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},Jse=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,r=t.strideHeight,n=t.strideWidth,a=t.padInfo.front,i=t.padInfo.top,o=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yF = 0; yF < `+t.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+a+`;

            if (xF < 0 || xF >= `+t.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+t.outHeight+`; yR++) {
              int xR = wR + yR * `+r+" - "+i+`;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+t.outWidth+`; yC++) {
                int xC = wC + yC * `+n+" - "+o+`;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Qse=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,r=t.filterHeight,n=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,u=r-1-t.padInfo.top,l=n-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+t.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+r+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+r+` - 1 - wR;

            for (int wC = 0; wC < `+n+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+n+` - 1 - wC;

              for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Zse=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,r=t.strideWidth,n=t.padInfo.top,a=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+n+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+r+" - "+a+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},eue=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,r=t.filterWidth,n=t.strideHeight,a=t.strideWidth,i=e-1-t.padInfo.top,o=r-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+r+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+r+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},aD=function(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var a=t.padInfo.top,i=t.padInfo.left,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,f=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),v=t.inChannels%4,g=t.dataFormat==="channelsLast",b=g?1:2,y=g?2:3,x=g?3:1,S="",E="";r&&(S=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+r+`
        }`:`
          float activation(float x) {
            `+r+`
          }
        `,E="result = activation(result);");var C=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+S+`

      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+x+`];

        ivec2 xRCCorner =
            ivec2(coords[`+b+"], coords["+y+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+t.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+p+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+g+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(v===1)+`) {

              if (`+g+`) {
                dotProd +=
                    getX(batch, xR, xC, `+p+`) *
                    getW(wR, wC, `+p+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+p+`, xR, xC) *
                    getW(wR, wC, `+p+`, d2);
              }

            } else if (`+(v===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2)
              );

              if (`+g+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(v===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2),
                getW(wR, wC, `+p+` + 2, d2)
              );

              if (`+g+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1),
                  getX(batch, xR, xC, `+p+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC),
                  getX(batch, `+p+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+C+`
        `+E+`
        setOutput(result);
      }
    `},tue=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,r=t.padInfo.top,n=t.padInfo.left,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,f=t.filterDepth,d=t.filterHeight,p=t.filterWidth,v=4*Math.floor(t.inChannels/4),g=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+o+`);
      const ivec3 pads = ivec3(`+e+", "+r+", "+n+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+f+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+p+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+v+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(g===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+v+`) *
                  getW(wF, wR, wC, `+v+`, d2);
              } else if (`+(g===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+v+`),
                  getX(batch, xF, xR, xC, `+v+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+v+`, d2),
                  getW(wF, wR, wC, `+v+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(g===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+v+`),
                  getX(batch, xF, xR, xC, `+v+` + 1),
                  getX(batch, xF, xR, xC, `+v+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+v+`, d2),
                  getW(wF, wR, wC, `+v+` + 1, d2),
                  getW(wF, wR, wC, `+v+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},iD=function(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var a=t.inHeight,i=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,f=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,v=t.filterWidth,g=t.outChannels/t.inChannels,b="",y="";r&&(b=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+r+`
        }`:`
          float activation(float x) {
            `+r+`
          }
        `,y="result = activation(result);");var x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+b+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+g+`;
        int q = d2 - d1 * `+g+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+p+`; wR++) {
          int xR = xRCorner + wR * `+f+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+x+`
        `+y+`
        setOutput(result);
      }
    `},oD=function(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var a=t.inHeight,i=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,f=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,v=t.filterWidth,g=v,b="int xR; int xC; int xCOffset;",y=0;y<p;y++)for(var x=0;x<v;x++)b+=`
          vec4 xTexelR`+y+"C"+2*x+` = vec4(0.);
          vec4 wR`+y+"C"+x+` = vec4(0.);
          vec4 xR`+y+"C"+x+" = vec4(0.);";for(y=0;y<p;y++)for(var S=0;S<g;S++){if(b+=`
          xR = xRCorner + `+y*f+`;
          xC = xCCorner + `+(x=2*S)*d+`;
        `,l===1){if(x<v&&(b+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+y+"C"+x+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+y+"C"+x+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+y+"C"+x+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+y+"C"+x+" = vec4(previous.zw, xTexelR"+y+"C"+x+`.xy);
                } else {
                  xR`+y+"C"+x+" = vec4(0, 0, xTexelR"+y+"C"+x+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+y+"C"+x+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+x+` = vec4(0.);
                }

                xR`+y+"C"+x+" = xTexelR"+y+"C"+x+`;
              `,x+1<v)){var E=s%2==0?XF(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(b+=`
                  xCOffset = xC + `+s%2+" + "+E+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+y+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(b+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+y+"C"+x+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+y+"C"+x+` = vec4(0.);
                    }
                  `),b+=`
                  xR`+y+"C"+(x+1)+` = vec4(
                    xTexelR`+y+"C"+x+".zw, xTexelR"+y+"C"+(x+2)+`.xy);
                `):b+=`
                  xCOffset = xC + `+E+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+y+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+y+"C"+(x+1)+" = xTexelR"+y+"C"+(x+2)+`;
                `}}else x<v&&(b+=`
              if(xR >= 0 && xR < `+a+`) {
            `,s%2==1?(b+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+y+"C"+x+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+x+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+y+"C"+(x+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+y+"C"+(x+2)+` = vec4(0.);
                }

                xR`+y+"C"+x+` = vec4(
                  xTexelR`+y+"C"+x+".zw, xTexelR"+y+"C"+(x+2)+`.zw);
              `,x+1<v&&(b+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+y+"C"+(x+1)+" = vec4(xTexelR"+y+"C"+(x+2)+`.xy, final.xy);
                `)):(b+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+y+"C"+x+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+x+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+y+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+(x+2)+` = vec4(0.);
                }

                xR`+y+"C"+x+` = vec4(
                  xTexelR`+y+"C"+x+".xy, xTexelR"+y+"C"+(x+2)+`.xy);
              `,x+1<v&&(b+=`
                  xR`+y+"C"+(x+1)+` = vec4(
                    xTexelR`+y+"C"+x+".zw, xTexelR"+y+"C"+(x+2)+`.zw);
                `)),b+="}");x<v&&(b+=`
            vec4 wTexelR`+y+"C"+x+" = getW("+y+", "+x+`, d1, q);
            wR`+y+"C"+x+" = vec4(wTexelR"+y+"C"+x+".xz, wTexelR"+y+"C"+x+`.xz);
          `,x+1<v&&(b+=`
              vec4 wTexelR`+y+"C"+(x+1)+" = getW("+y+", "+(x+1)+`, d1, q);
              wR`+y+"C"+(x+1)+` =
                vec4(wTexelR`+y+"C"+(x+1)+".xz, wTexelR"+y+"C"+(x+1)+".xz);"))}for(y=0;y<p;y++)for(x=0;x<v;x++)b+="dotProd += xR"+y+"C"+x+" * wR"+y+"C"+x+";";var C="",k="";r&&(C=n?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+r+`
        }`:`vec4 activation(vec4 x) {
          `+r+`
        }`,k="result = activation(result);");var A=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+C+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+b+`

        vec4 result = dotProd;
        `+A+`
        `+k+`
        setOutput(result);
      }
    `},rue=function(t,e,r,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=t[0],o=t[1],s=t[2],u=t[3],l=e[0],f=r[0],d=r[1];this.outputShape=[l,f,d,u];var p=n==="bilinear"?1:0,v=[o-1+".0",s-1+".0"],g=v[0],b=v[1],y=f>1?[""+(o-1)/(f-1),"(y2-y1) * height_ratio","y1*"+g+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+g],x=y[0],S=y[1],E=y[2],C=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+b+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+b],k=C[0],A=C[1],T=C[2];this.userCode=`
      const float height_ratio = float(`+x+`);
      const float width_ratio = float(`+k+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+S+`;
        float width_scale = `+A+`;

        float in_y = `+E+`;
        if( in_y < 0.0 || in_y > `+g+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+T+`;
        if( in_x < 0.0 || in_x > `+b+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+p+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},nue=function(t,e,r){this.variableNames=["x"],this.outputShape=t;var n=t.length,a=t[t.length-1],i=r?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(r?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Ct(n)+` coords = getOutputCoords();
        int end = `+sD(n,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+sD(n,"coords")+` = idx;
          val += getX(`+(function(o,s){if(o===1)return""+s;if(o===2)return s+".x, "+s+".y";if(o===3)return s+".x, "+s+".y, "+s+".z";if(o===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")})(n,"coords")+`);
        }
        setOutput(val);
      }
    `};function sD(t,e){if(t===1)return""+e;if(t===2)return e+".y";if(t===3)return e+".z";if(t===4)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var aue=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Wf.DENSE;var e=Vc(t),r=Hr();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ts(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+r.output+` = result;
      }
    `},iue=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Wf.DENSE;var e=Vc(t),r=Hr();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ts(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+r.output+` = result;
      }
    `},oue=(function(){function t(e,r,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=r,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+r+`;
      int offset_h = imod(h, `+r+`);
      int in_w = w / `+r+`;
      int offset_w = imod(w, `+r+`);
      int offset_d = (offset_h * `+r+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return t.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t})(),sue=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},uue=function(t){this.variableNames=["A"],this.outTexUsage=kn.DOWNLOAD;var e=Hr();this.outputShape=t,this.userCode=`
      `+OL+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},lue=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=kn.DOWNLOAD;var e=Hr();this.outputShape=t,this.userCode=`
      `+OL+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},cue=function(t,e,r){r===void 0&&(r=!1),this.variableNames=["A"];var n=Hr(),a=e[0],i=e[1];this.outputShape=t;var o="result";r&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+DS(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+n.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+n.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},fue=function(t,e,r){r===void 0&&(r=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=Hr(),a=e[0],i=e[1];this.outputShape=t;var o="",s="result";r&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var f=2*u+l;o+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+t[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+t[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+n.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+f+`] = values[0];
              } else if(offset == 1) {
                result[`+f+`] = values[1];
              } else if(offset == 2) {
                result[`+f+`] = values[2];
              } else {
                result[`+f+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+DS(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+n.output+" = "+s+`;
      }
    `},due="return real * expR - imag * expI;",hue="return real * expI + imag * expR;",uD=function(t,e,r){this.variableNames=["real","imag"];var n=e[1];this.outputShape=e;var a=r?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=r?n+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+t+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+n+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+n+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},pue=(function(){function t(e,r){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var r=this;return function(n,a){r.valueLoc==null&&(r.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(r.valueLoc,e)}},t})(),vue=function(t,e,r){this.variableNames=["A","indices"];var n=t.slice();n[r]=e,this.outputShape=n,this.rank=n.length;var a=Ct(this.rank),i=(function(o,s){var u=o.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],f=[],d=0;d<o.length;d++)d===s?f.push("int(getIndices("+l[d]+"))"):f.push(""+l[d]);return f.join()})(t,r);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},mue=function(t,e,r){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=r;var n=Ct(e.length),a=Ct(r.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+n+" strides = "+n+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function gue(t,e){var r=Hr();return doe(t,e,r.version+`
    precision highp float;
    `+r.attribute+` vec3 clipSpacePos;
    `+r.attribute+` vec2 uv;
    `+r.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function yue(t,e){return goe(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function bue(t,e){return yoe(t,e,new Uint16Array([0,1,2,2,1,3]))}function sd(t,e,r,n,a,i,o){xoe(r,n);var s=boe(t,e),u=t.TEXTURE_2D;return Be(t,e,(function(){return t.bindTexture(u,s)})),Be(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),Be(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),Be(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),Be(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),Be(t,e,(function(){return t.texImage2D(u,0,a,r,n,0,i,o,null)})),Be(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function xue(t,e,r,n,a){var i=gm(r,n);return sd(t,e,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,t.FLOAT)}function wue(t,e,r,n,a){var i=gm(r,n);return sd(t,e,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function _ue(t,e,r,n,a){var i=gm(r,n);return sd(t,e,i[0],i[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function Sue(t,e,r,n,a){var i=od(r,n);return sd(t,e,i[0],i[1],a.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function Eue(t,e,r,n,a){var i=od(r,n);return sd(t,e,i[0],i[1],a.internalFormatPackedHalfFloat,t.RGBA,a.textureTypeHalfFloat)}function Cue(t,e,r,n){return Be(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,n)})),Xj(t,e,r,"clipSpacePos",n,3,20,0)&&Xj(t,e,r,"uv",n,2,20,12)}function kue(t,e,r,n,a,i,o){var s,u,l;Be(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,r)})),i instanceof Uint8Array?(s=new Uint8Array(n*a*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(s=new Float32Array(n*a*4),u=t.FLOAT,l=o.internalFormatPackedFloat),s.set(i),Be(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,l,n,a,0,t.RGBA,u,s)})),Be(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Aue(t,e,r,n){Be(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,r)})),n.data instanceof Uint8Array?Be(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)})):Be(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)})),Be(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Oue(t,e,r,n,a){var i=t.createBuffer();Be(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)}));var o=16*r*n;return Be(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)})),Be(t,e,(function(){return t.readPixels(0,0,n,r,t.RGBA,t.FLOAT,0)})),Be(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),i}function Tue(t,e,r){var n=t,a=new Float32Array(r);return n.bindBuffer(n.PIXEL_PACK_BUFFER,e),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function Pue(t,e,r,n,a){var i=gm(r,n),o=i[0],s=i[1],u=new Uint8Array(r*n*4);return Be(t,e,(function(){return t.readPixels(0,0,o,s,a.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function Nue(t,e,r,n,a,i,o,s){var u=t,l=new Float32Array((function(f,d){var p=od(f,d);return p[0]*p[1]*4})(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function Rue(t,e,r,n){var a=new Float32Array(r*n*4);return Be(t,e,(function(){return t.readPixels(0,0,n,r,t.RGBA,t.FLOAT,a)})),a}var Iue=(function(){function t(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var r=ce().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,soe(r,e)):this.gl=Ua(r);var n="WEBGL_color_buffer_float";if(ce().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=zh(this.gl,this.debug,"OES_texture_float"),zn(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=zh(this.gl,this.debug,"OES_texture_half_float");else if(ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),zn(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=zh(this.gl,this.debug,"EXT_color_buffer_half_float");else if(ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",zn(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!zn(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=yue(this.gl,this.debug),this.indexBuffer=bue(this.gl,this.debug),this.framebuffer=woe(this.gl,this.debug),this.textureConfig=CS(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return ce().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var r=this.gl;Be(r,this.debug,(function(){return r.finish()})),Be(r,this.debug,(function(){return r.bindFramebuffer(r.FRAMEBUFFER,null)})),Be(r,this.debug,(function(){return r.deleteFramebuffer(e.framebuffer)})),Be(r,this.debug,(function(){return r.bindBuffer(r.ARRAY_BUFFER,null)})),Be(r,this.debug,(function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null)})),Be(r,this.debug,(function(){return r.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(e,r){return this.throwIfDisposed(),xue(this.gl,this.debug,e,r,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(e,r){return this.throwIfDisposed(),wue(this.gl,this.debug,e,r,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(e,r){return this.throwIfDisposed(),_ue(this.gl,this.debug,e,r,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(e,r){this.throwIfDisposed(),Aue(this.gl,this.debug,e,r)},t.prototype.uploadDenseMatrixToTexture=function(e,r,n,a){this.throwIfDisposed(),kue(this.gl,this.debug,e,r,n,a,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(e,r){return this.throwIfDisposed(),Eue(this.gl,this.debug,e,r,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(e,r){return this.throwIfDisposed(),Sue(this.gl,this.debug,e,r,this.textureConfig)},t.prototype.deleteMatrixTexture=function(e){var r=this;this.throwIfDisposed(),this.outputTexture===e&&(Yj(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Be(this.gl,this.debug,(function(){return r.gl.deleteTexture(e)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,r,n){var a=this;return this.downloadMatrixDriver(e,(function(){return Pue(a.gl,a.debug,r,n,a.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(e,r,n,a,i,o){return Nue(this.gl,e,0,0,0,i,o,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(e,r){return Tue(this.gl,e,r)},t.prototype.createBufferFromTexture=function(e,r,n){this.bindTextureToFrameBuffer(e);var a=Oue(this.gl,this.debug,r,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},t.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},t.prototype.createFence=function(e){var r,n,a=this;if(ce().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var s=i.clientWaitSync(o,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},r=o}else ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(r=this.beginQuery(),this.endQuery(),n=function(){return a.isQueryAvailable(r,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:r,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(e,r,n){var a=this;return this.downloadMatrixDriver(e,(function(){return Rue(a.gl,a.debug,r,n)}))},t.prototype.createProgram=function(e){this.throwIfDisposed();var r=this.gl,n=hoe(r,this.debug,e),a=gue(r,this.debug),i=voe(r,this.debug);return Be(r,this.debug,(function(){return r.attachShader(i,a)})),Be(r,this.debug,(function(){return r.attachShader(i,n)})),moe(r,this.debug,i),this.debug&&Uw(r,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=Cue(r,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(e){var r=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Be(this.gl,this.debug,(function(){return r.gl.deleteProgram(e)}))},t.prototype.setProgram=function(e){var r=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Uw(this.gl,this.debug,this.program),Be(this.gl,this.debug,(function(){return r.gl.useProgram(e)}))},t.prototype.getUniformLocation=function(e,r,n){return n===void 0&&(n=!0),this.throwIfDisposed(),n?Soe(this.gl,this.debug,e,r):Eoe(this.gl,e,r)},t.prototype.getAttributeLocation=function(e,r){var n=this;return this.throwIfDisposed(),Be(this.gl,this.debug,(function(){return n.gl.getAttribLocation(e,r)}))},t.prototype.getUniformLocationNoThrow=function(e,r){return this.throwIfDisposed(),this.gl.getUniformLocation(e,r)},t.prototype.setInputMatrixTexture=function(e,r,n){this.throwIfDisposed(),this.throwIfNoProgram(),Coe(this.gl,this.debug,this.program,e,r,n)},t.prototype.setOutputMatrixTexture=function(e,r,n){this.setOutputMatrixTextureDriver(e,n,r)},t.prototype.setOutputPackedMatrixTexture=function(e,r,n){this.throwIfDisposed();var a=od(r,n),i=a[0],o=a[1];this.setOutputMatrixTextureDriver(e,i,o)},t.prototype.setOutputMatrixWriteRegion=function(e,r,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,r)},t.prototype.setOutputPackedMatrixWriteRegion=function(e,r,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){this.program!=null&&Uw(this.gl,this.debug,this.program),qh(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Be(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Be(this.gl,this.debug,(function(){return e.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=zh(this.gl,this.debug,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,r=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(r.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var r=this.gl,n=this.getQueryTimerExtensionWebGL2();r.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(e){return Ne(this,void 0,void 0,(function(){var r=this;return Re(this,(function(n){switch(n.label){case 0:return[4,zj((function(){return r.disposed||r.isQueryAvailable(e,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(e,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(e,r){if(r===0)return null;if(r===2){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(e,a.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(e,r){if(r===0)return!0;if(r===2){var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(e){var r=this;return new Promise((function(n){r.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var e=(function(n){for(var a=0;a<n.length&&n[a]();++a);return a-1})(this.itemsToPoll.map((function(n){return n.isDoneFn}))),r=0;r<=e;++r)(0,this.itemsToPoll[r].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},t.prototype.addItemToPoll=function(e,r){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:r}),this.itemsToPoll.length>1||zj((function(){return n.pollItems(),n.itemsToPoll.length===0}))},t.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),Ww(this.gl,this.debug,e,this.framebuffer),this.debug&&qh(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Ww(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&qh(this.gl)):Yj(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(e,r){this.bindTextureToFrameBuffer(e);var n=r();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(e,r,n){this.throwIfDisposed();var a=this.gl;Ww(a,this.debug,e,this.framebuffer),this.debug&&qh(a),this.outputTexture=e,Be(a,this.debug,(function(){return a.viewport(0,0,r,n)})),Be(a,this.debug,(function(){return a.scissor(0,0,r,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(e,r,n,a){var i=this;this.throwIfDisposed(),Be(this.gl,this.debug,(function(){return i.gl.scissor(e,r,n,a)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},t})();function lD(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(r,n){var a=r.logicalShape,i=e[n],o=i.shape;if(!wr(a,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+o+" must match");if(!r.isUniform||!i.isUniform){var s=r.texShape,u=i.isUniform?null:i.texData.texShape;if(!wr(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}}))}var jue=function(t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n=r.filterWidth,a=r.inChannels,i=r.strideWidth,o=r.strideHeight,s=r.padInfo,u=r.outWidth,l=r.dilationWidth,f=r.dilationHeight,d=r.dataFormat,p=s.left,v=s.top,g=a*n,b=Hr(),y=d==="channelsLast",x=y?0:1,S=y?1:2,E="",C=0;C<=1;C++)for(var k=0;k<=1;k++)E+=`
          blockIndex = rc.y + `+k+`;
          pos = rc.x + `+C+`;

          if(blockIndex < `+t[1]+" && pos < "+t[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+o+" - "+v+`;
            d0 = offsetY + `+f+" * (pos / "+g+`);

            if(d0 < `+e[x]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+p+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+g+".) / "+a+`.));

              if(d1 < `+e[S]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+y+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*C+k)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*C+k)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+E+`

        `+b.output+` = result;
      }
    `},Due=function(t,e,r,n,a){this.variableNames=["x"],this.outputShape=[];var i,o=e,s=t[3]-1;this.outputShape=t;var u="float("+r+") + float("+n+") * sum";i=a===.5?"inversesqrt("+u+")":a===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},Mue=function(t,e,r,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=r,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+n+") * norm + float("+r+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+n+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},Fue=function(t,e,r,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=e,s=t[3]-1;this.outputShape=t;var u="float("+r+") + float("+n+") * sum";i=a===.5?"inversesqrt("+u+")":a===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},Lue=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,r=t.strideWidth,n=t.dilationHeight,a=t.effectiveFilterHeight,i=t.effectiveFilterWidth,o=a-1-t.padInfo.top,s=i-1-t.padInfo.left,u=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+n+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+r+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},Bue=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,r=t.strideHeight,n=t.strideWidth,a=t.dilationDepth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,f=s-1-t.padInfo.front,d=u-1-t.padInfo.top,p=l-1-t.padInfo.left,v=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+f+", "+d+", "+p+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+r+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+n+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+v+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Gw=function(t,e,r,n,a,i,o){r===void 0&&(r=!1),n===void 0&&(n=!1),a===void 0&&(a=!1),i===void 0&&(i=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=r?t[1]:t[2],u=Math.ceil(s/2),l=r?"i * 2, rc.y":"rc.y, i * 2",f=n?"rc.z, i * 2":"i * 2, rc.z",d=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=n?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],v="",g="";i&&(v=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,g="result = activation(result);");var b=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+v+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+f+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+p[0]+`);
          result += (`+d[1]+" * "+p[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+b+`

        `+g+`

        setOutput(result);
      }
    `},$ue=(function(){function t(e,r,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(r-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(r-1)+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var r=this;return function(n,a){r.seedLoc==null&&(r.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(r.seedLoc,e)}},t})(),Uue=function(t,e,r,n){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+n+"), float("+r+`),
                      float(index == coords.y)));
      }
    `},Wue=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var r=ln("rc",e),n=Ct(e),a=(function(s,u,l){if(s===1)return"rc > "+u[0];for(var f="",d=s-2;d<s;d++)f+=l[d]+" >= "+u[d],d<s-1&&(f+="||");return f})(e,t,r),i=(function(s,u,l,f){if(s===1)return"";var d=f.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `})(e,t[t.length-1],t[t.length-2],r),o=(function(s,u){var l=s.length,f=(function(d,p){for(var v=[],g=0;g<=1;g++)for(var b=0;b<=1;b++){for(var y=(g===0?"r":"rp1")+", "+(b===0?"c":"cp1"),x=2;x<d;x++)y=p[p.length-1-x]+","+y;v.push(y)}return v})(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+f[0]+`),
          cEdge ? 0. : getA(`+f[1]+`),
          rEdge ? 0. : getA(`+f[2]+`),
          rEdge || cEdge ? 0. : getA(`+f[3]+")"})(t,r);this.userCode=`
        void main() {
          `+n+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},zue=function(t,e,r){this.variableNames=["x"],this.outputShape=e.map((function(u,l){return u[0]+t[l]+u[1]}));var n=t.length,a=Ct(n),i=e.map((function(u){return u[0]})).join(","),o=e.map((function(u,l){return u[0]+t[l]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=n!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+o+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+r+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+r+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},que=function(t,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(y,x){return y[0]+t[x]+y[1]}));for(var n=t.length,a=Ct(n),i=e.map((function(y){return y[0]})).join(","),o=e.map((function(y,x){return y[0]+t[x]})).join(","),s=ln("rc",n),u=ln("source",n),l=s[n-1]+" < "+this.outputShape[n-1],f=n===1?"source":"vec2("+u.slice(-2).join()+")",d=[a+" rc = outputLoc;",s[n-1]+` += 1;
       if(`+l+`) {
      `,n===1?"":`}
       rc = outputLoc;
       `+s[n-2]+` += 1;
       if(`+s[n-2]+" < "+this.outputShape[n-2]+") {",n===1?"":"  "+s[n-1]+` += 1;
         if(`+l+") {"],p=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",v="",g=0,b=n===1?2:4;g<b;g++)v+=`
        `+d[g]+`
        if (`+p+`) {
          result[`+g+"] = float("+r+`);
        } else {
          `+a+` source = rc - start;
          result[`+g+"] = getChannel(getX("+u.join()+"), "+f+`);
        }
      `;v+=n===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+o+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+v+`
        setOutput(result);
      }
    `},Kw=function(t,e,r){if(this.variableNames=["x"],e==="avg"&&r)throw new Error("Cannot compute positions for average pool.");var n=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,f=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;var p=e==="avg",v="0.0";if(p||(v="-1.0 / 1e-20"),r)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+f+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+o+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var g=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(g="avgValue / count");var b=4*Math.floor(n/4),y=n%4,x=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+f+", "+d+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+o+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+x+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(y===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+x+`
          } else if (`+(y===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+x+`
          } else if (`+(y===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+x+`
          }
        }
        setOutput(`+g+`);
      }
    `}},Xw=function(t,e,r){if(this.variableNames=["x"],e==="avg"&&r)throw new Error("Cannot compute positions for average pool.");var n=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth,v=t.padInfo.front,g=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;var y=e==="avg",x="0.0";if(y||(x="-1.0 / 1e-20"),r)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+o+`);
        const ivec3 pads = ivec3(`+v+", "+g+", "+b+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+f+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+t.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+p+` +
                      wR * `+p+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var S=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(S="avgValue / count");var E=4*Math.floor(n/4),C=n%4,k=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+o+`);
      const ivec3 pads = ivec3(`+v+", "+g+", "+b+`);
      const float initializationValue = `+x+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+x+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+f+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+E+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+k+`
            }

            int xC = xCCorner + `+E+`;
            if (`+(C===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+k+`
            } else if (`+(C===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+k+`
            } else if (`+(C===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+k+`
            }
          }
          setOutput(`+S+`);
        }
      }
    `}},Vue=function(t,e){this.variableNames=["x"];var r=t.windowSize,n=t.batchSize,a=t.inSize,i=Math.ceil(a/r);this.outputShape=[n,i];var o="0.0",s="";e==="prod"?o="1.0":e==="min"?(o="1.0 / 1e-20",s="min"):e==="max"&&(o="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var l=4*Math.floor(r/4),f=r%4,d=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,p="vec4";e==="all"?(o="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):e==="any"&&(o="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");var v="";a%r>0&&(v=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+v+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(f===1)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(f===2)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(f===3)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},Hue=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r="",n=0;n<4;n++){var a="thisRC = rc;";n%2==1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),r+=`
        `+a+`
        `+(n>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+n+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(n>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+ts(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+DS(t)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+t[1]+`;
        int cols = `+t[2]+`;

        `+r+`

        setOutput(result);
      }
    `},Gue=function(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var n=e.shape,a=n[1],i=n[2],o=t.shape,s=o[1],u=o[2],l=[r&&s>1?a-1:a,r&&u>1?i-1:i],f=[r&&s>1?s-1:s,r&&u>1?u-1:u],d=l[0]/f[0],p=l[1]/f[1],v=1/d,g=1/p,b=2*Math.ceil(v)+2,y=2*Math.ceil(g)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+v+`);
        const float invWidthScale = float(`+g+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},Kue=function(t,e,r,n){this.variableNames=["A"],this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,r,s];var u=[n&&e>1?i-1:i,n&&r>1?o-1:o],l=[n&&e>1?e-1:e,n&&r>1?r-1:r];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},Xue=function(t,e,r,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,r,s];var u=[n&&e>1?i-1:i,n&&r>1?o-1:o],l=[n&&e>1?e-1:e,n&&r>1?r-1:r];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(r-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},Yue=function(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var n=e.shape,a=n[1],i=n[2],o=t.shape,s=o[1],u=o[2],l=[r&&s>1?a-1:a,r&&u>1?i-1:i],f=[r&&s>1?s-1:s,r&&u>1?u-1:u],d=l[0]/f[0],p=l[1]/f[1],v=1/d,g=1/p,b=2*Math.ceil(v)+2,y=2*Math.ceil(g)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+v+`);
        const float invWidthScale = float(`+g+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+f[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+f[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+r+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+r+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},Jue=function(t,e,r,n){this.variableNames=["A"],this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,r,s];var u=[n&&e>1?i-1:i,n&&r>1?o-1:o],l=[n&&e>1?e-1:e,n&&r>1?r-1:r],f=n?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+f+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},Que=function(t,e){this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-"+r+" tensor is not yet supported");if(this.outputShape=t,r!==1){var n=t.map((function(i,o){return(function(s){return e.indexOf(s)!==-1&&t[s]!==1?t[s]+" - coords["+s+"] - 1":"coords["+s+"]"})(o)})).join(","),a=Ct(r);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+n+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+t[0]+` - coord - 1));
        }
      `},Zue=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-"+r+" tensor is not yet supported");this.outputShape=t;var n=ln("rc",r),a=n[r-1]+" + 1 < "+this.outputShape[r-1],i=n[r-2]+" + 1 < "+this.outputShape[r-2],o=Ct(r);function s(u){var l=t.map((function(f,d){return(function(p,v){return e.indexOf(p)!==-1&&t[p]!==1?t[p]+" - "+v[p]+" - 1":""+v[p]})(d,u)}));return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=r===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+t[0]+` - rc - 1),
            `+t[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+t[0]+` - (rc  + 1) - 1),
                `+t[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+(function(u){return s(u)})(n.slice())+`;
          if(`+a+`){
            result.g = `+(function(u){return u[r-1]="("+u[r-1]+" + 1)",s(u)})(n.slice())+`;
          }
          if(`+i+`) {
            result.b = `+(function(u){return u[r-2]="("+u[r-2]+" + 1)",s(u)})(n.slice())+`;
            if(`+a+`) {
              result.a = `+(function(u){return u[r-1]="("+u[r-1]+" + 1)",u[r-2]="("+u[r-2]+" + 1)",s(u)})(n.slice())+`;
            }
          }
          setOutput(result);
        }
    `},cD=function(t,e,r,n,a,i,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ct(a.length),u=Ct(i.length),l="";r===1?l="i":r===2&&(l="i, j");var f="getIndices("+l+")",d="";n===1?d="i":n===2&&(d="i, coords[1]");var p="getUpdates("+d+")",v=e>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+a+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+t+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+f+`);
              flattenedIndex += index * `+v+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+p+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},ele=function(t,e){this.variableNames=["x","segmentIds"];var r=t.windowSize,n=t.batchSize,a=t.inSize,i=t.numSegments,o=i*Math.ceil(a/r);this.outputShape=[n,o];var s=4*Math.floor(r/4),u=r%4,l=`
        sumValue += dot(values, segFilter);
    `,f="";a%r>0&&(f=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var d="";a%r>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+f+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+r+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},tle=function(t,e,r){var n,a;if(this.variableNames=["c","a","b"],this.outputShape=e,r>4)throw Error("Where for rank "+r+" is not yet supported");if(r===1)a="resRC",n="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<e.length;u++)s.push(""+i[u]),u<t&&o.push(""+i[u]);n=o.join(),a=s.join()}var l=Ct(r);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+n+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},rle=(function(){function t(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var r,n=Ct(this.rank),a="uniform int start["+this.rank+"];",i=(function(o){if(o===1)return"sourceLoc";if(o<=6)return Yw.slice(0,o).map((function(s){return"sourceLoc."+s})).join(",");throw Error("Slicing for rank "+o+" is not yet supported")})(this.rank);r=`
        `+n+` sourceLoc;
        `+n+` coords = getOutputCoords();
        `+e.map((function(o,s){return"sourceLoc."+Yw[s]+" = start["+s+"] + coords."+Yw[s]+";"})).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+r+`
        setOutput(getSource(`+i+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var r=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,a){r.startLoc==null&&(r.startLoc=n.getUniformLocationNoThrow(a,"start"),r.startLoc==null)||n.gl.uniform1iv(r.startLoc,e)}},t})(),Yw=["x","y","z","w","u","v"],nle=(function(){function t(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var r=Ct(this.rank),n=ln("coords",this.rank),a=ln("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",o="getChannel(getSource("+a.join()+"), "+i+")",s=`
      result.x = `+o+`;
      if (++`+n[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+o+`;
        --`+a[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+n[this.rank-1]+`;
      if (++`+n[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+n[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+r+"("+e.map((function(f,d){return"start["+d+"]"})).join()+");":e.map((function(f,d){return a[d]+" = "+n[d]+" + start["+d+"];"})).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+r+` coords = getOutputCoords();
        `+r+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var r=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,a){r.startLoc==null&&(r.startLoc=n.getUniformLocationNoThrow(a,"start"),r.startLoc==null)||n.gl.uniform1iv(r.startLoc,e)}},t})(),ale=function(t,e,r){this.variableNames=["x"],this.outputShape=r;var n=r.length,a=Ct(r.length),i=Ct(r.length),o="";if(n===1)o="coords * strides + begin";else{var s=0;o=r.map((function(u,l){return s++,r.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"})).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+t+`);
      `+a+" strides = "+a+"("+e+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},ile=(function(){function t(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(e,r,n){var a,i=fD(r,n),o=dD(e,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),i===En.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===En.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===En.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===En.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===En.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),a},t.prototype.releaseTexture=function(e,r,n,a){if(this.freeTextures!=null){var i=dD(r,fD(n,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(e),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],s=o.indexOf(e);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var r in this.freeTextures)this.freeTextures[r].forEach((function(n){e.gpgpu.deleteMatrixTexture(n)}));for(var r in this.usedTextures)this.usedTextures[r].forEach((function(a){e.gpgpu.deleteMatrixTexture(a)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t})();function fD(t,e){if(t===kn.UPLOAD)return En.PACKED_2X2_FLOAT32;if(t===kn.RENDER||t==null)return(function(r){return ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?r?En.PACKED_2X2_FLOAT32:En.UNPACKED_FLOAT32:r?En.PACKED_2X2_FLOAT16:En.UNPACKED_FLOAT16})(e);if(t===kn.DOWNLOAD||t===kn.PIXELS)return En.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function dD(t,e,r){return t[0]+"_"+t[1]+"_"+e+"_"+r}var ole=function(t,e){this.variableNames=["A"];for(var r=new Array(t.length),n=0;n<r.length;n++)r[n]=t[n]*e[n];this.outputShape=r,this.rank=r.length;var a=Ct(this.rank),i=(function(o){var s=o.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+o[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],f=0;f<o.length;f++)l.push("imod("+u[f]+", "+o[f]+")");return l.join()})(t);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},sle=function(t,e){this.variableNames=["A"];for(var r=new Array(t.length),n=0;n<r.length;n++)r[n]=t[e[n]];this.outputShape=r,this.rank=r.length;var a=Ct(this.rank),i=(function(o){var s=o.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),f=0;f<o.length;f++)l[o[f]]=u[f];return l.join()})(e);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},ule=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),n=0;n<r.length;n++)r[n]=t[e[n]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=Ct(this.rank),i=AL("rc",this.rank),o=new Array(this.rank);for(n=0;n<e.length;n++)o[e[n]]=i[n];var s="vec2("+o.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+r[this.rank-1],l="getChannel(getA("+o.join()+"), "+s+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+r[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},MS=1.7580993408473768,FS=1.0507009873554805,tt=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},ma="if (isnan(x)) return x;",lle="return x;",hD="return abs(x);",RL=ma+`
  return (x < 0.0) ? 0.0 : x;
`,IL=ma+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,jL="return (x >= 0.0) ? x : (exp(x) - 1.0);",cle=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+MS+`;
  float scale = `+FS+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,pD="return -x;",vD="return ceil(x);",mD="return floor(x);",gD="return exp(x);",yD="return exp(x) - 1.0;",fle=ma+`
  return sin(x);
`,dle=ma+`
  return cos(x);
`,hle=ma+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,ple=ma+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,vle=ma+`
  return atan(x);
`,mle=ma+"return log(x + sqrt(x * x + 1.0));",gle=ma+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,yle=ma+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Kh="return x;",ble="return x;",DL=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ML=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,FL=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Pc=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},xle=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,r=ln("rc",e),n=Ct(e),a=(function(s,u){if(s===1)return"rc";for(var l="",f=0;f<s;f++)l+=u[f],f<s-1&&(l+=",");return l})(e,r),i=r.slice(-2),o=e<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+n+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},Xh={};function Yh(t,e){if(e===void 0&&(e=!1),t==="linear")return e?ble:lle;if(t==="relu")return e?DL:RL;if(t==="elu")return e?FL:jL;if(t==="relu6")return e?ML:IL;if(t==="prelu")return e?NL:PL;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var wle=600,_le=(function(t){function e(r){var n,a=t.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!ce().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(r==null){var i=Ua(ce().getNumber("WEBGL_VERSION"));a.binaryCache=((n=ce().getNumber("WEBGL_VERSION"))in Xh||(Xh[n]={}),Xh[n]),a.gpgpu=new Iue(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=r,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=r.gl.canvas;return a.textureManager=new ile(a.gpgpu),a.numMBBeforeWarning=ce().global.screen==null?1024:ce().global.screen.height*ce().global.screen.width*window.devicePixelRatio*wle/1024/1024,a.texData=new yL(a,ee),a}return va(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(r,n,a){if(ce().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64"&&r!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:n,dtype:a,values:r,usage:kn.UPLOAD}),i},e.prototype.move=function(r,n,a,i){if(ce().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(r,{shape:a,dtype:i,values:n,usage:kn.UPLOAD})},e.prototype.readSync=function(r){var n=this.texData.get(r),a=n.values,i=n.dtype,o=n.complexTensors,s=n.slice,u=n.shape,l=n.isPacked;if(s!=null){var f=void 0;f=l?new Pc(u,Kh):new tt(u,Kh);var d=this.runWebGLProgram(f,[{dataId:r,shape:u,dtype:i}],i),p=this.readSync(d.dataId);return this.disposeData(d.dataId),p}if(a!=null)return this.convertAndCacheOnCPU(r);if(i==="string")return a;var v,g,b=this.activeTimers!=null;return b&&(v=Ca()),i==="complex64"?g=r2(o.real.dataSync(),o.imag.dataSync()):g=this.getValuesFromTexture(r),b&&(this.downloadWaitMs+=Ca()-v),this.convertAndCacheOnCPU(r,g)},e.prototype.read=function(r){return Ne(this,void 0,void 0,(function(){var n,a,i,o,s,u,l,f,d,p,v,g,b,y,x,S,E,C,k,A,T,N;return Re(this,(function(R){switch(R.label){case 0:if(this.pendingRead.has(r))return n=this.pendingRead.get(r),[2,new Promise((function(I){return n.push(I)}))];if(a=this.texData.get(r),i=a.values,o=a.shape,s=a.slice,u=a.dtype,l=a.complexTensors,f=a.isPacked,s!=null)return d=void 0,d=f?new Pc(o,Kh):new tt(o,Kh),p=this.runWebGLProgram(d,[{dataId:r,shape:o,dtype:u}],u),v=this.read(p.dataId),this.disposeData(p.dataId),[2,v];if(i!=null)return[2,this.convertAndCacheOnCPU(r)];if(!ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ce().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return g=null,u!=="complex64"&&ce().get("WEBGL_BUFFER_SUPPORTED")&&(b=this.decode(r),y=this.texData.get(b.dataId),g=(N=this.gpgpu).createBufferFromTexture.apply(N,[y.texture].concat(Vc(o)))),this.pendingRead.set(r,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:R.sent(),R.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return S=R.sent(),E=S[0],C=S[1],x=r2(E,C),[3,5];case 4:g==null?x=this.getValuesFromTexture(r):(k=je(o),x=this.gpgpu.downloadFloat32MatrixFromBuffer(g,k)),R.label=5;case 5:return b!=null&&this.disposeData(b.dataId),A=this.convertAndCacheOnCPU(r,x),T=this.pendingRead.get(r),this.pendingRead.delete(r),T.forEach((function(I){return I(A)})),this.pendingDisposal.has(r)&&(this.pendingDisposal.delete(r),this.disposeData(r),this.pendingDeletes--),[2,A]}}))}))},e.prototype.checkNumericalProblems=function(r){if(r!=null)for(var n=0;n<r.length;n++){var a=r[n];if(!coe(a))throw ce().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(r){var n,a=this.texData.get(r),i=a.shape,o=a.dtype,s=a.isPacked,u=je(i);if(ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(r),f=this.texData.get(l.dataId),d=(n=this.gpgpu).downloadMatrixFromPackedTexture.apply(n,[f.texture].concat(Vc(i))).subarray(0,u);return this.disposeData(l.dataId),d}var p=ce().getBool("WEBGL_PACK")&&s===!0,v=p?zw(i):i,g=p?new lue(v):new uue(v),b=this.runWebGLProgram(g,[{shape:v,dtype:o,dataId:r}],"float32"),y=this.texData.get(b.dataId),x=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(y.texture,y.texShape[0],y.texShape[1]).subarray(0,u);return this.disposeData(b.dataId),x},e.prototype.time=function(r){return Ne(this,void 0,void 0,(function(){var n,a,i,o,s,u,l;return Re(this,(function(f){switch(f.label){case 0:return n=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,r(),o=dl(this.activeTimers.map((function(d){return d.query}))).filter((function(d){return d!=null})),s=dl(this.activeTimers.map((function(d){return d.name}))).filter((function(d){return d!=null})),this.activeTimers=n,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return l=f.sent(),u.kernelMs=qie(l),u.getExtraProfileInfo=function(){return l.map((function(d,p){return{name:s[p],ms:d}})).map((function(d){return d.name+": "+d.ms})).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},f.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ca(),endMs:null}},e.prototype.endTimer=function(r){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),r):(r.endMs=Ca(),r)},e.prototype.getQueryTime=function(r){return Ne(this,void 0,void 0,(function(){var n;return Re(this,(function(a){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(r)]:[2,(n=r).endMs-n.startMs]}))}))},e.prototype.disposeData=function(r){if(!this.pendingDisposal.has(r)){if(this.pendingRead.has(r))return this.pendingDisposal.add(r),void this.pendingDeletes++;if(this.texData.has(r)){this.releaseGPUData(r);var n=this.texData.get(r).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.texData.delete(r)}}},e.prototype.releaseGPUData=function(r){var n=this.texData.get(r),a=n.texture,i=n.dtype,o=n.texShape,s=n.usage,u=n.isPacked,l=n.slice,f=l&&l.origDataId||r,d=this.dataRefCount.get(f);d>1?this.dataRefCount.set(f,d-1):(this.dataRefCount.delete(f),a!=null&&(this.numBytesInGPU-=this.computeBytes(o,i),this.textureManager.releaseTexture(a,o,s,u)));var p=this.texData.get(r);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null},e.prototype.getTexture=function(r){return this.uploadToGPU(r),this.texData.get(r).texture},e.prototype.getDataInfo=function(r){return this.texData.get(r)},e.prototype.getCPUBackend=function(){return ce().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=ee.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(r,n){var a=this;return n===void 0&&(n=128),this.getCPUBackend()!=null&&r.every((function(i){return a.texData.get(i.dataId).texture==null&&i.size<n}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(r,n){var a=this.makeOutput(r.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:ee.keep(r.clone()),imag:ee.keep(n.clone())},a},e.prototype.real=function(r){return this.texData.get(r.dataId).complexTensors.real.clone()},e.prototype.imag=function(r){return this.texData.get(r.dataId).complexTensors.imag.clone()},e.prototype.slice=function(r,n,a){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.slice(r,n,a);if(je(a)===0)return Rr([],a,r.dtype);var i=this.texData.get(r.dataId).isPacked,o=mL(r.shape,n,a);if(i||!o){var s=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nle(a):new rle(a),u=s.getCustomSetupFunc(n);return this.compileAndRun(s,[r],null,u)}return this.uploadToGPU(r.dataId),this.shallowSlice(r,n,a)},e.prototype.shallowSlice=function(r,n,a){var i=this.texData.get(r.dataId),o=this.makeOutput(a,r.dtype),s=this.texData.get(o.dataId);Object.assign(s,i),s.shape=a,s.dtype=r.dtype;var u=gL(n,r.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||r.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),o},e.prototype.stridedSlice=function(r,n,a,i){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.stridedSlice(r,n,a,i);var o=PS(n,a,i);if(o.some((function(u){return u===0})))return Rr([],o);var s=new ale(n,i,o);return this.compileAndRun(s,[r])},e.prototype.reverse=function(r,n){var a=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Zue(r.shape,n):new Que(r.shape,n);return this.compileAndRun(a,[r])},e.prototype.concat=function(r,n){if(r[0].dtype==="complex64"){var a=r.map((function(v){return Un(v)})),i=r.map((function(v){return Aa(v)}));return Pr(this.concat(a,n),this.concat(i,n))}if(this.shouldExecuteOnCPU(r))return this.cpuBackend.concat(r,n);if(r.length===1)return r[0];if(r.length>ce().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(r.length/2),s=this.concat(r.slice(0,o),n),u=this.concat(r.slice(o),n);return this.concat([s,u],n)}if(ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].rank>1){var l=new Kse(r.map((function(v){return v.shape})),n);return this.compileAndRun(l,r)}var f=pl(r.map((function(v){return v.shape})),n),d=r.map((function(v){return v.as2D(-1,je(v.shape.slice(n)))})),p=new Gse(d.map((function(v){return v.shape})));return this.compileAndRun(p,d).reshape(f)},e.prototype.neg=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.neg(r);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,pD,r.dtype);var n=new tt(r.shape,pD);return this.compileAndRun(n,[r])},e.prototype.batchMatMul=function(r,n,a,i){var o=a?r.shape[2]:r.shape[1],s=i?n.shape[1]:n.shape[2],u=a?r.shape[1]:r.shape[2],l=r.shape[0];if((o===1||s===1)&&u>1e3){a&&(r=r.transpose([0,2,1])),i&&(n=n.transpose([0,2,1]));var f=s===1?r:r.as3D(l,u,1),d=s===1?2:1,p=s===1?n.as3D(l,1,u):n;return this.multiply(f,p).sum(d,!0)}var v=Nr(r.dtype,n.dtype),g=new Gw(r.shape,[l,o,s],a,i);return this.compileAndRun(g,[r,n],v)},e.prototype.fusedBatchMatMul=function(r){var n=r.a,a=r.b,i=r.transposeA,o=r.transposeB,s=r.bias,u=r.activation,l=r.preluActivationWeights,f=i?n.shape[2]:n.shape[1],d=o?a.shape[1]:a.shape[2],p=n.shape[0],v=Nr(n.dtype,a.dtype),g=s!=null,b=l!=null,y=u?Yh(u,!0):null,x=new Gw(n.shape,[p,f,d],i,o,g,y,b),S=[n,a];return s&&S.push(s),l&&S.push(l),this.compileAndRun(x,S,v)},e.prototype.multiply=function(r,n){if(r.dtype==="complex64"){var a=this.texData.get(r.dataId),i=this.texData.get(n.dataId),o=new rD(Wse,r.shape,n.shape),s=new rD(zse,r.shape,n.shape),u=[this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag),this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],l=this.compileAndRun(o,u),f=this.compileAndRun(s,u),d=this.complex(l,f);return l.dispose(),f.dispose(),d}if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.multiply(r,n);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,nD,r.dtype);var p=new qt(nD,r.shape,n.shape);return this.compileAndRun(p,[r,n],r.dtype)},e.prototype.batchNormalization=function(r,n,a,i,o,s){var u=[r,n,a],l=null;s!=null&&(l=s.shape,u.push(s));var f=null;if(o!=null&&(f=o.shape,u.push(o)),ce().getBool("WEBGL_PACK_NORMALIZATION")){var d=new Use(r.shape,n.shape,a.shape,l,f,i);return this.compileAndRun(d,u)}var p=new $se(r.shape,n.shape,a.shape,l,f,i);return this.compileAndRun(p,u)},e.prototype.localResponseNormalization4D=function(r,n,a,i,o){var s=ce().getBool("WEBGL_PACK_NORMALIZATION")?new Fue(r.shape,n,a,i,o):new Due(r.shape,n,a,i,o);return this.compileAndRun(s,[r])},e.prototype.LRNGrad=function(r,n,a,i,o,s,u){var l=new Mue(n.shape,i,o,s,u);return this.compileAndRun(l,[n,a,r])},e.prototype.tile=function(r,n){if(r.dtype==="string"){var a=this.readSync(r.dataId).map((function(o){return dv(o)}));return CL(Ze(r.shape,r.dtype,a),n)}var i=new ole(r.shape,n);return this.compileAndRun(i,[r])},e.prototype.pad=function(r,n,a){var i=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new que(r.shape,n,a):new zue(r.shape,n,a);return this.compileAndRun(i,[r])},e.prototype.transpose=function(r,n){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.transpose(r,n);var a=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ule(r.shape,n):new sle(r.shape,n);return this.compileAndRun(a,[r])},e.prototype.gather=function(r,n,a){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.gather(r,n,a);var i=new vue(r.shape,n.size,a);return this.compileAndRun(i,[r,n])},e.prototype.batchToSpaceND=function(r,n,a){U(r.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var i=n.reduce((function(d,p){return d*p})),o=yv(r.shape,n,i),s=bv(o.length,n.length),u=xv(r.shape,n,i),l=dL(a,n.length),f=hL(u,a,n.length);return r.reshape(o).transpose(s).reshape(u).slice(l,f)},e.prototype.spaceToBatchND=function(r,n,a){U(r.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var i=n.reduce((function(p,v){return p*v})),o=[[0,0]];o.push.apply(o,a);for(var s=1+n.length;s<r.shape.length;++s)o.push([0,0]);var u=r.pad(o),l=yv(u.shape,n,i,!1),f=bv(l.length,n.length,!1),d=xv(u.shape,n,i,!1);return u.reshape(l).transpose(f).reshape(d)},e.prototype.reduce=function(r,n,a){var i=r.shape[0],o=r.shape[1],s=qw(o),u=new Vue({windowSize:s,inSize:o,batchSize:i},n),l=this.compileAndRun(u,[r],a);return l.shape[1]===1?l:this.reduce(l,n,a)},e.prototype.argReduce=function(r,n,a){a===void 0&&(a=null);var i=r.shape[0],o=r.shape[1];a!=null&&(i=a.shape[0],o=a.shape[1]);var s=qw(o),u=new Nse({windowSize:s,inSize:o,batchSize:i},n,a==null),l=[r];a!=null&&l.push(a);var f=this.compileAndRun(u,l,"int32");return f.shape[1]===1?f:this.argReduce(r,n,f)},e.prototype.argReducePacked=function(r,n,a){a===void 0&&(a=null);var i=a!=null?a.shape:r.shape,o=qw(i[i.length-1]),s=new Fse(i,o,n,a==null),u=a==null?[r]:[r,a],l=this.compileAndRun(s,u,"int32");return l.rank===r.rank?this.argReducePacked(r,n,l):l},e.prototype.sum=function(r,n){Sn("sum",n,r.rank);var a=Wr(r.shape,n),i=a[0],o=je(a[1]),s=r.as2D(-1,o),u=Mw(r.dtype);return this.reduce(s,"sum",u).reshape(i)},e.prototype.prod=function(r,n){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.prod(r,n);var a=Wr(r.shape,n),i=a[0],o=je(a[1]),s=r.as2D(-1,o),u=Mw(r.dtype);return this.reduce(s,"prod",u).reshape(i)},e.prototype.unsortedSegmentSum=function(r,n,a){var i=0,o=Wa([i],r.rank),s=r;o!=null&&(s=r.transpose(o),i=za(1,r.rank)[0]);var u=(function(v,g,b){for(var y=[],x=v.length,S=0;S<x;S++)S!==g?y.push(v[S]):y.push(b);return y})(s.shape,i,a),l=je([s.shape[i]]),f=s.as2D(-1,l),d=Mw(r.dtype),p=this.segOpCompute(f,"unsortedSegmentSum",n,d,a).reshape(u);return o!=null&&(p=p.transpose(kS(o))),p},e.prototype.segOpCompute=function(r,n,a,i,o){var s=r.shape[0],u=r.shape[1],l=(function(p,v){var g,b=!1;for(p<=vL?(g=p,b=!0):g=G_(p,Math.floor(Math.sqrt(p)));!b;)g>v||g===p?b=!0:g=G_(p,g+1);return g})(u,o),f=new ele({windowSize:l,inSize:u,batchSize:s,numSegments:o}),d=this.compileAndRun(f,[r,a],i);return d.shape[1]===o?d:(a=gv(0,o).tile([u/l]),this.segOpCompute(d,n,a,i,o))},e.prototype.argMinMaxReduce=function(r,n,a){var i=[n];if(Sn("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,r.rank),!ce().getBool("WEBGL_PACK_REDUCE")||r.rank<=2){var o=Wr(r.shape,i),s=o[0],u=je(o[1]),l=r.as2D(-1,u);return this.argReduce(l,a).reshape(s)}return this.argReducePacked(r,a)},e.prototype.argMin=function(r,n){return this.argMinMaxReduce(r,n,"min")},e.prototype.argMax=function(r,n){return this.argMinMaxReduce(r,n,"max")},e.prototype.cumsum=function(r,n,a,i){if(n!==r.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(r.rank-1)+" but got axis="+n);var o=new nue(r.shape,a,i);return this.compileAndRun(o,[r])},e.prototype.equal=function(r,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(equal(a, b));
`,"bool");var a=new qt("return float(a == b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},e.prototype.notEqual=function(r,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(notEqual(a, b));
`,"bool");var a=new qt("return float(a != b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},e.prototype.less=function(r,n){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.less(r,n);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(lessThan(a, b));
`,"bool");var a=new qt("return float(a < b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},e.prototype.lessEqual=function(r,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new qt("return float(a <= b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},e.prototype.greater=function(r,n){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.greater(r,n);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new qt("return float(a > b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},e.prototype.greaterEqual=function(r,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new qt("return float(a >= b);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},e.prototype.logicalNot=function(r){var n=new tt(r.shape,"return float(!(x >= 1.0));");return this.compileAndRun(n,[r])},e.prototype.logicalAnd=function(r,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new qt("return float(a >= 1.0 && b >= 1.0);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},e.prototype.logicalOr=function(r,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new qt("return float(a >= 1.0 || b >= 1.0);",r.shape,n.shape);return this.compileAndRun(a,[r,n],"bool")},e.prototype.select=function(r,n,a){var i=new tle(r.rank,n.shape,n.rank);return this.compileAndRun(i,[r,n,a],Nr(n.dtype,a.dtype))},e.prototype.where=function(r){vv("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var n=r.dataSync();return jS(r.shape,n)},e.prototype.topk=function(r,n,a){return kL(r.dataSync(),r.shape,r.dtype,n)},e.prototype.min=function(r,n){Sn("min",n,r.rank);var a=Wr(r.shape,n),i=a[0],o=je(a[1]),s=r.as2D(-1,o);return this.reduce(s,"min",s.dtype).reshape(i)},e.prototype.minimum=function(r,n){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.minimum(r,n);var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ti(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new qt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,r.shape,n.shape);return this.compileAndRun(a,[r,n])},e.prototype.mod=function(r,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ti(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new qt(`if (b == 0.0) return NAN;
  return mod(a, b);`,r.shape,n.shape);return this.compileAndRun(a,[r,n])},e.prototype.max=function(r,n){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.max(r,n);Sn("max",n,r.rank);var a=Wr(r.shape,n),i=a[0],o=je(a[1]),s=r.as2D(-1,o);return this.reduce(s,"max",s.dtype).reshape(i)},e.prototype.maximum=function(r,n){if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.maximum(r,n);var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ti(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new qt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,r.shape,n.shape);return this.compileAndRun(a,[r,n])},e.prototype.all=function(r,n){Sn("all",n,r.rank);var a=Wr(r.shape,n),i=a[0],o=je(a[1]),s=r.as2D(-1,o);return this.reduce(s,"all",s.dtype).reshape(i)},e.prototype.any=function(r,n){Sn("any",n,r.rank);var a=Wr(r.shape,n),i=a[0],o=je(a[1]),s=r.as2D(-1,o);return this.reduce(s,"any",s.dtype).reshape(i)},e.prototype.realDivide=function(r,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new qt(`
if (a == b) {
  return 1.0;
};
return a / b;`,r.shape,n.shape);return this.compileAndRun(a,[r,n],"float32")},e.prototype.floorDiv=function(r,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new qt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,r.shape,n.shape);return this.compileAndRun(a,[r,n],"int32")},e.prototype.add=function(r,n){if(r.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(r,n,Vw);if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.add(r,n);var a=Nr(r.dtype,n.dtype);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,Vw,a);var i=new qt(Vw,r.shape,n.shape);return this.compileAndRun(i,[r,n],a)},e.prototype.packedUnaryOp=function(r,n,a){var i=new Pc(r.shape,n);return this.compileAndRun(i,[r],a)},e.prototype.packedBinaryOp=function(r,n,a,i,o){o===void 0&&(o=!1);var s=new ti(a,r.shape,n.shape,o);return this.compileAndRun(s,[r,n],i)},e.prototype.complexSeparableBinaryOp=function(r,n,a){var i=this,o=this.texData.get(r.dataId),s=this.texData.get(n.dataId),u=[[o.complexTensors.real,s.complexTensors.real],[o.complexTensors.imag,s.complexTensors.imag]].map((function(p){var v=p[0],g=p[1],b=i.makeComplexComponentTensorInfo(r,v),y=i.makeComplexComponentTensorInfo(n,g),x=new qt(a,r.shape,n.shape);return i.compileAndRun(x,[b,y],Nr(v.dtype,g.dtype))})),l=u[0],f=u[1],d=this.complex(l,f);return l.dispose(),f.dispose(),d},e.prototype.makeComplexComponentTensorInfo=function(r,n){return{dataId:n.dataId,dtype:n.dtype,shape:r.shape}},e.prototype.addN=function(r){if(r.length===1)return r[0];if(r.length>ce().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(r.length/2),a=this.addN(r.slice(0,n)),i=this.addN(r.slice(n));return this.addN([a,i])}var o=r.map((function(l){return l.dtype})).reduce((function(l,f){return Nr(l,f)})),s=r.map((function(l){return l.shape})),u=ce().getBool("WEBGL_PACK")?new Pse(r[0].shape,s):new Tse(r[0].shape,s);return this.compileAndRun(u,r,o)},e.prototype.subtract=function(r,n){if(r.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(r,n,Hw);if(this.shouldExecuteOnCPU([r,n]))return this.cpuBackend.subtract(r,n);var a=Nr(r.dtype,n.dtype);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(r,n,Hw,r.dtype);var i=new qt(Hw,r.shape,n.shape);return this.compileAndRun(i,[r,n],a)},e.prototype.pow=function(r,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ti(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new qt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,r.shape,n.shape),i=Nr(r.dtype,n.dtype);return this.compileAndRun(a,[r,n],i)},e.prototype.ceil=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.ceil(r);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,vD,r.dtype);var n=new tt(r.shape,vD);return this.compileAndRun(n,[r])},e.prototype.floor=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.floor(r);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,mD,r.dtype);var n=new tt(r.shape,mD);return this.compileAndRun(n,[r])},e.prototype.sign=function(r){var n=new tt(r.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(n,[r])},e.prototype.isNaN=function(r){var n=new tt(r.shape,"return float(isnan(x));");return this.compileAndRun(n,[r],"bool")},e.prototype.isInf=function(r){var n=new tt(r.shape,"return float(isinf(x));");return this.compileAndRun(n,[r],"bool")},e.prototype.isFinite=function(r){var n=new tt(r.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(n,[r],"bool")},e.prototype.round=function(r){var n=new tt(r.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(n,[r])},e.prototype.exp=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.exp(r);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,gD,r.dtype);var n=new tt(r.shape,gD);return this.compileAndRun(n,[r])},e.prototype.expm1=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.expm1(r);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,yD,r.dtype);var n=new tt(r.shape,yD);return this.compileAndRun(n,[r])},e.prototype.softmax=function(r,n){var a=vr([n],r.shape),i=this.max(r,a),o=dn(i.shape,a),s=this.subtract(r,i.reshape(o)),u=this.exp(s),l=this.sum(u,a).reshape(o);return this.realDivide(u,l)},e.prototype.log=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.log(r);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,r.dtype);var n=new tt(r.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(n,[r])},e.prototype.log1p=function(r){var n=new tt(r.shape,"return log(1.0 + x);");return this.compileAndRun(n,[r])},e.prototype.sqrt=function(r){var n=new tt(r.shape,"return sqrt(x);");return this.compileAndRun(n,[r])},e.prototype.rsqrt=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.rsqrt(r);var n=new tt(r.shape,"return inversesqrt(x);");return this.compileAndRun(n,[r])},e.prototype.reciprocal=function(r){var n=new tt(r.shape,"return 1.0 / x;");return this.compileAndRun(n,[r])},e.prototype.relu=function(r){var n;return n=ce().getBool("WEBGL_PACK")?new Pc(r.shape,DL):new tt(r.shape,RL),this.compileAndRun(n,[r])},e.prototype.relu6=function(r){var n;return n=ce().getBool("WEBGL_PACK")?new Pc(r.shape,ML):new tt(r.shape,IL),this.compileAndRun(n,[r])},e.prototype.prelu=function(r,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ti(NL,r.shape,n.shape):new qt(PL,r.shape,n.shape);return this.compileAndRun(a,[r,n])},e.prototype.elu=function(r){if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,FL,r.dtype);var n=new tt(r.shape,jL);return this.compileAndRun(n,[r])},e.prototype.eluDer=function(r,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ti(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,r.shape,n.shape):new qt("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,n.shape);return this.compileAndRun(a,[r,n])},e.prototype.selu=function(r){var n=new tt(r.shape,cle);return this.compileAndRun(n,[r])},e.prototype.int=function(r){var n=new tt(r.shape,"return float(int(x));");return this.compileAndRun(n,[r],"int32")},e.prototype.clip=function(r,n,a){var i,o=(i=ce().getBool("WEBGL_PACK_CLIP")?new Vse(r.shape):new qse(r.shape)).getCustomSetupFunc(n,a);return this.compileAndRun(i,[r],null,o)},e.prototype.abs=function(r){if(this.shouldExecuteOnCPU([r]))return this.cpuBackend.abs(r);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(r,hD,r.dtype);var n=new tt(r.shape,hD);return this.compileAndRun(n,[r])},e.prototype.complexAbs=function(r){var n=this.texData.get(r.dataId),a=new Hse(r.shape),i=[this.makeComplexComponentTensorInfo(r,n.complexTensors.real),this.makeComplexComponentTensorInfo(r,n.complexTensors.imag)];return this.compileAndRun(a,i)},e.prototype.sigmoid=function(r){var n=new tt(r.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(n,[r])},e.prototype.softplus=function(r){var n=new tt(r.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(n,[r])},e.prototype.sin=function(r){var n=new tt(r.shape,fle);return this.compileAndRun(n,[r])},e.prototype.cos=function(r){var n=new tt(r.shape,dle);return this.compileAndRun(n,[r])},e.prototype.tan=function(r){var n=new tt(r.shape,"return tan(x);");return this.compileAndRun(n,[r])},e.prototype.asin=function(r){var n=new tt(r.shape,hle);return this.compileAndRun(n,[r])},e.prototype.acos=function(r){var n=new tt(r.shape,ple);return this.compileAndRun(n,[r])},e.prototype.atan=function(r){var n=new tt(r.shape,vle);return this.compileAndRun(n,[r])},e.prototype.atan2=function(r,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ti(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,r.shape,n.shape):new qt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,r.shape,n.shape);return this.compileAndRun(a,[r,n])},e.prototype.sinh=function(r){var n=new tt(r.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[r])},e.prototype.cosh=function(r){var n=new tt(r.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[r])},e.prototype.tanh=function(r){var n=new tt(r.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(n,[r])},e.prototype.asinh=function(r){var n=new tt(r.shape,mle);return this.compileAndRun(n,[r])},e.prototype.acosh=function(r){var n=new tt(r.shape,gle);return this.compileAndRun(n,[r])},e.prototype.atanh=function(r){var n=new tt(r.shape,yle);return this.compileAndRun(n,[r])},e.prototype.erf=function(r){var n=new tt(r.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(n,[r])},e.prototype.step=function(r,n){var a=new tt(r.shape,(function(i){return i===void 0&&(i=0),ma+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `})(n));return this.compileAndRun(a,[r])},e.prototype.conv2dByMatMul=function(r,n,a,i,o,s){var u=r.shape,l=this.texData.get(r.dataId),f=a.inChannels,d=u[0]*u[1]*u[2],p=a.outChannels,v=a.dataFormat==="channelsLast",g=(d===1||p===1)&&f>1e3,b=u[2]%2!=0&&!!l.isPacked;if(g||!ce().getBool("WEBGL_LAZILY_UNPACK")||!ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!b){var y=v?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],x=this.reshape(r,[1,y,a.inChannels]),S=this.reshape(n,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:x,b:S,transposeA:!1,transposeB:!1,bias:i,activation:o,preluActivationWeights:s}),a.outShape)}var E=v?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),C={dataId:r.dataId,shape:[1,E,a.inChannels],dtype:r.dtype},k=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,U(Hh(l.shape,C.shape),(function(){return"packed reshape "+l.shape+" to "+C.shape+" isn't free"}));var A=this.reshape(n,[1,a.inChannels,a.outChannels]),T=this.fusedBatchMatMul({a:C,b:A,transposeA:!1,transposeB:!1,bias:i,activation:o,preluActivationWeights:s}),N=this.texData.get(T.dataId);return U(N.isPacked,(function(){return"batchMatMul result is expected to be packed"})),l.shape=k,N.shape=a.outShape,ee.makeTensorFromDataId(T.dataId,a.outShape,T.dtype)},e.prototype.conv2dWithIm2Row=function(r,n,a,i,o,s){var u=a.filterWidth,l=a.filterHeight,f=a.inChannels,d=a.outWidth,p=a.outHeight,v=a.dataFormat==="channelsLast",g=u*l*f,b=p*d,y=[g,b],x=r.squeeze([0]),S=n.reshape([1,g,-1]),E=new jue(y,x.shape,a),C=this.compileAndRun(E,[x]).reshape([1,y[0],y[1]]),k=i!=null,A=s!=null,T=o?Yh(o,!0):null,N=new Gw(C.shape,[1,b,a.outChannels],!0,!1,k,T,A),R=[C,S];i&&R.push(i),A&&R.push(s);var I=this.compileAndRun(N,R);return v?I.reshape([1,p,d,a.outChannels]):I.reshape([1,a.outChannels,p,d])},e.prototype.fusedConv2d=function(r){var n=r.input,a=r.filter,i=r.convInfo,o=r.bias,s=r.activation,u=r.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,i,o,s,u);if(ce().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,i,o,s,u);var l=o!=null,f=u!=null,d=s?Yh(s,!1):null,p=new aD(i,l,d,f),v=[n,a];return o&&v.push(o),u&&v.push(u),this.compileAndRun(p,v)},e.prototype.conv2d=function(r,n,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(r,n,a);if(ce().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,n,a);var i=new aD(a);return this.compileAndRun(i,[r,n])},e.prototype.conv2dDerInput=function(r,n,a){var i=new Yse(a);return this.compileAndRun(i,[r,n])},e.prototype.conv2dDerFilter=function(r,n,a){var i=new Xse(a);return this.compileAndRun(i,[r,n])},e.prototype.fusedDepthwiseConv2D=function(r){var n,a=r.input,i=r.filter,o=r.convInfo,s=r.bias,u=r.activation,l=r.preluActivationWeights,f=ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,d=u?Yh(u,f):null,p=[a,i],v=s!=null,g=l!=null;return v&&p.push(s),g&&p.push(l),f?(n=new oD(o,v,d,g),this.compileAndRun(n,p)):(n=new iD(o,v,d,g),this.compileAndRun(n,p))},e.prototype.depthwiseConv2D=function(r,n,a){var i;return ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new oD(a),this.compileAndRun(i,[r,n])):(i=new iD(a),this.compileAndRun(i,[r,n]))},e.prototype.depthwiseConv2DDerInput=function(r,n,a){var i=new eue(a);return this.compileAndRun(i,[r,n])},e.prototype.depthwiseConv2DDerFilter=function(r,n,a){var i=new Zse(a);return this.compileAndRun(i,[r,n])},e.prototype.conv3d=function(r,n,a){var i=new tue(a);return this.compileAndRun(i,[r,n])},e.prototype.conv3dDerInput=function(r,n,a){var i=new Qse(a);return this.compileAndRun(i,[r,n])},e.prototype.conv3dDerFilter=function(r,n,a){var i=new Jse(a);return this.compileAndRun(i,[r,n])},e.prototype.maxPool=function(r,n){var a=new Kw(n,"max",!1);return this.compileAndRun(a,[r])},e.prototype.avgPool=function(r,n){var a=new Kw(n,"avg",!1);return this.compileAndRun(a,[r],"float32")},e.prototype.maxPoolBackprop=function(r,n,a,i){var o=new Kw(i,"max",!0),s=this.compileAndRun(o,[n]),u=new Lue(i),l=this.compileAndRun(u,[r,s],n.dtype);return s.dispose(),l},e.prototype.avgPoolBackprop=function(r,n,a){var i=new Lse(a);return this.compileAndRun(i,[r],n.dtype)},e.prototype.cast=function(r,n){return wL(r,n,this)},e.prototype.unstack=function(r,n){for(var a=r.shape[n],i=new Array(r.rank-1),o=0,s=0;s<r.rank;s++)s!==n&&(i[o++]=r.shape[s]);var u=new Array(r.rank).fill(0),l=r.shape.slice();l[n]=1;var f=new Array(a);for(s=0;s<f.length;s++)u[n]=s,f[s]=this.slice(r,u,l).reshape(i);return f},e.prototype.avgPool3d=function(r,n){var a=new Xw(n,"avg",!1);return this.compileAndRun(a,[r],"float32")},e.prototype.avgPool3dBackprop=function(r,n,a){var i=new Bse(a);return this.compileAndRun(i,[r],n.dtype)},e.prototype.maxPool3d=function(r,n){var a=new Xw(n,"max",!1);return this.compileAndRun(a,[r],"float32")},e.prototype.maxPool3dBackprop=function(r,n,a,i){var o=new Xw(i,"max",!0),s=this.compileAndRun(o,[n]),u=new Bue(i),l=this.compileAndRun(u,[r,s],n.dtype);return s.dispose(),l},e.prototype.reshape=function(r,n){var a=this.texData.get(r.dataId);if(a.isPacked&&!Hh(r.shape,n)&&(a.texture===null||!Hh(a.shape,n))){var i=this.packedReshape(r,n);return ee.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return t2(r,n)},e.prototype.resizeBilinear=function(r,n,a,i){var o=ce().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Xue(r.shape,n,a,i):new Kue(r.shape,n,a,i);return this.compileAndRun(o,[r],"float32")},e.prototype.resizeBilinearBackprop=function(r,n,a){var i=new Gue(r,n,a);return this.compileAndRun(i,[r])},e.prototype.resizeNearestNeighbor=function(r,n,a,i){var o=new Jue(r.shape,n,a,i);return this.compileAndRun(o,[r])},e.prototype.resizeNearestNeighborBackprop=function(r,n,a){var i=new Yue(r,n,a);return this.compileAndRun(i,[r])},e.prototype.multinomial=function(r,n,a,i){var o=n?r:xi(r),s=o.shape[0],u=o.shape[1],l=new $ue(s,u,a),f=l.getCustomSetupFunc(i);return this.compileAndRun(l,[o],"int32",f)},e.prototype.oneHot=function(r,n,a,i){var o=new Uue(r.size,n,a,i);return this.compileAndRun(o,[r])},e.prototype.diag=function(r){var n=new sue(r.size);return this.compileAndRun(n,[r])},e.prototype.nonMaxSuppression=function(r,n,a,i,o){return vv("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),RS(r.dataSync(),n.dataSync(),a,i,o)},e.prototype.cropAndResize=function(r,n,a,i,o,s){var u=new rue(r.shape,n.shape,i,o,s);return this.compileAndRun(u,[r,n,a],"float32")},e.prototype.depthToSpace=function(r,n,a){U(n>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+n}));var i=r.shape[0],o=a==="NHWC"?r.shape[1]:r.shape[2],s=a==="NHWC"?r.shape[2]:r.shape[3],u=a==="NHWC"?r.shape[3]:r.shape[1],l=o*n,f=s*n,d=u/(n*n),p=new oue(a==="NHWC"?[i,l,f,d]:[i,d,l,f],n,a);return this.compileAndRun(p,[r])},e.prototype.split=function(r,n,a){return EL(r,n,a)},e.prototype.scatterND=function(r,n,a){var i=wv(0,r,a),o=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,f=i.outputSize,d=[f/u,u],p=r.reshape([s,o]),v=n.reshape([s,u]);if(f===0)return t2(Rr([]),a);var g=Ee(0),b=new cD(s,o,p.rank,v.rank,l,d);return this.compileAndRun(b,[v,p,g]).reshape(a)},e.prototype.sparseToDense=function(r,n,a,i){var o=wv(0,r,a),s=o.sliceRank,u=o.numUpdates,l=o.strides,f=o.outputSize,d=new cD(u,s,r.rank,n.rank,l,[f,1]);return this.compileAndRun(d,[n,r,i]).reshape(a)},e.prototype.fft=function(r){return this.fftImpl(r,!1)},e.prototype.ifft=function(r){return this.fftImpl(r,!0)},e.prototype.fftImpl=function(r,n){var a=this.texData.get(r.dataId),i=new uD(due,r.shape,n),o=new uD(hue,r.shape,n),s=[this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag)],u=this.compileAndRun(i,s),l=this.compileAndRun(o,s),f=this.complex(u,l).as2D(r.shape[0],r.shape[1]);return u.dispose(),l.dispose(),f},e.prototype.gatherND=function(r,n){var a=n.shape,i=a[a.length-1],o=pL(r,n),s=o[0],u=o[1],l=o[2],f=o[3],d=n.reshape([u,i]),p=r.reshape([r.size/l,l]),v=new mue(i,f,[u,l]);return this.compileAndRun(v,[p,d]).reshape(s)},e.prototype.fill=function(r,n,a){if((a=a||ad(n))==="string"){var i=fv(a,je(r));return i.fill(n),ee.makeTensor(i,r,a,this)}var o=new pue(r,n),s=o.getCustomSetupFunc(n);return this.compileAndRun(o,[],a,s)},e.prototype.onesLike=function(r){if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(r.shape,1,r.dtype)},e.prototype.zerosLike=function(r){return this.fill(r.shape,r.dtype==="string"?"":0,r.dtype)},e.prototype.linspace=function(r,n,a){return _L(r,n,a)},e.prototype.makeTensorInfo=function(r,n){var a=this.write(null,r,n);return this.texData.get(a).usage=null,{dataId:a,shape:r,dtype:n}},e.prototype.makeOutput=function(r,n){var a=this.makeTensorInfo(r,n).dataId;return ee.makeTensorFromDataId(a,r,n,this)},e.prototype.unpackTensor=function(r){var n=new xle(r.shape);return this.runWebGLProgram(n,[r],r.dtype)},e.prototype.packTensor=function(r){var n=new Wue(r.shape);return this.runWebGLProgram(n,[r],r.dtype,null,!0)},e.prototype.packedReshape=function(r,n){var a=[hv(r.shape)].concat(pv(r.shape)),i={dtype:r.dtype,shape:a,dataId:r.dataId},o=[hv(n)].concat(pv(n)),s=new Hue(o,a),u=this.runWebGLProgram(s,[i],r.dtype,null,!0);return{dataId:u.dataId,shape:n,dtype:u.dtype}},e.prototype.decode=function(r){var n,a=this.texData.get(r),i=a.isPacked,o=a.shape,s=a.dtype,u=zw(o);return n=i?new iue(u):new aue(u),{dtype:s,shape:o,dataId:this.runWebGLProgram(n,[{shape:u,dtype:s,dataId:r}],s,null,!0).dataId}},e.prototype.runWebGLProgram=function(r,n,a,i,o){var s=this;o===void 0&&(o=!1);var u=this.makeTensorInfo(r.outputShape,a),l=this.texData.get(u.dataId);if(r.packedOutput&&(l.isPacked=!0),r.outPackingScheme===Wf.DENSE){var f=Vc(r.outputShape);l.texShape=f.map((function(E){return 2*E}))}if(r.outTexUsage!=null&&(l.usage=r.outTexUsage),je(u.shape)===0)return l.values=$f(u.dtype,0),u;var d=[],p=n.map((function(E){if(E.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var C=s.texData.get(E.dataId);if(C.texture==null){if(!r.packedInputs&&je(E.shape)<=ce().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:E.shape,texData:null,isUniform:!0,uniformValues:C.values};r.packedInputs&&(C.isPacked=!0,C.shape=E.shape)}else if(!!C.isPacked!=!!r.packedInputs)E=C.isPacked?s.unpackTensor(E):s.packTensor(E),d.push(E),C=s.texData.get(E.dataId);else if(C.isPacked&&!Hh(C.shape,E.shape)){var k=E,A=E.shape;E.shape=C.shape,E=s.packedReshape(E,A),d.push(E),C=s.texData.get(E.dataId),k.shape=A}return s.uploadToGPU(E.dataId),{shape:E.shape,texData:C,isUniform:!1}}));this.uploadToGPU(u.dataId);var v,g={shape:u.shape,texData:l,isUniform:!1},b=(function(E,C,k){var A="";C.concat(k).forEach((function(R){var I=R.texData!=null&&R.texData.slice!=null&&R.texData.slice.flatOffset>0,D=R.isUniform?"uniform":R.texData.texShape;A+=R.shape+"_"+D+"_"+I}));var T=E.userCode,N=E.constructor.name;return N+="_"+A+"_"+T})(r,p,g),y=this.getAndSaveBinary(b,(function(){return(function(E,C,k,A){var T=C.userCode,N=k.map((function(z,B){var G={logicalShape:z.shape,texShape:z.isUniform?null:z.texData.texShape,isUniform:z.isUniform,isPacked:!z.isUniform&&z.texData.isPacked,flatOffset:null};return z.texData!=null&&z.texData.slice!=null&&z.texData.slice.flatOffset>0&&(G.flatOffset=z.texData.slice.flatOffset),{name:C.variableNames[B],shapeInfo:G}})),R=N.map((function(z){return z.shapeInfo})),I={logicalShape:A.shape,texShape:A.texData.texShape,isUniform:!1,isPacked:A.texData.isPacked,flatOffset:null},D=Rse(N,I,T,C.packedInputs),j=E.createProgram(D),$=null,W=E.getUniformLocation(j,"NAN",!1);ce().getNumber("WEBGL_VERSION")===1&&($=E.getUniformLocation(j,"INFINITY",!1));for(var q={},X=0;X<C.variableNames.length;X++){var Y=C.variableNames[X];q[Y]=E.getUniformLocation(j,Y,!1),q["offset"+Y]=E.getUniformLocation(j,"offset"+Y,!1)}return{program:C,source:D,webGLProgram:j,uniformLocations:q,inShapeInfos:R,outShapeInfo:I,infLoc:$,nanLoc:W}})(s.gpgpu,r,p,g)})),x=this.activeTimers!=null;if(x&&(v=this.startTimer()),(function(E,C,k,A,T){lD(C.inShapeInfos,k),lD([C.outShapeInfo],[A]);var N=A.texData.texture,R=A.texData.texShape;A.texData.isPacked?E.setOutputPackedMatrixTexture(N,R[0],R[1]):E.setOutputMatrixTexture(N,R[0],R[1]),E.setProgram(C.webGLProgram),ce().getNumber("WEBGL_VERSION")===1&&C.infLoc!==null&&E.gl.uniform1f(C.infLoc,1/0),C.nanLoc!==null&&E.gl.uniform1f(C.nanLoc,NaN),k.forEach((function(I,D){var j=C.program.variableNames[D],$=C.uniformLocations[j],W=C.uniformLocations["offset"+j];if($!=null)if(I.isUniform)if(je(I.shape)<2)E.gl.uniform1f($,I.uniformValues[0]);else{var q=I.uniformValues;q instanceof Float32Array||(q=new Float32Array(q)),E.gl.uniform1fv($,q)}else I.texData.slice!=null&&W!=null&&E.gl.uniform1i(W,I.texData.slice.flatOffset),E.setInputMatrixTexture(I.texData.texture,$,D)})),T?.(E,C.webGLProgram),E.executeProgram()})(this.gpgpu,y,p,g,i),d.forEach((function(E){return s.disposeData(E.dataId)})),x&&(v=this.endTimer(v),this.activeTimers.push({name:r.constructor.name,query:this.getQueryTime(v)})),!ce().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){var S=this.unpackTensor(u);return this.disposeData(u.dataId),S}return u},e.prototype.compileAndRun=function(r,n,a,i,o){o===void 0&&(o=!1),a=a||n[0].dtype;var s=this.runWebGLProgram(r,n,a,i,o);return ee.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},e.prototype.getAndSaveBinary=function(r,n){return r in this.binaryCache||(this.binaryCache[r]=n()),this.binaryCache[r]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var r=this;this.disposed||(ce().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(n){r.gpgpu.deleteProgram(r.binaryCache[n].webGLProgram),delete r.binaryCache[n]})),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var r=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ae((function(){if(!ce().get("WEBGL_RENDER_FLOAT32_ENABLED")){var n=ce().getBool("DEBUG");ce().set("DEBUG",!1);var a=r.abs(Ee(1e-8)).dataSync()[0];if(ce().set("DEBUG",n),a>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(r){var n,a=this.texData.get(r),i=a.shape,o=a.dtype,s=a.values,u=a.texture,l=a.usage,f=a.isPacked;if(u==null){var d,p=this.activeTimers!=null;p&&(d=Ca());var v=a.texShape;if(v==null&&(v=Ooe(i,f),a.texShape=v),s!=null){var g=zw(i),b=void 0,y=v[1],x=v[0],S=s instanceof Uint8Array;f?(y=(n=od(v[0],v[1]))[0],x=n[1],b=new fue(g,[x,y],S)):b=new cue(g,[x,y],S);var E=this.makeTensorInfo([x,y],o);this.texData.get(E.dataId).usage=S?kn.PIXELS:kn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(E.dataId),y,x,s);var C=this.runWebGLProgram(b,[E],o,null,!0),k=this.texData.get(C.dataId);a.texture=k.texture,a.texShape=k.texShape,a.isPacked=k.isPacked,a.usage=k.usage,this.disposeData(E.dataId),this.texData.delete(C.dataId),a.values=null,p&&(this.uploadWaitMs+=Ca()-d)}else{var A=this.acquireTexture(v,l,o,f);a.texture=A}}},e.prototype.convertAndCacheOnCPU=function(r,n){var a=this.texData.get(r),i=a.dtype;return this.releaseGPUData(r),n!=null&&(a.values=(function(o,s){if(s==="float32"||s==="complex64")return o;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(o.length):new Uint8Array(o.length),l=0;l<u.length;++l)u[l]=Math.round(o[l]);return u}throw new Error("Unknown dtype "+s)})(n,i)),a.values},e.prototype.acquireTexture=function(r,n,a,i){if(this.numBytesInGPU+=this.computeBytes(r,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(r,n,i)},e.prototype.computeBytes=function(r,n){return r[0]*r[1]*YF(n)},e})(bL);nL()&&ee.registerBackend("webgl",(function(){return new _le}),2);var Sle=J({square_:function(t){var e=F(t,"x","square"),r=[e];return ee.runKernelFunc((function(n,a){return a([e]),n.square(e)}),{x:e},null,"Square",{},r,[])}}),qf="SquaredDifference",LL=J({squaredDifference_:function(t,e){var r,n=F(t,"a","squaredDifference"),a=F(e,"b","squaredDifference");r=$t(n,a),n=r[0],a=r[1],ot(n.shape,a.shape);var i={a:n,b:a},o=[n,a];return ee.runKernelFunc((function(s,u){var l=s.squaredDifference(n,a);return u([n,a]),l}),i,(function(s,u){var l=u[0],f=u[1],d=Ee(2);return{a:function(){return s.mul(l.sub(f).mul(d))},b:function(){return s.mul(f.sub(l).mul(d))}}}),qf,{},o,[])}}),Ele=J({abs_:function(t){var e=F(t,"x","abs");return e.dtype==="complex64"?ee.runKernelFunc((function(r){return r.complexAbs(e)}),{$x:e}):ee.runKernelFunc((function(r,n){var a=r.abs(e);return n([e]),a}),{x:e},(function(r,n){var a=n[0];return{x:function(){return r.mul(a.toFloat().step(-1))}}}),"Abs")}}),Cle=J({acos_:function(t){var e=F(t,"x","acos");return ee.runKernelFunc((function(r,n){var a=r.acos(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.divStrict(Ee(1).sub(a.toFloat().square()).sqrt()).neg()}}}))}}),kle=J({acosh_:function(t){var e=F(t,"x","acosh");return ee.runKernelFunc((function(r,n){var a=r.acosh(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.divStrict(a.toFloat().square().sub(1).sqrt())}}}))}}),Ale=J({asin_:function(t){var e=F(t,"x","asin");return ee.runKernelFunc((function(r,n){var a=r.asin(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.divStrict(Ee(1).sub(a.toFloat().square()).sqrt())}}}))}}),Ole=J({asinh_:function(t){var e=F(t,"x","asinh");return ee.runKernelFunc((function(r,n){var a=r.asinh(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.divStrict(Ee(1).add(a.toFloat().square()).sqrt())}}}))}}),Tle=J({atan_:function(t){var e=F(t,"x","atan");return ee.runKernelFunc((function(r,n){var a=r.atan(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.div(a.toFloat().square().add(1))}}}))}}),Ple=J({atanh_:function(t){var e=F(t,"x","atanh");return ee.runKernelFunc((function(r,n){var a=r.atanh(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.div(Ee(1).sub(a.toFloat().square()))}}}))}}),Nle=J({ceil_:function(t){var e=F(t,"x","ceil");return ee.runKernelFunc((function(r){return r.ceil(e)}),{$x:e},(function(r){return{$x:function(){return ut(r)}}}))}}),LS=J({clipByValue_:function(t,e,r){var n=F(t,"x","clipByValue");U(e<=r,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+r+")."}));var a=[n],i={min:e,max:r};return ee.runKernelFunc((function(o,s){var u=o.clip(n,e,r);return s([n]),u}),{x:n},(function(o,s){var u=s[0];return{x:function(){return o.where(u.greaterEqual(e).logicalAnd(u.lessEqual(r)),ut(o))}}}),"ClipByValue",i,a)}}),Rle=J({cos_:function(t){var e=F(t,"x","cos"),r=[e];return ee.runKernelFunc((function(n,a){var i=n.cos(e);return a([e]),i}),{x:e},(function(n,a){var i=a[0];return{x:function(){return i.toFloat().sin().neg().mul(n)}}}),"Cos",{},r)}}),Ile=J({cosh_:function(t){var e=F(t,"x","cosh");return ee.runKernelFunc((function(r,n){var a=r.cosh(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return a.toFloat().sinh().mulStrict(r)}}}))}}),jle=J({erf_:function(t){var e=F(t,"x","erf");return U(e.dtype==="int32"||e.dtype==="float32",(function(){return"Input dtype must be `int32` or `float32`."})),e.dtype==="int32"&&(e=e.toFloat()),ee.runKernelFunc((function(r,n){var a=r.erf(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),n2=J({exp_:function(t){var e=F(t,"x","exp");return ee.runKernelFunc((function(r,n){var a=r.exp(e);return n([a]),a}),{x:e},(function(r,n){return{x:function(){return r.mulStrict(n[0])}}}),"Exp",{},[],[!0])}}),Dle=J({expm1_:function(t){var e=F(t,"x","expm1");return ee.runKernelFunc((function(r,n){var a=r.expm1(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.mul(a.exp())}}}))}}),Mle=J({floor_:function(t){var e=F(t,"x","floor");return ee.runKernelFunc((function(r){return r.floor(e)}),{$x:e},(function(r){return{$x:function(){return ut(r)}}}))}}),Fle=J({log_:function(t){var e=F(t,"x","log"),r=[e];return ee.runKernelFunc((function(n,a){var i=n.log(e);return a([e]),i}),{x:e},(function(n,a){var i=a[0];return{x:function(){return n.div(i.toFloat())}}}),"Log",{},r)}}),Lle=J({log1p_:function(t){var e=F(t,"x","log1p");return ee.runKernelFunc((function(r,n){var a=r.log1p(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.div(a.add(1))}}}))}}),Ble=J({logSigmoid_:function(t){var e=F(t,"x","logSigmoid");return ee.runKernelFunc((function(r,n){var a=r.softplus(e.neg()).neg();return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.mul(a.neg().sigmoid())}}}))}}),Cv=J({neg_:function(t){var e=F(t,"x","neg"),r=[e];return ee.runKernelFunc((function(n){return n.neg(e)}),{x:e},(function(n){return{x:function(){return n.neg()}}}),"Neg",{},r)}}),$le=J({reciprocal_:function(t){var e=F(t,"x","reciprocal");return ee.runKernelFunc((function(r,n){var a=r.reciprocal(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.div(a.square().neg())}}}))}}),Ule=J({round_:function(t){var e=F(t,"x","round");return ee.runKernelFunc((function(r){return r.round(e)}),{$x:e},(function(r){return{$x:function(){return ut(r)}}}))}}),BL=J({rsqrt_:function(t){var e=F(t,"x","rsqrt"),r=[e];return ee.runKernelFunc((function(n,a){var i=n.rsqrt(e);return a([e]),i}),{x:e},(function(n,a){var i=a[0];return{x:function(){return n.div(i.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},r)}}),$L=J({sigmoid_:function(t){var e=F(t,"x","sigmoid");return ee.runKernelFunc((function(r,n){var a=r.sigmoid(e);return n([a]),a}),{x:e},(function(r,n){var a=n[0];return{x:function(){return r.mul(a.mul(Ee(1).sub(a)))}}}),"Sigmoid")}}),Wle=J({sign_:function(t){var e=F(t,"x","sign");return ee.runKernelFunc((function(r){return r.sign(e)}),{$x:e},(function(r){return{$x:function(){return ut(r)}}}))}}),zle=J({isNaN_:function(t){var e=F(t,"x","isNaN");return ee.runKernelFunc((function(r){return r.isNaN(e)}),{$x:e},(function(r){return{$x:function(){return ut(r)}}}))}}),qle=J({isInf_:function(t){var e=F(t,"x","isInf");return ee.runKernelFunc((function(r){return r.isInf(e)}),{$x:e},(function(r){return{$x:function(){return ut(r)}}}))}}),Vle=J({isFinite_:function(t){var e=F(t,"x","isFinite");return ee.runKernelFunc((function(r){return r.isFinite(e)}),{$x:e},(function(r){return{$x:function(){return ut(r)}}}))}}),Hle=J({sin_:function(t){var e=F(t,"x","sin"),r=[e];return ee.runKernelFunc((function(n,a){var i=n.sin(e);return a([e]),i}),{x:e},(function(n,a){var i=a[0];return{x:function(){return i.toFloat().cos().mul(n)}}}),"Sin",{},r)}}),Gle=J({sinh_:function(t){var e=F(t,"x","sinh");return ee.runKernelFunc((function(r,n){var a=r.sinh(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return a.toFloat().cosh().mulStrict(r)}}}))}}),Kle=J({softplus_:function(t){var e=F(t,"x","softplus");return ee.runKernelFunc((function(r,n){var a=r.softplus(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.mul(a.sigmoid())}}}))}}),Xle=J({sqrt_:function(t){var e=F(t,"x","sqrt");return ee.runKernelFunc((function(r,n){var a=r.sqrt(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.div(a.toFloat().sqrt().mul(2))}}}))}}),Yle=J({step_:function(t,e){e===void 0&&(e=0);var r=F(t,"x","step");return ee.runKernelFunc((function(n){return n.step(r,e)}),{$x:r},(function(n){return{$x:function(){return ut(n)}}}))}}),Jle=J({tan_:function(t){var e=F(t,"x","tan");return ee.runKernelFunc((function(r,n){var a=r.tan(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return r.div(a.cos().square())}}}))}}),Qle=J({tanh_:function(t){var e=F(t,"x","tanh");return ee.runKernelFunc((function(r,n){var a=r.tanh(e);return n([a]),a}),{x:e},(function(r,n){var a=n[0];return{x:function(){return Ee(1).sub(a.square()).mulStrict(r)}}}),"Tanh",{},null,[!0])}});function UL(t,e,r,n,a,i){var o,s,u=F(t,"x","batchNorm"),l=F(e,"mean","batchNorm"),f=F(r,"variance","batchNorm");return a!=null&&(o=F(a,"scale","batchNorm")),n!=null&&(s=F(n,"offset","batchNorm")),U(u.rank===2,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),U(l.rank===2||l.rank===1,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."})),U(f.rank===2||f.rank===1,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+f.rank+"."})),o!=null&&U(o.rank===2||o.rank===1,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."})),s!=null&&U(s.rank===2||s.rank===1,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),ud(u,l,f,s,o,i)}function WL(t,e,r,n,a,i){var o,s,u=F(t,"x","batchNorm"),l=F(e,"mean","batchNorm"),f=F(r,"variance","batchNorm");return a!=null&&(o=F(a,"scale","batchNorm")),n!=null&&(s=F(n,"offset","batchNorm")),U(u.rank===3,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),U(l.rank===3||l.rank===1,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."})),U(f.rank===3||f.rank===1,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+f.rank+"."})),o!=null&&U(o.rank===3||o.rank===1,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."})),s!=null&&U(s.rank===3||s.rank===1,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),ud(u,l,f,s,o,i)}function zL(t,e,r,n,a,i){var o,s,u=F(t,"x","batchNorm"),l=F(e,"mean","batchNorm"),f=F(r,"variance","batchNorm");return a!=null&&(o=F(a,"scale","batchNorm")),n!=null&&(s=F(n,"offset","batchNorm")),U(u.rank===4,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),U(l.rank===4||l.rank===1,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."})),U(f.rank===4||f.rank===1,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+f.rank+"."})),o!=null&&U(o.rank===4||o.rank===1,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."})),s!=null&&U(s.rank===4||s.rank===1,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),ud(u,l,f,s,o,i)}function ud(t,e,r,n,a,i){i==null&&(i=.001);var o,s,u,l=F(t,"x","batchNorm"),f=F(e,"mean","batchNorm"),d=F(r,"variance","batchNorm");a!=null&&(o=F(a,"scale","batchNorm")),n!=null&&(s=F(n,"offset","batchNorm")),U(f.rank===d.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),U(s==null||f.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),U(o==null||f.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var p=[l,f,d,o];return ee.runKernelFunc((function(v,g){var b=v.batchNormalization(u,Jh(f),Jh(d),i,Jh(o),Jh(s));return g([l,f,d,o]),b}),{x:l,mean:f,variance:d,scale:o,offset:s},(function(v,g){var b=g,y=b[0],x=b[1],S=b[2],E=b[3],C=E??Ee(1),k=dr(x.shape,u.shape),A=[];if(x.rank===1){for(var T=0;T<u.shape.length-1;++T)A.push(u.shape[T]);A.push(1)}var N=y.sub(x),R=v.mul(C),I=BL(S.add(Ee(i))),D=I.mul(I).mul(I).mul(Ee(-.5));return{x:function(){return x.rank===1?v.mul(Nu(I.as4D(1,1,1,x.shape[0]),A)).mul(C).reshape(y.shape):v.mul(I).mul(C).reshape(y.shape)},mean:function(){var j=I.mul(Ee(-1)).mul(R);return x.rank===1&&(j=j.sum(k)),j.reshape(x.shape)},variance:function(){var j=D.mul(N).mul(R);return x.rank===1&&(j=j.sum(k)),j.reshape(x.shape)},scale:function(){var j=N.mul(I),$=v.mul(j);return x.rank===1&&($=$.sum(k)),$.reshape(x.shape)},offset:function(){var j=v;return x.rank===1&&(j=j.sum(k)),j.reshape(x.shape)}}}),"BatchNormalization",{varianceEpsilon:i},p).reshape(l.shape)}function Jh(t){return t==null?null:t.rank===0?t.as1D():t.rank===1?t:t.rank===2?t.as4D(1,1,t.shape[0],t.shape[1]):t.rank===3?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function xm(){aL("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Zle=J({batchNormalization2d_:function(t,e,r,n,a,i){return n===void 0&&(n=.001),xm(),UL(t,e,r,i,a,n)}}),ece=J({batchNormalization3d_:function(t,e,r,n,a,i){return n===void 0&&(n=.001),xm(),WL(t,e,r,i,a,n)}}),tce=J({batchNormalization4d_:function(t,e,r,n,a,i){return n===void 0&&(n=.001),xm(),zL(t,e,r,i,a,n)}}),rce=J({batchNormalization_:function(t,e,r,n,a,i){return n===void 0&&(n=.001),xm(),ud(t,e,r,i,a,n)}}),qL=J({batchNorm_:ud}),nce=J({batchNorm2d_:UL}),ace=J({batchNorm3d_:WL}),ice=J({batchNorm4d_:zL}),wm=J({logicalAnd_:function(t,e){var r=F(t,"a","logicalAnd","bool"),n=F(e,"b","logicalAnd","bool");return ot(r.shape,n.shape),ee.runKernelFunc((function(a){return a.logicalAnd(r,n)}),{a:r,b:n},null,"LogicalAnd")}}),oce=J({logicalNot_:function(t){var e=F(t,"x","logicalNot","bool");return ee.runKernelFunc((function(r){return r.logicalNot(e)}),{$x:e})}}),VL=J({logicalOr_:function(t,e){var r=F(t,"a","logicalOr","bool"),n=F(e,"b","logicalOr","bool");return ot(r.shape,n.shape),ee.runKernelFunc((function(a){return a.logicalOr(r,n)}),{$a:r,$b:n})}}),sce=J({logicalXor_:function(t,e){var r=F(t,"a","logicalXor","bool"),n=F(e,"b","logicalXor","bool");return ot(r.shape,n.shape),VL(t,e).logicalAnd(wm(t,e).logicalNot())}}),ds=J({where_:function(t,e,r){var n=F(e,"a","where"),a=F(r,"b","where"),i=F(t,"condition","where","bool");return vt(n.shape,a.shape,"Error in where: "),i.rank===1?U(i.shape[0]===n.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):vt(i.shape,a.shape,"Error in where: "),ee.runKernelFunc((function(o,s){var u=o.select(i,n,a);return s([i]),u}),{$condition:i,$a:n,$b:a},(function(o,s){var u=s[0];return{$condition:function(){return ut(u).toFloat()},$a:function(){return o.mul(u.cast(o.dtype))},$b:function(){return o.mul(u.logicalNot().cast(o.dtype))}}}))}}),HL=function(t){return Ne(this,void 0,void 0,(function(){var e,r,n;return Re(this,(function(a){switch(a.label){case 0:return[4,(e=F(t,"condition","whereAsync","bool")).data()];case 1:return r=a.sent(),n=jS(e.shape,r),t!==e&&e.dispose(),[2,n]}}))}))},it=J({add_:function(t,e){var r,n=F(t,"a","add"),a=F(e,"b","add");r=$t(n,a),n=r[0],a=r[1];var i=ot(n.shape,a.shape);return ee.runKernelFunc((function(o){return o.add(n,a)}),{a:n,b:a},(function(o){return{a:function(){var s=o,u=dr(n.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(n.shape)},b:function(){var s=o,u=dr(a.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(a.shape)}}}),"Add")}}),uce=J({addN_:function(t){U(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),U(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(a,i){return F(a,"tensors"+i,"addN")})),r=e[0];e.forEach((function(a){if(a.dtype!==r.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(a){if(!wr(a.shape,r.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var n=e;return ee.runKernelFunc((function(a){return a.addN(e)}),n,(function(a){var i={};return e.forEach((function(o,s){i[s]=function(){return a.clone()}})),i}),"AddN")}}),lce=J({addStrict_:function(t,e){var r=F(t,"a","addStrict"),n=F(e,"b","addStrict");return vt(r.shape,n.shape,"Error in addStrict: "),r.add(n)}}),cce=J({atan2_:function(t,e){var r,n=F(t,"a","atan2"),a=F(e,"b","atan2");r=$t(n,a),n=r[0],a=r[1];var i=ot(n.shape,a.shape);return ee.runKernelFunc((function(o,s){var u=o.atan2(n,a);return s([n,a]),u}),{$a:n,$b:a},(function(o,s){var u=s[0],l=s[1];return{$a:function(){var f=it(u.square(),l.square()),d=o.mul(l.div(f)),p=dr(u.shape,i);return p.length>0&&(d=d.sum(p)),d.reshape(u.shape)},$b:function(){var f=it(u.square(),l.square()),d=Cv(o.mul(u.div(f))),p=dr(l.shape,i);return p.length>0&&(d=d.sum(p)),d.reshape(l.shape)}}}))}}),ua=J({div_:function(t,e){var r,n=F(t,"a","div"),a=F(e,"b","div");if(r=$t(n,a),n=r[0],a=r[1],n.dtype==="int32"&&a.dtype==="int32")return GL(n,a);var i=ot(n.shape,a.shape);return ee.runKernelFunc((function(o,s){var u=o.realDivide(n,a);return s([n,a]),u}),{a:n,b:a},(function(o,s){var u=s[0],l=s[1];return{a:function(){var f=o.div(l.toFloat()),d=dr(u.shape,i);return d.length>0?f.sum(d).reshape(u.shape):f},b:function(){var f=o.mul(u.toFloat()),d=dr(l.shape,i);d.length>0&&(f=f.sum(d).reshape(l.shape));var p=l.square();return f.div(p.toFloat()).neg()}}}),"Div")}}),fce=J({divNoNan_:function(t,e){var r,n=F(t,"a","div"),a=F(e,"b","div");n=(r=$t(n,a))[0],a=r[1];var i=ua(n,a),o=ut(i),s=a.equal(o);return ds(s,o,i)}}),dce=J({divStrict_:function(t,e){var r=F(t,"a","div"),n=F(e,"b","div");return vt(r.shape,n.shape,"Error in divideStrict: "),r.div(n)}}),GL=J({floorDiv_:function(t,e){var r,n=F(t,"a","floorDiv"),a=F(e,"b","floorDiv");r=$t(n,a),n=r[0],a=r[1];var i=ot(n.shape,a.shape);return ee.runKernelFunc((function(o,s){var u=o.floorDiv(n,a);return s([n,a]),u}),{a:n,b:a},(function(o,s){var u=s[0],l=s[1];return{a:function(){var f=o.div(l.toFloat()),d=dr(u.shape,i);return d.length>0?f.sum(d).reshape(u.shape):f},b:function(){var f=o.mul(u.toFloat()),d=dr(l.shape,i);d.length>0&&(f=f.sum(d).reshape(l.shape));var p=l.square();return f.div(p.toFloat()).neg()}}}),"FloorDiv")}}),BS=J({maximum_:function(t,e){var r,n=F(t,"a","maximum"),a=F(e,"b","maximum");return r=$t(n,a),n=r[0],a=r[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),ot(n.shape,a.shape),ee.runKernelFunc((function(i,o){var s=i.maximum(n,a);return o([n,a]),s}),{a:n,b:a},(function(i,o){var s=o[0],u=o[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}}),"Maximum")}}),hce=J({maximumStrict_:function(t,e){var r=F(t,"a","maximumStrict"),n=F(e,"b","maximumStrict");return vt(r.shape,n.shape,"Error in maximumStrict: "),r.maximum(n)}}),KL=J({minimum_:function(t,e){var r,n=F(t,"a","minimum"),a=F(e,"b","minimum");return r=$t(n,a),n=r[0],a=r[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),ot(n.shape,a.shape),ee.runKernelFunc((function(i,o){var s=i.minimum(n,a);return o([n,a]),s}),{a:n,b:a},(function(i,o){var s=o[0],u=o[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}}),"Minimum")}}),pce=J({minimumStrict_:function(t,e){var r=F(t,"a","minimumStrict"),n=F(e,"b","minimumStrict");return vt(r.shape,n.shape,"Error in minimumStrict: "),r.minimum(n)}}),vce=J({mod_:function(t,e){var r,n=F(t,"a","mod"),a=F(e,"b","mod");r=$t(n,a),n=r[0],a=r[1];var i=ot(n.shape,a.shape);return ee.runKernelFunc((function(o,s){var u=o.mod(n,a);return s([n,a]),u}),{$a:n,$b:a},(function(o,s){var u=s[0],l=s[1];return{$a:function(){var f=dr(u.shape,i);return f.length>0?o.sum(f).reshape(u.shape):o},$b:function(){var f=o.mul(u.div(l).floor().neg()),d=dr(l.shape,i);return d.length>0?f.sum(d).reshape(l.shape):f}}}))}}),mce=J({modStrict_:function(t,e){var r=F(t,"a","modStrict"),n=F(e,"b","modStrict");return vt(r.shape,n.shape,"Error in modStrict: "),r.mod(n)}}),Kr=J({mul_:function(t,e){var r,n=F(t,"a","mul"),a=F(e,"b","mul");r=$t(n,a),n=r[0],a=r[1];var i=ot(n.shape,a.shape);return ee.runKernelFunc((function(o,s){var u=o.multiply(n,a);return s([n,a]),u}),{a:n,b:a},(function(o,s){var u=s[0],l=s[1];return{a:function(){var f=o.mul(l.toFloat()),d=dr(u.shape,i);return d.length>0?f.sum(d).reshape(u.shape):f},b:function(){var f=o.mul(u.toFloat()),d=dr(l.shape,i);return d.length>0?f.sum(d).reshape(l.shape):f}}}),"Mul")}}),gce=J({mulStrict_:function(t,e){var r=F(t,"a","mul"),n=F(e,"b","mul");return vt(r.shape,n.shape,"Error in multiplyStrict: "),r.mul(n)}}),kv=J({pow_:function(t,e){var r,n=F(t,"base","pow"),a=F(e,"exp","pow");r=$t(n,a),n=r[0],a=r[1];var i=ot(n.shape,a.shape),o=[n,a];return ee.runKernelFunc((function(s,u){var l=s.pow(n,a);return u([n,a,l]),l}),{a:n,b:a},(function(s,u){var l=u[0],f=u[1],d=u[2];return{a:function(){var p=f.toFloat(),v=s.mul(p.mul(l.pow(p.sub(Ee(1))))),g=dr(l.shape,i);return g.length>0&&(v=v.sum(g)),v.reshape(l.shape)},b:function(){var p=l.greater(0),v=l.log().where(p,ut(l)),g=s.mul(d.mul(v)),b=dr(f.shape,i);return b.length>0&&(g=g.sum(b)),g.reshape(f.shape)}}}),"Pow",{},o,[!0])}}),yce=J({powStrict_:function(t,e){return vt(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),bce=J({squaredDifferenceStrict_:function(t,e){var r=F(t,"a","squaredDifferenceStrict"),n=F(e,"b","squaredDifferenceStrict");return vt(r.shape,n.shape,"Error in squaredDifferenceStrict: "),r.squaredDifference(n)}}),hr=J({sub_:function(t,e){var r,n=F(t,"a","sub"),a=F(e,"b","sub");r=$t(n,a),n=r[0],a=r[1];var i=ot(n.shape,a.shape);return ee.runKernelFunc((function(o){return o.subtract(n,a)}),{a:n,b:a},(function(o){return{a:function(){var s=o,u=dr(n.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(n.shape)},b:function(){var s=o,u=dr(a.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(a.shape)}}}),"Sub")}}),xce=J({subStrict_:function(t,e){var r=F(t,"a","subStrict"),n=F(e,"b","subStrict");return vt(r.shape,n.shape,"Error in subStrict: "),r.sub(n)}}),XL=J({equal_:function(t,e){var r,n=F(t,"a","equal"),a=F(e,"b","equal");return r=$t(n,a),n=r[0],a=r[1],ot(n.shape,a.shape),ee.runKernelFunc((function(i){return i.equal(n,a)}),{$a:n,$b:a})}}),wce=J({equalStrict_:function(t,e){var r=F(t,"a","equalStrict"),n=F(e,"b","equalStrict");return vt(r.shape,n.shape,"Error in equalStrict: "),r.equal(n)}}),_ce=J({greater_:function(t,e){var r,n=F(t,"a","greater"),a=F(e,"b","greater");return r=$t(n,a),n=r[0],a=r[1],ot(n.shape,a.shape),ee.runKernelFunc((function(i){return i.greater(n,a)}),{a:n,b:a},null,"Greater")}}),YL=J({greaterEqual_:function(t,e){var r,n=F(t,"a","greaterEqual"),a=F(e,"b","greaterEqual");return r=$t(n,a),n=r[0],a=r[1],ot(n.shape,a.shape),ee.runKernelFunc((function(i,o){var s=i.greaterEqual(n,a);return o([n,a]),s}),{a:n,b:a},(function(i,o){var s=o[0],u=o[1];return{a:function(){return ut(s)},b:function(){return ut(u)}}}),"GreaterEqual")}}),Sce=J({greaterEqualStrict_:function(t,e){var r=F(t,"a","greaterEqualStrict"),n=F(e,"b","greaterEqualStrict");return vt(r.shape,n.shape,"Error in greaterEqualStrict: "),r.greaterEqual(n)}}),Ece=J({greaterStrict_:function(t,e){var r=F(t,"a","greaterStrict"),n=F(e,"b","greaterStrict");return vt(r.shape,n.shape,"Error in greaterStrict: "),r.greater(n)}}),Cce=J({less_:function(t,e){var r,n=F(t,"a","less"),a=F(e,"b","less");return r=$t(n,a),n=r[0],a=r[1],ot(n.shape,a.shape),ee.runKernelFunc((function(i){return i.less(n,a)}),{a:n,b:a},null,"Less")}}),kce=J({lessEqual_:function(t,e){var r,n=F(t,"a","lessEqual"),a=F(e,"b","lessEqual");return r=$t(n,a),n=r[0],a=r[1],ot(n.shape,a.shape),ee.runKernelFunc((function(i,o){var s=i.lessEqual(n,a);return o([n,a]),s}),{a:n,b:a},null,"LessEqual")}}),Ace=J({lessEqualStrict_:function(t,e){var r=F(t,"a","lessEqualStrict"),n=F(e,"b","lessEqualStrict");return vt(r.shape,n.shape,"Error in lessEqualStrict: "),r.lessEqual(n)}}),Oce=J({lessStrict_:function(t,e){var r=F(t,"a","lessStrict"),n=F(e,"b","lessStrict");return vt(r.shape,n.shape,"Error in lessStrict: "),r.less(n)}}),Tce=J({notEqual_:function(t,e){var r,n=F(t,"a","notEqual"),a=F(e,"b","notEqual");return r=$t(n,a),n=r[0],a=r[1],ot(n.shape,a.shape),ee.runKernelFunc((function(i){return i.notEqual(n,a)}),{a:n,b:a},null,"NotEqual")}}),Pce=J({notEqualStrict_:function(t,e){var r=F(t,"a","notEqualStrict"),n=F(e,"b","notEqualStrict");return vt(r.shape,n.shape,"Error in notEqualStrict: "),r.notEqual(n)}});function bD(t,e){for(var r=[],n=t;n<e;++n)r.push(n);return r}function xD(t){for(var e=[],r=0;r<t.length;++r)for(var n=0;n<t[r].length;++n)e.push(t[r][n]);return e}var $S=J({gather_:function(t,e,r){r===void 0&&(r=0);var n=F(t,"x","gather"),a=F(e,"indices","gather","int32");r=vr(r,n.shape)[0];var i=(function(o,s,u){for(var l=o.shape[u],f=[],d=1,p=1,v=0;v<u;v++)f.push(o.shape[v]),d*=o.shape[v];for(v=0;v<s.rank;v++)f.push(s.shape[v]);for(v=u+1;v<o.rank;v++)f.push(o.shape[v]),p*=o.shape[v];return{batchSize:d,sliceSize:p,dimSize:l,outputShape:f}})(n,a,r);return ee.runKernelFunc((function(o,s){var u=o.gather(n,a.flatten(),r);return s([a]),u}),{x:n,indices:a},(function(o,s){var u=s[0];return{x:function(){var l=n.shape,f=u.size,d=l.slice(0,r),p=d.length,v=l.slice(r,l.length).slice(1),g=v.length,b=bD(0,p),y=bD(p+1,p+1+g),x=xD([d,[f],v]),S=o.reshape(x),E=u.reshape([f]),C=xD([[p],b,y]),k=S.transpose(C),A=JL(k,E,n.shape[r]),T=kS(C);return A=A.transpose(T)},indices:function(){return u}}}),"Gather",{axis:r}).reshape(i.outputShape)}}),JL=J({unsortedSegmentSum_:function(t,e,r){var n=F(t,"x","unsortedSegmentSum"),a=F(e,"segmentIds","unsortedSegmentSum","int32");return U(Xt(r),(function(){return"numSegments must be of dtype int"})),ee.runKernelFunc((function(i,o){var s=i.unsortedSegmentSum(n,a,r);return o([a]),s}),{$x:n},(function(i,o){var s=o[0];return{$x:function(){return(function(u,l){for(var f=BS(l,ut(l)),d=$S(u,f),p=YL(l,Ee(0,"int32")),v=d.rank-p.rank,g=0;g<v;++g)p=$n(p,g+1);p=wm(p,Nl(d.shape,"bool"));var b=ut(d);return ds(p,d,b)})(i,s)}}}))}}),Nce=function(t,e,r){return Ne(this,void 0,void 0,(function(){var n,a,i,o,s,u,l,f,d,p,v,g,b;return Re(this,(function(y){switch(y.label){case 0:for(n=F(t,"tensor","boolMask"),a=F(e,"mask","boolMask","bool"),i=r??0,o=a.rank,s=n.shape,U(o>0,(function(){return"mask cannot be scalar"})),vt(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+o;l++)u*=s[l];return f=s.slice(0,i).concat([u],s.slice(i+o)),d=n.reshape(f),p=a.reshape([-1]),[4,HL(p)];case 1:return v=y.sent(),g=v.squeeze([1]),b=$S(d,g,i),t!==n&&n.dispose(),e!==a&&a.dispose(),g.dispose(),d.dispose(),p.dispose(),v.dispose(),[2,b]}}))}))};function QL(t,e,r,n,a,i,o){i===void 0&&(i="NHWC"),U(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,u=e,l=!1;e.rank===3&&(l=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),U(s.length===4,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),U(u.rank===4,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),U(r.rank===4,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+r.rank}));var f=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?u.shape[3]:u.shape[1];U(f===r.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+f+") must match input depth for filter "+r.shape[2]+"."})),U(d===r.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+r.shape[3]+"."})),o!=null&&U(Xt(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var p=NS(i),v=_s(s,r.shape,n,1,a,o,!1,p),g=ee.runKernelFunc((function(b,y){var x=b.conv2dDerInput(u,r,v);return y([r,u]),x}),{dy4D:u,filter:r},(function(b,y){var x=y[0],S=y[1];return{dy4D:function(){return Kn(b,x,n,a,i,1,o)},filter:function(){return US(b,S,x.shape,n,a,i,o)}}}));return l?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}function Jw(t){var e=(function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i})(t),r=e[0],n=e[1],a=e[2];return r===1&&n===1&&a===1}function ZL(t,e,r,n,a){U(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var i=t,o=e,s=!1;e.rank===4&&(s=!0,o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),i=[1,t[0],t[1],t[2],t[3]]);var u=i[4],l=o.shape[4];U(i.length===5,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),U(o.rank===5,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank})),U(r.rank===5,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+r.rank})),U(u===r.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+r.shape[3]+"."})),U(l===r.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+r.shape[4]+"."}));var f=Sv(i,r.shape,n,1,a),d=ee.runKernelFunc((function(p){return p.conv3dDerInput(o,r,f)}),{dy5D:o});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var Rce=J({conv1d_:function(t,e,r,n,a,i,o){a===void 0&&(a="NWC"),i===void 0&&(i=1);var s=F(t,"x","conv1d"),u=F(e,"filter","conv1d"),l=s,f=!1;s.rank===2&&(f=!0,l=s.as3D(1,s.shape[0],s.shape[1])),U(l.rank===3,(function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."})),U(u.rank===3,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),o!=null&&U(Xt(n),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+n+"."})),U(l.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),U(hn(r,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+r+" and dilation '"+i+"'"})),U(a==="NWC",(function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."}));var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),v=Kn(p,d,[1,r],n,"NHWC",[1,i],o);return f?v.as2D(v.shape[2],v.shape[3]):v.as3D(v.shape[0],v.shape[2],v.shape[3])}}),Kn=J({conv2d_:function(t,e,r,n,a,i,o){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var s=F(t,"x","conv2d"),u=F(e,"filter","conv2d"),l=s,f=!1;s.rank===3&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,(function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."})),U(u.rank===4,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),o!=null&&U(Xt(n),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+n+"."}));var d=a==="NHWC"?l.shape[3]:l.shape[1];U(d===u.shape[2],(function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."})),U(hn(r,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var p=NS(a),v=_s(l.shape,u.shape,r,i,n,o,!1,p),g=[u,l],b=ee.runKernelFunc((function(y,x){var S=y.conv2d(l,u,v);return x([u,l]),S}),{x:l,filter:u},(function(y,x){var S=x,E=S[0],C=S[1];return U(vl(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return eB(C.shape,y,E,r,n,a)},filter:function(){return US(C,y,E.shape,r,n,a)}}}),"Conv2D",v,g);return f?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),Ice=J({conv3d_:function(t,e,r,n,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var o=F(t,"x","conv3d"),s=F(e,"filter","conv3d"),u=o,l=!1;o.rank===4&&(l=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),U(u.rank===5,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),U(s.rank===5,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),U(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),U((function(p,v){return Jw(p)||Jw(v)})(r,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),U(a==="NDHWC",(function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."}));var f=Sv(u.shape,s.shape,r,i,n),d=ee.runKernelFunc((function(p,v){var g=p.conv3d(u,s,f);return v([u,s]),g}),{x:u,$filter:s},(function(p,v){U(Jw(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var g=v[0],b=v[1];return{x:function(){return ZL(g.shape,p,b,r,n)},$filter:function(){return(function(y,x,S,E,C){var k=y;y.rank===4&&(k=y.as5D(1,y.shape[0],y.shape[1],y.shape[2],y.shape[3]));var A=x;A.rank===4&&(A=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3])),U(k.rank===5,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+k.shape+"."})),U(A.rank===5,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+A.shape+"."})),U(S.length===5,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+S+"."})),U(k.shape[4]===S[3],(function(){return"Error in conv3dDerFilter: depth of input "+k.shape[4]+") must match input depth in filter ("+S[3]+"."})),U(A.shape[4]===S[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+A.shape[4]+") must match output depth for filter ("+S[4]+")."}));var T=Sv(k.shape,S,E,1,C);return ee.runKernelFunc((function(N){return N.conv3dDerFilter(k,A,T)}),{x5D:k,dy5D:A})})(g,p,b.shape,r,n)}}}));return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),US=J({conv2dDerFilter_:function(t,e,r,n,a,i,o){i===void 0&&(i="NHWC");var s=t;t.rank===3&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),U(s.rank===4,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),U(u.rank===4,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),U(r.length===4,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+r+"."}));var l=i==="NHWC"?s.shape[3]:s.shape[1],f=i==="NHWC"?u.shape[3]:u.shape[1];U(l===r[2],(function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+r[2]+"."})),U(f===r[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+f+") must match output depth for filter ("+r[3]+")."})),o!=null&&U(Xt(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var d=NS(i),p=_s(s.shape,r,n,1,a,o,!1,d);return ee.runKernelFunc((function(v){return v.conv2dDerFilter(s,u,p)}),{x4D:s,dy4D:u})}}),eB=J({conv2dDerInput_:QL}),_m=J({depthwiseConv2d_:function(t,e,r,n,a,i,o){i===void 0&&(i=[1,1]);var s=F(t,"x","depthwiseConv2d"),u=F(e,"filter","depthwiseConv2d"),l=s,f=!1;s.rank===3&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."})),U(u.rank===4,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),U(l.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),i==null&&(i=[1,1]),U(hn(r,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),o!=null&&U(Xt(n),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+n+"."}));var d=_s(l.shape,u.shape,r,i,n,o,!0),p=[l,u],v=ee.runKernelFunc((function(g,b){var y=g.depthwiseConv2D(l,u,d);return b([l,u]),y}),{x:l,filter:u},(function(g,b){U(vl(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var y=b[0],x=b[1];return{x:function(){return tB(y.shape,g,x,d)},filter:function(){return rB(y,g,x.shape,d)}}}),"DepthwiseConv2dNative",d,p);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),tB=J({depthwiseConv2dDerInput_:function(t,e,r,n){var a=e,i=!1;e.rank===3&&(i=!0,a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=ee.runKernelFunc((function(s){return s.depthwiseConv2DDerInput(a,r,n)}),{dy4D:a});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),rB=J({depthwiseConv2dDerFilter_:function(t,e,r,n){var a=t;t.rank===3&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=e;return i.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),ee.runKernelFunc((function(o){return o.depthwiseConv2DDerFilter(a,i,n)}),{x4D:a,dy4D:i})}}),WS=J({separableConv2d_:function(t,e,r,n,a,i,o){i===void 0&&(i=[1,1]),o===void 0&&(o="NHWC");var s=F(t,"x","separableConv2d"),u=F(e,"depthwiseFilter","separableConv2d"),l=F(r,"pointwiseFilter","separableConv2d"),f=s,d=!1;if(s.rank===3&&(d=!0,f=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");U(f.rank===4,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+f.rank+"."})),U(u.rank===4,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),U(l.rank===4,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),U(l.shape[0]===1,(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."})),U(l.shape[1]===1,(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."}));var p=u.shape[2],v=u.shape[3];U(l.shape[2]===p*v,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*v+", but got "+l.shape[2]+"."}));var g=_m(f,u,n,a,o,i),b=Kn(g,l,1,"valid",o);return d?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),jce=J({conv2dTranspose_:function(t,e,r,n,a,i){return QL(r,F(t,"x","conv2dTranspose"),F(e,"filter","conv2dTranspose"),n,a,"NHWC",i)}}),Dce=J({conv3dTranspose_:function(t,e,r,n,a){return ZL(r,F(t,"x","conv3dTranspose"),F(e,"filter","conv3dTranspose"),n,a)}}),Sm=J({matMul_:function(t,e,r,n){var a;r===void 0&&(r=!1),n===void 0&&(n=!1);var i=F(t,"a","matMul"),o=F(e,"b","matMul");a=$t(i,o),i=a[0],o=a[1];var s=r?i.shape[i.rank-2]:i.shape[i.rank-1],u=n?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?i.shape[i.rank-1]:i.shape[i.rank-2],f=n?o.shape[o.rank-2]:o.shape[o.rank-1],d=i.shape.slice(0,-2),p=o.shape.slice(0,-2),v=je(d),g=je(p);U(i.rank>=2&&o.rank>=2&&i.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."})),U(wr(d,p),(function(){return"Error in matMul: outer dimensions ("+d+") and ("+p+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."})),U(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+r+" and transposeB="+n+" must match."}));var b=i.shape.slice(0,-2).concat([l,f]),y=r?i.as3D(v,s,l):i.as3D(v,l,s),x=n?o.as3D(g,f,u):o.as3D(g,u,f),S={transposeA:r,transposeB:n};return ee.runKernelFunc((function(E,C){var k=E.batchMatMul(y,x,r,n);return C([y,x]),k}),{a:y,b:x},(function(E,C){var k=C,A=k[0],T=k[1];return r||n?!r&&n?{a:function(){return E.matMul(T,!1,!1)},b:function(){return E.matMul(A,!0,!1)}}:r&&!n?{a:function(){return T.matMul(E,!1,!0)},b:function(){return A.matMul(E,!1,!1)}}:{a:function(){return T.matMul(E,!0,!0)},b:function(){return E.matMul(A,!0,!0)}}:{a:function(){return E.matMul(T,!1,!0)},b:function(){return A.matMul(E,!0,!1)}}}),"BatchMatMul",S).reshape(b)}}),Mce=J({dot_:function(t,e){var r=F(t,"t1","dot"),n=F(e,"t2","dot");U(!(r.rank!==1&&r.rank!==2||n.rank!==1&&n.rank!==2),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+r.rank+" and "+n.rank+"."}));var a=r.rank===1?r.size:r.shape[1],i=n.rank===1?n.size:n.shape[0];return U(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."})),r.rank===1&&n.rank===1?r.as2D(1,-1).matMul(n.as2D(-1,1)).asScalar():r.rank===1&&n.rank===2?r.as2D(1,-1).matMul(n.as2D(n.shape[0],n.shape[1])).as1D():r.rank===2&&n.rank===1?r.matMul(n.as2D(-1,1)).as1D():r.matMul(n.as2D(n.shape[0],n.shape[1]))}}),Fce=J({outerProduct_:function(t,e){var r=F(t,"v1","outerProduct"),n=F(e,"v2","outerProduct");return U(r.rank===1&&n.rank===1,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+r.rank+" and "+n.rank+"."})),r.as2D(-1,1).matMul(n.as2D(1,-1))}}),ld=J({reverse_:function(t,e){var r=F(t,"x","reverse");if(r.rank===0)return r.clone();var n=vr(e,r.shape);return ee.runKernelFunc((function(a){return a.reverse(r,n)}),{$x:r},(function(a){return{$x:function(){return a.reverse(n)}}})).reshapeAs(r)}}),Lce=J({reverse1d_:function(t){var e=F(t,"x","reverse");return U(e.rank===1,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),ld(e,0)}}),Bce=J({reverse2d_:function(t,e){var r=F(t,"x","reverse");return U(r.rank===2,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+r.rank+"."})),ld(r,e)}}),$ce=J({reverse3d_:function(t,e){var r=F(t,"x","reverse");return U(r.rank===3,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+r.rank+"."})),ld(r,e)}}),Uce=J({reverse4d_:function(t,e){var r=F(t,"x","reverse");return U(r.rank===4,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+r.rank+"."})),ld(r,e)}});function nB(t,e,r,n,a,i){var o=F(t,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(s.rank===4,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),U(hn(r,n),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+n+"'"})),i!=null&&U(Xt(a),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var l=zf(s.shape,e,r,n,a,i);if(l.filterWidth===1&&l.filterHeight===1&&wr(l.inShape,l.outShape))return o.clone();var f=[s],d=ee.runKernelFunc((function(p,v){var g=p.maxPool(s,l);return v([s,g]),g}),{x:s},(function(p,v){var g=v[0],b=v[1];return{x:function(){return(function(y,x,S,E,C,k,A,T){var N=F(y,"dy","maxPoolBackprop"),R=F(x,"input","maxPoolBackprop"),I=F(S,"output","maxPoolBackprop");U(R.rank===N.rank,(function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+N.rank+")"})),U(hn(C,k),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+C+" and dilations '"+k+"'"})),U(N.rank===4,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+N.rank+"."})),U(R.rank===4,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+R.rank+"."}));var D=zf(R.shape,E,C,k,A,T);return ee.runKernelFunc((function(j){return j.maxPoolBackprop(N,R,I,D)}),{$dy:N,$input:R})})(p,g,b,e,r,n,a)}}}),"MaxPool",l,f);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function aB(t,e,r,n,a,i){var o=F(t,"x","avgPool","float32");U(hn(r,n),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+n+"'"}));var s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(s.rank===4,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),i!=null&&U(Xt(a),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var l=zf(s.shape,e,r,n,a,i);if(l.filterWidth===1&&l.filterHeight===1&&wr(l.inShape,l.outShape))return o.clone();var f=ee.runKernelFunc((function(d){return d.avgPool(s,l)}),{x:s},(function(d){return{x:function(){return(function(p,v,g,b,y,x){var S=F(p,"dy","avgPoolBackprop"),E=F(v,"input","avgPoolBackprop");U(E.rank===S.rank,(function(){return"Rank of input ("+E.rank+") does not match rank of dy ("+S.rank+")"})),U(hn(b,y),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+y+"'"}));var C=E,k=S,A=!1;E.rank===3&&(A=!0,C=E.as4D(1,E.shape[0],E.shape[1],E.shape[2]),k=S.as4D(1,S.shape[0],S.shape[1],S.shape[2])),U(k.rank===4,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+k.rank+"."})),U(C.rank===4,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+C.rank+"."}));var T=zf(C.shape,g,b,y,x),N=ee.runKernelFunc((function(R){return R.avgPoolBackprop(k,C,T)}),{dy4D:k,input4D:C});return A?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N})(d,s,e,r,n,a)}}}),"AvgPool",l);return f=f.cast(o.dtype),u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}var br=J({maxPool_:function(t,e,r,n,a){return nB(t,e,r,1,n,a)}}),cd=J({avgPool_:function(t,e,r,n,a){return aB(t,e,r,1,n,a)}}),Wce=J({pool_:function(t,e,r,n,a,i){a==null&&(a=[1,1]),i==null&&(i=1),n===0&&(n="valid");var o=F(t,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(hn(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"}));var l,f=zf(s.shape,e,i,a,n),d=[f.dilationHeight,f.dilationWidth];l=n==="same"?(function(C,k){var A=C.map((function(R,I){return R+(R-1)*(k[I]-1)})).map((function(R){return R-1})),T=A.map((function(R){return Math.floor(R/2)})),N=A.map((function(R,I){return R-T[I]}));return A.map((function(R,I){return[T[I],N[I]]}))})([f.filterHeight,f.filterWidth],d):[[0,0],[0,0]];var p=d[0]===1&&d[1]===1,v=(function(C,k,A){var T=A.map((function(W){return W[0]})),N=A.map((function(W){return W[1]})),R=C.concat(T,N),I=k.map((function(W,q){return(W-R[q]%W)%W})),D=N.map((function(W,q){return W+I[q]})),j=k.map((function(W,q){return[T[q],D[q]]})),$=k.map((function(W,q){return[0,I[q]]}));return[j,$]})([f.inHeight,f.inWidth],d,l),g=v[0],b=v[1],y=p?n:"valid",x=p?s:cL(s,d,g),S=(r==="avg"?function(){return aB(x,e,i,1,y)}:function(){return nB(x,e,i,1,y)})(),E=p?S:sL(S,d,b);return u?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),zce=J({maxPool3d_:function(t,e,r,n,a,i,o){i===void 0&&(i="NDHWC");var s=F(t,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),U(i==="NDHWC",(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),U(hn(r,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"})),a!=null&&U(Xt(n),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."}));var f=_v(u.shape,e,r,o,n,a,i),d=ee.runKernelFunc((function(p,v){var g=p.maxPool3d(u,f);return v([u,g]),g}),{x:u},(function(p,v){var g=v[0],b=v[1];return{x:function(){return(function(y,x,S,E,C,k,A,T){var N=F(y,"dy","maxPool3dBackprop"),R=F(x,"input","maxPool3dBackprop"),I=F(S,"output","maxPool3dBackprop"),D=N,j=R,$=I,W=!1;R.rank===4&&(W=!0,D=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),j=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),$=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3])),U(D.rank===5,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."})),U(j.rank===5,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+j.rank+"."})),U($.rank===5,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+$.rank+"."})),k==null&&(k=[1,1,1]),U(hn(C,k),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+C+" and dilations '"+k+"'"})),T!=null&&U(Xt(A),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+T+" but got pad "+A+"."}));var q=_v(j.shape,E,C,k,A,T),X=ee.runKernelFunc((function(Y){return Y.maxPool3dBackprop(D,j,$,q)}),{dy5D:D,input5D:j});return W?X.as4D(X.shape[1],X.shape[2],X.shape[3],X.shape[4]):X})(p,g,b,e,r,o,n,a)}}}));return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),qce=J({avgPool3d_:function(t,e,r,n,a,i,o){i===void 0&&(i="NDHWC");var s=F(t,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),U(i==="NDHWC",(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),U(hn(r,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"})),a!=null&&U(Xt(n),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."}));var f=_v(u.shape,e,r,o,n,a,i),d=ee.runKernelFunc((function(p){return p.avgPool3d(u,f)}),{x:u},(function(p){return{x:function(){return(function(v,g,b,y,x,S,E){var C=F(v,"dy","avgPool3dBackprop"),k=F(g,"input","avgPool3dBackprop"),A=C,T=k,N=!1;k.rank===4&&(N=!0,A=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),T=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3])),U(A.rank===5,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+A.rank+"."})),U(T.rank===5,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."})),x==null&&(x=[1,1,1]),U(hn(y,x),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+y+" and dilations '"+x+"'"})),E!=null&&U(Xt(S),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+E+" but got pad "+S+"."}));var R=_v(T.shape,b,y,x,S,E),I=ee.runKernelFunc((function(D){return D.avgPool3dBackprop(A,T,R)}),{dy5D:A,input5D:T});return N?I.as4D(I.shape[1],I.shape[2],I.shape[3],I.shape[4]):I})(p,u,e,r,o,n,a)}}}));return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),La=J({slice_:function(t,e,r){var n,a,i=F(t,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(n=typeof e=="number"?[e].concat(new Array(i.rank-1).fill(0)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice()).forEach((function(u){U(u!==-1,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=r==null?new Array(i.rank).fill(-1):typeof r=="number"?[r].concat(new Array(i.rank-1).fill(-1)):r.length<i.rank?r.concat(new Array(i.rank-r.length).fill(-1)):r).map((function(u,l){return u>=0?u:(U(u===-1,(function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."})),i.shape[l]-n[l])})),yse(i,n,a);var o=i.shape,s={begin:n,size:a};return ee.runKernelFunc((function(u){return u.slice(i,n,a)}),{x:i},(function(u){for(var l=[],f=0;f<u.rank;f++)l.push([n[f],o[f]-n[f]-a[f]]);return{x:function(){return u.pad(l)}}}),"Slice",s)}}),Vce=J({slice1d_:function(t,e,r){var n=F(t,"x","slice1d");return U(n.rank===1,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"})),La(n,[e],[r])}}),Hce=J({slice2d_:function(t,e,r){var n=F(t,"x","slice2d");return U(n.rank===2,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"})),La(n,e,r)}}),iB=J({slice3d_:function(t,e,r){var n=F(t,"x","slice3d");return U(n.rank===3,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"})),La(n,e,r)}}),Gce=J({slice4d_:function(t,e,r){var n=F(t,"x","slice4d");return U(n.rank===4,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"})),La(n,e,r)}});function oB(t,e,r,n,a){return e.rank<r.rank&&(e=e.reshape(dn(e.shape,n))),t.rank<r.rank&&(t=t.reshape(dn(t.shape,n))),{x:function(){var i=t.mul(r.equal(e).cast(t.dtype));return a==null?i:i.transpose(a)}}}var Kce=J({all_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=F(t,"x","all","bool"),a=vr(e,n.shape),i=a,o=Wa(i,n.rank);o!=null&&(n=n.transpose(o),i=za(i.length,n.rank));var s=ee.runKernelFunc((function(l){return l.all(n,i)}),{$x:n});if(r){var u=dn(s.shape,a);return s.reshape(u)}return s}}),Xce=J({any_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=F(t,"x","any","bool"),a=vr(e,n.shape),i=a,o=Wa(i,n.rank);o!=null&&(n=n.transpose(o),i=za(i.length,n.rank));var s=ee.runKernelFunc((function(l){return l.any(n,i)}),{$x:n});if(r){var u=dn(s.shape,a);return s.reshape(u)}return s}}),Yce=J({argMax_:function(t,e){e===void 0&&(e=0);var r=F(t,"x","argMax");e==null&&(e=0);var n=vr(e,r.shape),a=Wa(n,r.rank);a!=null&&(r=r.transpose(a),n=za(n.length,r.rank));var i={axis:n[0]},o=[r];return ee.runKernelFunc((function(s,u){var l=s.argMax(r,n[0]);return u([r]),l}),{x:r},(function(s,u){var l=u[0];return{x:function(){return ut(l)}}}),"ArgMax",i,o)}}),Jce=J({argMin_:function(t,e){e===void 0&&(e=0);var r=F(t,"x","argMin");e==null&&(e=0);var n=vr(e,r.shape),a=Wa(n,r.rank);return a!=null&&(r=r.transpose(a),n=za(n.length,r.rank)),ee.runKernelFunc((function(i,o){var s=i.argMin(r,n[0]);return o([r]),s}),{$x:r},(function(i,o){var s=o[0];return{$x:function(){return ut(s)}}}))}}),Qce=J({logSumExp_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=F(t,"x","logSumExp"),a=vr(e,n.shape),i=n.max(a,!0),o=n.sub(i).exp().sum(a).log(),s=i.reshape(o.shape).add(o);if(r){var u=dn(s.shape,a);return s.reshape(u)}return s}}),Em=J({max_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=F(t,"x","max"),a=n,i=vr(e,n.shape),o=i,s=Wa(o,n.rank);s!=null&&(n=n.transpose(s),o=za(o.length,n.rank));var u=[n],l=ee.runKernelFunc((function(d,p){var v=d.max(n,o);return p([a,v]),v}),{x:n},(function(d,p){return oB(d,p[1],p[0],i,s)}),"Max",{axes:o},u,[!0]);if(r){var f=dn(l.shape,i);l=l.reshape(f)}return l}}),Zce=J({mean_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=F(t,"x","mean"),a=vr(e,n.shape),i=je(Wr(n.shape,a)[1]);return bm((function(o){var s=Ee(i);return{value:(s.dtype===o.dtype?o:o.cast(s.dtype)).div(s).sum(e,r),gradFunc:function(u){var l=o.shape.slice();return a.forEach((function(f){l[f]=1})),u.reshape(l).mul(Nl(o.shape,"float32")).div(i)}}}))(n)}}),efe=J({min_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=F(t,"x","min"),a=n,i=vr(e,n.shape),o=i,s=Wa(o,n.rank);s!=null&&(n=n.transpose(s),o=za(o.length,n.rank));var u=[n],l=ee.runKernelFunc((function(d,p){var v=d.min(n,o);return p([a,v]),v}),{x:n},(function(d,p){return oB(d,p[1],p[0],i,s)}),"Min",{axes:o},u,[!0]);if(r){var f=dn(l.shape,i);l=l.reshape(f)}return l}}),tfe=J({moments_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=vr(e,(t=F(t,"x","moments")).shape),a=t.mean(n,r),i=a.shape;r||(i=dn(a.shape,n));var o=t.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(n,r)}}}),sB=J({sum_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=F(t,"x","sum");n.dtype==="bool"&&(n=n.toInt());var a=vr(e,n.shape);return bm((function(i){var o=Wa(a,i.rank),s=a,u=i;o!=null&&(u=i.transpose(o),s=za(s.length,i.rank));var l=function(v){var g=i.shape.slice();return a.forEach((function(b){g[b]=1})),v.reshape(g).mul(Nl(i.shape,"float32"))},f={axes:s},d=ee.runKernelFunc((function(v){return v.sum(u,s)}),{x:u},(function(v){return{x:function(){return l(v)}}}),"Sum",f);if(r){var p=dn(d.shape,a);d=d.reshape(p)}return{value:d,gradFunc:l}}))(n)}}),rfe=J({prod_:function(t,e,r){e===void 0&&(e=null),r===void 0&&(r=!1);var n=F(t,"x","prod");n.dtype==="bool"&&(n=n.toInt());var a=vr(e,n.shape),i=Wa(a,n.rank),o=a,s=n;i!=null&&(s=n.transpose(i),o=za(o.length,n.rank));var u=ee.runKernelFunc((function(f){return f.prod(s,o)}),{permutedX:s});if(r){var l=dn(u.shape,a);u=u.reshape(l)}return u}}),uB=J({elu_:function(t){var e=F(t,"x","elu");return ee.runKernelFunc((function(r,n){var a=r.elu(e);return n([a]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){return ee.runKernelFunc((function(i){return i.eluDer(r,a)}),{dy:r,y:a})}}}))}}),nfe=J({leakyRelu_:function(t,e){e===void 0&&(e=.2);var r=F(t,"x","leakyRelu");return BS(Ee(e).mul(r),r)}}),lB=J({prelu_:function(t,e){var r=F(t,"x","prelu"),n=F(e,"alpha","prelu");return ee.runKernelFunc((function(a,i){var o=a.prelu(r,n);return i([r,n]),o}),{x:r,alpha:n},(function(a,i){var o=i[0],s=i[1],u=o.greater(0);return{x:function(){return ds(u,a,a.mul(s))},alpha:function(){var l=ds(u,ut(a),a.mul(o)),f=dr(s.shape,a.shape);return f.length>0&&(l=l.sum(f)),l.reshape(s.shape)}}}),"Prelu")}}),Lt=J({relu_:function(t){var e=F(t,"x","relu");return e.dtype==="bool"?e.toInt():ee.runKernelFunc((function(r,n){var a=r.relu(e);return n([e]),a}),{x:e},(function(r,n){var a=n[0];return{x:function(){return r.mulStrict(a.step().toFloat())}}}),"Relu")}}),cB=J({relu6_:function(t){var e=F(t,"x","relu6");return e.dtype==="bool"?e.toInt():ee.runKernelFunc((function(r,n){var a=r.relu6(e);return n([e]),a}),{x:e},(function(r,n){var a=n[0],i=a.lessEqual(6).mul(a.step());return{x:function(){return r.mulStrict(i.toFloat())}}}),"Relu6")}}),afe=J({selu_:function(t){var e=F(t,"x","selu");return ee.runKernelFunc((function(r,n){var a=r.selu(e);return n([e]),a}),{$x:e},(function(r,n){var a=n[0];return{$x:function(){var i=a.greater(Ee(0)),o=Ee(MS),s=Ee(FS),u=r.mul(s),l=r.mul(o).mul(a.toFloat().exp());return ds(i,u,l)}}}))}}),lo=J({transpose_:function(t,e){var r=F(t,"x","transpose");if(e==null&&(e=r.shape.map((function(a,i){return i})).reverse()),U(r.rank===e.length,(function(){return"Error in transpose: rank of input "+r.rank+" must match length of perm "+e+"."})),e.forEach((function(a){U(a>=0&&a<r.rank,(function(){return"All entries in 'perm' must be between 0 and "+(r.rank-1)+" but got "+e}))})),r.rank<=1)return r.clone();var n={perm:e};return ee.runKernelFunc((function(a){return a.transpose(r,e)}),{x:r},(function(a){var i=kS(e);return{x:function(){return a.transpose(i)}}}),"Transpose",n)}}),ife=J({localResponseNormalization_:function(t,e,r,n,a){e===void 0&&(e=5),r===void 0&&(r=1),n===void 0&&(n=1),a===void 0&&(a=.5);var i=F(t,"x","localResponseNormalization");U(i.rank===4||i.rank===3,(function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."})),U(Xt(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var o=i,s=!1;i.rank===3&&(s=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=ee.runKernelFunc((function(l,f){var d=l.localResponseNormalization4D(o,e,r,n,a);return f([o,d]),d}),{x4D:o},(function(l,f){var d=f[0],p=f[1];return{x4D:function(){return ee.runKernelFunc((function(v){return v.LRNGrad(l,d,p,e,r,n,a)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),fB=J({norm_:function(t,e,r,n){e===void 0&&(e="euclidean"),r===void 0&&(r=null),n===void 0&&(n=!1);var a=(function s(u,l,f){if(f===void 0&&(f=null),u.rank===0)return u.abs();if(u.rank!==1&&f===null)return s(u.reshape([-1]),l,f);if(u.rank===1||typeof f=="number"||Array.isArray(f)&&f.length===1){if(l===1)return u.abs().sum(f);if(l===1/0)return u.abs().max(f);if(l===-1/0)return u.abs().min(f);if(l==="euclidean"||l===2)return u.abs().pow(Ee(2,"int32")).sum(f).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(f)&&f.length===2){if(l===1)return u.abs().sum(f[0]).max(f[1]-1);if(l===1/0)return u.abs().sum(f[1]).max(f[0]);if(l===-1/0)return u.abs().sum(f[1]).min(f[0]);if(l==="fro"||l==="euclidean")return u.square().sum(f).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+f)})(t=F(t,"x","norm"),e,r),i=a.shape;if(n){var o=vr(r,t.shape);i=dn(a.shape,o)}return a.reshape(i)}}),ofe=J({basicLSTMCell_:function(t,e,r,n,a,i){var o=F(t,"forgetBias","basicLSTMCell"),s=F(e,"lstmKernel","basicLSTMCell"),u=F(r,"lstmBias","basicLSTMCell"),l=F(n,"data","basicLSTMCell"),f=F(a,"c","basicLSTMCell"),d=F(i,"h","basicLSTMCell"),p=l.concat(d,1).matMul(s).add(u),v=p.shape[0],g=p.shape[1]/4,b=[v,g],y=p.slice([0,0],b),x=p.slice([0,g],b),S=p.slice([0,2*g],b),E=p.slice([0,3*g],b),C=y.sigmoid().mulStrict(x.tanh()).addStrict(f.mulStrict(o.add(S).sigmoid())),k=C.tanh().mulStrict(E.sigmoid());return[C,k]}}),sfe=J({multiRNNCell_:function(t,e,r,n){for(var a=F(e,"data","multiRNNCell"),i=mv(r,"c","multiRNNCell"),o=mv(n,"h","multiRNNCell"),s=a,u=[],l=0;l<t.length;l++){var f=t[l](s,i[l],o[l]);u.push(f[0]),u.push(f[1]),s=f[1]}var d=[],p=[];for(l=0;l<u.length;l+=2)d.push(u[l]),p.push(u[l+1]);return[d,p]}}),ufe=J({movingAverage_:function(t,e,r,n,a){a===void 0&&(a=!0);var i=F(t,"v","movingAverage"),o=F(e,"x","movingAverage"),s=F(r,"decay","movingAverage");ioe(i,o),U(wr(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=Ee(1),l=u.sub(s),f=o.sub(i).mul(l);if(a){U(n!=null,(function(){return"When using zeroDebias: true, step is required."}));var d=F(n,"step","movingAverage");f=f.div(u.sub(kv(s,d)))}return i.add(f)}}),lfe=J({stridedSlice_:function(t,e,r,n,a,i,o,s,u){if(a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),n==null&&(n=new Array(e.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var l=F(t,"x","stridedSlice"),f=Zj(s),d=l.shape.slice();f.forEach((function(y){e[y]=0,r[y]=1,d.splice(y,0,1)})),l=l.reshape(d);for(var p=0;p<l.rank;p++)e[p]=bse(a,e,n,l.shape,p),r[p]=xse(i,r,n,l.shape,p),n[p]=n[p]||1;var v=Zj(u);v.forEach((function(y){r[y]=e[y]+1,n[y]=1}));var g=PS(e,r,n),b=g.filter((function(y,x){return v.indexOf(x)===-1}));return n.every((function(y){return y===1}))?La(l,e,g).reshape(b):ee.runKernelFunc((function(y){return y.stridedSlice(l,e,r,n)}),{$x:l}).reshape(b)}}),cfe=J({topk_:function(t,e,r){e===void 0&&(e=1),r===void 0&&(r=!0);var n=F(t,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=n.shape[n.shape.length-1];if(e>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+e);var i=ee.runKernelFunc((function(o){return o.topk(n,e,r)}),{$x:n});return{values:i[0],indices:i[1]}}}),ffe=J({scatterND_:function(t,e,r){var n=F(t,"indices","scatterND","int32"),a=F(e,"updates","scatterND");return gse(a,n,r),ee.runKernelFunc((function(i){return i.scatterND(n,a,r)}),{indices:n,updates:a},null,"ScatterNd",{shape:r})}}),zS=J({fft_:function(t){U(t.dtype==="complex64",(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],r=t.size/e,n=t.as2D(r,e);return ee.runKernelFunc((function(a){return a.fft(n)}),{input:t}).reshape(t.shape)}}),Av=J({ifft_:function(t){U(t.dtype==="complex64",(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],r=t.size/e,n=t.as2D(r,e);return ee.runKernelFunc((function(a){return a.ifft(n)}),{input:t}).reshape(t.shape)}}),qS=J({rfft_:function(t,e){U(t.dtype==="float32",(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var r,n=t.shape[t.shape.length-1],a=t.size/n;if(e!=null&&e<n){var i=t.shape.map((function(x){return 0})),o=t.shape.map((function(x){return x}));o[t.shape.length-1]=e,r=t.slice(i,o),n=e}else if(e!=null&&e>n){var s=t.shape.map((function(x){return x}));s[t.shape.length-1]=e-n,r=t.concat(Ot(s),t.shape.length-1),n=e}else r=t;var u=r.zerosLike(),l=Pr(r,u).as2D(a,n),f=zS(l),d=Math.floor(n/2)+1,p=Un(f),v=Aa(f),g=p.split([d,n-d],p.shape.length-1),b=v.split([d,n-d],v.shape.length-1),y=r.shape.slice();return y[r.shape.length-1]=d,Pr(g[0],b[0]).reshape(y)}}),dB=J({irfft_:function(t){var e=t.shape[t.shape.length-1],r=t.size/e;if(e<=2){var n=t.as2D(r,e),a=Av(n);return Un(a)}var i=[r,2*(e-1)],o=Un(t).as2D(r,e),s=Aa(t).as2D(r,e),u=o.slice([0,1],[r,e-2]).reverse(1),l=s.slice([0,1],[r,e-2]).reverse(1).mul(Ee(-1)),f=o.concat(u,1),d=s.concat(l,1);return n=Pr(f,d).as2D(i[0],i[1]),a=Av(n),Un(a)}}),dfe=Object.freeze({fft:zS,ifft:Av,rfft:qS,irfft:dB}),hfe=J({sparseToDense_:function(t,e,r,n){n===void 0&&(n=0);var a=F(t,"sparseIndices","sparseToDense","int32"),i=F(e,"sparseValues","sparseToDense"),o=F(n,"defaultValue","sparseToDense",i.dtype);return(function(s,u,l,f){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,p=s.rank>1?s.shape[1]:1;if(l.length!==p)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+p+".");var v=u.size;if(u.rank!==0&&(u.rank!==1||v!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==f.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")})(a,i,r,o),ee.runKernelFunc((function(s){return s.sparseToDense(a,i,r,o)}),{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),pfe=J({gatherND_:function(t,e){var r=F(e,"indices","gatherND","int32"),n=F(t,"x","gatherND");return ee.runKernelFunc((function(a){return a.gatherND(n,r)}),{x:n,indices:r},null,"GatherNd")}}),vfe=J({diag_:function(t){var e=F(t,"x","diag").flatten(),r=t.shape.concat(t.shape);return ee.runKernelFunc((function(n){return n.diag(e)}),{$x:e}).reshape(r)}}),mfe=J({dropout_:function(t,e,r,n){var a=F(t,"x","dropout");if(U(a.dtype==="float32",(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."})),U(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),e===0)return t instanceof Ft?a.clone():a;var i=(function(u,l){if(l==null)return u.shape.slice();if(wr(u.shape,l))return l;if(u.shape.length===l.length){for(var f=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?f.push(u.shape[d]):f.push(l[d]);return f}return l})(a,r),o=1-e,s=lL(i,0,1,"float32",n).add(o).floor().div(o);return a.mul(s)}});function hB(t,e,r){for(var n=1-t%2,a=new Float32Array(t),i=0;i<t;++i){var o=2*Math.PI*i/(t+n-1);a[i]=e-r*Math.cos(o)}return er(a,"float32")}var VS=J({hannWindow_:function(t){return hB(t,.5,.5)}}),pB=J({hammingWindow_:function(t){return hB(t,.54,.46)}}),HS=J({frame_:function(t,e,r,n,a){n===void 0&&(n=!1),a===void 0&&(a=0);for(var i=0,o=[];i+e<=t.size;)o.push(La(t,i,e)),i+=r;if(n)for(;i<t.size;){var s=i+e-t.size,u=cr([La(t,i,e-s),Da([s],a)]);o.push(u),i+=r}return o.length===0?io([],[0,e]):cr(o).as2D(o.length,e)}}),vB=J({stft_:function(t,e,r,n,a){var i;a===void 0&&(a=VS),n==null&&(i=e,n=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=HS(t,e,r),s=Kr(o,a(e)),u=[],l=0;l<o.shape[0];l++)u.push(qS(s.slice([l,0],[1,e]),n));return cr(u)}}),gfe=Object.freeze({hannWindow:VS,hammingWindow:pB,frame:HS,stft:vB}),Gr,yfe=function(t,e,r){return r===void 0&&(r=1),Ne(this,void 0,void 0,(function(){var n,a,i,o,s,u,l,f,d,p,v,g,b,y;return Re(this,(function(x){switch(x.label){case 0:return n=F(t,"predictions","inTopK"),a=F(e,"targets","inTopK"),U(n.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+n.rank})),U(n.rank-1===a.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+n.rank+" and targets rank "+a.rank})),vt(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=n.shape[n.shape.length-1],U(r>0&&r<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+r})),[4,n.data()];case 1:return o=x.sent(),[4,a.data()];case 2:for(s=x.sent(),u=[o.length/i,i],f=u[1],d=$f("bool",l=u[0]),p=0;p<l;p++){for(v=p*f,g=o.subarray(v,v+f),b=[],y=0;y<g.length;y++)b.push({value:g[y],index:y});for(b.sort((function(S,E){return E.value-S.value})),d[p]=0,y=0;y<r;y++)if(b[y].index===s[p]){d[p]=1;break}}return t!==n&&n.dispose(),e!==a&&a.dispose(),[2,Rr(d,a.shape,"bool")]}}))}))};(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Gr||(Gr={}));var bfe=J({absoluteDifference_:function(t,e,r,n){n===void 0&&(n=Gr.SUM_BY_NONZERO_WEIGHTS);var a=F(t,"labels","absoluteDifference"),i=F(e,"predictions","absoluteDifference"),o=null;r!=null&&(o=F(r,"weights","absoluteDifference")),vt(a.shape,i.shape,"Error in absoluteDifference: ");var s=a.sub(i).abs();return wi(s,o,n)}}),wi=J({computeWeightedLoss_:function(t,e,r){r===void 0&&(r=Gr.SUM_BY_NONZERO_WEIGHTS);var n=F(t,"losses","computeWeightedLoss"),a=null;e!=null&&(a=F(e,"weights","computeWeightedLoss"));var i=a==null?n:n.mul(a);if(r===Gr.NONE)return i;if(r===Gr.SUM)return i.sum();if(r===Gr.MEAN){if(a==null)return i.mean();var o=n.size/a.size,s=i.sum().div(a.sum());return o>1?s.div(Ee(o)):s}if(r===Gr.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(Ee(n.size));var u=a.mul(Nl(n.shape)).notEqual(Ee(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+r)}}),xfe=J({cosineDistance_:function(t,e,r,n,a){a===void 0&&(a=Gr.SUM_BY_NONZERO_WEIGHTS);var i=F(t,"labels","cosineDistance"),o=F(e,"predictions","cosineDistance"),s=null;n!=null&&(s=F(n,"weights","cosineDistance")),vt(i.shape,o.shape,"Error in cosineDistance: ");var u=Ee(1).sub(i.mul(o).sum(r,!0));return wi(u,s,a)}}),wfe=J({hingeLoss_:function(t,e,r,n){n===void 0&&(n=Gr.SUM_BY_NONZERO_WEIGHTS);var a=F(t,"labels","hingeLoss"),i=F(e,"predictions","hingeLoss"),o=null;r!=null&&(o=F(r,"weights","hingeLoss")),vt(a.shape,i.shape,"Error in hingeLoss: ");var s=Ee(1);a=Ee(2).mul(a).sub(s);var u=s.sub(a.mul(i)).relu();return wi(u,o,n)}}),_fe=J({huberLoss_:function(t,e,r,n,a){n===void 0&&(n=1),a===void 0&&(a=Gr.SUM_BY_NONZERO_WEIGHTS);var i=F(t,"labels","huberLoss"),o=F(e,"predictions","huberLoss"),s=null;r!=null&&(s=F(r,"weights","huberLoss")),vt(i.shape,o.shape,"Error in huberLoss: ");var u=Ee(n),l=o.sub(i).abs(),f=KL(l,u),d=l.sub(f),p=Ee(.5).mul(f.square()).add(u.mul(d));return wi(p,s,a)}}),Sfe=J({logLoss_:function(t,e,r,n,a){n===void 0&&(n=1e-7),a===void 0&&(a=Gr.SUM_BY_NONZERO_WEIGHTS);var i=F(t,"labels","logLoss"),o=F(e,"predictions","logLoss"),s=null;r!=null&&(s=F(r,"weights","logLoss")),vt(i.shape,o.shape,"Error in logLoss: ");var u=Ee(1),l=Ee(n),f=i.mul(o.add(l).log()).neg().sub(u.sub(i).mul(u.sub(o).add(l).log()));return wi(f,s,a)}}),Efe=J({meanSquaredError_:function(t,e,r,n){n===void 0&&(n=Gr.SUM_BY_NONZERO_WEIGHTS);var a=F(t,"labels","meanSquaredError"),i=F(e,"predictions","meanSquaredError"),o=null;r!=null&&(o=F(r,"weights","meanSquaredError")),vt(a.shape,i.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(i);return wi(s,o,n)}}),Cfe=J({sigmoidCrossEntropy_:function(t,e,r,n,a){n===void 0&&(n=0),a===void 0&&(a=Gr.SUM_BY_NONZERO_WEIGHTS);var i=F(t,"multiClassLabels","sigmoidCrossEntropy"),o=F(e,"logits","sigmoidCrossEntropy"),s=null;if(r!=null&&(s=F(r,"weights","sigmoidCrossEntropy")),vt(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),n>0){var u=Ee(n),l=Ee(1),f=Ee(.5);i=i.mul(l.sub(u)).add(f.mul(u))}var d=(function(p,v){var g=F(p,"labels","sigmoidCrossEntropyWithLogits"),b=F(v,"logits","sigmoidCrossEntropyWithLogits");vt(g.shape,b.shape,"Error in sigmoidCrossEntropyWithLogits: ");var y=b.relu(),x=b.mul(g),S=b.abs().neg().exp().log1p();return y.sub(x).add(S)})(i,o);return wi(d,s,a)}}),kfe=J({softmaxCrossEntropy_:function(t,e,r,n,a){n===void 0&&(n=0),a===void 0&&(a=Gr.SUM_BY_NONZERO_WEIGHTS);var i=F(t,"onehotLabels","softmaxCrossEntropy"),o=F(e,"logits","softmaxCrossEntropy"),s=null;if(r!=null&&(s=F(r,"weights","softmaxCrossEntropy")),vt(i.shape,o.shape,"Error in softmaxCrossEntropy: "),n>0){var u=Ee(n),l=Ee(1),f=Ee(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(f))}var d=(function(p,v,g){if(g===void 0&&(g=-1),g===-1&&(g=v.rank-1),g!==v.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+v.rank+" and dim was "+g);return bm((function(b,y,x){var S=y.logSumExp([g],!0),E=y.toFloat().sub(S);return x([b,E]),{value:E.mul(b).neg().sum([g]),gradFunc:function(C,k){var A=k[0],T=k[1],N=dn(C.shape,[g]);return[C.reshape(N).mul(A.toFloat().sub(T.exp())),C.reshape(N).mul(T.exp().sub(A.toFloat()))]}}}))(p,v)})(i,o);return wi(d,s,a)}}),Afe=Object.freeze({get Reduction(){return Gr},absoluteDifference:bfe,computeWeightedLoss:wi,cosineDistance:xfe,hingeLoss:wfe,huberLoss:_fe,logLoss:Sfe,meanSquaredError:Efe,sigmoidCrossEntropy:Cfe,softmaxCrossEntropy:kfe});function wD(t,e){return e===void 0&&(e=!1),ee.tidy((function(){if(t.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var r=t.shape[0],n=t.shape[1],a=uL(r),i=t.clone(),o=io([[1]],[1,1]),s=o.clone(),u=r>=n?n:r,l=function(d){var p,v=i,g=s,b=a;p=ee.tidy((function(){var y=i.slice([d,d],[r-d,1]),x=y.norm(),S=i.slice([d,d],[1,1]),E=io([[-1]]).where(S.greater(0),io([[1]])),C=S.sub(E.mul(x)),k=y.div(C);s=k.shape[0]===1?o.clone():o.concat(k.slice([1,0],[k.shape[0]-1,k.shape[1]]),0);var A=E.matMul(C).div(x).neg(),T=i.slice([d,0],[r-d,n]),N=A.mul(s);if(d===0)i=T.sub(N.matMul(s.transpose().matMul(T)));else{var R=T.sub(N.matMul(s.transpose().matMul(T)));i=i.slice([0,0],[d,n]).concat(R,0)}var I=a.slice([0,d],[r,a.shape[1]-d]);if(d===0)a=I.sub(I.matMul(s).matMul(N.transpose()));else{var D=I.sub(I.matMul(s).matMul(N.transpose()));a=a.slice([0,0],[r,d]).concat(D,1)}return[s,i,a]})),s=p[0],i=p[1],a=p[2],fn([v,g,b])},f=0;f<u;++f)l(f);return!e&&r>n&&(a=a.slice([0,0],[r,n]),i=i.slice([0,0],[n,n])),[a,i]}))}var Ofe=J({bandPart_:function(t,e,r){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(r%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+r+".");var n=F(t,"a","bandPart");if(n.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+n.rank+".");var a=n.shape,i=n.shape.slice(-2),o=i[0],s=i[1];if(!(e<=o))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+o+").");if(!(r<=s))throw new Error("bandPart(): numUpper ("+r+") must not be greater than the number of columns ("+s+").");e<0&&(e=o),r<0&&(r=s);var u=gv(0,o,1,"int32").reshape([-1,1]),l=gv(0,s,1,"int32"),f=hr(u,l),d=wm(f.lessEqual(Ee(+e,"int32")),f.greaterEqual(Ee(-r,"int32"))),p=Ot([o,s],n.dtype);return Tn(fr(n.reshape([-1,o,s])).map((function(v){return ds(d,v,p)}))).reshape(a)}}),Tfe=J({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,U(t!=null&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var r=t[0].shape[0],n=function(u){U(t[u].shape[0]===r,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[u].shape[0]+" vs. "+r+")"}))},a=1;a<t.length;++a)n(a)}else e=!0,t=OS(t,t.shape[0],0).map((function(u){return fL(u,[0])}));U(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var i=[],o=t,s=function(u){i.push(ee.tidy((function(){var l=o[u];if(u>0)for(var f=0;f<u;++f){var d=sB(i[f].mulStrict(l)).mul(i[f]);l=l.sub(d)}return l.div(fB(l,"euclidean"))})))};for(a=0;a<t.length;++a)s(a);return e?Tn(i,0):i}}),Pfe=J({qr_:function(t,e){if(e===void 0&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(t.rank===2)return wD(t,e);var r=t.shape.slice(0,t.shape.length-2).reduce((function(o,s){return o*s})),n=fr(t.reshape([r,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];return n.forEach((function(o){var s=wD(o,e),u=s[0],l=s[1];a.push(u),i.push(l)})),[Tn(a,0).reshape(t.shape),Tn(i,0).reshape(t.shape)]}}),Nfe=Object.freeze({bandPart:Ofe,gramSchmidt:Tfe,qr:Pfe});function Cm(t,e,r,n,a,i){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);var o=t.shape[0];return r=Math.min(r,o),U(0<=n&&n<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"})),U(t.rank===2,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),U(t.shape[1]===4,(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),U(e.rank===1,(function(){return"scores must be a 1D tensor"})),U(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),U(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"})),{maxOutputSize:r,iouThreshold:n,scoreThreshold:a,softNmsSigma:i}}var Rfe=J({resizeBilinear_:function(t,e,r){r===void 0&&(r=!1);var n=F(t,"images","resizeBilinear");U(n.rank===3||n.rank===4,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+n.rank+"."})),U(e.length===2,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=e[0],s=e[1],u=ee.runKernelFunc((function(l,f){return f([a]),l.resizeBilinear(a,o,s,r)}),{x:a},(function(l,f){return{x:function(){return ee.runKernelFunc((function(d){return d.resizeBilinearBackprop(l,f[0],r)}),{})}}}),"ResizeBilinear",{alignCorners:r,newHeight:o,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Ife=J({resizeNearestNeighbor_:function(t,e,r){r===void 0&&(r=!1);var n=F(t,"images","resizeNearestNeighbor");U(n.rank===3||n.rank===4,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+n.rank+"."})),U(e.length===2,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),U(n.dtype==="float32"||n.dtype==="int32",(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=e[0],s=e[1],u=ee.runKernelFunc((function(l,f){return f([a]),l.resizeNearestNeighbor(a,o,s,r)}),{batchImages:a},(function(l,f){return{batchImages:function(){return ee.runKernelFunc((function(d){return d.resizeNearestNeighborBackprop(l,f[0],r)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),jfe=J({nonMaxSuppression_:function(t,e,r,n,a){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=F(t,"boxes","nonMaxSuppression"),o=F(e,"scores","nonMaxSuppression"),s=Cm(i,o,r,n,a);r=s.maxOutputSize,n=s.iouThreshold,a=s.scoreThreshold;var u={maxOutputSize:r,iouThreshold:n,scoreThreshold:a};return ee.runKernelFunc((function(l){return l.nonMaxSuppression(i,o,r,n,a)}),{boxes:i,scores:o},null,"NonMaxSuppressionV3",u)}}),Dfe=function(t,e,r,n,a){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),Ne(this,void 0,void 0,(function(){var i,o,s,u,l,f,d;return Re(this,(function(p){switch(p.label){case 0:return i=F(t,"boxes","nonMaxSuppressionAsync"),o=F(e,"scores","nonMaxSuppressionAsync"),s=Cm(i,o,r,n,a),r=s.maxOutputSize,n=s.iouThreshold,a=s.scoreThreshold,[4,Promise.all([i.data(),o.data()])];case 1:return u=p.sent(),l=u[0],f=u[1],d=RS(l,f,r,n,a),i!==t&&i.dispose(),o!==e&&o.dispose(),[2,d]}}))}))},Mfe=J({nonMaxSuppressionWithScore_:function(t,e,r,n,a,i){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var o=F(t,"boxes","nonMaxSuppression"),s=F(e,"scores","nonMaxSuppression"),u=Cm(o,s,r,n,a,i),l={maxOutputSize:r=u.maxOutputSize,iouThreshold:n=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},f=ee.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},l);return{selectedIndices:f[0],selectedScores:f[1]}}}),Ffe=function(t,e,r,n,a,i){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),Ne(this,void 0,void 0,(function(){var o,s,u,l,f,d,p;return Re(this,(function(v){switch(v.label){case 0:return o=F(t,"boxes","nonMaxSuppressionAsync"),s=F(e,"scores","nonMaxSuppressionAsync"),u=Cm(o,s,r,n,a,i),r=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=v.sent(),f=l[0],d=l[1],p=IS(f,d,r,n,a,i),o!==t&&o.dispose(),s!==e&&s.dispose(),[2,p]}}))}))},Lfe=J({cropAndResize_:function(t,e,r,n,a,i){var o=F(t,"image","cropAndResize"),s=F(e,"boxes","cropAndResize","float32"),u=F(r,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var l=s.shape[0];return U(o.rank===4,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."})),U(s.rank===2&&s.shape[1]===4,(function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."})),U(u.rank===1&&u.shape[0]===l,(function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."})),U(n.length===2,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+n.length+"."})),U(n[0]>=1&&n[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+n})),U(a==="bilinear"||a==="nearest",(function(){return"method must be bilinear or nearest, but was "+a})),ee.runKernelFunc((function(f,d){return f.cropAndResize(o,s,u,n,a,i)}),{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:n})}}),GS=Object.freeze({resizeBilinear:Rfe,resizeNearestNeighbor:Ife,nonMaxSuppression:jfe,nonMaxSuppressionAsync:Dfe,nonMaxSuppressionWithScore:Mfe,nonMaxSuppressionWithScoreAsync:Ffe,cropAndResize:Lfe}),KS=function(t,e){return!(t>0)||e==="linear"},XS=function(t,e,r){if(r==null||r==="linear")return t;if(r==="relu")return t.mul(e.step());throw new Error("Gradient for activation "+r+" has not been implemented yet.")},YS=function(t,e){var r=e,n=dr(t.shape,e.shape);return n.length>0&&(r=r.sum(n)),r.reshape(t.shape)},JS=function(t,e,r){if(e==="linear")return t;if(e==="relu")return Lt(t);if(e==="elu")return uB(t);if(e==="relu6")return cB(t);if(e==="prelu")return lB(t,r);throw new Error("Unknown fused activation "+e+".")},Bfe=J({fusedMatMul_:function(t){var e,r=t.a,n=t.b,a=t.transposeA,i=a!==void 0&&a,o=t.transposeB,s=o!==void 0&&o,u=t.bias,l=t.activation,f=l===void 0?"linear":l,d=t.preluActivationWeights;if(KS(ee.state.gradientDepth,f)===!1){var p=Sm(r,n,i,s);return u!=null&&(p=it(p,u)),JS(p,f,d)}var v=F(r,"a","fused matMul"),g=F(n,"b","fused matMul");e=$t(v,g),v=e[0],g=e[1];var b=i?v.shape[v.rank-2]:v.shape[v.rank-1],y=s?g.shape[g.rank-1]:g.shape[g.rank-2],x=i?v.shape[v.rank-1]:v.shape[v.rank-2],S=s?g.shape[g.rank-2]:g.shape[g.rank-1],E=v.shape.slice(0,-2),C=g.shape.slice(0,-2),k=je(E),A=je(C);U(v.rank>=2&&g.rank>=2&&v.rank===g.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+v.rank+" and "+g.rank+"."})),U(wr(E,C),(function(){return"Error in fused matMul: outer dimensions ("+E+") and ("+C+") of Tensors with shapes "+v.shape+" and "+g.shape+" must match."})),U(b===y,(function(){return"Error in fused matMul: inner shapes ("+b+") and ("+y+") of Tensors with shapes "+v.shape+" and "+g.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var T,N,R=v.shape.slice(0,-2).concat([x,S]),I=i?v.as3D(k,b,x):v.as3D(k,x,b),D=s?g.as3D(A,S,y):g.as3D(A,y,S);u!=null&&ot(R,(T=$t(T=F(u,"bias","fused matMul"),v)[0]).shape),d!=null&&(N=F(d,"prelu weights","fused matMul"));var j={a:I,b:D};u!=null&&(j.bias=T),d!=null&&(j.preluActivationWeights=N);var $=[I,D];return ee.runKernelFunc((function(W,q){var X=W.fusedBatchMatMul({a:I,b:D,transposeA:i,transposeB:s,bias:T,activation:f,preluActivationWeights:N});return q([I,D,X]),X}),j,(function(W,q){var X=q[0],Y=q[1],z=q[2],B=XS(W,z,f),G={};return u!=null&&(G={bias:function(){return YS(T,B)}}),Object.assign(i||s?!i&&s?{a:function(){return B.matMul(Y,!1,!1)},b:function(){return B.matMul(X,!0,!1)}}:i&&!s?{a:function(){return Y.matMul(B,!1,!0)},b:function(){return X.matMul(B,!1,!1)}}:{a:function(){return Y.matMul(B,!0,!0)},b:function(){return B.matMul(X,!0,!0)}}:{a:function(){return B.matMul(Y,!1,!0)},b:function(){return X.matMul(B,!0,!1)}},G)}),"_FusedMatMul",{transposeA:i,transposeB:s,activation:f},$,[!0]).reshape(R)}}),$fe=J({fusedConv2d_:function(t){var e=t.x,r=t.filter,n=t.strides,a=t.pad,i=t.dataFormat,o=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,l=t.dimRoundingMode,f=t.bias,d=t.activation,p=d===void 0?"linear":d,v=t.preluActivationWeights;if(p=p||"linear",KS(ee.state.gradientDepth,p)===!1){var g=Kn(e,r,n,a,o,u,l);return f!=null&&(g=it(g,f)),JS(g,p,v)}var b=F(e,"x","conv2d"),y=F(r,"filter","conv2d"),x=b,S=!1;b.rank===3&&(S=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),U(x.rank===4,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+x.rank+"."})),U(y.rank===4,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+y.rank+"."})),l!=null&&U(Xt(a),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+a+"."})),U(x.shape[3]===y.shape[2],(function(){return"Error in conv2d: depth of input ("+x.shape[3]+") must match input depth for filter "+y.shape[2]+"."})),U(hn(n,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+u+"'"})),U(o==="NHWC",(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var E,C,k=_s(x.shape,y.shape,n,u,a,l);f!=null&&(E=$t(E=F(f,"bias","fused conv2d"),b)[0],ot(k.outShape,E.shape)),v!=null&&(C=F(v,"prelu weights","fused conv2d"));var A={x,filter:y};f!=null&&(A.bias=E),v!=null&&(A.preluActivationWeights=C);var T=[y,x],N=ee.runKernelFunc((function(R,I){var D=R.fusedConv2d({input:x,filter:y,convInfo:k,bias:E,activation:p,preluActivationWeights:C});return I([y,x,D]),D}),A,(function(R,I){var D=I,j=D[0],$=D[1],W=D[2],q=XS(R,W,p);U(vl(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var X={};return f!=null&&(X={bias:function(){return YS(E,q)}}),Object.assign({x:function(){return eB($.shape,q,j,n,a)},filter:function(){return US($,q,j.shape,n,a)}},X)}),"FusedConv2D",{convInfo:k,activation:p},T,[!0]);return S?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),Ufe=J({fusedDepthwiseConv2d_:function(t){var e=t.x,r=t.filter,n=t.strides,a=t.pad,i=t.dataFormat,o=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,l=t.dimRoundingMode,f=t.bias,d=t.activation,p=d===void 0?"linear":d,v=t.preluActivationWeights;if(KS(ee.state.gradientDepth,p)===!1){var g=_m(e,r,n,a,o,u,l);return f!=null&&(g=it(g,f)),JS(g,p,v)}var b=F(e,"x","depthwiseConv2d"),y=F(r,"filter","depthwiseConv2d"),x=b,S=!1;b.rank===3&&(S=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),U(x.rank===4,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+x.rank+"."})),U(y.rank===4,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+y.rank+"."})),U(x.shape[3]===y.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+x.shape[3]+") must match the inChannels dimension in filter "+y.shape[2]+"."})),u==null&&(u=[1,1]),U(hn(n,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+u+"'"})),l!=null&&U(Xt(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+a+"."}));var E,C,k=_s(x.shape,y.shape,n,u,a,l,!0);f!=null&&(E=$t(E=F(f,"bias","fused conv2d"),b)[0],ot(k.outShape,E.shape)),v!=null&&(C=F(v,"prelu weights","fused depthwiseConv2d"));var A={x,filter:y};f!=null&&(A.bias=E),v!=null&&(A.preluActivationWeights=C);var T=[y,x],N=ee.runKernelFunc((function(R,I){var D=R.fusedDepthwiseConv2D({input:x,filter:y,convInfo:k,bias:E,activation:p,preluActivationWeights:C});return I([y,x,D]),D}),A,(function(R,I){U(vl(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var D=I[0],j=I[1],$=I[2],W=XS(R,$,p),q={};return f!=null&&(q={bias:function(){return YS(E,W)}}),Object.assign({x:function(){return tB(j.shape,W,D,k)},filter:function(){return rB(j,W,D.shape,k)}},q)}),"FusedDepthwiseConv2D",{convInfo:k,activation:p},T,[!0]);return S?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),Wfe=Object.freeze({matMul:Bfe,conv2d:$fe,depthwiseConv2d:Ufe}),zfe=Object.freeze({image:GS,linalg:Nfe,losses:Afe,spectral:dfe,fused:Wfe,signal:gfe,square:Sle,squaredDifference:LL,conv1d:Rce,conv2d:Kn,conv3d:Ice,depthwiseConv2d:_m,separableConv2d:WS,conv2dTranspose:jce,conv3dTranspose:Dce,op:J,batchNormalization2d:Zle,batchNormalization3d:ece,batchNormalization4d:tce,batchNormalization:rce,batchNorm:qL,batchNorm2d:nce,batchNorm3d:ace,batchNorm4d:ice,booleanMaskAsync:Nce,complex:Pr,real:Un,imag:Aa,concat:cr,concat1d:Woe,concat2d:zoe,concat3d:qoe,concat4d:Voe,split:OS,matMul:Sm,dot:Mce,outerProduct:Fce,reverse:ld,reverse1d:Lce,reverse2d:Bce,reverse3d:$ce,reverse4d:Uce,maxPool:br,avgPool:cd,pool:Wce,maxPool3d:zce,avgPool3d:qce,slice:La,slice1d:Vce,slice2d:Hce,slice3d:iB,slice4d:Gce,abs:Ele,acos:Cle,acosh:kle,asin:Ale,asinh:Ole,atan:Tle,atanh:Ple,ceil:Nle,clipByValue:LS,cos:Rle,cosh:Ile,erf:jle,exp:n2,expm1:Dle,floor:Mle,log:Fle,log1p:Lle,logSigmoid:Ble,neg:Cv,reciprocal:$le,round:Ule,rsqrt:BL,sigmoid:$L,sign:Wle,isNaN:zle,isInf:qle,isFinite:Vle,sin:Hle,sinh:Gle,softplus:Kle,sqrt:Xle,step:Yle,tan:Jle,tanh:Qle,all:Kce,any:Xce,argMax:Yce,argMin:Jce,logSumExp:Qce,max:Em,mean:Zce,min:efe,moments:tfe,sum:sB,prod:rfe,equal:XL,equalStrict:wce,greater:_ce,greaterEqual:YL,greaterEqualStrict:Sce,greaterStrict:Ece,less:Cce,lessEqual:kce,lessEqualStrict:Ace,lessStrict:Oce,notEqual:Tce,notEqualStrict:Pce,add:it,addN:uce,addStrict:lce,atan2:cce,div:ua,divNoNan:fce,divStrict:dce,floorDiv:GL,maximum:BS,maximumStrict:hce,minimum:KL,minimumStrict:pce,mod:vce,modStrict:mce,mul:Kr,mulStrict:gce,pow:kv,powStrict:yce,squaredDifferenceStrict:bce,sub:hr,subStrict:xce,elu:uB,leakyRelu:nfe,prelu:lB,relu:Lt,relu6:cB,selu:afe,logicalAnd:wm,logicalNot:oce,logicalOr:VL,logicalXor:sce,where:ds,whereAsync:HL,buffer:Ze,print:ese,batchToSpaceND:sL,broadcastTo:tse,cast:rse,clone:nse,cumsum:ase,depthToSpace:ise,expandDims:$n,eye:uL,multinomial:ose,oneHot:Z_,pad:ws,pad1d:sse,pad2d:use,pad3d:lse,pad4d:cse,rand:fse,randomNormal:dse,randomGamma:hse,randomUniform:lL,reshape:fa,spaceToBatchND:cL,squeeze:fL,stack:Tn,tile:Nu,truncatedNormal:pse,unstack:fr,setdiff1dAsync:vse,fill:Da,linspace:Uoe,ones:Nl,range:gv,scalar:Ee,tensor:Rr,tensor1d:er,tensor2d:io,tensor3d:AS,tensor4d:un,tensor5d:Loe,tensor6d:Boe,variable:$oe,zeros:Ot,onesLike:oL,zerosLike:ut,transpose:lo,softmax:xi,logSoftmax:_se,localResponseNormalization:ife,norm:fB,gather:$S,unsortedSegmentSum:JL,basicLSTMCell:ofe,multiRNNCell:sfe,movingAverage:ufe,stridedSlice:lfe,topk:cfe,scatterND:ffe,fft:zS,ifft:Av,rfft:qS,irfft:dB,sparseToDense:hfe,gatherND:pfe,diag:vfe,dropout:mfe,hannWindow:VS,hammingWindow:pB,frame:HS,stft:vB,inTopKAsync:yfe});function de(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(r){r!=null&&U(r.dtype!=="complex64",(function(){return e+" does not support complex64 tensors."}))}))}function Qw(t,e,r,n){if(r==="linear")return t.linear(e);if(r==="relu")return t.relu(e);if(r==="elu")return t.elu(e);if(r==="relu6")return t.relu6(e);if(r==="prelu")return t.prelu(e,n);throw new Error("Activation "+r+" has not been implemented for the CPU backend.")}var qfe=(function(t){function e(){var r=t.call(this)||this;return r.blockSize=48,r.firstUse=!0,r.data=new yL(r,ee),r}return va(e,t),e.prototype.write=function(r,n,a){this.firstUse&&(this.firstUse=!1,ce().get("IS_NODE")&&vv(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:r,dtype:a}),i},e.prototype.move=function(r,n,a,i){this.data.set(r,{values:n,dtype:i})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(r){return Ne(this,void 0,void 0,(function(){return Re(this,(function(n){return[2,this.readSync(r)]}))}))},e.prototype.readSync=function(r){var n=this.data.get(r),a=n.dtype,i=n.complexTensors;return a==="complex64"?r2(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(r).values},e.prototype.bufferSync=function(r){var n=this.readSync(r.dataId),a=n;if(r.dtype==="string")try{a=n.map((function(i){return dv(i)}))}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ze(r.shape,r.dtype,a)},e.prototype.makeOutput=function(r,n,a){var i=this.write(r,n,a);return ee.makeTensorFromDataId(i,n,a,this)},e.prototype.disposeData=function(r){if(this.data.has(r)){var n=this.data.get(r).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.data.delete(r)}},e.prototype.time=function(r){return Ne(this,void 0,void 0,(function(){var n;return Re(this,(function(a){return n=Ca(),r(),[2,{kernelMs:Ca()-n}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(r,n){var a=this.makeOutput(null,r.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:ee.keep(r.clone()),imag:ee.keep(n.clone())},a},e.prototype.real=function(r){return this.data.get(r.dataId).complexTensors.real.clone()},e.prototype.imag=function(r){return this.data.get(r.dataId).complexTensors.imag.clone()},e.prototype.slice=function(r,n,a){if(de(r,"slice"),mL(r.shape,n,a)){var i=gL(n,r.strides),o=je(a);return Rr(this.readSync(r.dataId).subarray(i,i+o),a,r.dtype)}for(var s=Ze(a,r.dtype),u=this.bufferSync(r),l=0;l<s.size;++l){var f=s.indexToLoc(l).map((function(d,p){return d+n[p]}));s.values[l]=u.get.apply(u,f)}return s.toTensor()},e.prototype.stridedSlice=function(r,n,a,i){de(r,"stridedSlice");var o=PS(n,a,i);if(o.some((function(v){return v===0})))return Rr([],o);for(var s=Ze(o,r.dtype),u=this.bufferSync(r),l=0;l<s.size;l++){for(var f=s.indexToLoc(l),d=new Array(f.length),p=0;p<d.length;p++)d[p]=f[p]*i[p]+n[p];s.set.apply(s,[u.get.apply(u,d)].concat(f))}return s.toTensor()},e.prototype.diag=function(r){for(var n=this.readSync(r.dataId),a=Ze([r.size,r.size],r.dtype),i=a.values,o=0;o<n.length;o++)i[o*r.size+o]=n[o];return a.toTensor()},e.prototype.unstack=function(r,n){for(var a=r.shape[n],i=new Array(r.rank-1),o=0,s=0;s<r.rank;s++)s!==n&&(i[o++]=r.shape[s]);var u=new Array(r.rank).fill(0),l=r.shape.slice();l[n]=1;var f=new Array(a);for(s=0;s<f.length;s++)u[n]=s,f[s]=this.slice(r,u,l).reshape(i);return f},e.prototype.reverse=function(r,n){de(r,"reverse");for(var a=Ze(r.shape,r.dtype),i=this.bufferSync(r),o=function(u){var l=a.indexToLoc(u),f=l.slice();n.forEach((function(d){return f[d]=r.shape[d]-1-f[d]})),a.set.apply(a,[i.get.apply(i,f)].concat(l))},s=0;s<a.size;s++)o(s);return a.toTensor()},e.prototype.concat=function(r,n){var a=this;if(r[0].dtype==="complex64"){var i=r.map((function(v){return Un(v)})),o=r.map((function(v){return Aa(v)}));return Pr(this.concat(i,n),this.concat(o,n))}var s=r.map((function(v){var g=je(v.shape.slice(n));return v.as2D(-1,g)})),u=pl(s.map((function(v){return v.shape})),1),l=Ze(u,r[0].dtype).values;if(s[0].shape[0]===1){var f=0;s.forEach((function(v){l.set(a.readSync(v.dataId),f),f+=v.size}))}else{var d=0;s.forEach((function(v){for(var g=a.readSync(v.dataId),b=0,y=0;y<v.shape[0];++y)for(var x=y*u[1]+d,S=0;S<v.shape[1];++S)l[x+S]=g[b++];d+=v.shape[1]}))}var p=pl(r.map((function(v){return v.shape})),n);return Rr(l,p,r[0].dtype)},e.prototype.neg=function(r){return de(r,"neg"),this.multiply(Ee(-1),r)},e.prototype.add=function(r,n){return r.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(r.cast("complex64"),n.cast("complex64"),(function(a,i,o,s){return{real:a+o,imag:i+s}})):this.broadcastedBinaryOp(r,n,Nr(r.dtype,n.dtype),(function(a,i){return a+i}))},e.prototype.addN=function(r){var n=this;de(r,"addN");for(var a=r.map((function(f){return n.readSync(f.dataId)})),i=Ze(r[0].shape,r[0].dtype),o=i.values,s=0;s<r.length;s++)for(var u=a[s],l=0;l<o.length;l++)o[l]+=u[l];return i.toTensor()},e.prototype.softmax=function(r,n){var a=vr([n],r.shape),i=this.max(r,a),o=dn(i.shape,a),s=this.subtract(r,i.reshape(o)),u=this.exp(s),l=this.sum(u,a).reshape(o);return this.realDivide(u,l)},e.prototype.subtract=function(r,n){return r.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(r.cast("complex64"),n.cast("complex64"),(function(a,i,o,s){return{real:a-o,imag:i-s}})):this.broadcastedBinaryOp(r,n,Nr(r.dtype,n.dtype),(function(a,i){return a-i}))},e.prototype.pow=function(r,n){return de([r,n],"pow"),this.broadcastedBinaryOp(r,n,r.dtype,(function(a,i){return Math.pow(a,i)}))},e.prototype.batchMatMul=function(r,n,a,i){de([r,n],"matMul");for(var o=a?r.shape[1]:r.shape[2],s=a?r.shape[2]:r.shape[1],u=i?n.shape[1]:n.shape[2],l=r.shape[0],f=this.readSync(r.dataId),d=this.readSync(n.dataId),p=a?[r.strides[0],1,r.strides[1]]:[r.strides[0],r.strides[1],1],v=p[0],g=p[1],b=p[2],y=i?[1,n.strides[1],n.strides[0]]:[n.strides[1],1,n.strides[0]],x=y[0],S=y[1],E=y[2],C=s*u,k=Ze([l,s,u],r.dtype),A=k.values,T=this.blockSize,N=0;N<l;N++)for(var R=0;R<s;R+=T)for(var I=0;I<u;I+=T)for(var D=0;D<o;D+=T)for(var j=Math.min(R+T,s),$=Math.min(I+T,u),W=Math.min(D+T,o),q=R;q<j;q++)for(var X=I;X<$;X++){for(var Y=0,z=D;z<W;z++)Y+=f[N*v+q*g+z*b]*d[z*x+X*S+N*E];A[N*C+(q*u+X)]+=Y}return k.toTensor()},e.prototype.fusedBatchMatMul=function(r){var n=r.a,a=r.b,i=r.transposeA,o=r.transposeB,s=r.bias,u=r.activation,l=r.preluActivationWeights,f=this.batchMatMul(n,a,i,o);return s&&(f=this.add(f,s)),u&&(f=Qw(this,f,u,l)),f},e.prototype.multiply=function(r,n){return r.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(r.cast("complex64"),n.cast("complex64"),(function(a,i,o,s){return{real:a*o-i*s,imag:a*s+i*o}})):this.broadcastedBinaryOp(r,n,Nr(r.dtype,n.dtype),(function(a,i){return a*i}))},e.prototype.realDivide=function(r,n){return de([r,n],"realDivide"),this.broadcastedBinaryOp(r,n,"float32",(function(a,i){return a/i}))},e.prototype.floorDiv=function(r,n){return de([r,n],"floorDiv"),this.broadcastedBinaryOp(r,n,"int32",(function(a,i){return Math.floor(a/i)}))},e.prototype.sum=function(r,n){de(r,"sum"),Sn("sum",n,r.rank);for(var a=Wr(r.shape,n),i=a[0],o=a[1],s=Ot(i,Nr(r.dtype,"int32")),u=je(o),l=this.readSync(s.dataId),f=this.readSync(r.dataId),d=0;d<l.length;++d){for(var p=d*u,v=0,g=0;g<u;++g)v+=f[p+g];l[d]=v}return s},e.prototype.prod=function(r,n){de(r,"sum");for(var a=Wr(r.shape,n),i=a[0],o=a[1],s=Ot(i,Nr(r.dtype,"int32")),u=je(o),l=this.readSync(s.dataId),f=this.readSync(r.dataId),d=0;d<l.length;++d){for(var p=d*u,v=1,g=0;g<u;++g)v*=f[p+g];l[d]=v}return s},e.prototype.unsortedSegmentSum=function(r,n,a){de(r,"unsortedSegmentSum");for(var i=[],o=r.rank-n.rank,s=0;s<o;++s)n=n.expandDims(s+1);for(s=0;s<a;++s){var u=Ee(s,"int32"),l=XL(u,n).asType("float32").mul(r).sum(0);i.push(l)}return Tn(i)},e.prototype.argMin=function(r,n){de(r,"argMin");var a=[n];Sn("argMin",a,r.rank);for(var i=Wr(r.shape,a),o=i[0],s=i[1],u=Ot(o,"int32"),l=je(s),f=this.readSync(u.dataId),d=this.readSync(r.dataId),p=0;p<f.length;++p){for(var v=p*l,g=d[v],b=0,y=0;y<l;++y){var x=d[v+y];x<g&&(g=x,b=y)}f[p]=b}return u},e.prototype.argMax=function(r,n){de(r,"argMax");var a=[n];Sn("argMax",a,r.rank);for(var i=Wr(r.shape,a),o=i[0],s=i[1],u=Ot(o,"int32"),l=je(s),f=this.readSync(u.dataId),d=this.readSync(r.dataId),p=0;p<f.length;++p){for(var v=p*l,g=d[v],b=0,y=0;y<l;++y){var x=d[v+y];x>g&&(g=x,b=y)}f[p]=b}return u},e.prototype.cumsum=function(r,n,a,i){if(de(r,"cumsum"),n!==r.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(r.rank-1)+" but got axis="+n);for(var o=Nr(r.dtype,"int32"),s=Ot(r.shape,o),u=this.readSync(s.dataId),l=this.readSync(r.dataId),f=r.shape[r.rank-1],d=i?function(y,x){return y+f-x-1}:function(y,x){return y+x},p=0;p<l.length;p+=f)for(var v=0;v<f;v++){var g=d(p,v);if(v===0)u[g]=a?0:l[g];else{var b=d(p,v-1);u[g]=a?l[b]+u[b]:l[g]+u[b]}}return s},e.prototype.equal=function(r,n){return de([r,n],"equal"),this.broadcastedBinaryOp(r,n,"bool",(function(a,i){return a===i?1:0}))},e.prototype.notEqual=function(r,n){return de([r,n],"notEqual"),this.broadcastedBinaryOp(r,n,"bool",(function(a,i){return a!==i?1:0}))},e.prototype.less=function(r,n){return de([r,n],"less"),this.broadcastedBinaryOp(r,n,"bool",(function(a,i){return a<i?1:0}))},e.prototype.lessEqual=function(r,n){return de([r,n],"lessEqual"),this.broadcastedBinaryOp(r,n,"bool",(function(a,i){return a<=i?1:0}))},e.prototype.greater=function(r,n){return de([r,n],"greater"),this.broadcastedBinaryOp(r,n,"bool",(function(a,i){return a>i?1:0}))},e.prototype.greaterEqual=function(r,n){return de([r,n],"greaterEqual"),this.broadcastedBinaryOp(r,n,"bool",(function(a,i){return a>=i?1:0}))},e.prototype.logicalNot=function(r){de(r,"logicalNot");for(var n=this.readSync(r.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)a[i]=n[i]?0:1;return this.makeOutput(a,r.shape,"bool")},e.prototype.logicalAnd=function(r,n){return de([r,n],"logicalAnd"),this.broadcastedBinaryOp(r,n,"bool",(function(a,i){return a&&i}))},e.prototype.logicalOr=function(r,n){return de([r,n],"logicalOr"),this.broadcastedBinaryOp(r,n,"bool",(function(a,i){return a||i}))},e.prototype.select=function(r,n,a){de([r,n,a],"select");for(var i=this.readSync(r.dataId),o=this.readSync(n.dataId),s=this.readSync(a.dataId),u=Ot(n.shape,Nr(n.dtype,a.dtype)),l=this.readSync(u.dataId),f=0,d=r.rank===0||r.rank>1||n.rank===1?1:je(n.shape.slice(1)),p=0;p<i.length;p++)for(var v=0;v<d;v++)i[p]===1?l[f++]=o[p]:l[f++]=s[p];return u},e.prototype.where=function(r){de([r],"where");var n=this.readSync(r.dataId);return jS(r.shape,n)},e.prototype.topk=function(r,n,a){return de(r,"topk"),kL(this.readSync(r.dataId),r.shape,r.dtype,n)},e.prototype.min=function(r,n){de(r,"min"),Sn("min",n,r.rank);for(var a=Wr(r.shape,n),i=a[0],o=a[1],s=Ot(i,r.dtype),u=je(o),l=this.readSync(s.dataId),f=this.readSync(r.dataId),d=0;d<l.length;++d){for(var p=d*u,v=f[p],g=0;g<u;++g){var b=f[p+g];b<v&&(v=b)}l[d]=v}return s},e.prototype.minimum=function(r,n){return de([r,n],"minimum"),this.broadcastedBinaryOp(r,n,r.dtype,(function(a,i){return Math.min(a,i)}))},e.prototype.mod=function(r,n){return de([r,n],"mod"),this.broadcastedBinaryOp(r,n,r.dtype,(function(a,i){var o=a%i;return a<0&&i<0||a>=0&&i>=0?o:(o+i)%i}))},e.prototype.max=function(r,n){de(r,"max"),Sn("max",n,r.rank);for(var a=Wr(r.shape,n),i=a[0],o=a[1],s=Ot(i,r.dtype),u=je(o),l=this.readSync(s.dataId),f=this.readSync(r.dataId),d=0;d<l.length;++d){for(var p=d*u,v=f[p],g=0;g<u;++g){var b=f[p+g];b>v&&(v=b)}l[d]=v}return s},e.prototype.maximum=function(r,n){return de([r,n],"maximum"),this.broadcastedBinaryOp(r,n,r.dtype,(function(a,i){return Math.max(a,i)}))},e.prototype.all=function(r,n){de(r,"all"),Sn("all",n,r.rank);for(var a=Wr(r.shape,n),i=a[0],o=a[1],s=Ot(i,r.dtype),u=je(o),l=this.readSync(s.dataId),f=this.readSync(r.dataId),d=0;d<l.length;++d){for(var p=d*u,v=f[p],g=0;g<u;++g){var b=f[p+g];v=v&&b}l[d]=v}return s},e.prototype.any=function(r,n){de(r,"any"),Sn("any",n,r.rank);for(var a=Wr(r.shape,n),i=a[0],o=a[1],s=Ot(i,r.dtype),u=je(o),l=this.readSync(s.dataId),f=this.readSync(r.dataId),d=0;d<l.length;++d){for(var p=d*u,v=f[p],g=0;g<u;++g){var b=f[p+g];v=v||b}l[d]=v}return s},e.prototype.squaredDifference=function(r,n){return de([r,n],"squaredDifference"),this.broadcastedBinaryOp(r,n,r.dtype,(function(a,i){var o=a-i;return o*o}))},e.prototype.ceil=function(r){de(r,"ceil");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.ceil(n[i]);return this.makeOutput(a,r.shape,"float32")},e.prototype.floor=function(r){de(r,"floor");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.floor(n[i]);return this.makeOutput(a,r.shape,"float32")},e.prototype.sign=function(r){de(r,"x");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)n[i]<0?a[i]=-1:n[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,r.shape,"float32")},e.prototype.isNaN=function(r){de(r,"x");for(var n=this.readSync(r.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isNaN(n[i])&&(a[i]=1);return this.makeOutput(a,r.shape,"bool")},e.prototype.isInf=function(r){de(r,"x");for(var n=this.readSync(r.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Math.abs(n[i])===1/0&&(a[i]=1);return this.makeOutput(a,r.shape,"bool")},e.prototype.isFinite=function(r){de(r,"x");for(var n=this.readSync(r.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isFinite(n[i])&&(a[i]=1);return this.makeOutput(a,r.shape,"bool")},e.prototype.round=function(r){de(r,"round");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=Math.floor(n[i]);n[i]-o<.5?a[i]=Math.floor(n[i]):n[i]-o>.5?a[i]=Math.ceil(n[i]):a[i]=o%2==0?o:o+1}return this.makeOutput(a,r.shape,"float32")},e.prototype.exp=function(r){de(r,"exp");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.exp(n[i]);return this.makeOutput(a,r.shape,"float32")},e.prototype.expm1=function(r){de(r,"expm1");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.expm1(n[i]);return this.makeOutput(a,r.shape,"float32")},e.prototype.log=function(r){de(r,"log");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=n[i];a[i]=Math.log(o)}return this.makeOutput(a,r.shape,"float32")},e.prototype.log1p=function(r){de(r,"log1p");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=n[i];a[i]=Math.log1p(o)}return this.makeOutput(a,r.shape,"float32")},e.prototype.sqrt=function(r){de(r,"sqrt");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=n[i];a[i]=Math.sqrt(o)}return this.makeOutput(a,r.shape,"float32")},e.prototype.rsqrt=function(r){de(r,"rsqrt");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var o=n[i];a[i]=1/Math.sqrt(o)}return this.makeOutput(a,r.shape,"float32")},e.prototype.reciprocal=function(r){de(r,"reciprocal");for(var n=this.readSync(r.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=1/n[i];return this.makeOutput(a,r.shape,"float32")},e.prototype.linear=function(r){return r},e.prototype.relu=function(r){de(r,"relu");for(var n=Ot(r.shape,r.dtype),a=this.readSync(n.dataId),i=this.readSync(r.dataId),o=0;o<i.length;++o)a[o]=Math.max(0,i[o]);return n},e.prototype.relu6=function(r){de(r,"relu");for(var n=Ot(r.shape,r.dtype),a=this.readSync(n.dataId),i=this.readSync(r.dataId),o=0;o<i.length;++o)a[o]=Math.min(Math.max(0,i[o]),6);return n},e.prototype.prelu=function(r,n){return de([r,n],"prelu"),this.broadcastedBinaryOp(r,n,r.dtype,(function(a,i){return a<0?i*a:a}))},e.prototype.elu=function(r){de(r,"elu");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i){var o=a[i];n[i]=o>=0?o:Math.exp(o)-1}return this.makeOutput(n,r.shape,"float32")},e.prototype.eluDer=function(r,n){de([r,n],"eluDer");for(var a=new Float32Array(n.size),i=this.readSync(n.dataId),o=this.readSync(r.dataId),s=0;s<i.length;++s){var u=i[s];a[s]=u>=1?o[s]:o[s]*(u+1)}return this.makeOutput(a,n.shape,"float32")},e.prototype.selu=function(r){de(r,"selu");for(var n=MS,a=FS,i=new Float32Array(r.size),o=this.readSync(r.dataId),s=0;s<o.length;++s){var u=o[s];i[s]=u>=0?a*u:n*(Math.exp(u)-1)}return this.makeOutput(i,r.shape,"float32")},e.prototype.clip=function(r,n,a){de(r,"clip");for(var i=new Float32Array(r.size),o=this.readSync(r.dataId),s=0;s<o.length;++s){var u=o[s];i[s]=u>a?a:u<n?n:u}return this.makeOutput(i,r.shape,"float32")},e.prototype.abs=function(r){for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.abs(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.complexAbs=function(r){for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<r.size;++i){var o=a[2*i],s=a[2*i+1];n[i]=Math.hypot(o,s)}return this.makeOutput(n,r.shape,"float32")},e.prototype.int=function(r){de(r,"int");for(var n=new Int32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=a[i];return this.makeOutput(n,r.shape,"int32")},e.prototype.sigmoid=function(r){de(r,"sigmoid");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(n,r.shape,"float32")},e.prototype.softplus=function(r){de(r,"softplus");for(var n=Math.log(11920928955078125e-23)+2,a=new Float32Array(r.size),i=this.readSync(r.dataId),o=0;o<i.length;++o){var s=i[o]>-n,u=i[o]<n,l=Math.exp(i[o]),f=void 0;f=u?l:s?i[o]:Math.log(1+l),a[o]=f}return this.makeOutput(a,r.shape,"float32")},e.prototype.sin=function(r){de(r,"sin");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.sin(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.cos=function(r){de(r,"cos");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.cos(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.tan=function(r){de(r,"tan");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.tan(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.asin=function(r){de(r,"asin");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.asin(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.acos=function(r){de(r,"acos");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.acos(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.atan=function(r){de(r,"atan");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.atan(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.atan2=function(r,n){return de([r,n],"atan2"),this.broadcastedBinaryOp(r,n,r.dtype,(function(a,i){return Math.atan2(a,i)}))},e.prototype.sinh=function(r){de(r,"sinh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.sinh(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.cosh=function(r){de(r,"cosh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.cosh(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.tanh=function(r){de(r,"tanh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Vie(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.asinh=function(r){de(r,"asinh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.asinh(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.acosh=function(r){de(r,"acosh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.acosh(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.atanh=function(r){de(r,"atanh");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i)n[i]=Math.atanh(a[i]);return this.makeOutput(n,r.shape,"float32")},e.prototype.erf=function(r){de(r,"erf");for(var n=new Float32Array(r.size),a=this.readSync(r.dataId),i=0;i<a.length;++i){var o=Math.sign(a[i]),s=Math.abs(a[i]),u=1/(1+.3275911*s);n[i]=o*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(n,r.shape,"float32")},e.prototype.step=function(r,n){n===void 0&&(n=0),de(r,"step");for(var a=new Float32Array(r.size),i=this.readSync(r.dataId),o=0;o<i.length;++o){var s=i[o];isNaN(s)?a[o]=NaN:a[o]=s>0?1:n}return this.makeOutput(a,r.shape,"float32")},e.prototype.fusedConv2d=function(r){var n=r.input,a=r.filter,i=r.convInfo,o=r.bias,s=r.activation,u=r.preluActivationWeights,l=this.conv2d(n,a,i);return o&&(l=this.add(l,o)),s&&(l=Qw(this,l,s,u)),l},e.prototype.conv2d=function(r,n,a){de([r,n],"conv2d");for(var i=a.filterHeight,o=a.filterWidth,s=a.dilationHeight,u=a.dilationWidth,l=a.padInfo.left,f=a.padInfo.top,d=a.dataFormat==="channelsLast",p=Ze(a.outShape,r.dtype),v=r.strides[0],g=d?r.strides[1]:r.strides[2],b=d?r.strides[2]:1,y=d?1:r.strides[1],x=p.strides[0],S=d?p.strides[1]:p.strides[2],E=d?p.strides[2]:1,C=d?1:p.strides[1],k=this.readSync(r.dataId),A=this.readSync(n.dataId),T=p.values,N=0;N<a.batchSize;++N)for(var R=N*v,I=N*x,D=0;D<a.outHeight;++D)for(var j=I+D*S,$=D*a.strideHeight-f,W=0;W<i;W++){var q=$+W*s;if(!(q<0||q>=a.inHeight))for(var X=W*n.strides[0],Y=R+q*g,z=0;z<a.outWidth;++z)for(var B=j+z*E,G=z*a.strideWidth-l,L=0;L<o;L++){var K=G+L*u;if(!(K<0||K>=a.inWidth))for(var oe=Y+K*b,he=X+L*n.strides[1],ge=0;ge<a.inChannels;++ge){for(var xe=k[oe+ge*y],ke=0;ke<a.outChannels;++ke)T[B+ke*C]+=xe*A[he+ke];he+=a.outChannels}}}return p.toTensor()},e.prototype.conv3d=function(r,n,a){for(var i=a.filterDepth,o=a.filterHeight,s=a.filterWidth,u=a.dilationDepth,l=a.dilationHeight,f=a.dilationWidth,d=a.padInfo.front,p=a.padInfo.left,v=a.padInfo.top,g=Ze(a.outShape,r.dtype),b=this.readSync(r.dataId),y=this.readSync(n.dataId),x=g.values,S=0;S<a.batchSize;++S)for(var E=S*r.strides[0],C=S*g.strides[0],k=0;k<a.outDepth;++k)for(var A=C+k*g.strides[1],T=k*a.strideDepth-d,N=0;N<i;N++){var R=T+N*u;if(!(R<0||R>=a.inDepth))for(var I=N*n.strides[0],D=E+R*r.strides[1],j=0;j<a.outHeight;++j)for(var $=A+j*g.strides[2],W=j*a.strideHeight-v,q=0;q<o;q++){var X=W+q*l;if(!(X<0||X>=a.inHeight))for(var Y=I+q*n.strides[1],z=D+X*r.strides[2],B=0;B<a.outWidth;++B)for(var G=$+B*a.outChannels,L=B*a.strideWidth-p,K=0;K<s;K++){var oe=L+K*f;if(!(oe<0||oe>=a.inWidth))for(var he=Y+K*n.strides[2],ge=z+oe*a.inChannels,xe=he,ke=0;ke<a.inChannels;++ke){for(var we=b[ge+ke],ue=0;ue<a.outChannels;++ue)x[G+ue]+=we*y[xe+ue];xe+=a.outChannels}}}}return g.toTensor()},e.prototype.conv2dDerInput=function(r,n,a){de([r,n],"conv2dDerInput");for(var i=Ze(a.inShape,"float32"),o=i.values,s=this.readSync(r.dataId),u=this.readSync(n.dataId),l=n.strides,f=l[0],d=l[1],p=l[2],v=a.batchSize,g=a.filterHeight,b=a.filterWidth,y=a.inChannels,x=a.inHeight,S=a.inWidth,E=a.outChannels,C=a.outHeight,k=a.outWidth,A=a.strideHeight,T=a.strideWidth,N=a.dataFormat,R=g-1-a.padInfo.top,I=b-1-a.padInfo.left,D=N==="channelsLast",j=i.strides[0],$=D?i.strides[1]:i.strides[2],W=D?i.strides[2]:1,q=D?1:i.strides[1],X=r.strides[0],Y=D?r.strides[1]:r.strides[2],z=D?r.strides[2]:1,B=D?1:r.strides[1],G=0;G<v;++G)for(var L=0;L<y;++L)for(var K=0;K<x;++K)for(var oe=K-R,he=Math.max(0,Math.ceil(oe/A)),ge=Math.min(C,(g+oe)/A),xe=0;xe<S;++xe){for(var ke=xe-I,we=Math.max(0,Math.ceil(ke/T)),ue=Math.min(k,(b+ke)/T),Se=0,_e=he;_e<ge;++_e)for(var le=_e*A-oe,$e=we;$e<ue;++$e)for(var Fe=X*G+Y*_e+z*$e,Xe=f*(g-1-le)+d*(b-1-($e*T-ke))+p*L,Ye=0;Ye<E;++Ye)Se+=s[Fe+B*Ye]*u[Xe+Ye];o[j*G+$*K+W*xe+q*L]=Se}return i.toTensor()},e.prototype.conv3dDerInput=function(r,n,a){for(var i=Ze(a.inShape,"float32"),o=i.values,s=i.strides,u=s[0],l=s[1],f=s[2],d=s[3],p=this.readSync(r.dataId),v=r.strides,g=v[0],b=v[1],y=v[2],x=v[3],S=this.readSync(n.dataId),E=n.strides,C=E[0],k=E[1],A=E[2],T=E[3],N=a.batchSize,R=a.filterDepth,I=a.filterHeight,D=a.filterWidth,j=a.inChannels,$=a.inDepth,W=a.inHeight,q=a.inWidth,X=a.outChannels,Y=a.outDepth,z=a.outHeight,B=a.outWidth,G=a.strideDepth,L=a.strideHeight,K=a.strideWidth,oe=R-1-a.padInfo.front,he=I-1-a.padInfo.top,ge=D-1-a.padInfo.left,xe=0;xe<N;++xe)for(var ke=0;ke<j;++ke)for(var we=0;we<$;++we)for(var ue=we-oe,Se=Math.max(0,Math.ceil(ue/G)),_e=Math.min(Y,(R+ue)/G),le=0;le<W;++le)for(var $e=le-he,Fe=Math.max(0,Math.ceil($e/L)),Xe=Math.min(z,(I+$e)/L),Ye=0;Ye<q;++Ye){for(var mt=Ye-ge,Ut=Math.max(0,Math.ceil(mt/K)),Pt=Math.min(B,(D+mt)/K),Er=0,Nt=Se;Nt<_e;++Nt)for(var Yt=Nt*G-ue,Mr=Fe;Mr<Xe;++Mr)for(var Pn=Mr*L-$e,Xr=Ut;Xr<Pt;++Xr)for(var Cs=g*xe+b*Nt+y*Mr+x*Xr,ga=C*(R-1-Yt)+k*(I-1-Pn)+A*(D-1-(Xr*K-mt))+T*ke,Yr=0;Yr<X;++Yr)Er+=p[Cs+Yr]*S[ga+Yr];o[u*xe+l*we+f*le+d*Ye+ke]=Er}return i.toTensor()},e.prototype.conv2dDerFilter=function(r,n,a){de([r,n],"conv2dDerFilter");for(var i=a.strideHeight,o=a.strideWidth,s=a.filterHeight,u=a.filterWidth,l=a.dataFormat==="channelsLast",f=Ze(a.filterShape,"float32"),d=a.padInfo.left,p=a.padInfo.top,v=this.bufferSync(r),g=this.bufferSync(n),b=0;b<s;++b)for(var y=Math.max(0,Math.ceil((p-b)/i)),x=Math.min(a.outHeight,(a.inHeight+p-b)/i),S=0;S<u;++S)for(var E=Math.max(0,Math.ceil((d-S)/o)),C=Math.min(a.outWidth,(a.inWidth+d-S)/o),k=0;k<a.inChannels;++k)for(var A=0;A<a.outChannels;++A){for(var T=0,N=0;N<a.batchSize;++N)for(var R=y;R<x;++R)for(var I=b+R*i-p,D=E;D<C;++D){var j=S+D*o-d;T+=l?v.get(N,I,j,k)*g.get(N,R,D,A):v.get(N,k,I,j)*g.get(N,A,R,D)}f.set(T,b,S,k,A)}return f.toTensor()},e.prototype.conv3dDerFilter=function(r,n,a){for(var i=a.strideDepth,o=a.strideHeight,s=a.strideWidth,u=a.filterDepth,l=a.filterHeight,f=a.filterWidth,d=Ze(a.filterShape,"float32"),p=d.values,v=d.strides,g=v[0],b=v[1],y=v[2],x=v[3],S=this.readSync(n.dataId),E=n.strides,C=E[0],k=E[1],A=E[2],T=E[3],N=this.readSync(r.dataId),R=r.strides,I=R[0],D=R[1],j=R[2],$=R[3],W=a.padInfo.front,q=a.padInfo.left,X=a.padInfo.top,Y=0;Y<u;++Y)for(var z=Math.max(0,Math.ceil((W-Y)/i)),B=Math.min(a.outDepth,(a.inDepth+W-Y)/i),G=Y*g,L=0;L<l;++L)for(var K=Math.max(0,Math.ceil((X-L)/o)),oe=Math.min(a.outHeight,(a.inHeight+X-L)/o),he=L*b+G,ge=0;ge<f;++ge)for(var xe=Math.max(0,Math.ceil((q-ge)/s)),ke=Math.min(a.outWidth,(a.inWidth+q-ge)/s),we=ge*y+he,ue=0;ue<a.inChannels;++ue)for(var Se=ue*x+we,_e=0;_e<a.outChannels;++_e){for(var le=0,$e=0;$e<a.batchSize;++$e)for(var Fe=$e*I,Xe=$e*C,Ye=z;Ye<B;++Ye)for(var mt=(Y+Ye*i-W)*D+Fe,Ut=Ye*k+Xe,Pt=K;Pt<oe;++Pt)for(var Er=(L+Pt*o-X)*j+mt,Nt=Pt*A+Ut,Yt=xe;Yt<ke;++Yt){var Mr=Yt*T+Nt;le+=N[(ge+Yt*s-q)*$+Er+ue]*S[Mr+_e]}p[Se+_e]=le}return d.toTensor()},e.prototype.fusedDepthwiseConv2D=function(r){var n=r.input,a=r.filter,i=r.convInfo,o=r.bias,s=r.activation,u=r.preluActivationWeights,l=this.depthwiseConv2D(n,a,i);return o&&(l=this.add(l,o)),s&&(l=Qw(this,l,s,u)),l},e.prototype.depthwiseConv2D=function(r,n,a){de([r,n],"depthwiseConv2D");for(var i=a.filterHeight,o=a.filterWidth,s=a.dilationHeight,u=a.dilationWidth,l=a.padInfo.left,f=a.padInfo.top,d=a.outChannels/a.inChannels,p=Ze(a.outShape,r.dtype),v=this.readSync(r.dataId),g=this.readSync(n.dataId),b=p.values,y=0;y<a.batchSize;++y)for(var x=y*r.strides[0],S=y*p.strides[0],E=0;E<a.outHeight;++E)for(var C=S+E*p.strides[1],k=E*a.strideHeight-l,A=0;A<i;++A){var T=k+A*s;if(!(T<0||T>=a.inHeight))for(var N=A*n.strides[0],R=x+T*r.strides[1],I=0;I<a.outWidth;++I)for(var D=C+I*p.strides[2],j=I*a.strideWidth-f,$=0;$<o;++$){var W=j+$*u;if(!(W<0||W>=a.inWidth))for(var q=N+$*n.strides[1],X=R+W*a.inChannels,Y=D,z=q,B=0;B<a.inChannels;++B){for(var G=v[X+B],L=0;L<d;++L)b[Y+L]+=G*g[z+L];Y+=d,z+=d}}}return p.toTensor()},e.prototype.depthwiseConv2DDerInput=function(r,n,a){de([r,n],"depthwiseConv2DDerInput");for(var i=Ze(a.inShape,"float32"),o=i.values,s=i.strides,u=s[0],l=s[1],f=s[2],d=this.readSync(r.dataId),p=r.strides,v=p[0],g=p[1],b=p[2],y=this.readSync(n.dataId),x=n.strides,S=x[0],E=x[1],C=x[2],k=a.batchSize,A=a.filterHeight,T=a.filterWidth,N=a.inChannels,R=a.inHeight,I=a.inWidth,D=a.outChannels,j=a.outHeight,$=a.outWidth,W=a.strideHeight,q=a.strideWidth,X=A-1-a.padInfo.top,Y=T-1-a.padInfo.left,z=D/N,B=0;B<k;++B)for(var G=0;G<N;++G)for(var L=0;L<R;++L)for(var K=L-X,oe=Math.max(0,Math.ceil(K/W)),he=Math.min(j,(A+K)/W),ge=0;ge<I;++ge){for(var xe=ge-Y,ke=Math.max(0,Math.ceil(xe/q)),we=Math.min($,(T+xe)/q),ue=0,Se=oe;Se<he;++Se)for(var _e=Se*W-K,le=ke;le<we;++le)for(var $e=v*B+g*Se+b*le,Fe=S*(A-1-_e)+E*(T-1-(le*q-xe))+C*G,Xe=0;Xe<z;++Xe)ue+=d[$e+(G*z+Xe)]*y[Fe+Xe];o[u*B+l*L+f*ge+G]=ue}return i.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(r,n,a){de([r,n],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,o=a.strideWidth,s=a.filterHeight,u=a.filterWidth,l=Ze(a.filterShape,"float32"),f=a.padInfo.left,d=a.padInfo.top,p=a.outChannels/a.inChannels,v=this.bufferSync(r),g=this.bufferSync(n),b=0;b<s;++b)for(var y=Math.max(0,Math.ceil((d-b)/i)),x=Math.min(a.outHeight,(a.inHeight+d-b)/i),S=0;S<u;++S)for(var E=Math.max(0,Math.ceil((f-S)/o)),C=Math.min(a.outWidth,(a.inWidth+f-S)/o),k=0;k<a.outChannels;++k){for(var A=Math.trunc(k/p),T=k%p,N=0,R=0;R<a.batchSize;++R)for(var I=y;I<x;++I)for(var D=b+I*i-d,j=E;j<C;++j){var $=S+j*o-f;N+=v.get(R,D,$,A)*g.get(R,I,j,k)}l.set(N,b,S,A,T)}return l.toTensor()},e.prototype.tile=function(r,n){return de(r,"tile"),CL(this.bufferSync(r),n)},e.prototype.pad=function(r,n,a){de(r,"pad");var i=n.map((function(p,v){return p[0]+r.shape[v]+p[1]})),o=n.map((function(p){return p[0]})),s=this.bufferSync(r),u=Ze(i,r.dtype);a!==0&&u.values.fill(a);for(var l=0;l<r.size;l++){var f=s.indexToLoc(l),d=f.map((function(p,v){return p+o[v]}));u.set.apply(u,[s.get.apply(s,f)].concat(d))}return u.toTensor()},e.prototype.transpose=function(r,n){de(r,"transpose");for(var a=new Array(r.rank),i=0;i<a.length;i++)a[i]=r.shape[n[i]];var o=this.readSync(r.dataId),s=Ze(a,r.dtype),u=this.bufferSync(r);for(i=0;i<r.size;++i){for(var l=u.indexToLoc(i),f=new Array(l.length),d=0;d<f.length;d++)f[d]=l[n[d]];var p=s.locToIndex(f);s.values[p]=o[i]}return s.toTensor()},e.prototype.gather=function(r,n,a){de([r,n],"gather");var i=r.shape.slice(),o=this.readSync(n.dataId);i[a]=o.length;for(var s=Ze(i,r.dtype),u=this.bufferSync(r),l=0;l<s.size;++l){var f=s.indexToLoc(l),d=f.slice();d[a]=o[f[a]];var p=u.locToIndex(d);s.values[l]=u.values[p]}return s.toTensor()},e.prototype.batchToSpaceND=function(r,n,a){de([r],"batchToSpaceND");var i=n.reduce((function(d,p){return d*p})),o=yv(r.shape,n,i),s=bv(o.length,n.length),u=xv(r.shape,n,i),l=dL(a,n.length),f=hL(u,a,n.length);return r.reshape(o).transpose(s).reshape(u).slice(l,f)},e.prototype.spaceToBatchND=function(r,n,a){de([r],"spaceToBatchND");var i=n.reduce((function(p,v){return p*v})),o=[[0,0]];o.push.apply(o,a);for(var s=1+n.length;s<r.shape.length;++s)o.push([0,0]);var u=r.pad(o),l=yv(u.shape,n,i,!1),f=bv(l.length,n.length,!1),d=xv(u.shape,n,i,!1);return u.reshape(l).transpose(f).reshape(d)},e.prototype.pool=function(r,n,a){de(r,"pool");for(var i=n.strideHeight,o=n.strideWidth,s=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,f=n.effectiveFilterWidth,d=n.padInfo.top,p=n.padInfo.left,v=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(r.dataId),b=Ze(n.outShape,r.dtype),y=b.values,x=n.outShape[1]*n.outShape[2]*n.outShape[3],S=n.outShape[2]*n.outShape[3],E=n.outShape[3],C=0;C<n.batchSize;++C)for(var k=C*x,A=C*r.strides[0],T=0;T<n.inChannels;++T)for(var N=0;N<n.outHeight;++N)for(var R=N*i-d,I=Math.max(0,R),D=Math.min(n.inHeight,l+R),j=k+N*S,$=0;$<n.outWidth;++$){for(var W=$*o-p,q=Math.max(0,W),X=Math.min(n.inWidth,f+W),Y=v,z=0,B=0,G=I;G<D;G+=s){for(var L=A+G*r.strides[1],K=q;K<X;K+=u){var oe=g[L+K*r.strides[2]+T];a==="max"&&oe>Y?Y=oe:a==="avg"&&(z+=oe,B++)}if(isNaN(Y))break}y[j+$*E+T]=a==="avg"?z/B:Y}return b.toTensor()},e.prototype.maxPool=function(r,n){return this.pool(r,n,"max")},e.prototype.maxPoolPositions=function(r,n){for(var a=Ze(n.outShape,"int32"),i=n.strideHeight,o=n.strideWidth,s=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,f=n.effectiveFilterWidth,d=n.padInfo.top,p=n.padInfo.left,v=this.bufferSync(r),g=0;g<n.batchSize;++g)for(var b=0;b<n.inChannels;++b)for(var y=0;y<n.outHeight;++y){for(var x=y*i-d,S=x;S<0;)S+=s;for(var E=Math.min(n.inHeight,l+x),C=0;C<n.outWidth;++C){for(var k=C*o-p,A=k;A<0;)A+=u;for(var T=Math.min(n.inWidth,f+k),N=Number.NEGATIVE_INFINITY,R=-1,I=S;I<E;I+=s)for(var D=I-x,j=A;j<T;j+=u){var $=j-k,W=v.get(g,I,j,b);W>N&&(N=W,R=D*f+$)}a.set(R,g,y,C,b)}}return a.toTensor()},e.prototype.maxPoolBackprop=function(r,n,a,i){de([n,a],"maxPoolBackprop");for(var o=this.maxPoolPositions(n,i),s=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,f=i.dilationWidth,d=i.effectiveFilterHeight,p=i.effectiveFilterWidth,v=p-1-i.padInfo.left,g=d-1-i.padInfo.top,b=Ze(n.shape,"float32"),y=this.bufferSync(o),x=this.bufferSync(r),S=0;S<i.batchSize;++S)for(var E=0;E<i.inChannels;++E)for(var C=0;C<i.inHeight;++C)for(var k=0;k<i.inWidth;++k){for(var A=C-g,T=k-v,N=0,R=0;R<d;R+=l){var I=(A+R)/s;if(!(I<0||I>=i.outHeight||Math.floor(I)!==I))for(var D=0;D<p;D+=f){var j=(T+D)/u;if(!(j<0||j>=i.outWidth||Math.floor(j)!==j)){var $=d*p-1-y.get(S,I,j,E)===R*p+D?1:0;$!==0&&(N+=x.get(S,I,j,E)*$)}}}b.set(N,S,C,k,E)}return b.toTensor()},e.prototype.avgPoolBackprop=function(r,n,a){de([r,n],"avgPoolBackprop");for(var i=a.strideHeight,o=a.strideWidth,s=a.filterHeight,u=a.filterWidth,l=a.dilationHeight,f=a.dilationWidth,d=a.effectiveFilterHeight,p=a.effectiveFilterWidth,v=p-1-a.padInfo.left,g=d-1-a.padInfo.top,b=Ze(n.shape,"float32"),y=1/(s*u),x=this.bufferSync(r),S=0;S<a.batchSize;++S)for(var E=0;E<a.inChannels;++E)for(var C=0;C<a.inHeight;++C)for(var k=0;k<a.inWidth;++k){for(var A=C-g,T=k-v,N=0,R=0;R<d;R+=l){var I=(A+R)/i;if(!(I<0||I>=a.outHeight||Math.floor(I)!==I))for(var D=0;D<p;D+=f){var j=(T+D)/o;j<0||j>=a.outWidth||Math.floor(j)!==j||(N+=x.get(S,I,j,E))}}b.set(N*y,S,C,k,E)}return b.toTensor()},e.prototype.pool3d=function(r,n,a){de(r,"pool3d");for(var i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,u=n.dilationDepth,l=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,p=n.effectiveFilterHeight,v=n.effectiveFilterWidth,g=n.padInfo.front,b=n.padInfo.top,y=n.padInfo.left,x=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,S=this.readSync(r.dataId),E=Ze(n.outShape,r.dtype),C=E.values,k=n.outShape[1]*n.outShape[2]*n.outShape[3]*n.outShape[4],A=n.outShape[2]*n.outShape[3]*n.outShape[4],T=n.outShape[3]*n.outShape[4],N=n.outShape[4],R=0;R<n.batchSize;++R)for(var I=R*k,D=R*r.strides[0],j=0;j<n.inChannels;++j)for(var $=0;$<n.outDepth;++$){for(var W=$*i-g,q=W;q<0;)q+=u;for(var X=Math.min(n.inDepth,d+W),Y=I+$*A,z=0;z<n.outHeight;++z){for(var B=z*o-b,G=B;G<0;)G+=l;for(var L=Math.min(n.inHeight,p+B),K=Y+z*T,oe=0;oe<n.outWidth;++oe){for(var he=oe*s-y,ge=he;ge<0;)ge+=f;for(var xe=Math.min(n.inWidth,v+he),ke=K+oe*N,we=x,ue=0,Se=0,_e=q;_e<X;_e+=u){for(var le=D+_e*r.strides[1],$e=G;$e<L;$e+=l){for(var Fe=le+$e*r.strides[2],Xe=ge;Xe<xe;Xe+=f){var Ye=S[Fe+Xe*r.strides[3]+j];if(a==="max"&&Ye>we?we=Ye:a==="avg"&&(ue+=Ye,Se++),isNaN(we))break}if(isNaN(we))break}if(isNaN(we))break}C[ke+j]=a==="avg"?ue/Se:we}}}return E.toTensor()},e.prototype.avgPool3d=function(r,n){return de(r,"avgPool3d"),this.pool3d(r,n,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(r,n,a){de([r,n],"avgPool3dBackprop");for(var i=a.strideDepth,o=a.strideHeight,s=a.strideWidth,u=a.filterDepth,l=a.filterHeight,f=a.filterWidth,d=a.dilationDepth,p=a.dilationHeight,v=a.dilationWidth,g=a.effectiveFilterDepth,b=a.effectiveFilterHeight,y=a.effectiveFilterWidth,x=g-1-a.padInfo.front,S=y-1-a.padInfo.left,E=b-1-a.padInfo.top,C=Ze(n.shape,"float32"),k=1/(u*l*f),A=this.bufferSync(r),T=0;T<a.batchSize;++T)for(var N=0;N<a.inChannels;++N)for(var R=0;R<a.inDepth;++R)for(var I=0;I<a.inHeight;++I)for(var D=0;D<a.inWidth;++D){for(var j=R-x,$=I-E,W=D-S,q=0,X=0;X<g;X+=d){var Y=(j+X)/i;if(!(Y<0||Y>=a.outDepth||Math.floor(Y)!==Y))for(var z=0;z<b;z+=p){var B=($+z)/o;if(!(B<0||B>=a.outHeight||Math.floor(B)!==B))for(var G=0;G<y;G+=v){var L=(W+G)/s;L<0||L>=a.outWidth||Math.floor(L)!==L||(q+=A.get(T,Y,B,L,N))}}}C.set(q*k,T,R,I,D,N)}return C.toTensor()},e.prototype.maxPool3d=function(r,n){return de(r,"maxPool3d"),this.pool3d(r,n,"max").toFloat()},e.prototype.maxPool3dPositions=function(r,n){for(var a=Ze(n.outShape,"int32"),i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,u=n.dilationDepth,l=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,p=n.effectiveFilterHeight,v=n.effectiveFilterWidth,g=n.padInfo.front,b=n.padInfo.top,y=n.padInfo.left,x=this.bufferSync(r),S=0;S<n.batchSize;++S)for(var E=0;E<n.inChannels;++E)for(var C=0;C<n.outDepth;++C){for(var k=C*i-g,A=k;A<0;)A+=u;for(var T=Math.min(n.inDepth,d+k),N=0;N<n.outHeight;++N){for(var R=N*o-b,I=R;I<0;)I+=l;for(var D=Math.min(n.inHeight,p+R),j=0;j<n.outWidth;++j){for(var $=j*s-y,W=$;W<0;)W+=f;for(var q=Math.min(n.inWidth,v+$),X=Number.NEGATIVE_INFINITY,Y=-1,z=A;z<T;z+=u)for(var B=z-k,G=I;G<D;G+=l)for(var L=G-R,K=W;K<q;K+=f){var oe=K-$,he=x.get(S,z,G,K,E);he>=X&&(X=he,Y=B*p*v+L*p+oe)}a.set(Y,S,C,N,j,E)}}}return a.toTensor()},e.prototype.maxPool3dBackprop=function(r,n,a,i){de([n,a],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(n,i),s=i.strideDepth,u=i.strideHeight,l=i.strideWidth,f=i.dilationDepth,d=i.dilationHeight,p=i.dilationWidth,v=i.effectiveFilterDepth,g=i.effectiveFilterHeight,b=i.effectiveFilterWidth,y=v-1-i.padInfo.front,x=b-1-i.padInfo.left,S=g-1-i.padInfo.top,E=Ze(n.shape,"float32"),C=this.bufferSync(o),k=this.bufferSync(r),A=0;A<i.batchSize;++A)for(var T=0;T<i.inChannels;++T)for(var N=0;N<i.inDepth;++N)for(var R=0;R<i.inHeight;++R)for(var I=0;I<i.inWidth;++I){for(var D=N-y,j=R-S,$=I-x,W=0,q=0;q<v;q+=f){var X=(D+q)/s;if(!(X<0||X>=i.outDepth||Math.floor(X)!==X))for(var Y=0;Y<g;Y+=d){var z=(j+Y)/u;if(!(z<0||z>=i.outHeight||Math.floor(z)!==z))for(var B=0;B<b;B+=p){var G=($+B)/l;if(!(G<0||G>=i.outWidth||Math.floor(G)!==G)){var L=v*g*b-1-C.get(A,X,z,G,T)===q*g*b+Y*b+B?1:0;L!==0&&(W+=k.get(A,X,z,G,T)*L)}}}}E.set(W,A,N,R,I,T)}return E.toTensor()},e.prototype.cast=function(r,n){return wL(r,n,this)},e.prototype.reshape=function(r,n){return t2(r,n)},e.prototype.avgPool=function(r,n){return de(r,"avgPool"),this.pool(r,n,"avg").toFloat()},e.prototype.resizeBilinear=function(r,n,a,i){de(r,"resizeBilinear");for(var o=r.shape,s=o[0],u=o[1],l=o[2],f=o[3],d=this.readSync(r.dataId),p=new Float32Array(je([s,n,a,f])),v=[i&&n>1?u-1:u,i&&a>1?l-1:l],g=[i&&n>1?n-1:n,i&&a>1?a-1:a],b=0,y=v[0]/g[0],x=v[1]/g[1],S=0;S<s;S++)for(var E=0;E<n;E++)for(var C=y*E,k=Math.floor(C),A=C-k,T=Math.min(u-1,Math.ceil(C)),N=S*r.strides[0]+k*r.strides[1],R=S*r.strides[0]+T*r.strides[1],I=0;I<a;I++)for(var D=x*I,j=Math.floor(D),$=D-j,W=Math.min(l-1,Math.ceil(D)),q=N+j*r.strides[2],X=R+j*r.strides[2],Y=N+W*r.strides[2],z=R+W*r.strides[2],B=0;B<f;B++){var G=d[q+B],L=d[X+B],K=G+(d[Y+B]-G)*$,oe=K+(L+(d[z+B]-L)*$-K)*A;p[b++]=oe}return Rr(p,[s,n,a,f])},e.prototype.resizeBilinearBackprop=function(r,n,a){de([r,n],"resizeBilinearBackprop");for(var i=n.shape,o=i[0],s=i[1],u=i[2],l=i[3],f=r.shape,d=f[1],p=f[2],v=new Float32Array(o*s*u*l),g=[a&&d>1?s-1:s,a&&p>1?u-1:u],b=[a&&d>1?d-1:d,a&&p>1?p-1:p],y=g[0]/b[0],x=g[1]/b[1],S=this.readSync(r.dataId),E=0,C=0;C<o;C++)for(var k=C*n.strides[0],A=0;A<d;A++)for(var T=A*y,N=Math.floor(T),R=Math.min(Math.ceil(T),s-1),I=k+N*n.strides[1],D=k+R*n.strides[1],j=T-N,$=1-j,W=0;W<p;W++)for(var q=W*x,X=Math.floor(q),Y=Math.min(Math.ceil(q),u-1),z=q-X,B=1-z,G=I+X*n.strides[2],L=I+Y*n.strides[2],K=D+X*n.strides[2],oe=D+Y*n.strides[2],he=$*B,ge=$*z,xe=j*B,ke=j*z,we=0;we<l;we++){var ue=S[E++];v[G+we]+=ue*he,v[L+we]+=ue*ge,v[K+we]+=ue*xe,v[oe+we]+=ue*ke}return un(v,[o,u,s,l],n.dtype)},e.prototype.resizeNearestNeighbor=function(r,n,a,i){de(r,"resizeNearestNeighbor");for(var o=r.shape,s=o[0],u=o[1],l=o[2],f=o[3],d=this.readSync(r.dataId),p=new Float32Array(s*n*a*f),v=[i&&n>1?u-1:u,i&&a>1?l-1:l],g=[i&&n>1?n-1:n,i&&a>1?a-1:a],b=v[0]/g[0],y=v[1]/g[1],x=0,S=0;S<s;S++)for(var E=S*r.strides[0],C=0;C<n;C++)for(var k=b*C,A=E+Math.min(u-1,i?Math.round(k):Math.floor(k))*r.strides[1],T=0;T<a;T++)for(var N=y*T,R=A+Math.min(l-1,i?Math.round(N):Math.floor(N))*r.strides[2],I=0;I<f;I++){var D=d[R+I];p[x++]=D}return Rr(p,[s,n,a,f],r.dtype)},e.prototype.resizeNearestNeighborBackprop=function(r,n,a){de([r,n],"resizeNearestNeighborBackprop");for(var i=n.shape,o=i[0],s=i[1],u=i[2],l=i[3],f=r.shape,d=f[1],p=f[2],v=new Float32Array(o*s*u*l),g=this.readSync(r.dataId),b=[a&&d>1?s-1:s,a&&p>1?u-1:u],y=[a&&d>1?d-1:d,a&&p>1?p-1:p],x=b[0]/y[0],S=b[1]/y[1],E=1/x,C=1/S,k=2*Math.ceil(E)+2,A=2*Math.ceil(C)+2,T=0;T<o;T++)for(var N=T*n.strides[0],R=0;R<s;R++)for(var I=N+R*n.strides[1],D=Math.floor(R*E),j=Math.floor(D-k/2),$=0;$<u;$++)for(var W=I+$*n.strides[2],q=Math.floor($*C),X=Math.floor(q-A/2),Y=0;Y<l;Y++){for(var z=0,B=0;B<k;B++){var G=B+j;if(!(G<0||G>=d)){var L=N+G*r.strides[1],K=G*x;if(R===Math.min(s-1,a?Math.round(K):Math.floor(K)))for(var oe=0;oe<A;oe++){var he=oe+X;if(!(he<0||he>=p)){var ge=L+he*r.strides[2],xe=he*S;$===Math.min(u-1,a?Math.round(xe):Math.floor(xe))&&(z+=g[ge+Y])}}}}v[W+Y]=z}return un(v,n.shape,n.dtype)},e.prototype.batchNormalization=function(r,n,a,i,o,s){de([r,n,a,o,s],"batchNorm");for(var u=this.readSync(r.dataId),l=this.readSync(n.dataId),f=this.readSync(a.dataId),d=o?this.readSync(o.dataId):new Float32Array([1]),p=s?this.readSync(s.dataId):new Float32Array([0]),v=new Float32Array(u.length),g=p.length,b=d.length,y=f.length,x=l.length,S=0,E=0,C=0,k=0,A=0;A<u.length;++A)v[A]=p[S++]+(u[A]-l[E++])*d[C++]/Math.sqrt(f[k++]+i),S>=g&&(S=0),E>=x&&(E=0),C>=b&&(C=0),k>=y&&(k=0);return un(v,r.shape)},e.prototype.localResponseNormalization4D=function(r,n,a,i,o){de(r,"localResponseNormalization4D");var s=r.shape[3],u=s-1,l=this.readSync(r.dataId),f=r.size,d=new Float32Array(f);function p(y){for(var x=y%s,S=y-x+Math.max(0,x-n),E=y-x+Math.min(x+n,u),C=0;S<=E;S++){var k=l[S];C+=k*k}return C}for(var v=0;v<f;v++){var g=p(v),b=l[v]*Math.pow(a+i*g,-o);d[v]=b}return un(d,r.shape)},e.prototype.LRNGrad=function(r,n,a,i,o,s,u){de(r,"LRNGrad");for(var l=r.shape[3],f=this.readSync(r.dataId),d=this.readSync(n.dataId),p=this.readSync(a.dataId),v=new Float32Array(r.size),g=r.size,b=0;b<g;b++){for(var y=b%l,x=b-y+Math.max(0,y-i),S=b-y+Math.min(l,y+i+1),E=0,C=x;C<S;C++)E+=Math.pow(d[C],2);for(E=s*E+o,C=x;C<S;C++){var k=-2*s*u*d[C]*p[b]/E;b===C&&(k+=Math.pow(E,-u)),k*=f[b],v[C]+=k}}return un(v,r.shape)},e.prototype.multinomial=function(r,n,a,i){de(r,"multinomial");for(var o=n?r:xi(r),s=o.shape[0],u=o.shape[1],l=Ot([s,a],"int32"),f=this.readSync(l.dataId),d=this.readSync(o.dataId),p=0;p<s;++p){var v=p*u,g=new Float32Array(u-1);g[0]=d[v];for(var b=1;b<g.length;++b)g[b]=g[b-1]+d[v+b];for(var y=ym(i.toString()),x=p*a,S=0;S<a;++S){var E=y();f[x+S]=g.length;for(var C=0;C<g.length;C++)if(E<g[C]){f[x+S]=C;break}}}return l},e.prototype.oneHot=function(r,n,a,i){de(r,"oneHot");var o=new Float32Array(r.size*n);o.fill(i);for(var s=this.readSync(r.dataId),u=0;u<r.size;++u)s[u]>=0&&s[u]<n&&(o[u*n+s[u]]=a);return io(o,[r.size,n],"int32")},e.prototype.nonMaxSuppression=function(r,n,a,i,o){return de(r,"nonMaxSuppression"),RS(this.readSync(r.dataId),this.readSync(n.dataId),a,i,o)},e.prototype.fft=function(r){return this.fftBatch(r,!1)},e.prototype.ifft=function(r){return this.fftBatch(r,!0)},e.prototype.fftBatch=function(r,n){for(var a=r.shape[0],i=r.shape[1],o=Ze(r.shape,"float32"),s=Ze(r.shape,"float32"),u=Un(r).as2D(a,i),l=Aa(r).as2D(a,i),f=0;f<a;f++)for(var d=u.slice([f,0],[1,i]),p=l.slice([f,0],[1,i]),v=Pr(d,p),g=this.readSync(this.fftImpl(v,n).dataId),b=0;b<i;b++){var y=eD(g,b);o.values[f*i+b]=y.real,s.values[f*i+b]=y.imag}return Pr(o.toTensor(),s.toTensor()).as2D(a,i)},e.prototype.fftImpl=function(r,n){var a=r.as1D(),i=a.size;if(this.isExponentOf2(i)){var o=this.fftRadix2(a,i,n).as2D(r.shape[0],r.shape[1]);return n&&(o=Pr(Un(o).div(Ee(i)),Aa(o).div(Ee(i)))),o}var s=this.readSync(r.dataId),u=(function(l){for(var f=new Float32Array(l.length/2),d=new Float32Array(l.length/2),p=0;p<l.length;p+=2)f[p/2]=l[p],d[p/2]=l[p+1];return{real:f,imag:d}})(this.fourierTransformByMatmul(s,i,n));return Pr(u.real,u.imag).as2D(r.shape[0],r.shape[1])},e.prototype.isExponentOf2=function(r){return(r&r-1)==0},e.prototype.fftRadix2=function(r,n,a){if(n===1)return r;var i=this.readSync(r.dataId),o=n/2,s=(function(x){for(var S=Math.ceil(x.length/4),E=new Float32Array(S),C=new Float32Array(S),k=0;k<x.length;k+=4)E[Math.floor(k/4)]=x[k],C[Math.floor(k/4)]=x[k+1];return{real:E,imag:C}})(i),u=Pr(s.real,s.imag).as1D(),l=(function(x){for(var S=Math.floor(x.length/4),E=new Float32Array(S),C=new Float32Array(S),k=2;k<x.length;k+=4)E[Math.floor(k/4)]=x[k],C[Math.floor(k/4)]=x[k+1];return{real:E,imag:C}})(i),f=Pr(l.real,l.imag).as1D();u=this.fftRadix2(u,o,a),f=this.fftRadix2(f,o,a);var d=(function(x,S){for(var E=new Float32Array(x/2),C=new Float32Array(x/2),k=0;k<Math.ceil(x/2);k++){var A=(S?2:-2)*Math.PI*(k/x);E[k]=Math.cos(A),C[k]=Math.sin(A)}return{real:E,imag:C}})(n,a),p=Pr(d.real,d.imag).mul(f),v=u.add(p),g=u.sub(p),b=Un(v).concat(Un(g)),y=Aa(v).concat(Aa(g));return Pr(b,y).as1D()},e.prototype.fourierTransformByMatmul=function(r,n,a){for(var i=new Float32Array(2*n),o=0;o<n;o++){for(var s=0,u=0,l=0;l<n;l++){var f=Ese(o*l,n,a),d=eD(r,l);s+=d.real*f.real-d.imag*f.imag,u+=d.real*f.imag+d.imag*f.real}a&&(s/=n,u/=n),Sse(i,s,u,o)}return i},e.prototype.depthToSpace=function(r,n,a){U(a==="NHWC",(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a})),U(n>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+n}));for(var i=r.shape[0],o=r.shape[1],s=r.shape[2],u=r.shape[3],l=o*n,f=s*n,d=u/(n*n),p=this.readSync(r.dataId),v=new Float32Array(i*l*f*d),g=0,b=0;b<i;++b)for(var y=0;y<l;++y)for(var x=Math.floor(y/n),S=y%n,E=0;E<f;++E)for(var C=Math.floor(E/n),k=(S*n+E%n)*d,A=0;A<d;++A){var T=A+k+u*(C+s*(x+o*b));v[g++]=p[T]}return un(v,[i,l,f,d])},e.prototype.broadcastedBinaryOp=function(r,n,a,i){var o=ot(r.shape,n.shape),s=Ze(o,a),u=this.readSync(r.dataId),l=this.readSync(n.dataId),f=to(r.shape,o),d=to(n.shape,o),p=s.values;if(f.length+d.length===0)for(var v=0;v<p.length;++v)p[v]=i(u[v%u.length],l[v%l.length]);else{var g=this.bufferSync(r),b=this.bufferSync(n),y=function(x){var S=s.indexToLoc(x),E=S.slice(-r.rank);f.forEach((function(T){return E[T]=0}));var C=g.locToIndex(E),k=S.slice(-n.rank);d.forEach((function(T){return k[T]=0}));var A=b.locToIndex(k);p[x]=i(u[C],l[A])};for(v=0;v<p.length;++v)y(v)}return s.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(r,n,a){var i=ot(r.shape,n.shape),o=Ze(i,"float32"),s=Ze(i,"float32"),u=this.readSync(r.dataId),l=this.readSync(n.dataId),f=to(r.shape,i),d=to(n.shape,i),p=o.values,v=s.values;if(f.length+d.length===0)for(var g=0;g<p.length;g++){var b=g%u.length,y=g%l.length,x=a(u[2*b],u[2*b+1],l[2*y],l[2*y+1]);p[g]=x.real,v[g]=x.imag}else{var S=this.bufferSync(this.data.get(r.dataId).complexTensors.real),E=this.bufferSync(this.data.get(n.dataId).complexTensors.real),C=function(k){var A=o.indexToLoc(k),T=A.slice(-r.rank);f.forEach((function(j){return T[j]=0}));var N=S.locToIndex(T),R=A.slice(-n.rank);d.forEach((function(j){return R[j]=0}));var I=E.locToIndex(R),D=a(u[2*N],u[2*N+1],l[2*I],l[2*I+1]);p[k]=D.real,v[k]=D.imag};for(g=0;g<p.length;g++)C(g)}return this.complex(o.toTensor(),s.toTensor())},e.prototype.split=function(r,n,a){return EL(r,n,a)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(r,n,a,i,o,s){for(var u=r.shape,l=u[0],f=u[1],d=u[2],p=u[3],v=n.shape[0],g=i[0],b=i[1],y=Ze([v,g,b,p],"float32"),x=this.readSync(n.dataId),S=this.readSync(a.dataId),E=this.readSync(r.dataId),C=r.strides,k=y.strides,A=0;A<v;A++){var T=4*A,N=x[T],R=x[T+1],I=x[T+2],D=x[T+3],j=S[A];if(!(j>=l))for(var $=g>1?(I-N)*(f-1)/(g-1):0,W=b>1?(D-R)*(d-1)/(b-1):0,q=0;q<g;q++){var X=g>1?N*(f-1)+q*$:.5*(N+I)*(f-1);if(X<0||X>f-1)for(var Y=0;Y<b;Y++)for(var z=0;z<p;z++){var B=z+Y*k[2]+q*k[1]+A*k[0];y.values[B]=s}else if(o==="bilinear"){var G=Math.floor(X),L=Math.ceil(X),K=X-G;for(Y=0;Y<b;Y++)if((_e=b>1?R*(d-1)+Y*W:.5*(R+D)*(d-1))<0||_e>d-1)for(z=0;z<p;z++)B=z+Y*k[2]+q*k[1]+A*k[0],y.values[B]=s;else{var oe=Math.floor(_e),he=Math.ceil(_e),ge=_e-oe;for(z=0;z<p;z++){var xe=E[B=z+oe*C[2]+G*C[1]+j*C[0]],ke=E[B=z+he*C[2]+G*C[1]+j*C[0]],we=E[B=z+oe*C[2]+L*C[1]+j*C[0]],ue=xe+(ke-xe)*ge,Se=we+(E[B=z+he*C[2]+L*C[1]+j*C[0]]-we)*ge;B=z+Y*k[2]+q*k[1]+A*k[0],y.values[B]=ue+(Se-ue)*K}}}else for(Y=0;Y<b;++Y){var _e;if((_e=b>1?R*(d-1)+Y*W:.5*(R+D)*(d-1))<0||_e>d-1)for(z=0;z<p;z++)B=z+Y*k[2]+q*k[1]+A*k[0],y.values[B]=s;else{var le=Math.round(_e),$e=Math.round(X);for(z=0;z<p;z++){var Fe=z+le*C[2]+$e*C[1]+j*C[0],Xe=z+Y*k[2]+q*k[1]+A*k[0];y.values[Xe]=E[Fe]}}}}}return y.toTensor()},e.prototype.sparseToDense=function(r,n,a,i){var o=wv(0,r,a),s=o.sliceRank,u=o.numUpdates,l=o.sliceSize,f=o.strides,d=o.outputSize;return this.scatter(r,n,a,d,l,u,s,f,i,!1)},e.prototype.gatherND=function(r,n){var a=n.shape,i=a[a.length-1],o=pL(r,n),s=o[0],u=o[1],l=o[2],f=o[3];if(u===0)return Rr([],s,r.dtype);for(var d=new Uf([u,l],r.dtype),p=this.readSync(n.dataId),v=this.readSync(r.dataId),g=0;g<u;g++){for(var b=[],y=0,x=0;x<i;x++){var S=p[g*i+x];y+=S*f[x],b.push(S)}if(y<0||y>=r.size/l)throw new Error("Invalid indices: "+b+" does not index into "+r.shape);for(var E=0;E<l;E++)d.values[g*l+E]=v[y*l+E]}return d.toTensor().reshape(s)},e.prototype.scatterND=function(r,n,a){var i=wv(0,r,a),o=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,f=i.outputSize,d=Ee(0);return this.scatter(r,n,a,f,u,s,o,l,d,!0)},e.prototype.fill=function(r,n,a){var i=fv(a=a||ad(n),je(r));return i.fill(n),ee.makeTensor(i,r,a,this)},e.prototype.onesLike=function(r){if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(r.shape,1,r.dtype)},e.prototype.zerosLike=function(r){var n=fv(r.dtype,je(r.shape));return this.makeOutput(n,r.shape,r.dtype)},e.prototype.linspace=function(r,n,a){return _L(r,n,a)},e.prototype.scatter=function(r,n,a,i,o,s,u,l,f,d){var p=[i/o,o],v=this.readSync(r.dataId),g=this.readSync(n.dataId);if(i===0)return Rr([],a,n.dtype);var b=new Uf(p,n.dtype);b.values.fill(this.readSync(f.dataId)[0]);for(var y=0;y<s;y++){for(var x=[],S=0,E=0;E<u;E++){var C=v[y*u+E];x.push(C),S+=C*l[E]}if(S<0||S>=i/o)throw new Error("Invalid indices: "+x+" does not index into "+a);for(var k=0;k<o;k++)d?b.values[S*o+k]+=g[y*o+k]:b.values[S*o+k]=n.rank===0?g[0]:g[y*o+k]}return b.toTensor().reshape(a)},e})(bL);ee.registerBackend("cpu",(function(){return new qfe}),1);for(var Zw=0,_D=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,r=t.backend,n=t.attrs,a=e,i=a.boxes,o=a.scores,s=n,u=s.maxOutputSize,l=s.iouThreshold,f=s.scoreThreshold,d=s.softNmsSigma,p=r;de(i,"NonMaxSuppressionWithScore");var v=IS(p.data.get(i.dataId).values,p.data.get(o.dataId).values,u,l,f,d);return[v.selectedIndices,v.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,r=t.backend,n=e.x,a=r;de(n,"square");for(var i=a.data.get(n.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},{kernelName:qf,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,r=t.backend,n=e,a=n.a,i=n.b,o=r;de([a,i],qf);var s=o.data.get(a.dataId).values,u=o.data.get(i.dataId).values,l=(function(p,v,g,b,y,x){var S=ot(p,v),E=S.length,C=ja(S),k=$f(y,je(S)),A=p.length,T=v.length,N=ja(p),R=ja(v),I=to(p,S),D=to(v,S);if(I.length+D.length===0)for(var j=0;j<k.length;++j)k[j]=x(g[j%g.length],b[j%b.length]);else{var $=function(W){var q=eoe(W,E,C),X=q.slice(-A);I.forEach((function(G){return X[G]=0}));var Y=Vj(X,A,N),z=q.slice(-T);D.forEach((function(G){return z[G]=0}));var B=Vj(z,T,R);k[W]=x(g[Y],b[B])};for(j=0;j<k.length;++j)$(j)}return[k,S]})(a.shape,i.shape,s,u,a.dtype,(function(p,v){var g=p-v;return g*g})),f=l[0],d=l[1];return{dataId:o.write(f,d,a.dtype),shape:d,dtype:a.dtype}}}];Zw<_D.length;Zw++)GF(_D[Zw]);var cu,Vfe=function(t){this.variableNames=["A"];var e=Hr(),r=t[0],n=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+n+".0, "+r+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},Hfe=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=Hr(),r=t[0],n=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+n+".0, "+r+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var e1=0,SD=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,r=t.backend,n=t.attrs,a=e.pixels,i=n.numChannels,o=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,u=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],l=u[0],f=u[1],d=[f,l],p=[f,l,i];(s||o)&&(cu==null&&(cu=document.createElement("canvas").getContext("2d")),cu.canvas.width=l,cu.canvas.height=f,cu.drawImage(a,0,0,l,f),a=cu.canvas);var v=r.makeTensorInfo(d,"int32");r.texData.get(v.dataId).usage=kn.PIXELS,r.gpgpu.uploadPixelDataToTexture(r.getTexture(v.dataId),a);var g=ce().getBool("WEBGL_PACK")?new Hfe(p):new Vfe(p),b=r.runWebGLProgram(g,[v],"int32");return r.disposeData(v.dataId),b}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,r=t.backend,n=t.attrs;vv("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=e,i=a.boxes,o=a.scores,s=n,u=s.maxOutputSize,l=s.iouThreshold,f=s.scoreThreshold,d=s.softNmsSigma,p=r,v=IS(p.readSync(i.dataId),p.readSync(o.dataId),u,l,f,d);return[v.selectedIndices,v.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,r=t.backend,n=e.x,a=r,i=new tt(n.shape,"return x * x;");return a.runWebGLProgram(i,[n],n.dtype)}},{kernelName:qf,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,r=t.backend,n=e,a=n.a,i=n.b,o=r,s=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ti("return (a - b) * (a - b);",a.shape,i.shape):new qt("return (a - b) * (a - b);",a.shape,i.shape);return o.compileAndRun(s,[a,i])}}];e1<SD.length;e1++)GF(SD[e1]);for(var t1=0,ED=[{kernelName:"Square",gradFunc:function(t,e){var r=e[0];return{x:function(){return t.mul(r.toFloat().mul(2))}}}},{kernelName:qf,gradFunc:function(t,e){var r=e[0],n=e[1],a=Ee(2);return{a:function(){return Kr(t,Kr(a,hr(r,n)))},b:function(){return Kr(t,Kr(a,hr(n,r)))}}}}];t1<ED.length;t1++)zie(ED[t1]);var Gfe=(function(){function t(){}return t.prototype.fetch=function(e,r){return fetch(e,r)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(e,r){if(r!=="utf-8"&&r!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+r);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},t.prototype.decode=function(e,r){return new TextDecoder(r).decode(e)},t})();ce().get("IS_BROWSER")&&ce().setPlatform("browser",new Gfe);var r1,Kfe=function(){return require("node-fetch")},Xfe=(function(){function t(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(e,r){return ce().global.fetch!=null?ce().global.fetch(e,r):(r1==null&&(r1=Kfe()),r1(e,r))},t.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},t.prototype.encode=function(e,r){if(r!=="utf-8"&&r!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+r);return this.textEncoder.encode(e)},t.prototype.decode=function(e,r){return e.length===0?"":new this.util.TextDecoder(r).decode(e)},t})();ce().get("IS_NODE")&&ce().setPlatform("node",new Xfe);var a2={float32:4,int32:4,uint16:2,uint8:1,bool:1},Ov=4;function mB(t,e){for(var r={},n=0,a=function(s){var u=s.name,l=s.dtype,f=s.shape,d=je(f),p=void 0;if("quantization"in s){var v=s.quantization;if(v.dtype!=="uint8"&&v.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+v.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var g=a2[v.dtype],b=t.slice(n,n+d*g),y=v.dtype==="uint8"?new Uint8Array(b):new Uint16Array(b);if(l==="float32")p=Float32Array.from(y,(function(A){return A*v.scale+v.min}));else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);p=Int32Array.from(y,(function(A){return Math.round(A*v.scale+v.min)}))}n+=d*g}else if(l==="string"){var x=je(s.shape);p=[];for(var S=0;S<x;S++){var E=new Uint32Array(t.slice(n,n+Ov))[0];n+=Ov;var C=new Uint8Array(t.slice(n,n+E));p.push(C),n+=E}}else{var k=a2[l];if(b=t.slice(n,n+d*k),l==="float32")p=new Float32Array(b);else if(l==="int32")p=new Int32Array(b);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);p=new Uint8Array(b)}n+=d*k}r[u]=Rr(p,f,l)},i=0,o=e;i<o.length;i++)a(o[i]);return r}function Yfe(t){if(t===null)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,r=[];t.forEach((function(i){if(e+=i.byteLength,r.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)}));var n=new Uint8Array(e),a=0;return r.forEach((function(i){n.set(new Uint8Array(i.buffer),a),a+=i.byteLength})),n.buffer}var i2=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function CD(t){return i2?Buffer.byteLength(t):new Blob([t]).size}function QS(t){var e=0;t.forEach((function(a){e+=a.byteLength}));var r=new Uint8Array(e),n=0;return t.forEach((function(a){r.set(new Uint8Array(a),n),n+=a.byteLength})),r.buffer}function kD(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function fd(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:CD(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:CD(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}var An=(function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,r){return t.getHandlers(e,"load",r)},t.getHandlers=function(e,r,n){var a=[];return(r==="load"?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(i){var o=i(e,n);o!==null&&a.push(o)})),a},t})(),Iu="://",oo=(function(){function t(){this.managers={}}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerManager=function(e,r){U(e!=null,(function(){return"scheme must not be undefined or null."})),e.endsWith(Iu)&&(e=e.slice(0,e.indexOf(Iu))),U(e.length>0,(function(){return"scheme must not be an empty string."}));var n=t.getInstance();U(n.managers[e]==null,(function(){return"A model store manager is already registered for scheme '"+e+"'."})),n.managers[e]=r},t.getManager=function(e){var r=this.getInstance().managers[e];if(r==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return r},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t})();function np(t){if(t.indexOf(Iu)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+oo.getSchemes().join(","));return{scheme:t.split(Iu)[0],path:t.split(Iu)[1]}}function AD(t,e,r){return r===void 0&&(r=!1),Ne(this,void 0,void 0,(function(){var n,a,i,o,s,u,l,f,d;return Re(this,(function(p){switch(p.label){case 0:return U(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),U((n=An.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),U(n.length<2,(function(){return"Copying failed because more than one ("+n.length+") load handlers for source URL "+t+"."})),a=n[0],U((i=An.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),U(i.length<2,(function(){return"Copying failed because more than one ("+n.length+") save handlers for destination URL "+e+"."})),o=i[0],s=np(t).scheme,u=np(t).path,l=s===np(t).scheme,[4,a.load()];case 1:return f=p.sent(),r&&l?[4,oo.getManager(s).removeModel(u)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,o.save(f)];case 4:return d=p.sent(),!r||l?[3,6]:[4,oo.getManager(s).removeModel(u)];case 5:p.sent(),p.label=6;case 6:return[2,d.modelArtifactsInfo]}}))}))}var rs="models_store",ro="model_info_store";function gB(){if(!ce().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function o2(t){var e=t.result;e.createObjectStore(rs,{keyPath:"modelPath"}),e.createObjectStore(ro,{keyPath:"modelPath"})}var ju=(function(){function t(e){if(this.indexedDB=gB(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return t.prototype.save=function(e){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},t.prototype.load=function(){return Ne(this,void 0,void 0,(function(){return Re(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(e,r){var n=this;return new Promise((function(a,i){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return o2(o)},o.onsuccess=function(){var s=o.result;if(r==null){var u=s.transaction(rs,"readonly"),l=u.objectStore(rs).get(n.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),i(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(l.result.modelArtifacts)},l.onerror=function(b){return s.close(),i(l.error)},u.oncomplete=function(){return s.close()}}else{var f,d=fd(r),p=s.transaction(ro,"readwrite"),v=p.objectStore(ro),g=v.put({modelPath:n.modelPath,modelArtifactsInfo:d});g.onsuccess=function(){var b=(f=s.transaction(rs,"readwrite")).objectStore(rs).put({modelPath:n.modelPath,modelArtifacts:r,modelArtifactsInfo:d});b.onsuccess=function(){return a({modelArtifactsInfo:d})},b.onerror=function(y){var x=(v=p.objectStore(ro)).delete(n.modelPath);x.onsuccess=function(){return s.close(),i(b.error)},x.onerror=function(S){return s.close(),i(b.error)}}},g.onerror=function(b){return s.close(),i(g.error)},p.oncomplete=function(){f==null?s.close():f.oncomplete=function(){return s.close()}}}},o.onerror=function(s){return i(o.error)}}))},t.URL_SCHEME="indexeddb://",t})(),OD=function(t){return ce().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ju.URL_SCHEME)?(e=t.slice(ju.URL_SCHEME.length),new ju(e)):null;var e};An.registerSaveRouter(OD),An.registerLoadRouter(OD);var Jfe=(function(){function t(){this.indexedDB=gB()}return t.prototype.listModels=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Re(this,(function(r){return[2,new Promise((function(n,a){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return o2(i)},i.onsuccess=function(){var o=i.result,s=o.transaction(ro,"readonly"),u=s.objectStore(ro).getAll();u.onsuccess=function(){for(var l={},f=0,d=u.result;f<d.length;f++){var p=d[f];l[p.modelPath]=p.modelArtifactsInfo}n(l)},u.onerror=function(l){return o.close(),a(u.error)},s.oncomplete=function(){return o.close()}},i.onerror=function(o){return a(i.error)}}))]}))}))},t.prototype.removeModel=function(e){return Ne(this,void 0,void 0,(function(){var r=this;return Re(this,(function(n){var a;return e=(a=e).startsWith(ju.URL_SCHEME)?a.slice(ju.URL_SCHEME.length):a,[2,new Promise((function(i,o){var s=r.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return o2(s)},s.onsuccess=function(){var u,l=s.result,f=l.transaction(ro,"readwrite"),d=f.objectStore(ro),p=d.get(e);p.onsuccess=function(){if(p.result==null)return l.close(),o(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var v=d.delete(e),g=function(){var b=(u=l.transaction(rs,"readwrite")).objectStore(rs).delete(e);b.onsuccess=function(){return i(p.result.modelArtifactsInfo)},b.onerror=function(y){return o(p.error)}};v.onsuccess=g,v.onerror=function(b){return g(),l.close(),o(p.error)}},p.onerror=function(v){return l.close(),o(p.error)},f.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return o(s.error)}}))]}))}))},t})();if(ce().getBool("IS_BROWSER"))try{oo.registerManager(ju.URL_SCHEME,new Jfe)}catch{}var ni="/",bu="tensorflowjs_models",yB="info",Qfe="model_topology",Zfe="weight_specs",ede="weight_data",tde="model_metadata";function bB(t){return{info:[bu,t,yB].join(ni),topology:[bu,t,Qfe].join(ni),weightSpecs:[bu,t,Zfe].join(ni),weightData:[bu,t,ede].join(ni),modelMetadata:[bu,t,tde].join(ni)}}function rde(t){var e=t.split(ni);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(ni)}var Du=(function(){function t(e){if(!ce().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=bB(this.modelPath)}return t.prototype.save=function(e){return Ne(this,void 0,void 0,(function(){var r,n,a;return Re(this,(function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");r=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),a=fd(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,r),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(function(o){if(i2)return Buffer.from(o).toString("base64");for(var s=new Uint8Array(o),u="",l=0,f=s.length;l<f;l++)u+=String.fromCharCode(s[l]);return btoa(u)})(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]}))}))},t.prototype.load=function(){return Ne(this,void 0,void 0,(function(){var e,r,n,a,i,o,s;return Re(this,(function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(r={},(n=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(r.modelTopology=n,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(r.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(i),r.format=o.format,r.generatedBy=o.generatedBy,r.convertedBy=o.convertedBy,r.userDefinedMetadata=o.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return r.weightData=(function(l){if(i2){var f=Buffer.from(l,"base64");return f.buffer.slice(f.byteOffset,f.byteOffset+f.byteLength)}for(var d=atob(l),p=new Uint8Array(d.length),v=0;v<d.length;++v)p.set([d.charCodeAt(v)],v);return p.buffer})(s),[2,r]}))}))},t.URL_SCHEME="localstorage://",t})(),TD=function(t){return ce().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Du.URL_SCHEME)?(e=t.slice(Du.URL_SCHEME.length),new Du(e)):null;var e};An.registerSaveRouter(TD),An.registerLoadRouter(TD);var nde=(function(){function t(){U(ce().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),U(typeof window>"u"||window.localStorage!==void 0,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return Ne(this,void 0,void 0,(function(){var e,r,n,a,i,o;return Re(this,(function(s){for(e={},r=bu+ni,n=ni+yB,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(r)&&i.endsWith(n)&&(o=rde(i),e[o]=JSON.parse(this.LS.getItem(i)));return[2,e]}))}))},t.prototype.removeModel=function(e){return Ne(this,void 0,void 0,(function(){var r,n;return Re(this,(function(a){var i;if(e=(i=e).startsWith(Du.URL_SCHEME)?i.slice(Du.URL_SCHEME.length):i,r=bB(e),this.LS.getItem(r.info)==null)throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(r.info)),this.LS.removeItem(r.info),this.LS.removeItem(r.topology),this.LS.removeItem(r.weightSpecs),this.LS.removeItem(r.weightData),[2,n]}))}))},t})();if(ce().getBool("IS_BROWSER"))try{oo.registerManager(Du.URL_SCHEME,new nde)}catch{}var ade="model",ide=".json",ode=".weights.bin";function PD(t){return new Promise((function(e){return setTimeout(e)})).then(t)}var n1=(function(){function t(e){if(!ce().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),e!=null&&e.length!==0||(e=ade),this.modelTopologyFileName=e+ide,this.weightDataFileName=e+ode}return t.prototype.save=function(e){return Ne(this,void 0,void 0,(function(){var r,n,a,i,o,s;return Re(this,(function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(r=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,[4,PD((function(){return o.dispatchEvent(new MouseEvent("click"))}))];case 2:return u.sent(),e.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=r,[4,PD((function(){return s.dispatchEvent(new MouseEvent("click"))}))]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:fd(e)}]}}))}))},t.URL_SCHEME="downloads://",t})(),sde=(function(){function t(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return t.prototype.load=function(){return Ne(this,void 0,void 0,(function(){var e,r,n=this;return Re(this,(function(a){return e=this.files[0],r=this.files.slice(1),[2,new Promise((function(i,o){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),f=l.modelTopology;if(f!=null){r.length===0&&i({modelTopology:f});var d=l.weightsManifest;if(d!=null){var p;try{p=n.checkManifestAndWeightFiles(d,r)}catch(y){return void o(y)}var v=[],g=[],b=[];d.forEach((function(y){y.paths.forEach((function(x){g.push(x),b.push(null)})),v.push.apply(v,y.weights)})),d.forEach((function(y){y.paths.forEach((function(x){var S=new FileReader;S.onload=function(E){var C=E.target.result,k=g.indexOf(x);b[k]=C,b.indexOf(null)===-1&&i({modelTopology:f,weightSpecs:v,weightData:QS(b),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},S.onerror=function(E){return o("Failed to weights data from file of path '"+x+"'.")},S.readAsArrayBuffer(p[x])}))}))}else o(new Error("weightManifest field is missing from file "+e.name))}else o(new Error("modelTopology field is missing from file "+e.name))},s.onerror=function(u){return o("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(e)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(e,r){for(var n=[],a=r.map((function(u){return kD(u.name)})),i={},o=0,s=e;o<s.length;o++)s[o].paths.forEach((function(u){var l=kD(u);if(n.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(n.push(l),a.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=r[a.indexOf(l)]}));if(n.length!==r.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+r.length+").");return i},t})();function ND(t,e,r,n){(function(i){U(i!=null&&Array.isArray(i)&&i.length>0,(function(){return"promises must be a none empty array"}))})(t),(function(i,o){U(i>=0&&i<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i})),U(o>=0&&o<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o})),U(o>=i,(function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+o}))})(r=r??0,n=n??1);var a=0;return Promise.all(t.map((function(i){return i.then((function(o){var s=r+ ++a/t.length*(n-r);return e(s),o})),i})))}function xB(t,e){return Ne(this,void 0,void 0,(function(){var r,n,a,i,o,s,u,l,f;return Re(this,(function(d){switch(d.label){case 0:return e==null&&(e={}),r=e.fetchFunc==null?ce().platform.fetch:e.fetchFunc,n=t.map((function(p){return r(p,e.requestInit,{isBinary:!0})})),a=0,i=.5,e.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return o=d.sent(),[3,4];case 2:return[4,ND(n,e.onProgress,a,i)];case 3:o=d.sent(),d.label=4;case 4:return s=o.map((function(p){return p.arrayBuffer()})),u=.5,l=1,e.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return f=d.sent(),[3,8];case 6:return[4,ND(s,e.onProgress,u,l)];case 7:f=d.sent(),d.label=8;case 8:return[2,f]}}))}))}function RD(t){var e=this;return function(r,n,a){return n===void 0&&(n=""),Ne(e,void 0,void 0,(function(){var i,o,s,u,l,f,d,p,v,g;return Re(this,(function(b){switch(b.label){case 0:if(i=r.map((function(){return!1})),o={},s=a!=null?a.map((function(){return!1})):[],u=[],r.forEach((function(y,x){var S=0;y.weights.forEach((function(E){var C="quantization"in E?E.quantization.dtype:E.dtype,k=a2[C]*je(E.shape),A=function(){i[x]=!0,o[x]==null&&(o[x]=[]),o[x].push({manifestEntry:E,groupOffset:S,sizeBytes:k})};a!=null?a.forEach((function(T,N){T===E.name&&(A(),s[N]=!0)})):A(),u.push(E.name),S+=k}))})),!s.every((function(y){return y})))throw l=a.filter((function(y,x){return!s[x]})),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return f=i.reduce((function(y,x,S){return x&&y.push(S),y}),[]),d=[],f.forEach((function(y){r[y].paths.forEach((function(x){var S=n+(n.endsWith("/")?"":"/")+x;d.push(S)}))})),[4,t(d)];case 1:return p=b.sent(),v={},g=0,f.forEach((function(y){for(var x=r[y].paths.length,S=0,E=0;E<x;E++)S+=p[g+E].byteLength;for(var C=new ArrayBuffer(S),k=new Uint8Array(C),A=0,T=0;T<x;T++){var N=new Uint8Array(p[g+T]);k.set(N,A),A+=N.byteLength}o[y].forEach((function(R){var I=mB(C.slice(R.groupOffset,R.groupOffset+R.sizeBytes),[R.manifestEntry]);for(var D in I)v[D]=I[D]})),g+=x})),[2,v]}}))}))}}An.registerSaveRouter((function(t){return ce().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(n1.URL_SCHEME)?(function(e){return e===void 0&&(e="model"),new n1(e)})(t.slice(n1.URL_SCHEME.length)):null}));var wB=(function(){function t(e,r){if(this.DEFAULT_METHOD="POST",r==null&&(r={}),this.weightPathPrefix=r.weightPathPrefix,this.onProgress=r.onProgress,r.fetchFunc!=null?(U(typeof r.fetchFunc=="function",(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=r.fetchFunc):this.fetch=ce().platform.fetch,U(e!=null&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&U(e.length===2,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,r.requestInit!=null&&r.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=r.requestInit||{}}return t.prototype.save=function(e){return Ne(this,void 0,void 0,(function(){var r,n,a,i;return Re(this,(function(o){switch(o.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(r=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},r.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),e.weightData!=null&&r.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,r)];case 1:if((i=o.sent()).ok)return[2,{modelArtifactsInfo:fd(e),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}}))}))},t.prototype.load=function(){return Ne(this,void 0,void 0,(function(){var e,r,n,a,i,o,s,u,l,f,d,p;return Re(this,(function(v){switch(v.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=v.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");v.label=2;case 2:return v.trys.push([2,4,,5]),[4,e.json()];case 3:return r=v.sent(),[3,5];case 4:throw v.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(a=r.modelTopology,i=r.weightsManifest,o=r.generatedBy,s=r.convertedBy,u=r.format,l=r.userDefinedMetadata,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:p=v.sent(),f=p[0],d=p[1],v.label=7;case 7:return[2,{modelTopology:a,weightSpecs:f,weightData:d,userDefinedMetadata:l,generatedBy:o,convertedBy:s,format:u}]}}))}))},t.prototype.loadWeights=function(e){return Ne(this,void 0,void 0,(function(){var r,n,a,i,o,s,u,l,f,d,p;return Re(this,(function(v){switch(v.label){case 0:for(r=Array.isArray(this.path)?this.path[1]:this.path,n=(function(g){var b=g.lastIndexOf("/"),y=g.lastIndexOf("?"),x=g.substring(0,b),S=y>b?g.substring(y):"";return[x+"/",S]})(r),a=n[0],i=n[1],o=this.weightPathPrefix||a,s=[],u=0,l=e;u<l.length;u++)f=l[u],s.push.apply(s,f.weights);return d=[],e.forEach((function(g){g.paths.forEach((function(b){d.push(o+b+i)}))})),[4,xB(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return p=v.sent(),[2,[s,QS(p)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t})();function s2(t){return t.match(wB.URL_SCHEME_REGEX)!=null}var ID=function(t,e){return typeof fetch>"u"?null:(Array.isArray(t)?t.every((function(r){return s2(r)})):s2(t))?u2(t,{onProgress:e}):null};function u2(t,e){return new wB(t,e)}An.registerSaveRouter(ID),An.registerLoadRouter(ID);var a1=(function(){function t(e){this.modelArtifacts=e}return t.prototype.load=function(){return Ne(this,void 0,void 0,(function(){return Re(this,(function(e){return[2,this.modelArtifacts]}))}))},t})(),ude=(function(){function t(e){this.saveHandler=e}return t.prototype.save=function(e){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){return[2,this.saveHandler(e)]}))}))},t})(),_B=Object.freeze({browserFiles:function(t){return new sde(t)},browserHTTPRequest:function(t,e){return u2(t,e)},concatenateArrayBuffers:QS,decodeWeights:mB,encodeWeights:function(t,e){return Ne(this,void 0,void 0,(function(){var r,n,a,i,o,s=this;return Re(this,(function(u){switch(u.label){case 0:for(r=[],n=[],a=Array.isArray(t)?t.map((function(l){return l.name})):Object.keys(t),i=function(l){var f=a[l],d=Array.isArray(t)?t[l].tensor:t[f];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+f+"': "+d.dtype);var p={name:f,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var v=new Promise((function(g){return Ne(s,void 0,void 0,(function(){var b,y,x,S,E,C,k;return Re(this,(function(A){switch(A.label){case 0:return[4,d.bytes()];case 1:for(b=A.sent(),y=b.reduce((function(T,N){return T+N.length}),0)+Ov*b.length,x=new Uint8Array(y),S=0,E=0;E<b.length;E++)C=b[E],k=new Uint8Array(new Uint32Array([C.length]).buffer),x.set(k,S),S+=Ov,x.set(C,S),S+=C.length;return g(x),[2]}}))}))}));n.push(v)}else n.push(d.data());e!=null&&(p.group=e),r.push(p)},o=0;o<a.length;++o)i(o);return[4,Promise.all(n)];case 1:return[2,{data:Yfe(u.sent()),specs:r}]}}))}))},fromMemory:function(t,e,r,n){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new a1(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new a1({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new a1({modelTopology:t,weightSpecs:e,weightData:r,trainingConfig:n}))},getLoadHandlers:function(t,e){return An.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:fd,getSaveHandlers:function(t){return An.getSaveHandlers(t)},http:u2,isHTTPScheme:s2,loadWeights:function(t,e,r,n){return e===void 0&&(e=""),Ne(this,void 0,void 0,(function(){return Re(this,(function(a){return[2,RD((function(i){return xB(i,{requestInit:n})}))(t,e,r)]}))}))},registerLoadRouter:function(t){return An.registerLoadRouter(t)},registerSaveRouter:function(t){return An.registerSaveRouter(t)},weightsLoaderFactory:RD,withSaveHandler:function(t){return new ude(t)},copyModel:function(t,e){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){return[2,AD(t,e,!1)]}))}))},listModels:function(){return Ne(this,void 0,void 0,(function(){var t,e,r,n,a,i,o;return Re(this,(function(s){switch(s.label){case 0:t=oo.getSchemes(),e={},r=0,n=t,s.label=1;case 1:return r<n.length?(a=n[r],[4,oo.getManager(a).listModels()]):[3,4];case 2:for(o in i=s.sent())e[a+Iu+o]=i[o];s.label=3;case 3:return r++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){return[2,AD(t,e,!0)]}))}))},removeModel:function(t){return Ne(this,void 0,void 0,(function(){var e;return Re(this,(function(r){return e=np(t),[2,oo.getManager(e.scheme).removeModel(e.path)]}))}))}}),fu;J({confusionMatrix_:function(t,e,r){var n=F(t,"labels","confusionMatrix"),a=F(e,"predictions","confusionMatrix");U(r==null||r>0&&Number.isInteger(r),(function(){return"If provided, numClasses must be a positive integer, but got "+r})),U(n.rank===1,(function(){return"Expected the rank of labels to be 1, but got "+n.rank})),U(a.rank===1,(function(){return"Expected the rank of predictions to be 1, but got "+a.rank})),U(n.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+n.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."})),U(r>0&&Number.isInteger(r),(function(){return"numClasses is required to be a positive integer, but got "+r}));var i=Z_(n.asType("int32"),r),o=Z_(a.asType("int32"),r);return i.transpose().matMul(o).asType("int32")}});var lde=J({fromPixels_:function(t,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var r=!1,n=!1,a=!1,i=!1,o=!1;if(t.data instanceof Uint8Array)r=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else{if(t.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);o=!0}if(a&&a&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(HF("FromPixels",ee.backendName)!=null)return ee.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,u,l=a?[t.videoWidth,t.videoHeight]:[t.width,t.height],f=l[0],d=l[1];if(o?s=t.getContext("2d").getImageData(0,0,f,d).data:n||r?s=t.data:(i||a)&&(fu==null&&(fu=document.createElement("canvas").getContext("2d")),fu.canvas.width=f,fu.canvas.height=d,fu.drawImage(t,0,0,f,d),s=fu.getImageData(0,0,f,d).data),e===4)u=new Int32Array(s);else{var p=f*d;u=new Int32Array(p*e);for(var v=0;v<p;v++)for(var g=0;g<e;++g)u[v*e+g]=s[4*v+g]}return AS(u,[d,f,e],"int32")}}),ZS=Object.freeze({toPixels:function(t,e){return Ne(this,void 0,void 0,(function(){var r,n,a,i,o,s,u,l,f,d,p,v,g,b,y,x,S,E,C,k,A,T,N;return Re(this,(function(R){switch(R.label){case 0:if(r=F(t,"img","toPixels"),t instanceof Ft||(r=r.toInt()),r.rank!==2&&r.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+r.rank+".");if(n=r.shape.slice(0,2),a=n[0],i=n[1],(o=r.rank===2?1:r.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,r.data()];case 1:return s=R.sent(),u=r.min(),l=r.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(f=R.sent(),d=f[0],p=f[1],v=d[0],g=p[0],u.dispose(),l.dispose(),r.dtype==="float32"){if(v<0||g>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+v+" - "+g+"].")}else{if(r.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+r.dtype+". Please use float32 or int32 tensors.");if(v<0||g>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+v+" - "+g+"].")}for(b=r.dtype==="float32"?255:1,y=new Uint8ClampedArray(i*a*4),x=0;x<a*i;++x)S=void 0,E=void 0,C=void 0,k=void 0,o===1?(S=s[x]*b,E=s[x]*b,C=s[x]*b,k=255):o===3?(S=s[3*x]*b,E=s[3*x+1]*b,C=s[3*x+2]*b,k=255):o===4&&(S=s[4*x]*b,E=s[4*x+1]*b,C=s[4*x+2]*b,k=s[4*x+3]*b),y[(A=4*x)+0]=Math.round(S),y[A+1]=Math.round(E),y[A+2]=Math.round(C),y[A+3]=Math.round(k);return e!=null&&(e.width=i,e.height=a,T=e.getContext("2d"),N=new ImageData(y,i,a),T.putImageData(N,0,0)),r!==t&&r.dispose(),[2,y]}}))}))},fromPixels:lde}),cde=(function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(e,r){return new e(r)},t})(),fde=(function(){function t(){this.classNameMap={}}return t.getMap=function(){return t.instance==null&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t})();function Ss(t){U(t.className!=null,(function(){return"Class being registered does not have the static className property defined."})),U(typeof t.className=="string",(function(){return"className is required to be a string, but got type "+typeof t.className})),U(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),fde.register(t)}var Es=(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return va(e,t),e.prototype.minimize=function(r,n,a){n===void 0&&(n=!1);var i=this.computeGradients(r,a),o=i.value,s=i.grads;if(a!=null){var u=a.map((function(l){return{name:l.name,tensor:s[l.name]}}));this.applyGradients(u)}else this.applyGradients(s);return fn(s),n?o:(o.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(r,n){return wse(r,n)},e.prototype.dispose=function(){this.iterations_!=null&&fn(this.iterations_)},e.prototype.saveIterations=function(){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Ee(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(r){return Ne(this,void 0,void 0,(function(){return Re(this,(function(n){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(r){return Ne(this,void 0,void 0,(function(){var n;return Re(this,(function(a){switch(a.label){case 0:return n=this,[4,r[0].tensor.data()];case 1:return n.iterations_=a.sent()[0],[2,r.slice(1)]}}))}))},e})(cde);Object.defineProperty(Es,Symbol.hasInstance,{value:function(t){return t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null}});var dde=(function(t){function e(r,n,a){a===void 0&&(a=null);var i=t.call(this)||this;return i.learningRate=r,i.rho=n,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=ee.backend.epsilon()),i}return va(e,t),e.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map((function(a){return a.name})):Object.keys(r)).forEach((function(a,i){var o=ee.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:Ae((function(){return ut(o).variable(!1)}))}),n.accumulatedUpdates[i]==null&&(n.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:Ae((function(){return ut(o).variable(!1)}))});var s=Array.isArray(r)?r[i].tensor:r[a];if(s!=null){var u=n.accumulatedGrads[i].variable,l=n.accumulatedUpdates[i].variable;Ae((function(){var f=u.mul(n.rho).add(s.square().mul(1-n.rho)),d=l.add(n.epsilon).sqrt().div(u.add(n.epsilon).sqrt()).mul(s),p=l.mul(n.rho).add(d.square().mul(1-n.rho));u.assign(f),l.assign(p);var v=d.mul(-n.learningRate).add(o);o.assign(v)}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(fn(this.accumulatedGrads.map((function(r){return r.variable}))),fn(this.accumulatedUpdates.map((function(r){return r.variable}))))},e.prototype.getWeights=function(){return Ne(this,void 0,void 0,(function(){var r;return Re(this,(function(n){switch(n.label){case 0:return r=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(r.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},e.prototype.setWeights=function(r){return Ne(this,void 0,void 0,(function(){var n;return Re(this,(function(a){switch(a.label){case 0:return[4,this.extractIterations(r)];case 1:return r=a.sent(),n=r.length/2,this.accumulatedGrads=r.slice(0,n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),this.accumulatedUpdates=r.slice(n,2*n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(r,n){return new r(n.learningRate,n.rho,n.epsilon)},e.className="Adadelta",e})(Es);Ss(dde);var hde=(function(t){function e(r,n){n===void 0&&(n=.1);var a=t.call(this)||this;return a.learningRate=r,a.initialAccumulatorValue=n,a.accumulatedGrads=[],a}return va(e,t),e.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map((function(a){return a.name})):Object.keys(r)).forEach((function(a,i){var o=ee.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accumulator",variable:Ae((function(){return Da(o.shape,n.initialAccumulatorValue).variable(!1)}))});var s=Array.isArray(r)?r[i].tensor:r[a];if(s!=null){var u=n.accumulatedGrads[i].variable;Ae((function(){var l=u.add(s.square());u.assign(l);var f=s.div(l.add(ee.backend.epsilon()).sqrt()).mul(-n.learningRate).add(o);o.assign(f)}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&fn(this.accumulatedGrads.map((function(r){return r.variable})))},e.prototype.getWeights=function(){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){switch(r.label){case 0:return[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(this.accumulatedGrads.map((function(n){return{name:n.originalName,tensor:n.variable}})))]}}))}))},e.prototype.setWeights=function(r){return Ne(this,void 0,void 0,(function(){return Re(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(r)];case 1:return r=n.sent(),this.accumulatedGrads=r.map((function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(r,n){return new r(n.learningRate,n.initialAccumulatorValue)},e.className="Adagrad",e})(Es);Ss(hde);var pde=(function(t){function e(r,n,a,i){i===void 0&&(i=null);var o=t.call(this)||this;return o.learningRate=r,o.beta1=n,o.beta2=a,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],Ae((function(){o.accBeta1=Ee(n).variable(),o.accBeta2=Ee(a).variable()})),i==null&&(o.epsilon=ee.backend.epsilon()),o}return va(e,t),e.prototype.applyGradients=function(r){var n=this,a=Array.isArray(r)?r.map((function(i){return i.name})):Object.keys(r);Ae((function(){var i=hr(1,n.accBeta1),o=hr(1,n.accBeta2);a.forEach((function(s,u){var l=ee.registeredVariables[s];n.accumulatedFirstMoment[u]==null&&(n.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Ae((function(){return ut(l).variable(!1)}))}),n.accumulatedSecondMoment[u]==null&&(n.accumulatedSecondMoment[u]={originalName:s+"/v",variable:Ae((function(){return ut(l).variable(!1)}))});var f=Array.isArray(r)?r[u].tensor:r[s];if(f!=null){var d=n.accumulatedFirstMoment[u].variable,p=n.accumulatedSecondMoment[u].variable,v=d.mul(n.beta1).add(f.mul(1-n.beta1)),g=p.mul(n.beta2).add(f.square().mul(1-n.beta2)),b=v.div(i),y=g.div(o);d.assign(v),p.assign(g);var x=b.div(y.sqrt().add(n.epsilon)).mul(-n.learningRate).add(l);l.assign(x)}})),n.accBeta1.assign(n.accBeta1.mul(n.beta1)),n.accBeta2.assign(n.accBeta2.mul(n.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&fn(this.accumulatedFirstMoment.map((function(r){return r.variable}))),this.accumulatedSecondMoment!=null&&fn(this.accumulatedSecondMoment.map((function(r){return r.variable})))},e.prototype.getWeights=function(){return Ne(this,void 0,void 0,(function(){var r;return Re(this,(function(n){switch(n.label){case 0:return r=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(r.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},e.prototype.setWeights=function(r){return Ne(this,void 0,void 0,(function(){var n,a=this;return Re(this,(function(i){switch(i.label){case 0:return[4,this.extractIterations(r)];case 1:return r=i.sent(),Ae((function(){a.accBeta1.assign(kv(a.beta1,a.iterations_+1)),a.accBeta2.assign(kv(a.beta2,a.iterations_+1))})),n=r.length/2,this.accumulatedFirstMoment=r.slice(0,n).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedSecondMoment=r.slice(n,2*n).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(r,n){return new r(n.learningRate,n.beta1,n.beta2,n.epsilon)},e.className="Adam",e})(Es);Ss(pde);var vde=(function(t){function e(r,n,a,i,o){i===void 0&&(i=null),o===void 0&&(o=0);var s=t.call(this)||this;return s.learningRate=r,s.beta1=n,s.beta2=a,s.epsilon=i,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],Ae((function(){s.iteration=Ee(0).variable(),s.accBeta1=Ee(n).variable()})),i==null&&(s.epsilon=ee.backend.epsilon()),s}return va(e,t),e.prototype.applyGradients=function(r){var n=this,a=Array.isArray(r)?r.map((function(i){return i.name})):Object.keys(r);Ae((function(){var i=hr(1,n.accBeta1),o=ua(-n.learningRate,n.iteration.mul(n.decay).add(1));a.forEach((function(s,u){var l=ee.registeredVariables[s];n.accumulatedFirstMoment[u]==null&&(n.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ut(l).variable(!1)}),n.accumulatedWeightedInfNorm[u]==null&&(n.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:ut(l).variable(!1)});var f=Array.isArray(r)?r[u].tensor:r[s];if(f!=null){var d=n.accumulatedFirstMoment[u].variable,p=n.accumulatedWeightedInfNorm[u].variable,v=d.mul(n.beta1).add(f.mul(1-n.beta1)),g=p.mul(n.beta2),b=f.abs(),y=g.maximum(b);d.assign(v),p.assign(y);var x=o.div(i).mul(v.div(y.add(n.epsilon))).add(l);l.assign(x)}})),n.iteration.assign(n.iteration.add(1)),n.accBeta1.assign(n.accBeta1.mul(n.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&fn(this.accumulatedFirstMoment.map((function(r){return r.variable}))),this.accumulatedWeightedInfNorm!=null&&fn(this.accumulatedWeightedInfNorm.map((function(r){return r.variable})))},e.prototype.getWeights=function(){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(r){return Ne(this,void 0,void 0,(function(){return Re(this,(function(n){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(r,n){return new r(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},e.className="Adamax",e})(Es);Ss(vde);var SB=(function(t){function e(r){var n=t.call(this)||this;return n.learningRate=r,n.setLearningRate(r),n}return va(e,t),e.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map((function(a){return a.name})):Object.keys(r)).forEach((function(a,i){var o=Array.isArray(r)?r[i].tensor:r[a];if(o!=null){var s=ee.registeredVariables[a];Ae((function(){var u=n.c.mul(o).add(s);s.assign(u)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(r){this.learningRate=r,this.c!=null&&this.c.dispose(),this.c=Doe(Ee(-r))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){switch(r.label){case 0:return[4,this.saveIterations()];case 1:return[2,[r.sent()]]}}))}))},e.prototype.setWeights=function(r){return Ne(this,void 0,void 0,(function(){return Re(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(r)];case 1:if((r=n.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(r,n){return new r(n.learningRate)},e.className="SGD",e})(Es);Ss(SB);var mde=(function(t){function e(r,n,a){a===void 0&&(a=!1);var i=t.call(this,r)||this;return i.learningRate=r,i.momentum=n,i.useNesterov=a,i.accumulations=[],i.m=Ee(i.momentum),i}return va(e,t),e.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map((function(a){return a.name})):Object.keys(r)).forEach((function(a,i){var o=ee.registeredVariables[a];n.accumulations[i]==null&&(n.accumulations[i]={originalName:a+"/momentum",variable:Ae((function(){return ut(o).variable(!1)}))});var s=n.accumulations[i].variable,u=Array.isArray(r)?r[i].tensor:r[a];u!=null&&Ae((function(){var l,f=n.m.mul(s).add(u);l=n.useNesterov?n.c.mul(u.add(f.mul(n.m))).add(o):n.c.mul(f).add(o),s.assign(f),o.assign(l)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&fn(this.accumulations.map((function(r){return r.variable})))},e.prototype.setMomentum=function(r){this.momentum=r},e.prototype.getWeights=function(){return Ne(this,void 0,void 0,(function(){return Re(this,(function(r){switch(r.label){case 0:return[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(this.accumulations.map((function(n){return{name:n.originalName,tensor:n.variable}})))]}}))}))},e.prototype.setWeights=function(r){return Ne(this,void 0,void 0,(function(){return Re(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(r)];case 1:return r=n.sent(),this.accumulations=r.map((function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(r,n){return new r(n.learningRate,n.momentum,n.useNesterov)},e.className="Momentum",e})(SB);Ss(mde);var gde=(function(t){function e(r,n,a,i,o){n===void 0&&(n=.9),a===void 0&&(a=0),i===void 0&&(i=null),o===void 0&&(o=!1);var s=t.call(this)||this;if(s.learningRate=r,s.decay=n,s.momentum=a,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,i==null&&(s.epsilon=ee.backend.epsilon()),r==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return va(e,t),e.prototype.applyGradients=function(r){var n=this;(Array.isArray(r)?r.map((function(a){return a.name})):Object.keys(r)).forEach((function(a,i){var o=ee.registeredVariables[a];n.accumulatedMeanSquares[i]==null&&(n.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:Ae((function(){return ut(o).variable(!1)}))}),n.accumulatedMoments[i]==null&&(n.accumulatedMoments[i]={originalName:a+"/momentum",variable:Ae((function(){return ut(o).variable(!1)}))}),n.accumulatedMeanGrads[i]==null&&n.centered&&(n.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:Ae((function(){return ut(o).variable(!1)}))});var s=Array.isArray(r)?r[i].tensor:r[a];if(s!=null){var u=n.accumulatedMeanSquares[i].variable,l=n.accumulatedMoments[i].variable;Ae((function(){var f=u.mul(n.decay).add(s.square().mul(1-n.decay));if(n.centered){var d=n.accumulatedMeanGrads[i].variable,p=d.mul(n.decay).add(s.mul(1-n.decay)),v=l.mul(n.momentum).add(s.mul(n.learningRate).div(f.sub(p.square().add(n.epsilon)).sqrt()));u.assign(f),d.assign(p),l.assign(v);var g=o.sub(v);o.assign(g)}else{var b=u.mul(n.decay).add(s.square().mul(1-n.decay));v=l.mul(n.momentum).add(s.mul(n.learningRate).div(b.add(n.epsilon).sqrt())),u.assign(b),l.assign(v),g=o.sub(v),o.assign(g)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&fn(this.accumulatedMeanSquares.map((function(r){return r.variable}))),this.accumulatedMeanGrads!=null&&this.centered&&fn(this.accumulatedMeanGrads.map((function(r){return r.variable}))),this.accumulatedMoments!=null&&fn(this.accumulatedMoments.map((function(r){return r.variable})))},e.prototype.getWeights=function(){return Ne(this,void 0,void 0,(function(){var r;return Re(this,(function(n){switch(n.label){case 0:return r=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&r.push.apply(r,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(r.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},e.prototype.setWeights=function(r){return Ne(this,void 0,void 0,(function(){var n;return Re(this,(function(a){switch(a.label){case 0:return[4,this.extractIterations(r)];case 1:return r=a.sent(),n=this.centered?r.length/3:r.length/2,this.accumulatedMeanSquares=r.slice(0,n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),this.accumulatedMoments=r.slice(n,2*n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=r.slice(2*n,3*n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(r,n){return new r(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},e.className="RMSProp",e})(Es);Ss(gde);Ft.prototype.squaredDifference=function(t){return LL(this,t)},se=zfe;var l2=function(t,e){return l2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},l2(t,e)};function Qe(t,e){l2(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Vr=function(){return Vr=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Vr.apply(this,arguments)};function De(t,e,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function s(f){try{l(n.next(f))}catch(d){o(d)}}function u(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?i(f.value):a(f.value).then(s,u)}l((n=n.apply(t,[])).next())})}function Me(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=l[0]&2?a.return:l[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,l[1])).done)return i;switch(a=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],a=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Gc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),a=0,e=0;e<r;e++)for(var i=arguments[e],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}var Mu=(function(){function t(e,r){if(!is(e)||!is(r))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:r}));this._width=e,this._height=r}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t})();function km(t,e){return t instanceof Ft&&t.shape.length===e}function yde(t){return km(t,2)}function Am(t){return km(t,3)}function so(t){return km(t,4)}function bde(t){return t%1!==0}function jD(t){return t%2===0}function xde(t,e){e===void 0&&(e=2);var r=Math.pow(10,e);return Math.floor(t*r)/r}function DD(t){return t&&t.width&&t.height}function wde(t,e){var r=t.width,n=t.height,a=e/Math.max(n,r);return new Mu(Math.round(r*a),Math.round(n*a))}function eE(t){return t.reduce(function(e,r){return e.add(r)},new dt(0,0)).div(new dt(t.length,t.length))}function Vf(t,e,r){return Array(t).fill(0).map(function(n,a){return e+a*r})}function is(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||t===0}function MD(t){return is(t)&&0<=t&&t<=1}var dt=(function(){function t(e,r){this._x=e,this._y=r}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t})(),co=(function(){function t(e,r){r===void 0&&(r=!0);var n=e||{},a=[n.left,n.top,n.right,n.bottom].every(is),i=[n.x,n.y,n.width,n.height].every(is);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(n));var o=i?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top],s=o[0],u=o[1],l=o[2],f=o[3];t.assertIsValidBox({x:s,y:u,width:l,height:f},"Box.constructor",r),this._x=s,this._y=u,this._width=l,this._height=f}return t.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(is)},t.assertIsValidBox=function(e,r,n){if(n===void 0&&(n=!1),!t.isRect(e))throw new Error(r+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!n&&(e.width<0||e.height<0))throw new Error(r+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new dt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new dt(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new dt(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new dt(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(o){return Math.round(o)}),r=e[0],n=e[1],a=e[2],i=e[3];return new t({x:r,y:n,width:a,height:i})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(o){return Math.floor(o)}),r=e[0],n=e[1],a=e[2],i=e[3];return new t({x:r,y:n,width:a,height:i})},t.prototype.toSquare=function(){var e=this,r=e.x,n=e.y,a=e.width,i=e.height,o=Math.abs(a-i);return a<i&&(r-=o/2,a+=o),i<a&&(n-=o/2,i+=o),new t({x:r,y:n,width:a,height:i})},t.prototype.rescale=function(e){var r=DD(e)?e.width:e,n=DD(e)?e.height:e;return new t({x:this.x*r,y:this.y*n,width:this.width*r,height:this.height*n})},t.prototype.pad=function(e,r){var n=[this.x-e/2,this.y-r/2,this.width+e,this.height+r],a=n[0],i=n[1],o=n[2],s=n[3];return new t({x:a,y:i,width:o,height:s})},t.prototype.clipAtImageBorders=function(e,r){var n=this,a=n.x,i=n.y,o=n.right,s=n.bottom,u=Math.max(a,0),l=Math.max(i,0),f=o-u,d=s-l,p=Math.min(f,e-u),v=Math.min(d,r-l);return new t({x:u,y:l,width:p,height:v}).floor()},t.prototype.shift=function(e,r){var n=this,a=n.width,i=n.height,o=this.x+e,s=this.y+r;return new t({x:o,y:s,width:a,height:i})},t.prototype.padAtBorders=function(e,r){var n=this.width+1,a=this.height+1,i=1,o=1,s=n,u=a,l=this.left,f=this.top,d=this.right,p=this.bottom;return d>r&&(s=-d+r+n,d=r),p>e&&(u=-p+e+a,p=e),l<1&&(u=2-l,l=1),f<1&&(u=2-f,f=1),{dy:o,edy:u,dx:i,edx:s,y:f,ey:p,x:l,ex:d,w:n,h:a}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t})(),Om=(function(t){Qe(e,t);function e(r,n,a,i,o){return o===void 0&&(o=!1),t.call(this,{left:r,top:n,right:a,bottom:i},o)||this}return e})(co),EB=(function(){function t(e,r,n,a,i){this._imageDims=new Mu(i.width,i.height),this._score=e,this._classScore=r,this._className=n,this._box=new co(a).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new co(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,r){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:r})},t})(),qa=(function(t){Qe(e,t);function e(r,n,a){return t.call(this,r,r,"",n,a)||this}return e.prototype.forSize=function(r,n){var a=t.prototype.forSize.call(this,r,n),i=a.score,o=a.relativeBox,s=a.imageDims;return new e(i,o,s)},e})(EB);function _de(t,e,r){r===void 0&&(r=!0);var n=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),a=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top)),i=n*a;return r?i/(t.area+e.area-i):i/Math.min(t.area,e.area)}function Sde(t){var e=t.map(function(s){return s.x}),r=t.map(function(s){return s.y}),n=e.reduce(function(s,u){return u<s?u:s},1/0),a=r.reduce(function(s,u){return u<s?u:s},1/0),i=e.reduce(function(s,u){return s<u?u:s},0),o=r.reduce(function(s,u){return s<u?u:s},0);return new Om(n,a,i,o)}function Hf(t,e,r,n){n===void 0&&(n=!0);for(var a=e.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],o=function(){var s=a.pop();i.push(s);for(var u=a,l=[],f=0;f<u.length;f++){var d=u[f],p=t[s],v=t[d];l.push(_de(p,v,n))}a=a.filter(function(g,b){return l[b]<=r})};a.length>0;)o();return i}function dd(t,e){return Ae(function(){var r=e[0],n=e[1],a=e[2],i=Da(Gc(t.shape.slice(0,3),[1]),r),o=Da(Gc(t.shape.slice(0,3),[1]),n),s=Da(Gc(t.shape.slice(0,3),[1]),a),u=cr([i,o,s],3);return hr(t,u)})}function Ede(t,e){return e===void 0&&(e=!1),Ae(function(){var r=t.shape.slice(1),n=r[0],a=r[1];if(n===a)return t;var i=Math.abs(n-a),o=Math.round(i*(e?.5:1)),s=n>a?2:1,u=function(v){var g=t.shape.slice();return g[s]=v,Da(g,0)},l=u(o),f=i-l.shape[s],d=e&&f?u(f):null,p=[d,t,l].filter(function(v){return!!v}).map(function(v){return v.toFloat()});return cr(p,s)})}function i1(t){return 1/(1+Math.exp(-t))}var tE=(function(t){Qe(e,t);function e(r,n,a,i,o){return o===void 0&&(o=!1),t.call(this,{x:r,y:n,width:a,height:i},o)||this}return e})(co),Cde=.5,kde=.43,Ade=.45,Tv=(function(){function t(e,r,n){n===void 0&&(n=new dt(0,0));var a=r.width,i=r.height;this._imgDims=new Mu(a,i),this._shift=n,this._positions=e.map(function(o){return o.mul(new dt(a,i)).add(n)})}return Object.defineProperty(t.prototype,"shift",{get:function(){return new dt(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(r){return r.sub(e._shift).div(new dt(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,r){return new this.constructor(this.relativePositions,{width:e,height:r})},t.prototype.shiftBy=function(e,r){return new this.constructor(this.relativePositions,this._imgDims,new dt(e,r))},t.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},t.prototype.align=function(e,r){if(r===void 0&&(r={}),e){var n=e instanceof qa?e.box.floor():new co(e);return this.shiftBy(n.x,n.y).align(null,r)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},r),i=a.useDlibAlignment,o=a.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(o)},t.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),r=e[0],n=e[1],a=e[2],i=function(d){return a.sub(d).magnitude()},o=(i(r)+i(n))/2,s=Math.floor(o/Ade),u=eE(e),l=Math.floor(Math.max(0,u.x-Cde*s)),f=Math.floor(Math.max(0,u.y-kde*s));return new tE(l,f,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+f))},t.prototype.alignMinBbox=function(e){var r=Sde(this.positions);return r.pad(r.width*e,r.height*e)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t})(),Ode=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var r=this.positions;return[r[0],r[1],eE([r[3],r[4]])]},e})(Tv),Tde=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(eE)},e})(Tv),FD=(function(){function t(e,r){this._label=e,this._distance=r}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+xde(this.distance)+")":"")},t})(),LD=(function(t){Qe(e,t);function e(r,n){var a=t.call(this,r)||this;return a._label=n,a}return e.assertIsValidLabeledBox=function(r,n){if(co.assertIsValidBox(r,n),!is(r.label))throw new Error(n+" - expected property label ("+r.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e})(co),Dc=(function(){function t(e,r){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(r)||r.some(function(n){return!(n instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=r}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},t.fromJSON=function(e){var r=e.descriptors.map(function(n){return new Float32Array(n)});return new t(e.label,r)},t})();(function(t){Qe(e,t);function e(r,n,a,i){var o=t.call(this,r,n)||this;return o._score=a,o._classScore=i,o}return e.assertIsValidPredictedBox=function(r,n){if(LD.assertIsValidLabeledBox(r,n),!MD(r.score)||!MD(r.classScore))throw new Error(n+" - expected properties score ("+r.score+") and ("+r.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(LD);function Pde(t){return t.detection instanceof qa}function rE(t,e){var r={detection:e};return Object.assign({},t,r)}function CB(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:e}}function kB(t){var e="";if(!t)try{t=require("fs")}catch(n){e=n.toString()}var r=t?function(n){return new Promise(function(a,i){t.readFile(n,function(o,s){return o?i(o):a(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:r}}function AB(){var t=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,r=function(){if(t)return new t;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},n=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=kB();return Vr({Canvas:t||(function(){function o(){}return o})(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||(function(){function o(){}return o})(),Image:e||(function(){function o(){}return o})(),ImageData:global.ImageData||(function(){function o(){}return o})(),Video:global.HTMLVideoElement||(function(){function o(){}return o})(),createCanvasElement:r,createImageElement:n,fetch:a},i)}function OB(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function TB(){return typeof global=="object"&&typeof require=="function"&&typeof u$<"u"&&typeof process<"u"&&!!process.version}var sr;function Nde(){if(!sr)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return sr}function c2(t){sr=t}function nE(){OB()&&c2(CB()),TB()&&c2(AB())}function Rde(t){if(sr||nE(),!sr)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,r=e===void 0?sr.Canvas:e,n=t.Image,a=n===void 0?sr.Image:n;sr.Canvas=r,sr.Image=a,sr.createCanvasElement=t.createCanvasElement||(function(){return new r}),sr.createImageElement=t.createImageElement||(function(){return new a}),sr.ImageData=t.ImageData||sr.ImageData,sr.Video=t.Video||sr.Video,sr.fetch=t.fetch||sr.fetch,sr.readFile=t.readFile||sr.readFile}var Dr={getEnv:Nde,setEnv:c2,initialize:nE,createBrowserEnv:CB,createFileSystem:kB,createNodejsEnv:AB,monkeyPatch:Rde,isBrowser:OB,isNodejs:TB};nE();function PB(t){return!Dr.isNodejs()&&typeof t=="string"?document.getElementById(t):t}function hs(t){var e=Dr.getEnv(),r=e.Canvas,n=e.CanvasRenderingContext2D;if(t instanceof n)return t;var a=PB(t);if(!(a instanceof r))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=a.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var BD;(function(t){t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT"})(BD||(BD={}));function NB(t){var e=Dr.getEnv(),r=e.Image,n=e.Video;return t instanceof r&&t.complete||t instanceof n&&t.readyState>=3}function Ide(t){return new Promise(function(e,r){if(t instanceof Dr.getEnv().Canvas||NB(t))return e();function n(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),e(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),r(i))}t.addEventListener("load",n),t.addEventListener("error",a)})}function jde(t){return new Promise(function(e,r){if(!(t instanceof Blob))return r("bufferToImage - expected buf to be of type: Blob");var n=new FileReader;n.onload=function(){if(typeof n.result!="string")return r("bufferToImage - expected reader.result to be a string, in onload");var a=Dr.getEnv().createImageElement();a.onload=function(){return e(a)},a.onerror=r,a.src=n.result},n.onerror=r,n.readAsDataURL(t)})}function RB(t){var e=Dr.getEnv(),r=e.Image,n=e.Video;return t instanceof r?new Mu(t.naturalWidth,t.naturalHeight):t instanceof n?new Mu(t.videoWidth,t.videoHeight):new Mu(t.width,t.height)}function Tm(t){var e=t.width,r=t.height,n=Dr.getEnv().createCanvasElement,a=n();return a.width=e,a.height=r,a}function aE(t,e){var r=Dr.getEnv().ImageData;if(!(t instanceof r)&&!NB(t))throw new Error("createCanvasFromMedia - media has not finished loading yet");var n=RB(t),a=n.width,i=n.height,o=Tm({width:a,height:i});return t instanceof r?hs(o).putImageData(t,0,0):hs(o).drawImage(t,0,0,a,i),o}function Dde(t,e){return De(this,void 0,void 0,function(){var r,n,a,i,o,s;return Me(this,function(u){switch(u.label){case 0:return r=Dr.getEnv().createCanvasElement(),n=t.shape.slice(so(t)?1:0),a=n[0],i=n[1],o=n[2],s=Ae(function(){return t.as3D(a,i,o).toInt()}),[4,ZS.toPixels(s,r)];case 1:return u.sent(),s.dispose(),[2,r]}})})}function $D(t){var e=Dr.getEnv(),r=e.Image,n=e.Canvas,a=e.Video;return t instanceof r||t instanceof n||t instanceof a}function Mde(t,e,r){r===void 0&&(r=!1);var n=Dr.getEnv(),a=n.Image,i=n.Canvas;if(!(t instanceof a||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var o=RB(t),s=e/Math.max(o.height,o.width),u=s*o.width,l=s*o.height,f=Tm({width:e,height:e}),d=t instanceof i?t:aE(t),p=Math.abs(u-l)/2,v=r&&u<l?p:0,g=r&&l<u?p:0;return hs(f).drawImage(d,v,g,u,l),f}var Pv=(function(){function t(e,r){var n=this;if(r===void 0&&(r=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=r,this._batchSize=e.length,e.forEach(function(a,i){if(Am(a)){n._imageTensors[i]=a,n._inputDimensions[i]=a.shape;return}if(so(a)){var o=a.shape[0];if(o!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+o+" passed, but not supported in input array");n._imageTensors[i]=a,n._inputDimensions[i]=a.shape.slice(1);return}var s=a instanceof Dr.getEnv().Canvas?a:aE(a);n._canvases[i]=s,n._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Vf(this.batchSize,0,1).map(function(r,n){return e.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),t.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},t.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},t.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},t.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},t.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var r=this.getInputWidth(e),n=this.getInputHeight(e);return wde({width:r,height:n},this.inputSize)},t.prototype.toBatchTensor=function(e,r){var n=this;return r===void 0&&(r=!0),this._inputSize=e,Ae(function(){var a=Vf(n.batchSize,0,1).map(function(o){var s=n.getInput(o);if(s instanceof Ft){var u=so(s)?s:s.expandDims();return u=Ede(u,r),(u.shape[1]!==e||u.shape[2]!==e)&&(u=GS.resizeBilinear(u,[e,e])),u.as3D(e,e,3)}if(s instanceof Dr.getEnv().Canvas)return ZS.fromPixels(Mde(s,e,r));throw new Error("toBatchTensor - at batchIdx "+o+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=Tn(a.map(function(o){return o.toFloat()})).as4D(n.batchSize,e,e,3);return i})},t})();function _r(t){return De(this,void 0,void 0,function(){var e,r,n;return Me(this,function(a){switch(a.label){case 0:if(t instanceof Pv)return[2,t];if(e=Array.isArray(t)?t:[t],!e.length)throw new Error("toNetInput - empty array passed as input");return r=function(i){return Array.isArray(t)?" at input index "+i+":":""},n=e.map(PB),n.forEach(function(i,o){if(!$D(i)&&!Am(i)&&!so(i))throw typeof e[o]=="string"?new Error("toNetInput -"+r(o)+" string passed, but could not resolve HTMLElement for element id "+e[o]):new Error("toNetInput -"+r(o)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(so(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+r(o)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(n.map(function(i){return $D(i)&&Ide(i)}))];case 1:return a.sent(),[2,new Pv(n,Array.isArray(t))]}})})}function iE(t,e){return De(this,void 0,void 0,function(){var r,n,a,i,o,s,u;return Me(this,function(l){switch(l.label){case 0:return r=Dr.getEnv().Canvas,n=t,t instanceof r?[3,5]:[4,_r(t)];case 1:if(a=l.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=a.getInput(0),i instanceof r?(o=i,[3,4]):[3,2];case 2:return[4,Dde(i)];case 3:o=l.sent(),l.label=4;case 4:n=o,l.label=5;case 5:return s=hs(n),u=e.map(function(f){return f instanceof qa?f.forSize(n.width,n.height).box.floor():f}).map(function(f){return f.clipAtImageBorders(n.width,n.height)}),[2,u.map(function(f){var d=f.x,p=f.y,v=f.width,g=f.height,b=Tm({width:v,height:g});return hs(b).putImageData(s.getImageData(d,p,v,g),0,0),b})]}})})}function oE(t,e){return De(this,void 0,void 0,function(){return Me(this,function(r){if(!Am(t)&&!so(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(so(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Ae(function(){var n=t.shape.slice(so(t)?1:0),a=n[0],i=n[1],o=n[2],s=e.map(function(l){return l instanceof qa?l.forSize(i,a).box:l}).map(function(l){return l.clipAtImageBorders(i,a)}),u=s.map(function(l){var f=l.x,d=l.y,p=l.width,v=l.height;return iB(t.as3D(a,i,o),[d,f,0],[v,p,o])});return u})]})})}function IB(t,e){return De(this,void 0,void 0,function(){var r,n;return Me(this,function(a){switch(a.label){case 0:return r=Dr.getEnv().fetch,[4,r(t,e)];case 1:if(n=a.sent(),!(n.status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function Fde(t){return De(this,void 0,void 0,function(){var e,r;return Me(this,function(n){switch(n.label){case 0:return[4,IB(t)];case 1:return e=n.sent(),[4,e.blob()];case 2:if(r=n.sent(),!r.type.startsWith("image/"))throw new Error("fetchImage - expected blob type to be of type image/*, instead have: "+r.type+", for url: "+e.url);return[2,jde(r)]}})})}function Lde(t){return De(this,void 0,void 0,function(){return Me(this,function(e){switch(e.label){case 0:return[4,IB(t)];case 1:return[2,e.sent().json()]}})})}function jB(t,e){var r=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:r};if(t==="/")return{modelBaseUri:"/",manifestUri:"/"+r};var n=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"";t=t.replace(n,"");var a=t.split("/").filter(function(s){return s}),i=t.endsWith(".json")?a[a.length-1]:r,o=n+(t.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return o=t.startsWith("/")?"/"+o:o,{modelBaseUri:o,manifestUri:o==="/"?"/"+i:o+"/"+i}}function Bde(t,e){return De(this,void 0,void 0,function(){var r,n,a,i;return Me(this,function(o){switch(o.label){case 0:return r=jB(t,e),n=r.manifestUri,a=r.modelBaseUri,[4,Lde(n)];case 1:return i=o.sent(),[2,_B.loadWeights(i,a)]}})})}var _i=(function(){function t(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(e){var r=this.traversePropertyPath(e),n=r.obj,a=r.objProp;return n[a]},t.prototype.reassignParamFromPath=function(e,r){var n=this.traversePropertyPath(e),a=n.obj,i=n.objProp;a[i].dispose(),a[i]=r},t.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(r){var n=r.paramPath;return{path:n,tensor:e.getParamFromPath(n)}})},t.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof hl})},t.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof hl)})},t.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(r){var n=r.path,a=r.tensor;e.reassignParamFromPath(n,a.variable())})},t.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(r){var n=r.path,a=r.tensor,i=Rr(a.dataSync());a.dispose(),e.reassignParamFromPath(n,i)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(r){if(e&&r.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+r.path);r.tensor.dispose()}),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var r=e.tensor;return Array.from(r.dataSync())}).reduce(function(e,r){return e.concat(r)}))},t.prototype.load=function(e){return De(this,void 0,void 0,function(){return Me(this,function(r){switch(r.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return r.sent(),[2]}})})},t.prototype.loadFromUri=function(e){return De(this,void 0,void 0,function(){var r;return Me(this,function(n){switch(n.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,Bde(e,this.getDefaultModelName())];case 1:return r=n.sent(),this.loadFromWeightMap(r),[2]}})})},t.prototype.loadFromDisk=function(e){return De(this,void 0,void 0,function(){var r,n,a,i,o,s,u,l,f,d;return Me(this,function(p){switch(p.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return r=Dr.getEnv().readFile,n=jB(e,this.getDefaultModelName()),a=n.manifestUri,i=n.modelBaseUri,o=function(v){return Promise.all(v.map(function(g){return r(g).then(function(b){return b.buffer})}))},s=_B.weightsLoaderFactory(o),f=(l=JSON).parse,[4,r(a)];case 1:return u=f.apply(l,[p.sent().toString()]),[4,s(u,i)];case 2:return d=p.sent(),this.loadFromWeightMap(d),[2]}})})},t.prototype.loadFromWeightMap=function(e){var r=this.extractParamsFromWeigthMap(e),n=r.paramMappings,a=r.params;this._paramMappings=n,this._params=a},t.prototype.extractWeights=function(e){var r=this.extractParams(e),n=r.paramMappings,a=r.params;this._paramMappings=n,this._params=a},t.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var r=e.split("/").reduce(function(i,o){if(!i.nextObj.hasOwnProperty(o))throw new Error("traversePropertyPath - object does not have property "+o+", for path "+e);return{obj:i.nextObj,objProp:o,nextObj:i.nextObj[o]}},{nextObj:this.params}),n=r.obj,a=r.objProp;if(!n||!a||!(n[a]instanceof Ft))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:n,objProp:a}},t})();function On(t,e,r){return Ae(function(){var n=WS(t,e.depthwise_filter,e.pointwise_filter,r,"same");return n=it(n,e.bias),n})}function o1(t,e,r){return r===void 0&&(r=!1),Ae(function(){var n=Lt(r?it(Kn(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):On(t,e.conv0,[2,2])),a=On(n,e.conv1,[1,1]),i=Lt(it(n,a)),o=On(i,e.conv2,[1,1]);return Lt(it(n,it(a,o)))})}function Qh(t,e,r,n){return r===void 0&&(r=!1),n===void 0&&(n=!0),Ae(function(){var a=Lt(r?it(Kn(t,e.conv0.filters,n?[2,2]:[1,1],"same"),e.conv0.bias):On(t,e.conv0,n?[2,2]:[1,1])),i=On(a,e.conv1,[1,1]),o=Lt(it(a,i)),s=On(o,e.conv2,[1,1]),u=Lt(it(a,it(i,s))),l=On(u,e.conv3,[1,1]);return Lt(it(a,it(i,it(s,l))))})}function da(t,e,r,n){return r===void 0&&(r="same"),n===void 0&&(n=!1),Ae(function(){var a=it(Kn(t,e.filters,[1,1],r),e.bias);return n?Lt(a):a})}function Si(t,e){Object.keys(t).forEach(function(r){e.some(function(n){return n.originalPath===r})||t[r].dispose()})}function Pm(t,e){return function(r,n,a,i){var o=un(t(r*n*a*a),[a,a,r,n]),s=er(t(n));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:o,bias:s}}}function sE(t,e){return function(r,n,a){var i=io(t(r*n),[r,n]),o=er(t(n));return e.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:o}}}var DB=(function(){function t(e,r,n){this.depthwise_filter=e,this.pointwise_filter=r,this.bias=n}return t})();function uE(t,e){return function(r,n,a){var i=un(t(9*r),[3,3,r,1]),o=un(t(r*n),[1,1,r,n]),s=er(t(n));return e.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new DB(i,o,s)}}function lE(t){return function(e){var r=t(e+"/depthwise_filter",4),n=t(e+"/pointwise_filter",4),a=t(e+"/bias",1);return new DB(r,n,a)}}function wo(t,e){return function(r,n,a){var i=t[r];if(!km(i,n))throw new Error("expected weightMap["+r+"] to be a Tensor"+n+"D, instead have "+i);return e.push({originalPath:r,paramPath:a||r}),i}}function Ei(t){var e=t;function r(a){var i=e.slice(0,a);return e=e.slice(a),i}function n(){return e}return{extractWeights:r,getRemainingWeights:n}}function MB(t,e){var r=Pm(t,e),n=uE(t,e);function a(o,s,u,l){l===void 0&&(l=!1);var f=l?r(o,s,3,u+"/conv0"):n(o,s,u+"/conv0"),d=n(s,s,u+"/conv1"),p=n(s,s,u+"/conv2");return{conv0:f,conv1:d,conv2:p}}function i(o,s,u,l){l===void 0&&(l=!1);var f=a(o,s,u,l),d=f.conv0,p=f.conv1,v=f.conv2,g=n(s,s,u+"/conv3");return{conv0:d,conv1:p,conv2:v,conv3:g}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function $de(t){var e=[],r=Ei(t),n=r.extractWeights,a=r.getRemainingWeights,i=MB(n,e).extractDenseBlock4Params,o=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:e,params:{dense0:o,dense1:s,dense2:u,dense3:l}}}function FB(t){return function(e){var r=t(e+"/filters",4),n=t(e+"/bias",1);return{filters:r,bias:n}}}function LB(t,e){var r=wo(t,e),n=FB(r),a=lE(r);function i(s,u){u===void 0&&(u=!1);var l=u?n(s+"/conv0"):a(s+"/conv0"),f=a(s+"/conv1"),d=a(s+"/conv2");return{conv0:l,conv1:f,conv2:d}}function o(s,u){u===void 0&&(u=!1);var l=u?n(s+"/conv0"):a(s+"/conv0"),f=a(s+"/conv1"),d=a(s+"/conv2"),p=a(s+"/conv3");return{conv0:l,conv1:f,conv2:d,conv3:p}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:o}}function Ude(t){var e=[],r=LB(t,e).extractDenseBlock4Params,n={dense0:r("dense0",!0),dense1:r("dense1"),dense2:r("dense2"),dense3:r("dense3")};return Si(t,e),{params:n,paramMappings:e}}var BB=(function(t){Qe(e,t);function e(){return t.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(r){var n=this.params;if(!n)throw new Error("FaceFeatureExtractor - load model before inference");return Ae(function(){var a=r.toBatchTensor(112,!0),i=[122.782,117.001,104.298],o=dd(a,i).div(Ee(255)),s=Qh(o,n.dense0,!0);return s=Qh(s,n.dense1),s=Qh(s,n.dense2),s=Qh(s,n.dense3),s=cd(s,[7,7],[2,2],"valid"),s})},e.prototype.forward=function(r){return De(this,void 0,void 0,function(){var n;return Me(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,_r(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(r){return Ude(r)},e.prototype.extractParams=function(r){return $de(r)},e})(_i);function Pa(t,e){return Ae(function(){return it(Sm(t,e.weights),e.bias)})}function Wde(t,e,r){var n=[],a=Ei(t),i=a.extractWeights,o=a.getRemainingWeights,s=sE(i,n),u=s(e,r,"fc");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{fc:u}}}function zde(t){var e=[],r=wo(t,e);function n(i){var o=r(i+"/weights",2),s=r(i+"/bias",1);return{weights:o,bias:s}}var a={fc:n("fc")};return Si(t,e),{params:a,paramMappings:e}}function $B(t){var e={},r={};return Object.keys(t).forEach(function(n){var a=n.startsWith("fc")?r:e;a[n]=t[n]}),{featureExtractorMap:e,classifierMap:r}}var UB=(function(t){Qe(e,t);function e(r,n){var a=t.call(this,r)||this;return a._faceFeatureExtractor=n,a}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(r){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Ae(function(){var i=r instanceof Pv?n.faceFeatureExtractor.forwardInput(r):r;return Pa(i.as2D(i.shape[0],-1),a.fc)})},e.prototype.dispose=function(r){r===void 0&&(r=!0),this.faceFeatureExtractor.dispose(r),t.prototype.dispose.call(this,r)},e.prototype.loadClassifierParams=function(r){var n=this.extractClassifierParams(r),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},e.prototype.extractClassifierParams=function(r){return Wde(r,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(r){var n=$B(r),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),zde(i)},e.prototype.extractParams=function(r){var n=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),i=a*n+a,o=r.slice(0,r.length-i),s=r.slice(r.length-i);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(s)},e})(_i),UD=["neutral","happy","sad","angry","fearful","disgusted","surprised"],qde=(function(){function t(e){var r=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);UD.forEach(function(n,a){r[n]=e[a]})}return t.prototype.asSortedArray=function(){var e=this;return UD.map(function(r){return{expression:r,probability:e[r]}}).sort(function(r,n){return n.probability-r.probability})},t})(),Vde=(function(t){Qe(e,t);function e(r){return r===void 0&&(r=new BB),t.call(this,"FaceExpressionNet",r)||this}return e.prototype.forwardInput=function(r){var n=this;return Ae(function(){return xi(n.runNet(r))})},e.prototype.forward=function(r){return De(this,void 0,void 0,function(){var n;return Me(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,_r(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},e.prototype.predictExpressions=function(r){return De(this,void 0,void 0,function(){var n,a,i,o,s=this;return Me(this,function(u){switch(u.label){case 0:return[4,_r(r)];case 1:return n=u.sent(),[4,this.forwardInput(n)];case 2:return a=u.sent(),[4,Promise.all(fr(a).map(function(l){return De(s,void 0,void 0,function(){var f;return Me(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return f=d.sent(),l.dispose(),[2,f]}})})}))];case 3:return i=u.sent(),a.dispose(),o=i.map(function(l){return new qde(l)}),[2,n.isBatchInput?o:o[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e})(UB);function WB(t,e){var r={expressions:e};return Object.assign({},t,r)}function Hde(t){return Pde(t)&&t.landmarks instanceof Tv&&t.unshiftedLandmarks instanceof Tv&&t.alignedRect instanceof qa}function cE(t,e){var r=t.detection.box,n=e.shiftBy(r.x,r.y),a=n.align(),i=t.detection.imageDims,o=new qa(t.detection.score,a.rescale(i.reverse()),i),s={landmarks:n,unshiftedLandmarks:e,alignedRect:o};return Object.assign({},t,s)}function Gde(t,e){var r=Pm(t,e),n=uE(t,e);function a(o,s,u){var l=n(o,s,u+"/separable_conv0"),f=n(s,s,u+"/separable_conv1"),d=r(o,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:f,expansion_conv:d}}function i(o,s){var u=n(o,o,s+"/separable_conv0"),l=n(o,o,s+"/separable_conv1"),f=n(o,o,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:f}}return{extractConvParams:r,extractSeparableConvParams:n,extractReductionBlockParams:a,extractMainBlockParams:i}}function Kde(t,e){var r=[],n=Ei(t),a=n.extractWeights,i=n.getRemainingWeights,o=Gde(a,r),s=o.extractConvParams,u=o.extractSeparableConvParams,l=o.extractReductionBlockParams,f=o.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),p=l(32,64,"entry_flow/reduction_block_0"),v=l(64,128,"entry_flow/reduction_block_1"),g={conv_in:d,reduction_block_0:p,reduction_block_1:v},b={};Vf(e,0,1).forEach(function(E){b["main_block_"+E]=f(128,"middle_flow/main_block_"+E)});var y=l(128,256,"exit_flow/reduction_block"),x=u(256,512,"exit_flow/separable_conv"),S={reduction_block:y,separable_conv:x};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:r,params:{entry_flow:g,middle_flow:b,exit_flow:S}}}function Xde(t,e){var r=wo(t,e),n=FB(r),a=lE(r);function i(s){var u=a(s+"/separable_conv0"),l=a(s+"/separable_conv1"),f=n(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:f}}function o(s){var u=a(s+"/separable_conv0"),l=a(s+"/separable_conv1"),f=a(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:f}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:o}}function Yde(t,e){var r=[],n=Xde(t,r),a=n.extractConvParams,i=n.extractSeparableConvParams,o=n.extractReductionBlockParams,s=n.extractMainBlockParams,u=a("entry_flow/conv_in"),l=o("entry_flow/reduction_block_0"),f=o("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:f},p={};Vf(e,0,1).forEach(function(y){p["main_block_"+y]=s("middle_flow/main_block_"+y)});var v=o("exit_flow/reduction_block"),g=i("exit_flow/separable_conv"),b={reduction_block:v,separable_conv:g};return Si(t,r),{params:{entry_flow:d,middle_flow:p,exit_flow:b},paramMappings:r}}function zB(t,e,r){return it(Kn(t,e.filters,r,"same"),e.bias)}function s1(t,e,r){r===void 0&&(r=!0);var n=r?Lt(t):t;return n=On(n,e.separable_conv0,[1,1]),n=On(Lt(n),e.separable_conv1,[1,1]),n=br(n,[3,3],[2,2],"same"),n=it(n,zB(t,e.expansion_conv,[2,2])),n}function Jde(t,e){var r=On(Lt(t),e.separable_conv0,[1,1]);return r=On(Lt(r),e.separable_conv1,[1,1]),r=On(Lt(r),e.separable_conv2,[1,1]),r=it(r,t),r}var Qde=(function(t){Qe(e,t);function e(r){var n=t.call(this,"TinyXception")||this;return n._numMainBlocks=r,n}return e.prototype.forwardInput=function(r){var n=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return Ae(function(){var i=r.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=dd(i,o).div(Ee(256)),u=Lt(zB(s,a.entry_flow.conv_in,[2,2]));return u=s1(u,a.entry_flow.reduction_block_0,!1),u=s1(u,a.entry_flow.reduction_block_1),Vf(n._numMainBlocks,0,1).forEach(function(l){u=Jde(u,a.middle_flow["main_block_"+l])}),u=s1(u,a.exit_flow.reduction_block),u=Lt(On(u,a.exit_flow.separable_conv,[1,1])),u})},e.prototype.forward=function(r){return De(this,void 0,void 0,function(){var n;return Me(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,_r(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(r){return Yde(r,this._numMainBlocks)},e.prototype.extractParams=function(r){return Kde(r,this._numMainBlocks)},e})(_i);function Zde(t){var e=[],r=Ei(t),n=r.extractWeights,a=r.getRemainingWeights,i=sE(n,e),o=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:e,params:{fc:{age:o,gender:s}}}}function ehe(t){var e=[],r=wo(t,e);function n(i){var o=r(i+"/weights",2),s=r(i+"/bias",1);return{weights:o,bias:s}}var a={fc:{age:n("fc/age"),gender:n("fc/gender")}};return Si(t,e),{params:a,paramMappings:e}}var Nv;(function(t){t.FEMALE="female",t.MALE="male"})(Nv||(Nv={}));var the=(function(t){Qe(e,t);function e(r){r===void 0&&(r=new Qde(2));var n=t.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=r,n}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(r){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Ae(function(){var i=r instanceof Pv?n.faceFeatureExtractor.forwardInput(r):r,o=cd(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Pa(o,a.fc.age).as1D(),u=Pa(o,a.fc.gender);return{age:s,gender:u}})},e.prototype.forwardInput=function(r){var n=this;return Ae(function(){var a=n.runNet(r),i=a.age,o=a.gender;return{age:i,gender:xi(o)}})},e.prototype.forward=function(r){return De(this,void 0,void 0,function(){var n;return Me(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,_r(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},e.prototype.predictAgeAndGender=function(r){return De(this,void 0,void 0,function(){var n,a,i,o,s,u,l=this;return Me(this,function(f){switch(f.label){case 0:return[4,_r(r)];case 1:return n=f.sent(),[4,this.forwardInput(n)];case 2:return a=f.sent(),i=fr(a.age),o=fr(a.gender),s=i.map(function(d,p){return{ageTensor:d,genderTensor:o[p]}}),[4,Promise.all(s.map(function(d){var p=d.ageTensor,v=d.genderTensor;return De(l,void 0,void 0,function(){var g,b,y,x,S;return Me(this,function(E){switch(E.label){case 0:return[4,p.data()];case 1:return g=E.sent()[0],[4,v.data()];case 2:return b=E.sent()[0],y=b>.5,x=y?Nv.MALE:Nv.FEMALE,S=y?b:1-b,p.dispose(),v.dispose(),[2,{age:g,gender:x,genderProbability:S}]}})})}))];case 3:return u=f.sent(),a.age.dispose(),a.gender.dispose(),[2,n.isBatchInput?u:u[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(r){r===void 0&&(r=!0),this.faceFeatureExtractor.dispose(r),t.prototype.dispose.call(this,r)},e.prototype.loadClassifierParams=function(r){var n=this.extractClassifierParams(r),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},e.prototype.extractClassifierParams=function(r){return Zde(r)},e.prototype.extractParamsFromWeigthMap=function(r){var n=$B(r),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),ehe(i)},e.prototype.extractParams=function(r){var n=1539,a=r.slice(0,r.length-n),i=r.slice(r.length-n);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},e})(_i),qB=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.postProcess=function(r,n,a){var i=a.map(function(s){var u=s.width,l=s.height,f=n/Math.max(l,u);return{width:u*f,height:l*f}}),o=i.length;return Ae(function(){var s=function(p,v){return Tn([Da([68],p),Da([68],v)],1).as2D(1,136).as1D()},u=function(p,v){var g=i[p],b=g.width,y=g.height;return v(b,y)?Math.abs(b-y)/2:0},l=function(p){return u(p,function(v,g){return v<g})},f=function(p){return u(p,function(v,g){return g<v})},d=r.mul(Da([o,136],n)).sub(Tn(Array.from(Array(o),function(p,v){return s(l(v),f(v))}))).div(Tn(Array.from(Array(o),function(p,v){return s(i[v].width,i[v].height)})));return d})},e.prototype.forwardInput=function(r){var n=this;return Ae(function(){var a=n.runNet(r);return n.postProcess(a,r.inputSize,r.inputDimensions.map(function(i){var o=i[0],s=i[1];return{height:o,width:s}}))})},e.prototype.forward=function(r){return De(this,void 0,void 0,function(){var n;return Me(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,_r(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},e.prototype.detectLandmarks=function(r){return De(this,void 0,void 0,function(){var n,a,i,o=this;return Me(this,function(s){switch(s.label){case 0:return[4,_r(r)];case 1:return n=s.sent(),a=Ae(function(){return fr(o.forwardInput(n))}),[4,Promise.all(a.map(function(u,l){return De(o,void 0,void 0,function(){var f,d,p,v,g;return Me(this,function(b){switch(b.label){case 0:return p=(d=Array).from,[4,u.data()];case 1:return f=p.apply(d,[b.sent()]),v=f.filter(function(y,x){return jD(x)}),g=f.filter(function(y,x){return!jD(x)}),[2,new Tde(Array(68).fill(0).map(function(y,x){return new dt(v[x],g[x])}),{height:n.getInputHeight(l),width:n.getInputWidth(l)})]}})})}))];case 2:return i=s.sent(),a.forEach(function(u){return u.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e})(UB),VB=(function(t){Qe(e,t);function e(r){return r===void 0&&(r=new BB),t.call(this,"FaceLandmark68Net",r)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e})(qB);function rhe(t){var e=[],r=LB(t,e).extractDenseBlock3Params,n={dense0:r("dense0",!0),dense1:r("dense1"),dense2:r("dense2")};return Si(t,e),{params:n,paramMappings:e}}function nhe(t){var e=[],r=Ei(t),n=r.extractWeights,a=r.getRemainingWeights,i=MB(n,e).extractDenseBlock3Params,o=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:e,params:{dense0:o,dense1:s,dense2:u}}}var ahe=(function(t){Qe(e,t);function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(r){var n=this.params;if(!n)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Ae(function(){var a=r.toBatchTensor(112,!0),i=[122.782,117.001,104.298],o=dd(a,i).div(Ee(255)),s=o1(o,n.dense0,!0);return s=o1(s,n.dense1),s=o1(s,n.dense2),s=cd(s,[14,14],[2,2],"valid"),s})},e.prototype.forward=function(r){return De(this,void 0,void 0,function(){var n;return Me(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,_r(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(r){return rhe(r)},e.prototype.extractParams=function(r){return nhe(r)},e})(_i),ihe=(function(t){Qe(e,t);function e(r){return r===void 0&&(r=new ahe),t.call(this,"FaceLandmark68TinyNet",r)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e})(qB);(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(VB);function ohe(t,e){return it(Kr(t,e.weights),e.biases)}function fE(t,e,r,n,a){a===void 0&&(a="same");var i=e.conv,o=i.filters,s=i.bias,u=Kn(t,o,r,a);return u=it(u,s),u=ohe(u,e.scale),n?Lt(u):u}function she(t,e){return fE(t,e,[1,1],!0)}function HB(t,e){return fE(t,e,[1,1],!1)}function GB(t,e){return fE(t,e,[2,2],!0,"valid")}function uhe(t,e){function r(s,u,l){var f=t(s),d=f.length/(u*l*l);if(bde(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+f.length+", numFilters: "+u+", filterSize: "+l);return Ae(function(){return lo(un(f,[u,d,l,l]),[2,3,1,0])})}function n(s,u,l,f){var d=r(s,u,l),p=er(t(u));return e.push({paramPath:f+"/filters"},{paramPath:f+"/bias"}),{filters:d,bias:p}}function a(s,u){var l=er(t(s)),f=er(t(s));return e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:f}}function i(s,u,l,f){var d=n(s,u,l,f+"/conv"),p=a(u,f+"/scale");return{conv:d,scale:p}}function o(s,u,l,f,d){d===void 0&&(d=!1);var p=i((d?.5:1)*s,u,l,f+"/conv1"),v=i(s,u,l,f+"/conv2");return{conv1:p,conv2:v}}return{extractConvLayerParams:i,extractResidualLayerParams:o}}function lhe(t){var e=Ei(t),r=e.extractWeights,n=e.getRemainingWeights,a=[],i=uhe(r,a),o=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=o(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),f=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),p=s(36864,64,3,"conv64_down",!0),v=s(36864,64,3,"conv64_1"),g=s(36864,64,3,"conv64_2"),b=s(36864,64,3,"conv64_3"),y=s(147456,128,3,"conv128_down",!0),x=s(147456,128,3,"conv128_1"),S=s(147456,128,3,"conv128_2"),E=s(589824,256,3,"conv256_down",!0),C=s(589824,256,3,"conv256_1"),k=s(589824,256,3,"conv256_2"),A=s(589824,256,3,"conv256_down_out"),T=Ae(function(){return lo(io(r(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),n().length!==0)throw new Error("weights remaing after extract: "+n().length);var N={conv32_down:u,conv32_1:l,conv32_2:f,conv32_3:d,conv64_down:p,conv64_1:v,conv64_2:g,conv64_3:b,conv128_down:y,conv128_1:x,conv128_2:S,conv256_down:E,conv256_1:C,conv256_2:k,conv256_down_out:A,fc:T};return{params:N,paramMappings:a}}function che(t,e){var r=wo(t,e);function n(o){var s=r(o+"/scale/weights",1),u=r(o+"/scale/biases",1);return{weights:s,biases:u}}function a(o){var s=r(o+"/conv/filters",4),u=r(o+"/conv/bias",1),l=n(o);return{conv:{filters:s,bias:u},scale:l}}function i(o){return{conv1:a(o+"/conv1"),conv2:a(o+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function fhe(t){var e=[],r=che(t,e),n=r.extractConvLayerParams,a=r.extractResidualLayerParams,i=n("conv32_down"),o=a("conv32_1"),s=a("conv32_2"),u=a("conv32_3"),l=a("conv64_down"),f=a("conv64_1"),d=a("conv64_2"),p=a("conv64_3"),v=a("conv128_down"),g=a("conv128_1"),b=a("conv128_2"),y=a("conv256_down"),x=a("conv256_1"),S=a("conv256_2"),E=a("conv256_down_out"),C=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!yde(C))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+C);var k={conv32_down:i,conv32_1:o,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:f,conv64_2:d,conv64_3:p,conv128_down:v,conv128_1:g,conv128_2:b,conv256_down:y,conv256_1:x,conv256_2:S,conv256_down_out:E,fc:C};return Si(t,e),{params:k,paramMappings:e}}function Sa(t,e){var r=she(t,e.conv1);return r=HB(r,e.conv2),r=it(r,t),r=Lt(r),r}function Zh(t,e){var r=GB(t,e.conv1);r=HB(r,e.conv2);var n=cd(t,2,2,"valid"),a=Ot(n.shape),i=n.shape[3]!==r.shape[3],o=n.shape[1]!==r.shape[1]||n.shape[2]!==r.shape[2];if(o){var s=Gc(r.shape);s[1]=1;var u=Ot(s);r=cr([r,u],1);var l=Gc(r.shape);l[2]=1;var f=Ot(l);r=cr([r,f],2)}return n=i?cr([n,a],3):n,r=it(n,r),r=Lt(r),r}var dhe=(function(t){Qe(e,t);function e(){return t.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(r){var n=this.params;if(!n)throw new Error("FaceRecognitionNet - load model before inference");return Ae(function(){var a=r.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],o=dd(a,i).div(Ee(256)),s=GB(o,n.conv32_down);s=br(s,3,2,"valid"),s=Sa(s,n.conv32_1),s=Sa(s,n.conv32_2),s=Sa(s,n.conv32_3),s=Zh(s,n.conv64_down),s=Sa(s,n.conv64_1),s=Sa(s,n.conv64_2),s=Sa(s,n.conv64_3),s=Zh(s,n.conv128_down),s=Sa(s,n.conv128_1),s=Sa(s,n.conv128_2),s=Zh(s,n.conv256_down),s=Sa(s,n.conv256_1),s=Sa(s,n.conv256_2),s=Zh(s,n.conv256_down_out);var u=s.mean([1,2]),l=Sm(u,n.fc);return l})},e.prototype.forward=function(r){return De(this,void 0,void 0,function(){var n;return Me(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,_r(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},e.prototype.computeFaceDescriptor=function(r){return De(this,void 0,void 0,function(){var n,a,i,o=this;return Me(this,function(s){switch(s.label){case 0:return[4,_r(r)];case 1:return n=s.sent(),a=Ae(function(){return fr(o.forwardInput(n))}),[4,Promise.all(a.map(function(u){return u.data()}))];case 2:return i=s.sent(),a.forEach(function(u){return u.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(r){return fhe(r)},e.prototype.extractParams=function(r){return lhe(r)},e})(_i);function KB(t,e){var r={descriptor:e};return Object.assign({},t,r)}function XB(t,e){var r={age:e};return Object.assign({},t,r)}function YB(t,e,r){var n={gender:e,genderProbability:r};return Object.assign({},t,n)}var JB=(function(){function t(e){var r=e===void 0?{}:e,n=r.minFaceSize,a=r.scaleFactor,i=r.maxNumScales,o=r.scoreThresholds,s=r.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=a||.709,this._maxNumScales=i||10,this._scoreThresholds=o||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t})();function hhe(t,e){function r(u,l){var f=un(t(9*u),[3,3,u,1]),d=er(t(u)),p=er(t(u)),v=er(t(u)),g=er(t(u));return e.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:f,batch_norm_scale:d,batch_norm_offset:p,batch_norm_mean:v,batch_norm_variance:g}}function n(u,l,f,d,p){var v=un(t(u*l*f*f),[f,f,u,l]),g=er(t(l));return e.push({paramPath:d+"/filters"},{paramPath:d+"/"+(p?"batch_norm_offset":"bias")}),{filters:v,bias:g}}function a(u,l,f,d){var p=n(u,l,f,d,!0),v=p.filters,g=p.bias;return{filters:v,batch_norm_offset:g}}function i(u,l,f){var d=r(u,f+"/depthwise_conv"),p=a(u,l,1,f+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:p}}function o(){var u=a(3,32,3,"mobilenetv1/conv_0"),l=i(32,64,"mobilenetv1/conv_1"),f=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),p=i(128,256,"mobilenetv1/conv_4"),v=i(256,256,"mobilenetv1/conv_5"),g=i(256,512,"mobilenetv1/conv_6"),b=i(512,512,"mobilenetv1/conv_7"),y=i(512,512,"mobilenetv1/conv_8"),x=i(512,512,"mobilenetv1/conv_9"),S=i(512,512,"mobilenetv1/conv_10"),E=i(512,512,"mobilenetv1/conv_11"),C=i(512,1024,"mobilenetv1/conv_12"),k=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:f,conv_3:d,conv_4:p,conv_5:v,conv_6:g,conv_7:b,conv_8:y,conv_9:x,conv_10:S,conv_11:E,conv_12:C,conv_13:k}}function s(){var u=a(1024,256,1,"prediction_layer/conv_0"),l=a(256,512,3,"prediction_layer/conv_1"),f=a(512,128,1,"prediction_layer/conv_2"),d=a(128,256,3,"prediction_layer/conv_3"),p=a(256,128,1,"prediction_layer/conv_4"),v=a(128,256,3,"prediction_layer/conv_5"),g=a(256,64,1,"prediction_layer/conv_6"),b=a(64,128,3,"prediction_layer/conv_7"),y=n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),x=n(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),S=n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),E=n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),C=n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),k=n(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),A=n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),T=n(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),N=n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),R=n(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),I=n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),D=n(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),j={box_encoding_predictor:y,class_predictor:x},$={box_encoding_predictor:S,class_predictor:E},W={box_encoding_predictor:C,class_predictor:k},q={box_encoding_predictor:A,class_predictor:T},X={box_encoding_predictor:N,class_predictor:R},Y={box_encoding_predictor:I,class_predictor:D};return{conv_0:u,conv_1:l,conv_2:f,conv_3:d,conv_4:p,conv_5:v,conv_6:g,conv_7:b,box_predictor_0:j,box_predictor_1:$,box_predictor_2:W,box_predictor_3:q,box_predictor_4:X,box_predictor_5:Y}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:s}}function phe(t){var e=[],r=Ei(t),n=r.extractWeights,a=r.getRemainingWeights,i=hhe(n,e),o=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=o(),l=s(),f=AS(n(5118*4),[1,5118,4]),d={extra_dim:f};if(e.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:e}}function vhe(t,e){var r=wo(t,e);function n(l,f,d){var p=r(l+"/Conv2d_"+f+"_pointwise/weights",4,d+"/filters"),v=r(l+"/Conv2d_"+f+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:p,batch_norm_offset:v}}function a(l){var f="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",p=f+"/depthwise_conv",v=f+"/pointwise_conv",g=r(d+"/depthwise_weights",4,p+"/filters"),b=r(d+"/BatchNorm/gamma",1,p+"/batch_norm_scale"),y=r(d+"/BatchNorm/beta",1,p+"/batch_norm_offset"),x=r(d+"/BatchNorm/moving_mean",1,p+"/batch_norm_mean"),S=r(d+"/BatchNorm/moving_variance",1,p+"/batch_norm_variance");return{depthwise_conv:{filters:g,batch_norm_scale:b,batch_norm_offset:y,batch_norm_mean:x,batch_norm_variance:S},pointwise_conv:n("MobilenetV1",l,v)}}function i(){return{conv_0:n("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function o(l,f){var d=r(l+"/weights",4,f+"/filters"),p=r(l+"/biases",1,f+"/bias");return{filters:d,bias:p}}function s(l){var f=o("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=o("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:f,class_predictor:d}}function u(){return{conv_0:n("Prediction",0,"prediction_layer/conv_0"),conv_1:n("Prediction",1,"prediction_layer/conv_1"),conv_2:n("Prediction",2,"prediction_layer/conv_2"),conv_3:n("Prediction",3,"prediction_layer/conv_3"),conv_4:n("Prediction",4,"prediction_layer/conv_4"),conv_5:n("Prediction",5,"prediction_layer/conv_5"),conv_6:n("Prediction",6,"prediction_layer/conv_6"),conv_7:n("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function mhe(t){var e=[],r=vhe(t,e),n=r.extractMobilenetV1Params,a=r.extractPredictionLayerParams,i=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Am(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var o={mobilenetv1:n(),prediction_layer:a(),output_layer:{extra_dim:i}};return Si(t,e),{params:o,paramMappings:e}}function Ea(t,e,r){return Ae(function(){var n=Kn(t,e.filters,r,"same");return n=it(n,e.batch_norm_offset),LS(n,0,6)})}var ghe=.0010000000474974513;function yhe(t,e,r){return Ae(function(){var n=_m(t,e.filters,r,"same");return n=qL(n,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,ghe),LS(n,0,6)})}function bhe(t){return[2,4,6,12].some(function(e){return e===t})?[2,2]:[1,1]}function xhe(t,e){return Ae(function(){var r=null,n=Ea(t,e.conv_0,[2,2]),a=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(a.forEach(function(i,o){var s=o+1,u=bhe(s);n=yhe(n,i.depthwise_conv,u),n=Ea(n,i.pointwise_conv,[1,1]),s===11&&(r=n)}),r===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:n,conv11:r}})}function whe(t,e,r,n,a){var i=t.shape[0],o=Math.min(r,i),s=e.map(function(f,d){return{score:f,boxIndex:d}}).filter(function(f){return f.score>a}).sort(function(f,d){return d.score-f.score}),u=function(f){return f<=n?1:0},l=[];return s.forEach(function(f){if(!(l.length>=o)){for(var d=f.score,p=l.length-1;p>=0;--p){var v=_he(t,f.boxIndex,l[p]);if(v!==0&&(f.score*=u(v),f.score<=a))break}d===f.score&&l.push(f.boxIndex)}}),l}function _he(t,e,r){var n=t.arraySync(),a=Math.min(n[e][0],n[e][2]),i=Math.min(n[e][1],n[e][3]),o=Math.max(n[e][0],n[e][2]),s=Math.max(n[e][1],n[e][3]),u=Math.min(n[r][0],n[r][2]),l=Math.min(n[r][1],n[r][3]),f=Math.max(n[r][0],n[r][2]),d=Math.max(n[r][1],n[r][3]),p=(o-a)*(s-i),v=(f-u)*(d-l);if(p<=0||v<=0)return 0;var g=Math.max(a,u),b=Math.max(i,l),y=Math.min(o,f),x=Math.min(s,d),S=Math.max(y-g,0)*Math.max(x-b,0);return S/(p+v-S)}function She(t){var e=fr(lo(t,[1,0])),r=[hr(e[2],e[0]),hr(e[3],e[1])],n=[it(e[0],ua(r[0],Ee(2))),it(e[1],ua(r[1],Ee(2)))];return{sizes:r,centers:n}}function Ehe(t,e){var r=She(t),n=r.sizes,a=r.centers,i=fr(lo(e,[1,0])),o=ua(Kr(n2(ua(i[2],Ee(5))),n[0]),Ee(2)),s=it(Kr(ua(i[0],Ee(10)),n[0]),a[0]),u=ua(Kr(n2(ua(i[3],Ee(5))),n[1]),Ee(2)),l=it(Kr(ua(i[1],Ee(10)),n[1]),a[1]);return lo(Tn([hr(s,o),hr(l,u),it(s,o),it(l,u)]),[1,0])}function Che(t,e,r){return Ae(function(){var n=t.shape[0],a=Ehe(fa(Nu(r.extra_dim,[n,1,1]),[-1,4]),fa(t,[-1,4]));a=fa(a,[n,a.shape[0]/n,4]);var i=$L(La(e,[0,0,1],[-1,-1,-1])),o=La(i,[0,0,0],[-1,-1,1]);o=fa(o,[n,o.shape[1]]);var s=fr(a),u=fr(o);return{boxes:s,scores:u}})}function du(t,e){return Ae(function(){var r=t.shape[0],n=fa(da(t,e.box_encoding_predictor),[r,-1,1,4]),a=fa(da(t,e.class_predictor),[r,-1,3]);return{boxPredictionEncoding:n,classPrediction:a}})}function khe(t,e,r){return Ae(function(){var n=Ea(t,r.conv_0,[1,1]),a=Ea(n,r.conv_1,[2,2]),i=Ea(a,r.conv_2,[1,1]),o=Ea(i,r.conv_3,[2,2]),s=Ea(o,r.conv_4,[1,1]),u=Ea(s,r.conv_5,[2,2]),l=Ea(u,r.conv_6,[1,1]),f=Ea(l,r.conv_7,[2,2]),d=du(e,r.box_predictor_0),p=du(t,r.box_predictor_1),v=du(a,r.box_predictor_2),g=du(o,r.box_predictor_3),b=du(u,r.box_predictor_4),y=du(f,r.box_predictor_5),x=cr([d.boxPredictionEncoding,p.boxPredictionEncoding,v.boxPredictionEncoding,g.boxPredictionEncoding,b.boxPredictionEncoding,y.boxPredictionEncoding],1),S=cr([d.classPrediction,p.classPrediction,v.classPrediction,g.classPrediction,b.classPrediction,y.classPrediction],1);return{boxPredictions:x,classPredictions:S}})}var hd=(function(){function t(e){var r=e===void 0?{}:e,n=r.minConfidence,a=r.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t})(),QB=(function(t){Qe(e,t);function e(){return t.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(r){var n=this.params;if(!n)throw new Error("SsdMobilenetv1 - load model before inference");return Ae(function(){var a=r.toBatchTensor(512,!1).toFloat(),i=hr(Kr(a,Ee(.007843137718737125)),Ee(1)),o=xhe(i,n.mobilenetv1),s=khe(o.out,o.conv11,n.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return Che(u,l,n.output_layer)})},e.prototype.forward=function(r){return De(this,void 0,void 0,function(){var n;return Me(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,_r(r)];case 1:return[2,n.apply(this,[a.sent()])]}})})},e.prototype.locateFaces=function(r,n){return n===void 0&&(n={}),De(this,void 0,void 0,function(){var a,i,o,s,u,l,f,d,p,v,g,b,y,x,S,E,C,k,A,T,N;return Me(this,function(R){switch(R.label){case 0:return a=new hd(n),i=a.maxResults,o=a.minConfidence,[4,_r(r)];case 1:for(s=R.sent(),u=this.forwardInput(s),l=u.boxes,f=u.scores,d=l[0],p=f[0],v=1;v<l.length;v++)l[v].dispose(),f[v].dispose();return y=(b=Array).from,[4,p.data()];case 2:return g=y.apply(b,[R.sent()]),x=.5,S=whe(d,g,i,x,o),E=s.getReshapedInputDimensions(0),C=s.inputSize,k=C/E.width,A=C/E.height,T=d.arraySync(),N=S.map(function(I){var D=[Math.max(0,T[I][0]),Math.min(1,T[I][2])].map(function(Y){return Y*A}),j=D[0],$=D[1],W=[Math.max(0,T[I][1]),Math.min(1,T[I][3])].map(function(Y){return Y*k}),q=W[0],X=W[1];return new qa(g[I],new tE(q,j,X-q,$-j),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),p.dispose(),[2,N]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(r){return mhe(r)},e.prototype.extractParams=function(r){return phe(r)},e})(_i);(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(QB);var Ahe=.4,Ohe=[new dt(.738768,.874946),new dt(2.42204,2.65704),new dt(4.30971,7.04493),new dt(10.246,4.59428),new dt(12.6868,11.8741)],The=[new dt(1.603231,2.094468),new dt(6.041143,7.080126),new dt(2.882459,3.518061),new dt(4.266906,5.178857),new dt(9.041765,10.66308)],Phe=[117.001,114.697,97.404],Nhe="tiny_yolov2_model",Rhe="tiny_yolov2_separable_conv_model",ep=function(t){return typeof t=="number"};function Ihe(t){if(!t)throw new Error("invalid config: "+t);if(typeof t.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!ep(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map(function(e){return e||{}}).every(function(e){return ep(e.x)&&ep(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||t.meanRgb.length!==3||!t.meanRgb.every(ep)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function dE(t){return Ae(function(){var e=Kr(t,Ee(.10000000149011612));return it(Lt(hr(t,e)),e)})}function qi(t,e){return Ae(function(){var r=ws(t,[[0,0],[1,1],[1,1],[0,0]]);return r=Kn(r,e.conv.filters,[1,1],"valid"),r=hr(r,e.bn.sub),r=Kr(r,e.bn.truediv),r=it(r,e.conv.bias),dE(r)})}function Vi(t,e){return Ae(function(){var r=ws(t,[[0,0],[1,1],[1,1],[0,0]]);return r=WS(r,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),r=it(r,e.bias),dE(r)})}function jhe(t,e){var r=Pm(t,e);function n(o,s){var u=er(t(o)),l=er(t(o));return e.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function a(o,s,u){var l=r(o,s,3,u+"/conv"),f=n(s,u+"/bn");return{conv:l,bn:f}}var i=uE(t,e);return{extractConvParams:r,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function Dhe(t,e,r,n){var a=Ei(t),i=a.extractWeights,o=a.getRemainingWeights,s=[],u=jhe(i,s),l=u.extractConvParams,f=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,p;if(e.withSeparableConvs){var v=n[0],g=n[1],b=n[2],y=n[3],x=n[4],S=n[5],E=n[6],C=n[7],k=n[8],A=e.isFirstLayerConv2d?l(v,g,3,"conv0"):d(v,g,"conv0"),T=d(g,b,"conv1"),N=d(b,y,"conv2"),R=d(y,x,"conv3"),I=d(x,S,"conv4"),D=d(S,E,"conv5"),j=C?d(E,C,"conv6"):void 0,$=k?d(C,k,"conv7"):void 0,W=l(k||C||E,5*r,1,"conv8");p={conv0:A,conv1:T,conv2:N,conv3:R,conv4:I,conv5:D,conv6:j,conv7:$,conv8:W}}else{var v=n[0],g=n[1],b=n[2],y=n[3],x=n[4],S=n[5],E=n[6],C=n[7],k=n[8],A=f(v,g,"conv0"),T=f(g,b,"conv1"),N=f(b,y,"conv2"),R=f(y,x,"conv3"),I=f(x,S,"conv4"),D=f(S,E,"conv5"),j=f(E,C,"conv6"),$=f(C,k,"conv7"),W=l(k,5*r,1,"conv8");p={conv0:A,conv1:T,conv2:N,conv3:R,conv4:I,conv5:D,conv6:j,conv7:$,conv8:W}}if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:p,paramMappings:s}}function Mhe(t,e){var r=wo(t,e);function n(s){var u=r(s+"/sub",1),l=r(s+"/truediv",1);return{sub:u,truediv:l}}function a(s){var u=r(s+"/filters",4),l=r(s+"/bias",1);return{filters:u,bias:l}}function i(s){var u=a(s+"/conv"),l=n(s+"/bn");return{conv:u,bn:l}}var o=lE(r);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:o}}function Fhe(t,e){var r=[],n=Mhe(t,r),a=n.extractConvParams,i=n.extractConvWithBatchNormParams,o=n.extractSeparableConvParams,s;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;s={conv0:e.isFirstLayerConv2d?a("conv0"):o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:u>7?o("conv6"):void 0,conv7:u>8?o("conv7"):void 0,conv8:a("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:a("conv8")};return Si(t,r),{params:s,paramMappings:r}}var WD;(function(t){t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG"})(WD||(WD={}));var hE=(function(){function t(e){var r=e===void 0?{}:e,n=r.inputSize,a=r.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t})(),ZB=(function(t){Qe(e,t);function e(r){var n=t.call(this,"TinyYolov2")||this;return Ihe(r),n._config=r,n}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(r,n){var a=qi(r,n.conv0);return a=br(a,[2,2],[2,2],"same"),a=qi(a,n.conv1),a=br(a,[2,2],[2,2],"same"),a=qi(a,n.conv2),a=br(a,[2,2],[2,2],"same"),a=qi(a,n.conv3),a=br(a,[2,2],[2,2],"same"),a=qi(a,n.conv4),a=br(a,[2,2],[2,2],"same"),a=qi(a,n.conv5),a=br(a,[2,2],[1,1],"same"),a=qi(a,n.conv6),a=qi(a,n.conv7),da(a,n.conv8,"valid",!1)},e.prototype.runMobilenet=function(r,n){var a=this.config.isFirstLayerConv2d?dE(da(r,n.conv0,"valid",!1)):Vi(r,n.conv0);return a=br(a,[2,2],[2,2],"same"),a=Vi(a,n.conv1),a=br(a,[2,2],[2,2],"same"),a=Vi(a,n.conv2),a=br(a,[2,2],[2,2],"same"),a=Vi(a,n.conv3),a=br(a,[2,2],[2,2],"same"),a=Vi(a,n.conv4),a=br(a,[2,2],[2,2],"same"),a=Vi(a,n.conv5),a=br(a,[2,2],[1,1],"same"),a=n.conv6?Vi(a,n.conv6):a,a=n.conv7?Vi(a,n.conv7):a,da(a,n.conv8,"valid",!1)},e.prototype.forwardInput=function(r,n){var a=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return Ae(function(){var o=r.toBatchTensor(n,!1).toFloat();return o=a.config.meanRgb?dd(o,a.config.meanRgb):o,o=o.div(Ee(256)),a.config.withSeparableConvs?a.runMobilenet(o,i):a.runTinyYolov2(o,i)})},e.prototype.forward=function(r,n){return De(this,void 0,void 0,function(){var a;return Me(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,_r(r)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent()]}})})},e.prototype.detect=function(r,n){return n===void 0&&(n={}),De(this,void 0,void 0,function(){var a,i,o,s,u,l,f,d,p,v,g,b,y,x,S=this;return Me(this,function(E){switch(E.label){case 0:return a=new hE(n),i=a.inputSize,o=a.scoreThreshold,[4,_r(r)];case 1:return s=E.sent(),[4,this.forwardInput(s,i)];case 2:return u=E.sent(),l=Ae(function(){return fr(u)[0].expandDims()}),f={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),o)];case 3:return d=E.sent(),u.dispose(),l.dispose(),p=d.map(function(C){return C.box}),v=d.map(function(C){return C.score}),g=d.map(function(C){return C.classScore}),b=d.map(function(C){return S.config.classes[C.label]}),y=Hf(p.map(function(C){return C.rescale(i)}),v,this.config.iouThreshold,!0),x=y.map(function(C){return new EB(v[C],g[C],b[C],p[C],f)}),[2,x]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(r){return Fhe(r,this.config)},e.prototype.extractParams=function(r){var n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,a=n?n.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return Dhe(r,this.config,this.boxEncodingSize,n)},e.prototype.extractBoxes=function(r,n,a){return De(this,void 0,void 0,function(){var i,o,s,u,l,f,d,p,v,g,b,y,x,S,E,C,k,A,T,N,R,I,D,j,$,W,q,X,Y,z=this;return Me(this,function(B){switch(B.label){case 0:return i=n.width,o=n.height,s=Math.max(i,o),u=s/i,l=s/o,f=r.shape[1],d=this.config.anchors.length,p=Ae(function(){var G=r.reshape([f,f,d,z.boxEncodingSize]),L=G.slice([0,0,0,0],[f,f,d,4]),K=G.slice([0,0,0,4],[f,f,d,1]),oe=z.withClassScores?xi(G.slice([0,0,0,5],[f,f,d,z.config.classes.length]),3):Ee(0);return[L,K,oe]}),v=p[0],g=p[1],b=p[2],y=[],[4,g.array()];case 1:return x=B.sent(),[4,v.array()];case 2:S=B.sent(),E=0,B.label=3;case 3:if(!(E<f))return[3,12];C=0,B.label=4;case 4:if(!(C<f))return[3,11];k=0,B.label=5;case 5:return k<d?(A=i1(x[E][C][k][0]),!a||A>a?(T=(C+i1(S[E][C][k][0]))/f*u,N=(E+i1(S[E][C][k][1]))/f*l,R=Math.exp(S[E][C][k][2])*this.config.anchors[k].x/f*u,I=Math.exp(S[E][C][k][3])*this.config.anchors[k].y/f*l,D=T-R/2,j=N-I/2,$={row:E,col:C,anchor:k},this.withClassScores?[4,this.extractPredictedClass(b,$)]:[3,7]):[3,9]):[3,10];case 6:return Y=B.sent(),[3,8];case 7:Y={classScore:1,label:0},B.label=8;case 8:W=Y,q=W.classScore,X=W.label,y.push(Vr({box:new Om(D,j,D+R,j+I),score:A,classScore:A*q,label:X},$)),B.label=9;case 9:return k++,[3,5];case 10:return C++,[3,4];case 11:return E++,[3,3];case 12:return v.dispose(),g.dispose(),b.dispose(),[2,y]}})})},e.prototype.extractPredictedClass=function(r,n){return De(this,void 0,void 0,function(){var a,i,o,s;return Me(this,function(u){switch(u.label){case 0:return a=n.row,i=n.col,o=n.anchor,[4,r.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,f){return s[a][i][o][f]}).map(function(l,f){return{classScore:l,label:f}}).reduce(function(l,f){return l.classScore>f.classScore?l:f})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e})(_i),Lhe=(function(t){Qe(e,t);function e(r){r===void 0&&(r=!0);var n=this,a=Object.assign({},{withSeparableConvs:r,iouThreshold:Ahe,classes:["face"]},r?{anchors:The,meanRgb:Phe}:{anchors:Ohe,withClassScores:!0});return n=t.call(this,a)||this,n}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(r,n){return De(this,void 0,void 0,function(){var a;return Me(this,function(i){switch(i.label){case 0:return[4,this.detect(r,n)];case 1:return a=i.sent(),[2,a.map(function(o){return new qa(o.score,o.relativeBox,{width:o.imageWidth,height:o.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?Rhe:Nhe},e.prototype.extractParamsFromWeigthMap=function(r){return t.prototype.extractParamsFromWeigthMap.call(this,r)},e})(ZB),pE=(function(t){Qe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._name="TinyFaceDetectorOptions",r}return e})(hE),pd=(function(){function t(){}return t.prototype.then=function(e){return De(this,void 0,void 0,function(){var r;return Me(this,function(n){switch(n.label){case 0:return r=e,[4,this.run()];case 1:return[2,r.apply(void 0,[n.sent()])]}})})},t.prototype.run=function(){return De(this,void 0,void 0,function(){return Me(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},t})();function Nm(t,e,r,n,a){return a===void 0&&(a=function(i){var o=i.alignedRect;return o}),De(this,void 0,void 0,function(){var i,o,s,u,l;return Me(this,function(f){switch(f.label){case 0:return i=t.map(function(d){return Hde(d)?a(d):d.detection}),s=n,s?[3,5]:e instanceof Ft?[4,oE(e,i)]:[3,2];case 1:return u=f.sent(),[3,4];case 2:return[4,iE(e,i)];case 3:u=f.sent(),f.label=4;case 4:s=u,f.label=5;case 5:return o=s,[4,r(o)];case 6:return l=f.sent(),o.forEach(function(d){return d instanceof Ft&&d.dispose()}),[2,l]}})})}function vE(t,e,r,n,a){return De(this,void 0,void 0,function(){var i=this;return Me(this,function(o){return[2,Nm([t],e,function(s){return De(i,void 0,void 0,function(){return Me(this,function(u){return[2,r(s[0])]})})},n,a)]})})}function Bhe(t){return Ae(function(){return Tn(fr(t,3).reverse(),3)})}var tp=2,Rv=12;function $he(t,e){var r=Pm(t,e),n=sE(t,e);function a(l,f){var d=er(t(l));return e.push({paramPath:f}),d}function i(l,f,d){d===void 0&&(d=!1);var p=r(l[0],l[1],3,f+"/conv1"),v=a(l[1],f+"/prelu1_alpha"),g=r(l[1],l[2],3,f+"/conv2"),b=a(l[2],f+"/prelu2_alpha"),y=r(l[2],l[3],d?2:3,f+"/conv3"),x=a(l[3],f+"/prelu3_alpha");return{conv1:p,prelu1_alpha:v,conv2:g,prelu2_alpha:b,conv3:y,prelu3_alpha:x}}function o(){var l=i([3,10,16,32],"pnet"),f=r(32,2,1,"pnet/conv4_1"),d=r(32,4,1,"pnet/conv4_2");return Vr(Vr({},l),{conv4_1:f,conv4_2:d})}function s(){var l=i([3,28,48,64],"rnet",!0),f=n(576,128,"rnet/fc1"),d=a(128,"rnet/prelu4_alpha"),p=n(128,2,"rnet/fc2_1"),v=n(128,4,"rnet/fc2_2");return Vr(Vr({},l),{fc1:f,prelu4_alpha:d,fc2_1:p,fc2_2:v})}function u(){var l=i([3,32,64,64],"onet"),f=r(64,128,2,"onet/conv4"),d=a(128,"onet/prelu4_alpha"),p=n(1152,256,"onet/fc1"),v=a(256,"onet/prelu5_alpha"),g=n(256,2,"onet/fc2_1"),b=n(256,4,"onet/fc2_2"),y=n(256,10,"onet/fc2_3");return Vr(Vr({},l),{conv4:f,prelu4_alpha:d,fc1:p,prelu5_alpha:v,fc2_1:g,fc2_2:b,fc2_3:y})}return{extractPNetParams:o,extractRNetParams:s,extractONetParams:u}}function Uhe(t){var e=Ei(t),r=e.extractWeights,n=e.getRemainingWeights,a=[],i=$he(r,a),o=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=o(),f=s(),d=u();if(n().length!==0)throw new Error("weights remaing after extract: "+n().length);return{params:{pnet:l,rnet:f,onet:d},paramMappings:a}}function Whe(t,e){var r=wo(t,e);function n(f){var d=r(f+"/weights",4,f+"/filters"),p=r(f+"/bias",1);return{filters:d,bias:p}}function a(f){var d=r(f+"/weights",2),p=r(f+"/bias",1);return{weights:d,bias:p}}function i(f){return r(f,1)}function o(f){var d=n(f+"/conv1"),p=i(f+"/prelu1_alpha"),v=n(f+"/conv2"),g=i(f+"/prelu2_alpha"),b=n(f+"/conv3"),y=i(f+"/prelu3_alpha");return{conv1:d,prelu1_alpha:p,conv2:v,prelu2_alpha:g,conv3:b,prelu3_alpha:y}}function s(){var f=o("pnet"),d=n("pnet/conv4_1"),p=n("pnet/conv4_2");return Vr(Vr({},f),{conv4_1:d,conv4_2:p})}function u(){var f=o("rnet"),d=a("rnet/fc1"),p=i("rnet/prelu4_alpha"),v=a("rnet/fc2_1"),g=a("rnet/fc2_2");return Vr(Vr({},f),{fc1:d,prelu4_alpha:p,fc2_1:v,fc2_2:g})}function l(){var f=o("onet"),d=n("onet/conv4"),p=i("onet/prelu4_alpha"),v=a("onet/fc1"),g=i("onet/prelu5_alpha"),b=a("onet/fc2_1"),y=a("onet/fc2_2"),x=a("onet/fc2_3");return Vr(Vr({},f),{conv4:d,prelu4_alpha:p,fc1:v,prelu5_alpha:g,fc2_1:b,fc2_2:y,fc2_3:x})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function zhe(t){var e=[],r=Whe(t,e),n=r.extractPNetParams,a=r.extractRNetParams,i=r.extractONetParams,o=n(),s=a(),u=i();return Si(t,e),{params:{pnet:o,rnet:s,onet:u},paramMappings:e}}function f2(t,e){var r=e[0],n=e[1];return{height:Math.floor(r*t),width:Math.floor(n*t)}}function qhe(t,e,r){for(var n=r[0],a=r[1],i=Rv/t,o=[],s=Math.min(n,a)*i,u=0;s>=12;)o.push(i*Math.pow(e,u)),s=s*e,u+=1;return o}var mE=(function(t){Qe(e,t);function e(r,n,a,i){return t.call(this,{left:r,top:n,right:a,bottom:i},!0)||this}return e})(co);function e$(t){return Ae(function(){return Kr(hr(t,Ee(127.5)),Ee(.0078125))})}function Fu(t,e){return Ae(function(){return it(Lt(t),Kr(e,Cv(Lt(Cv(t)))))})}function gE(t,e,r){return r===void 0&&(r=!1),Ae(function(){var n=da(t,e.conv1,"valid");return n=Fu(n,e.prelu1_alpha),n=br(n,r?[2,2]:[3,3],[2,2],"same"),n=da(n,e.conv2,"valid"),n=Fu(n,e.prelu2_alpha),n=r?n:br(n,[3,3],[2,2],"valid"),n=da(n,e.conv3,"valid"),n=Fu(n,e.prelu3_alpha),n})}function Vhe(t,e){return Ae(function(){var r=gE(t,e,!0),n=da(r,e.conv4_1,"valid"),a=$n(Em(n,3),3),i=xi(hr(n,a),3),o=da(r,e.conv4_2,"valid");return{prob:i,regions:o}})}function Hhe(t,e){return Ae(function(){var r=f2(e,t.shape.slice(1)),n=r.height,a=r.width,i=GS.resizeBilinear(t,[n,a]),o=e$(i);return lo(o,[0,2,1,3])})}function Ghe(t,e,r,n){for(var a=[],i=t.arraySync(),o=0;o<t.shape[0];o++)for(var s=0;s<t.shape[1];s++)i[o][s]>=n&&a.push(new dt(s,o));var u=a.map(function(l){var f=new Om(Math.round((l.y*tp+1)/r),Math.round((l.x*tp+1)/r),Math.round((l.y*tp+Rv)/r),Math.round((l.x*tp+Rv)/r)),d=i[l.y][l.x],p=e.arraySync(),v=new mE(p[l.y][l.x][0],p[l.y][l.x][1],p[l.y][l.x][2],p[l.y][l.x][3]);return{cell:f,score:d,region:v}});return u}function Khe(t,e,r,n,a){a.stage1=[];var i=e.map(function(p){return Ae(function(){var v={scale:p},g=Hhe(t,p),b=Date.now(),y=Vhe(g,n),x=y.prob,S=y.regions;v.pnet=Date.now()-b;var E=fr(fr(x,3)[1])[0],C=fr(S)[0];return{scoresTensor:E,regionsTensor:C,scale:p,statsForScale:v}})}),o=i.map(function(p){var v=p.scoresTensor,g=p.regionsTensor,b=p.scale,y=p.statsForScale,x=Ghe(v,g,b,r);if(v.dispose(),g.dispose(),!x.length)return a.stage1.push(y),[];var S=Date.now(),E=Hf(x.map(function(C){return C.cell}),x.map(function(C){return C.score}),.5);return y.nms=Date.now()-S,y.numBoxes=E.length,a.stage1.push(y),E.map(function(C){return x[C]})}),s=o.reduce(function(p,v){return p.concat(v)},[]),u=[],l=[];if(s.length>0){var f=Date.now(),d=Hf(s.map(function(p){return p.cell}),s.map(function(p){return p.score}),.7);a.stage1_nms=Date.now()-f,l=d.map(function(p){return s[p].score}),u=d.map(function(p){return s[p]}).map(function(p){var v=p.cell,g=p.region;return new Om(v.left+g.left*v.width,v.top+g.top*v.height,v.right+g.right*v.width,v.bottom+g.bottom*v.height).toSquare().round()})}return{boxes:u,scores:l}}function t$(t,e,r){var n=r.width,a=r.height;return De(this,void 0,void 0,function(){var i,o,s,u=this;return Me(this,function(l){switch(l.label){case 0:return i=hs(t),[4,Promise.all(e.map(function(f){return De(u,void 0,void 0,function(){var d,p,v,g,b,y,x,S;return Me(this,function(E){return d=f.padAtBorders(t.height,t.width),p=d.y,v=d.ey,g=d.x,b=d.ex,y=g-1,x=p-1,S=i.getImageData(y,x,b-y,v-x),[2,Dr.isNodejs()?aE(S):createImageBitmap(S)]})})}))];case 1:return o=l.sent(),s=[],o.forEach(function(f){var d=Tm({width:n,height:a}),p=hs(d);p.drawImage(f,0,0,n,a);for(var v=p.getImageData(0,0,n,a).data,g=[],b=0;b<v.length;b+=4)g.push(v[b+2]),g.push(v[b+1]),g.push(v[b]);s.push(g)}),[2,s.map(function(f){var d=Ae(function(){var p=lo(un(f,[1,n,a,3]),[0,2,1,3]).toFloat();return e$(p)});return d})]}})})}function Xhe(t,e){return Ae(function(){var r=gE(t,e),n=fa(r,[r.shape[0],e.fc1.weights.shape[0]]),a=Pa(n,e.fc1),i=Fu(a,e.prelu4_alpha),o=Pa(i,e.fc2_1),s=$n(Em(o,1),1),u=xi(hr(o,s),1),l=Pa(i,e.fc2_2),f=fr(u,1)[1];return{scores:f,regions:l}})}function Yhe(t,e,r,n,a){return De(this,void 0,void 0,function(){var i,o,s,u,l,f,d,p,v,g,b,y,x,S;return Me(this,function(E){switch(E.label){case 0:return i=Date.now(),[4,t$(t,e,{width:24,height:24})];case 1:return o=E.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=o.map(function(C){var k=Xhe(C,n);return C.dispose(),k}),a.stage2_rnet=Date.now()-i,u=s.length>1?cr(s.map(function(C){return C.scores})):s[0].scores,d=(f=Array).from,[4,u.data()];case 2:return l=d.apply(f,[E.sent()]),u.dispose(),p=l.map(function(C,k){return{score:C,idx:k}}).filter(function(C){return C.score>r}).map(function(C){var k=C.idx;return k}),v=p.map(function(C){return e[C]}),g=p.map(function(C){return l[C]}),b=[],y=[],v.length>0&&(i=Date.now(),x=Hf(v,g,.7),a.stage2_nms=Date.now()-i,S=x.map(function(C){var k=s[p[C]].regions.arraySync();return new mE(k[0][0],k[0][1],k[0][2],k[0][3])}),y=x.map(function(C){return g[C]}),b=x.map(function(C,k){return v[C].calibrate(S[k])})),s.forEach(function(C){C.regions.dispose(),C.scores.dispose()}),[2,{boxes:b,scores:y}]}})})}function Jhe(t,e){return Ae(function(){var r=gE(t,e);r=br(r,[2,2],[2,2],"same"),r=da(r,e.conv4,"valid"),r=Fu(r,e.prelu4_alpha);var n=fa(r,[r.shape[0],e.fc1.weights.shape[0]]),a=Pa(n,e.fc1),i=Fu(a,e.prelu5_alpha),o=Pa(i,e.fc2_1),s=$n(Em(o,1),1),u=xi(hr(o,s),1),l=Pa(i,e.fc2_2),f=Pa(i,e.fc2_3),d=fr(u,1)[1];return{scores:d,regions:l,points:f}})}function Qhe(t,e,r,n,a){return De(this,void 0,void 0,function(){var i,o,s,u,l,f,d,p,v,g,b,y,x,S,E;return Me(this,function(C){switch(C.label){case 0:return i=Date.now(),[4,t$(t,e,{width:48,height:48})];case 1:return o=C.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=o.map(function(k){var A=Jhe(k,n);return k.dispose(),A}),a.stage3_onet=Date.now()-i,u=s.length>1?cr(s.map(function(k){return k.scores})):s[0].scores,d=(f=Array).from,[4,u.data()];case 2:return l=d.apply(f,[C.sent()]),u.dispose(),p=l.map(function(k,A){return{score:k,idx:A}}).filter(function(k){return k.score>r}).map(function(k){var A=k.idx;return A}),v=p.map(function(k){var A=s[k].regions.arraySync();return new mE(A[0][0],A[0][1],A[0][2],A[0][3])}),g=p.map(function(k,A){return e[k].calibrate(v[A])}),b=p.map(function(k){return l[k]}),y=[],x=[],S=[],g.length>0&&(i=Date.now(),E=Hf(g,b,.7,!1),a.stage3_nms=Date.now()-i,y=E.map(function(k){return g[k]}),x=E.map(function(k){return b[k]}),S=E.map(function(k,A){return Array(5).fill(0).map(function(T,N){var R=s[k].points.arraySync();return new dt(R[0][N]*(y[A].width+1)+y[A].left,R[0][N+5]*(y[A].height+1)+y[A].top)})})),s.forEach(function(k){k.regions.dispose(),k.scores.dispose(),k.points.dispose()}),[2,{boxes:y,scores:x,points:S}]}})})}var Zhe=(function(t){Qe(e,t);function e(){return t.call(this,"Mtcnn")||this}return e.prototype.load=function(r){return De(this,void 0,void 0,function(){return Me(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,r)]})})},e.prototype.loadFromDisk=function(r){return De(this,void 0,void 0,function(){return Me(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,r)]})})},e.prototype.forwardInput=function(r,n){return n===void 0&&(n={}),De(this,void 0,void 0,function(){var a,i,o,s,u,l,f,d,p,v,g,b,y,x,S,E,C,k,A,T,N;return Me(this,function(R){switch(R.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(i=r.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},s=Date.now(),u=Ae(function(){return Bhe($n(ZS.fromPixels(i)).toFloat())}),l=function(I){return u.dispose(),o.total=Date.now()-s,I},f=u.shape.slice(1),d=f[0],p=f[1],v=new JB(n),g=v.minFaceSize,b=v.scaleFactor,y=v.maxNumScales,x=v.scoreThresholds,S=v.scaleSteps,E=(S||qhe(g,b,[d,p])).filter(function(I){var D=f2(I,[d,p]);return Math.min(D.width,D.height)>Rv}).slice(0,y),o.scales=E,o.pyramid=E.map(function(I){return f2(I,[d,p])}),C=Date.now(),[4,Khe(u,E,x[0],a.pnet,o)];case 1:return k=R.sent(),o.total_stage1=Date.now()-C,k.boxes.length?(o.stage2_numInputBoxes=k.boxes.length,C=Date.now(),[4,Yhe(i,k.boxes,x[1],a.rnet,o)]):[2,l({results:[],stats:o})];case 2:return A=R.sent(),o.total_stage2=Date.now()-C,A.boxes.length?(o.stage3_numInputBoxes=A.boxes.length,C=Date.now(),[4,Qhe(i,A.boxes,x[2],a.onet,o)]):[2,l({results:[],stats:o})];case 3:return T=R.sent(),o.total_stage3=Date.now()-C,N=T.boxes.map(function(I,D){return cE(rE({},new qa(T.scores[D],new tE(I.left/p,I.top/d,I.width/p,I.height/d),{height:d,width:p})),new Ode(T.points[D].map(function(j){return j.sub(new dt(I.left,I.top)).div(new dt(I.width,I.height))}),{width:I.width,height:I.height}))}),[2,l({results:N,stats:o})]}})})},e.prototype.forward=function(r,n){return n===void 0&&(n={}),De(this,void 0,void 0,function(){var a;return Me(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,_r(r)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent().results]}})})},e.prototype.forwardWithStats=function(r,n){return n===void 0&&(n={}),De(this,void 0,void 0,function(){var a;return Me(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,_r(r)];case 1:return[2,a.apply(this,[i.sent(),n])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(r){return zhe(r)},e.prototype.extractParams=function(r){return Uhe(r)},e})(_i),epe=.4,tpe=[new dt(1.603231,2.094468),new dt(6.041143,7.080126),new dt(2.882459,3.518061),new dt(4.266906,5.178857),new dt(9.041765,10.66308)],rpe=[117.001,114.697,97.404],npe=(function(t){Qe(e,t);function e(){var r=this,n={withSeparableConvs:!0,iouThreshold:epe,classes:["face"],anchors:tpe,meanRgb:rpe,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return r=t.call(this,n)||this,r}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(r,n){return De(this,void 0,void 0,function(){var a;return Me(this,function(i){switch(i.label){case 0:return[4,this.detect(r,n)];case 1:return a=i.sent(),[2,a.map(function(o){return new qa(o.score,o.relativeBox,{width:o.imageWidth,height:o.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(r){return t.prototype.extractParamsFromWeigthMap.call(this,r)},e})(ZB),lr={ssdMobilenetv1:new QB,tinyFaceDetector:new npe,tinyYolov2:new Lhe,mtcnn:new Zhe,faceLandmark68Net:new VB,faceLandmark68TinyNet:new ihe,faceRecognitionNet:new dhe,faceExpressionNet:new Vde,ageGenderNet:new the},r$=(function(t){Qe(e,t);function e(r,n,a){var i=t.call(this)||this;return i.parentTask=r,i.input=n,i.extractedFaces=a,i}return e})(pd),yE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n,a=this;return Me(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return r=i.sent(),[4,Nm(r,this.input,function(o){return De(a,void 0,void 0,function(){return Me(this,function(s){switch(s.label){case 0:return[4,Promise.all(o.map(function(u){return lr.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,r.map(function(o,s){return WB(o,n[s])})]}})})},e.prototype.withAgeAndGender=function(){return new _E(this,this.input)},e})(r$),bE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n;return Me(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return r=a.sent(),r?[4,vE(r,this.input,function(i){return lr.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return n=a.sent(),[2,WB(r,n)]}})})},e.prototype.withAgeAndGender=function(){return new SE(this,this.input)},e})(r$),xE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new EE(this,this.input)},e.prototype.withFaceDescriptors=function(){return new kE(this,this.input)},e})(yE),wE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new CE(this,this.input)},e.prototype.withFaceDescriptor=function(){return new AE(this,this.input)},e})(bE),n$=(function(t){Qe(e,t);function e(r,n,a){var i=t.call(this)||this;return i.parentTask=r,i.input=n,i.extractedFaces=a,i}return e})(pd),_E=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n,a=this;return Me(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return r=i.sent(),[4,Nm(r,this.input,function(o){return De(a,void 0,void 0,function(){return Me(this,function(s){switch(s.label){case 0:return[4,Promise.all(o.map(function(u){return lr.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,r.map(function(o,s){var u=n[s],l=u.age,f=u.gender,d=u.genderProbability;return XB(YB(o,f,d),l)})]}})})},e.prototype.withFaceExpressions=function(){return new yE(this,this.input)},e})(n$),SE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n,a,i,o;return Me(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return r=s.sent(),r?[4,vE(r,this.input,function(u){return lr.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return n=s.sent(),a=n.age,i=n.gender,o=n.genderProbability,[2,XB(YB(r,i,o),a)]}})})},e.prototype.withFaceExpressions=function(){return new bE(this,this.input)},e})(n$),EE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new xE(this,this.input)},e.prototype.withFaceDescriptors=function(){return new kE(this,this.input)},e})(_E),CE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new wE(this,this.input)},e.prototype.withFaceDescriptor=function(){return new AE(this,this.input)},e})(SE),a$=(function(t){Qe(e,t);function e(r,n){var a=t.call(this)||this;return a.parentTask=r,a.input=n,a}return e})(pd),kE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n;return Me(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return r=a.sent(),[4,Nm(r,this.input,function(i){return Promise.all(i.map(function(o){return lr.faceRecognitionNet.computeFaceDescriptor(o)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return n=a.sent(),[2,n.map(function(i,o){return KB(r[o],i)})]}})})},e.prototype.withFaceExpressions=function(){return new xE(this,this.input)},e.prototype.withAgeAndGender=function(){return new EE(this,this.input)},e})(a$),AE=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n;return Me(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return r=a.sent(),r?[4,vE(r,this.input,function(i){return lr.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return n=a.sent(),[2,KB(r,n)]}})})},e.prototype.withFaceExpressions=function(){return new wE(this,this.input)},e.prototype.withAgeAndGender=function(){return new CE(this,this.input)},e})(a$),i$=(function(t){Qe(e,t);function e(r,n,a){var i=t.call(this)||this;return i.parentTask=r,i.input=n,i.useTinyLandmarkNet=a,i}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?lr.faceLandmark68TinyNet:lr.faceLandmark68Net},enumerable:!0,configurable:!0}),e})(pd),ape=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n,a,i,o,s=this;return Me(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return r=u.sent(),n=r.map(function(l){return l.detection}),this.input instanceof Ft?[4,oE(this.input,n)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,iE(this.input,n)];case 4:i=u.sent(),u.label=5;case 5:return a=i,[4,Promise.all(a.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return o=u.sent(),a.forEach(function(l){return l instanceof Ft&&l.dispose()}),[2,r.map(function(l,f){return cE(l,o[f])})]}})})},e.prototype.withFaceExpressions=function(){return new xE(this,this.input)},e.prototype.withAgeAndGender=function(){return new EE(this,this.input)},e.prototype.withFaceDescriptors=function(){return new kE(this,this.input)},e})(i$),ipe=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n,a,i,o;return Me(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return r=s.sent(),r?(n=r.detection,this.input instanceof Ft?[4,oE(this.input,[n])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,iE(this.input,[n])];case 4:i=s.sent(),s.label=5;case 5:return a=i,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return o=s.sent(),a.forEach(function(u){return u instanceof Ft&&u.dispose()}),[2,cE(r,o)]}})})},e.prototype.withFaceExpressions=function(){return new wE(this,this.input)},e.prototype.withAgeAndGender=function(){return new CE(this,this.input)},e.prototype.withFaceDescriptor=function(){return new AE(this,this.input)},e})(i$),o$=(function(t){Qe(e,t);function e(r,n){n===void 0&&(n=new hd);var a=t.call(this)||this;return a.input=r,a.options=n,a}return e})(pd),s$=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n,a,i;return Me(this,function(o){switch(o.label){case 0:return r=this,n=r.input,a=r.options,a instanceof JB?[4,lr.mtcnn.forward(n,a)]:[3,2];case 1:return[2,o.sent().map(function(s){return s.detection})];case 2:if(i=a instanceof pE?function(s){return lr.tinyFaceDetector.locateFaces(s,a)}:a instanceof hd?function(s){return lr.ssdMobilenetv1.locateFaces(s,a)}:a instanceof hE?function(s){return lr.tinyYolov2.locateFaces(s,a)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(n)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var r=this;return new Promise(function(n){return De(r,void 0,void 0,function(){var a;return Me(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a.map(function(o){return rE({},o)}))]}})})})},e.prototype.withFaceLandmarks=function(r){return r===void 0&&(r=!1),new ape(this.runAndExtendWithFaceDetections(),this.input,r)},e.prototype.withFaceExpressions=function(){return new yE(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new _E(this.runAndExtendWithFaceDetections(),this.input)},e})(o$),ope=(function(t){Qe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return De(this,void 0,void 0,function(){var r,n;return Me(this,function(a){switch(a.label){case 0:return[4,new s$(this.input,this.options)];case 1:return r=a.sent(),n=r[0],r.forEach(function(i){i.score>n.score&&(n=i)}),[2,n]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var r=this;return new Promise(function(n){return De(r,void 0,void 0,function(){var a;return Me(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a?rE({},a):void 0)]}})})})},e.prototype.withFaceLandmarks=function(r){return r===void 0&&(r=!1),new ipe(this.runAndExtendWithFaceDetection(),this.input,r)},e.prototype.withFaceExpressions=function(){return new bE(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new SE(this.runAndExtendWithFaceDetection(),this.input)},e})(o$);function spe(t,e){return e===void 0&&(e=new hd),new ope(t,e)}function upe(t,e){return e===void 0&&(e=new hd),new s$(t,e)}function lpe(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var r=Array.from(t),n=Array.from(e);return Math.sqrt(r.map(function(a,i){return a-n[i]}).reduce(function(a,i){return a+Math.pow(i,2)},0))}var cpe=(function(){function t(e,r){r===void 0&&(r=.6),this._distanceThreshold=r;var n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,i=function(){return"person "+a++};this._labeledDescriptors=n.map(function(o){if(o instanceof Dc)return o;if(o instanceof Float32Array)return new Dc(i(),[o]);if(o.descriptor&&o.descriptor instanceof Float32Array)return new Dc(i(),[o.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(e,r){return r.map(function(n){return lpe(n,e)}).reduce(function(n,a){return n+a},0)/(r.length||1)},t.prototype.matchDescriptor=function(e){var r=this;return this.labeledDescriptors.map(function(n){var a=n.descriptors,i=n.label;return new FD(i,r.computeMeanDistance(e,a))}).reduce(function(n,a){return n.distance<a.distance?n:a})},t.prototype.findBestMatch=function(e){var r=this.matchDescriptor(e);return r.distance<this.distanceThreshold?r:new FD("unknown",r.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},t.fromJSON=function(e){var r=e.labeledDescriptors.map(function(n){return Dc.fromJSON(n)});return new t(r,e.distanceThreshold)},t})();function fpe(){const{user:t}=ha(),[e,r]=V.useState(null),[n,a]=V.useState(!0),[i,o]=V.useState("overview");V.useEffect(()=>{s()},[t]);const s=async()=>{try{if(!t?.id)return;const f=await fetch(`http://localhost:5000/api/student/dashboard?studentId=${t.id}`);if(f.ok){const d=await f.json();r(d)}}catch(f){console.error("Failed to load dashboard:",f)}finally{a(!1)}};if(n)return w.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-slate-200 border-t-primary-600"})});const u=e?.profile||{},l=e?.academics||{overallAttendance:0};return w.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 font-sans",children:[w.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[w.jsxs("div",{children:[w.jsxs("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:["Welcome, ",u.name||t?.user_metadata?.full_name,"!"]}),w.jsx("p",{className:"text-slate-500 font-medium",children:"Your academic performance overview"})]}),w.jsxs("div",{className:"flex items-center gap-2 bg-white px-4 py-2 rounded-xl border border-slate-200 shadow-sm",children:[w.jsx(Bu,{size:16,className:"text-primary-600"}),w.jsxs("div",{className:"text-sm font-bold text-slate-700",children:[u.semester?`Semester ${u.semester}`:"Current Session",w.jsx("span",{className:"text-slate-300 mx-2",children:"|"}),w.jsx("span",{className:"text-slate-500 font-normal",children:new Date().getFullYear()})]})]})]}),w.jsxs("div",{className:"flex items-center gap-4 border-b border-slate-200",children:[w.jsxs("button",{onClick:()=>o("overview"),className:`flex items-center gap-2 px-4 py-3 text-sm font-bold border-b-2 transition-colors ${i==="overview"?"border-primary-600 text-primary-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[w.jsx(nf,{size:18}),"Overview"]}),w.jsxs("button",{onClick:()=>o("timetable"),className:`flex items-center gap-2 px-4 py-3 text-sm font-bold border-b-2 transition-colors ${i==="timetable"?"border-primary-600 text-primary-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[w.jsx(Bu,{size:18}),"Timetable"]}),w.jsxs("button",{onClick:()=>o("face-registration"),className:`flex items-center gap-2 px-4 py-3 text-sm font-bold border-b-2 transition-colors ${i==="face-registration"?"border-primary-600 text-primary-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[w.jsx(CM,{size:18}),"Face Registration"]})]}),i==="overview"&&w.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[w.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[w.jsxs("div",{className:"rounded-2xl bg-gradient-to-br from-primary-600 to-indigo-700 p-6 text-white shadow-xl shadow-primary-200 relative overflow-hidden group hover:scale-[1.02] transition-transform",children:[w.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:w.jsx(lp,{size:80})}),w.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[w.jsx("div",{className:"text-primary-100 text-xs font-bold uppercase tracking-widest",children:"Attendance"}),w.jsx("div",{className:"rounded-full bg-white/20 p-2 backdrop-blur-sm",children:w.jsx(lp,{size:18})})]}),w.jsxs("div",{className:"mt-4 flex items-baseline relative z-10",children:[w.jsxs("span",{className:"text-4xl font-black tracking-tight",children:[l.overallAttendance,"%"]}),w.jsx("span",{className:"ml-2 text-xs font-bold text-primary-200 uppercase tracking-wide",children:"Aggregate"})]}),w.jsx("div",{className:"mt-4 h-1 w-full bg-black/20 rounded-full overflow-hidden",children:w.jsx("div",{className:"h-full bg-white/90 rounded-full transition-all duration-1000",style:{width:`${l.overallAttendance}%`}})})]}),w.jsxs("div",{className:"rounded-2xl bg-white p-6 border border-slate-200 shadow-sm hover:border-primary-200 transition-colors group",children:[w.jsx("div",{className:"flex items-center justify-between mb-4",children:w.jsx("div",{className:"h-10 w-10 rounded-xl bg-orange-50 text-orange-600 flex items-center justify-center group-hover:bg-orange-100 transition-colors",children:w.jsx(os,{size:20})})}),w.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Department"}),w.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900 leading-tight line-clamp-2",children:u.department||"Not Assigned"}),w.jsx("div",{className:"mt-2 text-[10px] font-bold text-orange-600 bg-orange-50 inline-block px-2 py-1 rounded uppercase tracking-tight",children:"B.Tech"})]}),w.jsxs("div",{className:"rounded-2xl bg-white p-6 border border-slate-200 shadow-sm hover:border-primary-200 transition-colors group",children:[w.jsx("div",{className:"flex items-center justify-between mb-4",children:w.jsx("div",{className:"h-10 w-10 rounded-xl bg-emerald-50 text-emerald-600 flex items-center justify-center group-hover:bg-emerald-100 transition-colors",children:w.jsx(Uu,{size:20})})}),w.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Semester"}),w.jsxs("div",{className:"mt-1 text-2xl font-black text-slate-900",children:["S",u.semester||"?"]}),w.jsx("div",{className:"mt-1 text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:u.batch||"Batch N/A"})]}),w.jsxs("div",{className:"rounded-2xl bg-white p-6 border border-slate-200 shadow-sm hover:border-primary-200 transition-colors group",children:[w.jsx("div",{className:"flex items-center justify-between mb-4",children:w.jsx("div",{className:"h-10 w-10 rounded-xl bg-blue-50 text-blue-600 flex items-center justify-center group-hover:bg-blue-100 transition-colors",children:w.jsx(uo,{size:20})})}),w.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Class Tutor"}),w.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900 truncate",title:u.tutor,children:u.tutor}),w.jsx("div",{className:"mt-2 text-[10px] font-bold text-blue-600 bg-blue-50 inline-block px-2 py-1 rounded uppercase tracking-tight",children:"Faculty Advisor"})]})]}),w.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[w.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[w.jsx("div",{className:"p-2 bg-indigo-50 rounded-lg text-indigo-600",children:w.jsx(ZA,{size:20})}),w.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Notifications"})]}),w.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center border-2 border-dashed border-slate-100 rounded-xl",children:[w.jsx("div",{className:"h-12 w-12 bg-slate-50 text-slate-300 rounded-full flex items-center justify-center mb-3",children:w.jsx(ZA,{size:24})}),w.jsx("p",{className:"text-slate-500 font-medium",children:"No new notifications"}),w.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"You're all caught up!"})]})]})]}),i==="timetable"&&w.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:w.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-4",children:[w.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Weekly Timetable"}),w.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:w.jsx(hpe,{timetable:e?.timetable||[]})})]})}),i==="face-registration"&&w.jsx(dpe,{user:t,isRegistered:u.face_registered})]})}function dpe({user:t,isRegistered:e}){const[r,n]=V.useState(!1),[a,i]=V.useState(!1),[o,s]=V.useState(e?"registered":"idle"),u=Z.useRef(null);V.useEffect(()=>{l()},[]);const l=async()=>{try{const d="https://justadudewhohacks.github.io/face-api.js/models";await lr.tinyFaceDetector.loadFromUri(d),await lr.faceLandmark68Net.loadFromUri(d),await lr.faceRecognitionNet.loadFromUri(d),i(!0)}catch(d){console.error("Failed to load face models",d)}},f=async()=>{if(a){s("scanning"),n(!0);try{const d=u.current.getScreenshot(),p=await Fde(d),v=await spe(p,new pE).withFaceLandmarks().withFaceDescriptor();if(!v){s("error"),alert("No face detected. Please position yourself clearly in front of the camera."),n(!1);return}if((await fetch("http://localhost:5000/api/student/face-register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:t.id,embedding:Array.from(v.descriptor)})})).ok)s("success");else throw new Error("Failed to register face")}catch(d){console.error(d),s("error")}finally{n(!1)}}};return a?w.jsxs("div",{className:"max-w-2xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Face Registration"}),w.jsx("p",{className:"text-slate-500 mt-2",children:"Register your face to enable AI-powered attendance."})]}),w.jsxs("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-xl overflow-hidden relative",children:[o==="registered"||o==="success"?w.jsxs("div",{className:"p-20 text-center bg-emerald-50",children:[w.jsx("div",{className:"h-24 w-24 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6",children:w.jsx(wM,{size:48})}),w.jsx("h3",{className:"text-xl font-bold text-emerald-900",children:"Face Registered Successfully"}),w.jsx("p",{className:"text-emerald-700 mt-2",children:"Your face data has been securely stored."})]}):w.jsxs("div",{className:"relative",children:[w.jsx(zF,{audio:!1,ref:u,screenshotFormat:"image/jpeg",className:"w-full aspect-video object-cover",videoConstraints:{facingMode:"user"}}),w.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:w.jsx("div",{className:"w-64 h-64 border-4 border-primary-500/50 rounded-full"})})]}),o!=="registered"&&o!=="success"&&w.jsxs("div",{className:"p-6 bg-white border-t border-slate-100",children:[w.jsx("button",{onClick:f,disabled:r,className:"w-full py-4 bg-primary-600 hover:bg-primary-700 text-white font-bold rounded-xl shadow-lg shadow-primary-200 transition-all active:scale-95 disabled:opacity-70 flex items-center justify-center gap-2",children:r?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white/30 border-t-white"}),"Scanning..."]}):w.jsxs(w.Fragment,{children:[w.jsx(CM,{size:20}),"Scan & Register Face"]})}),w.jsxs("p",{className:"text-xs text-center text-slate-400 mt-4 flex items-center justify-center gap-1",children:[w.jsx(f8,{size:12}),"Ensure good lighting and look directly at the camera"]})]})]})]}):w.jsx("div",{className:"text-center py-20 text-slate-500",children:"Loading AI Models..."})}function hpe({timetable:t}){const e=["Monday","Tuesday","Wednesday","Thursday","Friday"],r=[{id:1,time:"09:10 - 10:10"},{id:2,time:"10:10 - 11:10"},{id:"break1",label:"Break"},{id:3,time:"11:20 - 12:20"},{id:"lunch",label:"Lunch"},{id:4,time:"13:00 - 14:00"},{id:5,time:"14:00 - 15:00"},{id:"break2",label:"Break"},{id:6,time:"15:10 - 16:00"}],n=(a,i)=>t.find(o=>o.day_of_week===a&&o.period===i);return w.jsx("div",{className:"overflow-x-auto pb-2",children:w.jsxs("table",{className:"w-full text-[10px] border-collapse",children:[w.jsx("thead",{children:w.jsxs("tr",{className:"bg-slate-50 text-slate-500 uppercase font-semibold",children:[w.jsx("th",{className:"px-2 py-2 text-left border-b border-r border-slate-100 w-20",children:"Day"}),r.map((a,i)=>w.jsxs("th",{className:"px-1 py-2 text-center border-b border-slate-100 min-w-[70px]",children:[w.jsx("div",{className:"font-bold text-slate-700",children:a.label||`P${i+1}`}),a.time&&w.jsx("div",{className:"text-[9px] text-slate-400 font-normal",children:a.time})]},i))]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:e.map((a,i)=>w.jsxs("tr",{className:"hover:bg-slate-50/50",children:[w.jsx("td",{className:"px-3 py-2 font-bold text-slate-900 bg-slate-50/30 border-r border-slate-100",children:a}),r.map((o,s)=>{if(o.label)return w.jsx("td",{className:"bg-slate-50/50 text-center text-slate-400 font-bold uppercase tracking-widest writing-vertical-lr py-1",children:o.label},s);const u=n(i,o.id);return w.jsx("td",{className:"p-1 border-r border-slate-50 text-center h-16 align-middle",children:u?w.jsxs("div",{className:"bg-primary-50 text-primary-900 p-1.5 rounded-lg border border-primary-100 h-full flex flex-col justify-center",children:[w.jsx("div",{className:"font-bold truncate text-[10px]",title:u.subject?.name,children:u.subject?.code}),w.jsx("div",{className:"text-[9px] text-primary-600 truncate",children:u.staff?.full_name})]}):w.jsx("div",{className:"text-slate-200",children:"-"})},s)})]},a))})]})})}function ppe(){return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Lab Assistant"}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Labs Today"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"5"})]}),w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Devices Online"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"8"})]})]})]})}function vpe(){return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Accountant"}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Fees Collected (Month)"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:" 12.4L"})]}),w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Pending Dues"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:" 3.1L"})]}),w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Defaulters"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"42"})]})]})]})}function mpe(){return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Librarian"}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Books Issued"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"324"})]}),w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Overdue"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"27"})]}),w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Reservations"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"18"})]})]})]})}function gpe(){return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"IT Admin"}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Active Users"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"1,842"})]}),w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Devices Online"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"14 / 16"})]}),w.jsxs("div",{className:"card",children:[w.jsx("div",{className:"text-xs font-medium text-slate-500",children:"API Errors (24h)"}),w.jsx("div",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"12"})]})]})]})}function ype(){const{roles:t,user:e}=ha(),r=t[0];if(!r)return w.jsxs("div",{className:"p-8 text-center bg-red-50 text-red-700 rounded-lg m-4 border border-red-200",children:[w.jsx("h3",{className:"text-lg font-bold mb-2",children:"Access Denied: No Role Assigned"}),w.jsx("p",{className:"mb-4",children:"Your account does not have any roles assigned."}),w.jsxs("div",{className:"text-left text-xs bg-white p-4 rounded border font-mono",children:[w.jsx("p",{children:w.jsx("strong",{children:"Debug Info:"})}),w.jsxs("p",{children:["User Email: ",e?.email]}),w.jsxs("p",{children:["User ID: ",e?.id]}),w.jsxs("p",{children:["Roles (Context): ",JSON.stringify(t)]}),w.jsxs("p",{children:["App Metadata: ",JSON.stringify(e?.app_metadata)]}),w.jsx("p",{children:w.jsx("em",{children:"Tip: Try logging out and back in. If problem persists, run the seed script."})})]})]});if(["STAFF","LECTURER","HOD","PRINCIPAL"].includes(r))return w.jsx(Mie,{});switch(r){case"SUPER_ADMIN":return w.jsx(WF,{});case"STUDENT":return w.jsx(fpe,{});case"LAB_ASSISTANT":return w.jsx(ppe,{});case"ACCOUNTANT":return w.jsx(vpe,{});case"LIBRARIAN":return w.jsx(mpe,{});case"IT_ADMIN":return w.jsx(gpe,{});default:return w.jsxs("div",{className:"text-sm text-slate-600",children:["Unsupported role: ",r]})}}function bpe(){const{user:t,roles:e}=ha(),[r,n]=V.useState([]),[a,i]=V.useState(!0),o=e.includes("STUDENT");V.useEffect(()=>{o&&t?.id?s():i(!1)},[t,o]);const s=async()=>{try{const f=await fetch(`http://localhost:5000/api/student/dashboard?studentId=${t.id}`);if(f.ok){const d=await f.json();n(d.academics?.subjectStats||[])}}catch(f){console.error(f)}finally{i(!1)}},l=o&&!a?r:[{name:"Maths",percentage:85,total:20,present:17,code:"MAT101"},{name:"Physics",percentage:92,total:18,present:16,code:"PHY101"},{name:"Chemistry",percentage:78,total:22,present:17,code:"CHE101"},{name:"English",percentage:95,total:15,present:14,code:"ENG101"},{name:"CS",percentage:98,total:25,present:24,code:"CS101"}];return a?w.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-slate-200 border-t-primary-600"})}):w.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 font-sans",children:[w.jsxs("div",{className:"mb-4",children:[w.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Attendance Overview"}),w.jsx("p",{className:"text-slate-500",children:"Subject-wise breakdown and performance metrics"})]}),w.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm",children:w.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-5",children:[l.map((f,d)=>w.jsxs("div",{className:"text-center p-3 rounded-lg hover:bg-slate-50 transition-colors border border-slate-100/50",children:[w.jsx("div",{className:"text-sm font-bold text-slate-500 truncate",title:f.name,children:f.name}),w.jsx("div",{className:"mt-1 text-xs font-bold text-slate-400 uppercase tracking-widest",children:f.code||"SUB"}),w.jsx("div",{className:`mt-2 text-xl font-black ${f.percentage<75?"text-red-500":"text-emerald-600"}`,children:f.total===0?"N/A":`${f.percentage}%`}),w.jsxs("div",{className:"mt-1 text-xs font-bold text-slate-400",children:[f.present,"/",f.total," Attended"]})]},d)),l.length===0&&w.jsx("div",{className:"col-span-full text-center text-slate-400 italic py-4",children:"No subject records found."})]})})]})}function xpe(){const{id:t}=YD();return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Student Profile"}),w.jsxs("div",{className:"card text-xs text-slate-500",children:["Profile details for student ",t,"."]})]})}function wpe(){const{id:t}=YD();return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Staff Profile"}),w.jsxs("div",{className:"card text-xs text-slate-500",children:["Profile details for staff ",t,"."]})]})}function _pe(){return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Device Management"}),w.jsx("div",{className:"card text-xs text-slate-500",children:"Manage Raspberry Pi devices, view health status, and provision API keys."})]})}function Spe(){return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Reports & Analytics"}),w.jsx("div",{className:"card text-xs text-slate-500",children:"Charts and detailed analytics for attendance, performance, and device metrics will go here."})]})}function Epe(){return w.jsx("div",{className:"flex min-h-[60vh] items-center justify-center",children:w.jsx("div",{className:"card max-w-md text-center text-sm text-slate-600",children:"You do not have permission to access this page."})})}function Cpe(){const{user:t}=ha(),[e,r]=V.useState([]),[n,a]=V.useState(!0),[i,o]=V.useState(null);V.useEffect(()=>{s()},[t]);const s=async()=>{try{if(!t?.id)return;a(!0);const u=await fetch(`http://localhost:5000/api/student/courses?studentId=${t.id}`);if(!u.ok)throw new Error("Failed to load courses");const l=await u.json();r(l.courses||[])}catch(u){o(u.message)}finally{a(!1)}};return n?w.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-slate-200 border-t-primary-600"})}):w.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-in fade-in duration-500 font-sans",children:[w.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[w.jsx("div",{className:"h-12 w-12 rounded-2xl bg-primary-100 flex items-center justify-center text-primary-600",children:w.jsx(os,{size:24})}),w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"My Coursework"}),w.jsx("p",{className:"text-slate-500 font-medium",children:"Subjects assigned for your current semester"})]})]}),i&&w.jsxs("div",{className:"bg-red-50 text-red-700 p-4 rounded-xl border border-red-100 flex items-center gap-3",children:[w.jsx(xM,{size:20}),w.jsx("span",{className:"font-bold",children:i})]}),w.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.map(u=>w.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-md hover:border-primary-200 transition-all p-6 group",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:u.code}),w.jsx("div",{className:"bg-slate-50 text-slate-600 px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-tight group-hover:bg-primary-50 group-hover:text-primary-600 transition-colors",children:u.type||"Core"})]}),w.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2 leading-tight group-hover:text-primary-700 transition-colors",children:u.name}),w.jsxs("div",{className:"flex items-center gap-4 mt-6 pt-4 border-t border-slate-100",children:[w.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-wide",children:[w.jsx(Uu,{size:14,className:"text-slate-400"}),u.credits," Credits"]}),w.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-wide",children:[w.jsx($u,{size:14,className:"text-slate-400"}),u.hours||"45"," Hours"]})]})]},u.id)),e.length===0&&!i&&w.jsxs("div",{className:"col-span-full py-16 text-center bg-slate-50 rounded-2xl border-2 border-dashed border-slate-200",children:[w.jsx(os,{size:48,className:"mx-auto text-slate-300 mb-4"}),w.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-widest",children:"No courses found for this semester"})]})]})]})}function kpe(){const{user:t}=ha(),[e,r]=V.useState([]),[n,a]=V.useState(!0);V.useEffect(()=>{t?.id&&i()},[t]);const i=async()=>{try{const l=await fetch(`http://localhost:5000/api/student/timetable?studentId=${t.id}`);if(l.ok){const f=await l.json();r(f.timetable||[])}}catch(l){console.error("Failed to load timetable",l)}finally{a(!1)}},o=["Monday","Tuesday","Wednesday","Thursday","Friday"],s=[{id:1,time:"09:10 - 10:10"},{id:2,time:"10:10 - 11:10"},{id:"break1",label:"Break"},{id:3,time:"11:20 - 12:20"},{id:"lunch",label:"Lunch"},{id:4,time:"13:00 - 14:00"},{id:5,time:"14:00 - 15:00"},{id:"break2",label:"Break"},{id:6,time:"15:10 - 16:00"}],u=(l,f)=>e.find(d=>d.day_of_week===l&&d.period===f);return n?w.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-slate-200 border-t-primary-600"})}):w.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 font-sans",children:[w.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[w.jsx("div",{className:"h-14 w-14 rounded-2xl bg-primary-50 flex items-center justify-center text-primary-600 shadow-sm border border-primary-100",children:w.jsx(E1,{size:28})}),w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Weekly Timetable"}),w.jsx("p",{className:"text-slate-500 font-medium",children:"Detailed schedule for the current semester"})]})]}),w.jsx("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden ring-1 ring-slate-100/50",children:w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-left border-collapse",children:[w.jsx("thead",{children:w.jsxs("tr",{className:"bg-slate-50/50 border-b border-slate-100",children:[w.jsx("th",{className:"p-5 text-[10px] font-bold uppercase tracking-widest text-slate-400 w-28 border-r border-slate-100",children:"Day"}),s.map((l,f)=>w.jsxs("th",{className:"p-5 text-[10px] font-bold uppercase tracking-widest text-slate-500 text-center border-r border-slate-100 last:border-r-0 min-w-[120px]",children:[w.jsx("div",{className:"font-bold text-slate-700",children:l.label||`Period ${l.id}`}),l.time&&w.jsx("div",{className:"text-[10px] text-slate-400 font-normal mt-0.5",children:l.time})]},f))]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:o.map((l,f)=>w.jsxs("tr",{className:"group hover:bg-slate-50/50 transition-colors",children:[w.jsx("td",{className:"p-5 font-bold text-slate-600 text-[11px] uppercase tracking-wider border-r border-slate-100 bg-slate-50/20",children:l}),s.map((d,p)=>{if(d.label)return w.jsx("td",{className:"bg-slate-50/50 text-center text-slate-400 text-[10px] font-bold uppercase tracking-widest writing-vertical-lr select-none",children:d.label},p);const v=u(f,d.id);return w.jsx("td",{className:"p-3 border-r border-slate-100 last:border-r-0 h-32 min-w-[160px]",children:v?w.jsxs("div",{className:"w-full h-full p-4 rounded-2xl bg-white text-left border border-slate-200 hover:border-primary-400 hover:shadow-xl hover:shadow-primary-100 hover:scale-[1.03] transition-all relative overflow-hidden ring-0 hover:ring-2 hover:ring-primary-100 group/slot",children:[w.jsxs("div",{className:"text-[9px] font-black text-primary-600 uppercase tracking-tighter mb-1.5 flex items-center gap-1",children:[w.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-primary-500"}),v.subject?.code]}),w.jsx("div",{className:"text-sm font-bold text-slate-900 line-clamp-2 leading-snug mb-3",children:v.subject?.name}),w.jsx("div",{className:"flex items-center justify-between text-[11px] font-bold text-slate-500 uppercase tracking-tight mt-auto",children:w.jsxs("div",{className:"flex items-center gap-1.5 bg-slate-50 px-2 py-1 rounded-lg text-slate-600 group-hover/slot:bg-primary-50 group-hover/slot:text-primary-700 transition-colors",children:[w.jsx(uo,{size:12}),v.staff?.full_name||"TBA"]})})]}):w.jsx("div",{className:"w-full h-full border-2 border-dashed border-slate-100 rounded-2xl flex items-center justify-center opacity-30 hover:opacity-100 transition-opacity",children:w.jsx("span",{className:"text-[10px] font-black text-slate-300 uppercase tracking-widest",children:"Free"})})},p)})]},l))})]})})})]})}function Ape(){const[t,e]=V.useState(!1),r=n=>{n.preventDefault(),e(!0),setTimeout(()=>e(!1),3e3)};return w.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Activity Survey"}),w.jsx("p",{className:"text-slate-500",children:"Share your feedback relative to recent campus activities"})]}),w.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm",children:t?w.jsxs("div",{className:"flex h-64 flex-col items-center justify-center space-y-4 text-center",children:[w.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-green-100 text-green-600",children:w.jsx("svg",{className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),w.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Thank you!"}),w.jsx("p",{className:"text-slate-600",children:"Your response has been recorded."})]}):w.jsxs("form",{onSubmit:r,className:"space-y-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"mb-2 block text-sm font-medium text-slate-700",children:"Which activity did you participate in?"}),w.jsxs("select",{className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none ring-primary-500 focus:ring-2",children:[w.jsx("option",{children:"Tech Fest 2025"}),w.jsx("option",{children:"Sports Day"}),w.jsx("option",{children:"Cultural Night"}),w.jsx("option",{children:"Coding Hackathon"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"mb-2 block text-sm font-medium text-slate-700",children:"How would you rate the organization?"}),w.jsx("div",{className:"flex gap-4",children:[1,2,3,4,5].map(n=>w.jsxs("label",{className:"flex cursor-pointer items-center gap-2",children:[w.jsx("input",{type:"radio",name:"rating",className:"h-4 w-4 text-primary-600"}),w.jsx("span",{className:"text-sm text-slate-600",children:n})]},n))})]}),w.jsxs("div",{children:[w.jsx("label",{className:"mb-2 block text-sm font-medium text-slate-700",children:"Suggestions for improvement"}),w.jsx("textarea",{className:"h-32 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none ring-primary-500 focus:ring-2",placeholder:"Tell us what you think..."})]}),w.jsx("button",{type:"submit",className:"w-full rounded-lg bg-primary-600 px-4 py-2.5 text-sm font-semibold text-white hover:bg-primary-700",children:"Submit Survey"})]})})]})}function Ope(){const t=[{id:1,title:"Bonafide Certificate",desc:"Request for detailed student bonafide certificate",status:"Available"},{id:2,title:"Scholarship Application",desc:"Merit-based scholarship for semester 4",status:"Closing Soon"},{id:3,title:"Hostel Accommodation",desc:"Request for hostel room allocation",status:"Waitlist"},{id:4,title:"ID Card Replacement",desc:"Request new ID card (Lost/Damaged)",status:"Available"},{id:5,title:"Exam Re-valuation",desc:"Apply for re-checking of semester answer sheets",status:"Closed"}];return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Application Forms"}),w.jsx("p",{className:"text-slate-500",children:"Download and submit digital forms"})]}),w.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:t.map(e=>w.jsxs("div",{className:"flex flex-col justify-between rounded-xl border border-slate-200 bg-white p-5 shadow-sm hover:shadow-md transition-shadow",children:[w.jsxs("div",{children:[w.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[w.jsx("h3",{className:"font-semibold text-slate-900",children:e.title}),w.jsx("span",{className:`rounded-full px-2 py-0.5 text-[10px] font-bold uppercase tracking-wide
                            ${e.status==="Available"?"bg-green-100 text-green-700":e.status==="Closing Soon"?"bg-amber-100 text-amber-700":e.status==="Closed"?"bg-slate-100 text-slate-500":"bg-blue-100 text-blue-700"}`,children:e.status})]}),w.jsx("p",{className:"text-sm text-slate-500 mb-4",children:e.desc})]}),w.jsx("button",{disabled:e.status==="Closed",className:"w-full rounded-lg border border-slate-200 bg-slate-50 py-2 text-sm font-medium text-slate-700 hover:bg-white hover:text-primary-600 disabled:opacity-50 disabled:cursor-not-allowed",children:e.status==="Closed"?"Applications Closed":"View & Apply"})]},e.id))})]})}function Tpe(){const[t,e]=V.useState("apply"),r=[{id:1,type:"Medical",from:"2025-10-12",to:"2025-10-14",reason:"Fever",status:"Approved"},{id:2,type:"Personal",from:"2025-09-05",to:"2025-09-05",reason:"Family function",status:"Approved"},{id:3,type:"Event",from:"2025-08-20",to:"2025-08-22",reason:"Tech Symposium",status:"Rejected"}];return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Leave Applications"}),w.jsxs("div",{className:"flex gap-2 rounded-lg bg-slate-100 p-1",children:[w.jsx("button",{onClick:()=>e("apply"),className:`rounded-md px-3 py-1.5 text-sm font-medium transition-all ${t==="apply"?"bg-white text-primary-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Apply New"}),w.jsx("button",{onClick:()=>e("history"),className:`rounded-md px-3 py-1.5 text-sm font-medium transition-all ${t==="history"?"bg-white text-primary-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"History"})]})]}),w.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:t==="apply"?w.jsx("div",{className:"p-6",children:w.jsxs("form",{className:"space-y-4 max-w-2xl",children:[w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Leave Type"}),w.jsxs("select",{className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none ring-primary-500 focus:ring-2",children:[w.jsx("option",{children:"Medical Leave"}),w.jsx("option",{children:"Personal Leave"}),w.jsx("option",{children:"On Duty (OD)"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Dates"}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none ring-primary-500 focus:ring-2"}),w.jsx("span",{className:"self-center text-slate-400",children:"-"}),w.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none ring-primary-500 focus:ring-2"})]})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Reason"}),w.jsx("textarea",{className:"h-24 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none ring-primary-500 focus:ring-2",placeholder:"Explain reason for leave..."})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Attachments (Medical Cert etc)"}),w.jsx("input",{type:"file",className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"})]}),w.jsx("div",{className:"pt-2",children:w.jsx("button",{type:"button",className:"btn-primary",children:"Submit Application"})})]})}):w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-left text-sm",children:[w.jsx("thead",{className:"bg-slate-50 text-xs uppercase text-slate-500",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4",children:"Type"}),w.jsx("th",{className:"px-6 py-4",children:"Dates"}),w.jsx("th",{className:"px-6 py-4",children:"Reason"}),w.jsx("th",{className:"px-6 py-4",children:"Status"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:r.map(n=>w.jsxs("tr",{className:"hover:bg-slate-50",children:[w.jsx("td",{className:"px-6 py-4 font-medium text-slate-900",children:n.type}),w.jsxs("td",{className:"px-6 py-4 text-slate-500",children:[n.from," to ",n.to]}),w.jsx("td",{className:"px-6 py-4 text-slate-500",children:n.reason}),w.jsx("td",{className:"px-6 py-4",children:w.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium 
                                        ${n.status==="Approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:n.status})})]},n.id))})]})})})]})}function Ppe(){const[t]=tM(),e=ps(),{user:r}=ha(),[n,a]=V.useState(new Date().toISOString().split("T")[0]),[i,o]=V.useState([]),[s,u]=V.useState(null),[l,f]=V.useState([]),[d,p]=V.useState(!0),[v,g]=V.useState(!1),[b,y]=V.useState(!1),[x,S]=V.useState(""),[E,C]=V.useState(null),[k,A]=V.useState(!1),[T,N]=V.useState([]),[R,I]=V.useState(!1);V.useEffect(()=>{D()},[r]),V.useEffect(()=>{s?j():f([])},[s,n]);const D=async()=>{try{p(!0);const B=await fetch(`http://localhost:5000/api/admin/staff-dashboard-data?staffId=${r.id}`);if(!B.ok)throw new Error("Failed to fetch schedule");const G=await B.json();o(G.timetable||[]);const L=t.get("classId"),K=t.get("period");if(L&&K){const oe=(G.timetable||[]).find(he=>he.class_id===L&&he.period===parseInt(K));oe&&u(oe)}}catch(B){C({type:"error",text:B.message})}finally{p(!1)}},j=async()=>{try{g(!0);const B=await fetch(`http://localhost:5000/api/admin/attendance-sheet?classId=${s.class_id}&date=${n}&period=${s.period}`);if(!B.ok)throw new Error("Failed to fetch attendance sheet");const G=await B.json();f(G.students.map(L=>({...L,status:L.status||null})))}catch(B){C({type:"error",text:B.message})}finally{g(!1)}},$=(B,G)=>{f(L=>L.map(K=>K.id===B?{...K,status:G}:K))},W=B=>{f(G=>G.map(L=>({...L,status:B})))},q=async()=>{if(s)try{y(!0);const B=l.filter(L=>L.status).map(L=>({student_id:L.id,class_id:s.class_id,subject_id:s.subject_id,period:s.period,date:n,status:L.status,marked_by:r.id}));if(!(await fetch("http://localhost:5000/api/admin/mark-attendance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({records:B})})).ok)throw new Error("Failed to save attendance");C({type:"success",text:"Attendance records updated successfully!"}),window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>C(null),3e3)}catch(B){C({type:"error",text:B.message})}finally{y(!1)}},X=(new Date(n).getDay()+6)%7,Y=i.filter(B=>B.day_of_week===X).sort((B,G)=>B.period-G.period),z=l.filter(B=>B.name?.toLowerCase().includes(x.toLowerCase())||B.admission?.toLowerCase().includes(x.toLowerCase()));return d?w.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-slate-200 border-t-primary-600"})}):w.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 pb-20 animate-in fade-in duration-500 font-sans",children:[w.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("button",{onClick:()=>e("/dashboard"),className:"flex items-center gap-2 text-slate-500 hover:text-slate-900 transition-all text-sm font-bold group",children:[w.jsx(oq,{size:16,className:"group-hover:-translate-x-1 transition-transform"}),"Control Center"]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tight leading-none",children:"Attendance Ledger"}),w.jsx("p",{className:"text-sm text-slate-500 font-semibold tracking-tight",children:"Record or modify student attendance across sessions"})]})]}),w.jsxs("div",{className:"flex flex-wrap items-center gap-4 bg-white p-3 rounded-2xl border border-slate-200 shadow-sm ring-1 ring-slate-100",children:[w.jsxs("div",{className:"flex items-center gap-3 px-3",children:[w.jsx(Bu,{size:18,className:"text-primary-600"}),w.jsx("input",{type:"date",value:n,onChange:B=>{a(B.target.value),u(null)},className:"bg-transparent border-none p-0 text-sm font-bold text-slate-900 outline-none focus:ring-0 w-36 cursor-pointer"})]}),w.jsx("div",{className:"h-8 w-px bg-slate-100 hidden sm:block"}),w.jsxs("div",{className:"flex items-center gap-2 px-3",children:[w.jsx(Uq,{size:18,className:"text-slate-400"}),w.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Past Entry"})]})]})]}),E&&w.jsxs("div",{className:`p-4 rounded-2xl flex items-center gap-3 border-2 animate-in slide-in-from-top-4 duration-300 ${E.type==="success"?"bg-emerald-50 text-emerald-700 border-emerald-100/50":"bg-red-50 text-red-700 border-red-100/50"}`,children:[E.type==="success"?w.jsx(kq,{size:24}):w.jsx(xM,{size:24}),w.jsx("p",{className:"text-sm font-black tracking-tight",children:E.text})]}),w.jsxs("section",{className:"space-y-4",children:[w.jsxs("div",{className:"flex items-center justify-between px-1",children:[w.jsxs("h2",{className:"text-xs font-black uppercase tracking-widest text-slate-400",children:["Available Sessions for ",new Date(n).toLocaleDateString(void 0,{weekday:"long"})]}),w.jsxs("span",{className:"text-[10px] font-bold text-slate-400 bg-slate-100 px-2 py-0.5 rounded-full",children:[Y.length," Teaching Hours"]})]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[Y.map(B=>w.jsxs("button",{onClick:()=>u(B),className:`p-4 rounded-2xl border-2 transition-all text-left relative overflow-hidden group ${s?.id===B.id?"bg-primary-600 border-primary-600 text-white shadow-xl shadow-primary-200 scale-[1.02]":"bg-white border-slate-100 hover:border-primary-200 hover:shadow-lg"}`,children:[w.jsx("div",{className:`absolute top-0 right-0 p-2 opacity-0 group-hover:opacity-100 transition-all ${s?.id===B.id?"opacity-100":""}`,children:w.jsx(Qi,{size:16})}),w.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[w.jsxs("div",{className:`h-8 w-8 rounded-lg flex items-center justify-center text-[10px] font-black ${s?.id===B.id?"bg-white/20 text-white":"bg-slate-100 text-slate-500"}`,children:["P",B.period]}),w.jsx("div",{className:`text-[10px] font-black uppercase tracking-widest ${s?.id===B.id?"text-white/80":"text-slate-400"}`,children:B.subject?.code})]}),w.jsx("div",{className:"text-xs font-black leading-tight mb-2 line-clamp-1",children:B.subject?.name}),w.jsxs("div",{className:"flex items-center gap-1.5",children:[w.jsx(Lc,{size:12,className:s?.id===B.id?"text-white/50":"text-slate-300"}),w.jsx("span",{className:`text-[10px] font-bold uppercase tracking-tight ${s?.id===B.id?"text-white/90":"text-slate-500"}`,children:B.class?.name})]})]},`${B.class_id}-${B.period}`)),Y.length===0&&w.jsxs("div",{className:"col-span-full py-12 bg-slate-50 rounded-3xl border-2 border-dashed border-slate-200 flex flex-col items-center justify-center text-center",children:[w.jsx($u,{size:40,className:"text-slate-300 mb-3"}),w.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest",children:"No assigned teaching hours for this day"})]})]})]}),s&&w.jsxs("section",{className:"bg-white rounded-3xl border border-slate-200 shadow-xl shadow-slate-200/50 overflow-hidden ring-1 ring-slate-100 animate-in slide-in-from-bottom-6 duration-500",children:[w.jsxs("div",{className:"p-8 border-b border-slate-100 bg-slate-50/30 flex flex-col xl:flex-row xl:items-center justify-between gap-6",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("h2",{className:"text-xl font-black text-slate-900 flex items-center gap-3",children:s.subject?.name}),w.jsxs("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:[w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsx(uo,{size:14,className:"text-primary-500"})," ",l.length," Registered Students"]}),w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsx($u,{size:14,className:"text-primary-500"})," Session: Period ",s.period]}),w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsx(Lc,{size:14,className:"text-primary-500"})," ",s.class?.name]})]})]}),w.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[w.jsxs("div",{className:"relative w-full sm:w-80",children:[w.jsx(b2,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-300"}),w.jsx("input",{type:"text",placeholder:"Seach by name or ID...",value:x,onChange:B=>S(B.target.value),className:"w-full pl-12 pr-6 py-3.5 text-sm font-bold border-2 border-slate-100 rounded-2xl outline-none focus:border-primary-500 transition-all placeholder:text-slate-300"})]}),w.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[w.jsxs("button",{onClick:()=>A(!0),className:"flex-1 sm:flex-none text-[10px] font-black uppercase tracking-widest text-indigo-600 bg-indigo-50 px-5 py-4 rounded-2xl border-2 border-indigo-100 hover:bg-indigo-100 active:scale-95 transition-all shadow-sm shadow-indigo-50 flex items-center gap-2",children:[w.jsx(gq,{size:16}),"AI Mark"]}),w.jsx("button",{onClick:()=>W("PRESENT"),className:"flex-1 sm:flex-none text-[10px] font-black uppercase tracking-widest text-emerald-600 bg-emerald-50 px-5 py-4 rounded-2xl border-2 border-emerald-100 hover:bg-emerald-100 active:scale-95 transition-all shadow-sm shadow-emerald-50",children:"Mark All PR"}),w.jsx("button",{onClick:()=>W("ABSENT"),className:"flex-1 sm:flex-none text-[10px] font-black uppercase tracking-widest text-red-600 bg-red-50 px-5 py-4 rounded-2xl border-2 border-red-100 hover:bg-red-100 active:scale-95 transition-all shadow-sm shadow-red-50",children:"Mark All AB"})]})]})]}),w.jsxs("div",{className:"relative",children:[v&&w.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center",children:w.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-slate-100 border-t-primary-600"})}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-left border-collapse",children:[w.jsx("thead",{children:w.jsxs("tr",{className:"bg-slate-50/50 border-b border-slate-100",children:[w.jsx("th",{className:"p-6 text-[10px] font-black uppercase tracking-widest text-slate-400 w-20",children:"No."}),w.jsx("th",{className:"p-6 text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Student Identity"}),w.jsx("th",{className:"p-6 text-[10px] font-black uppercase tracking-widest text-slate-400 text-center",children:"Status Control"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:z.map((B,G)=>w.jsxs("tr",{className:"group hover:bg-slate-50/50 transition-colors",children:[w.jsx("td",{className:"p-6",children:w.jsx("span",{className:"text-xs font-black text-slate-300 group-hover:text-slate-900 transition-all",children:(G+1).toString().padStart(2,"0")})}),w.jsx("td",{className:"p-6",children:w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center text-primary-600 font-black text-sm border-2 border-white shadow-inner",children:B.name?.[0]}),w.jsxs("div",{children:[w.jsx("div",{className:"text-sm font-black text-slate-900 group-hover:text-primary-700 transition-colors",children:B.name}),w.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 group-hover:text-slate-500 transition-all",children:B.admission})]})]})}),w.jsx("td",{className:"p-6",children:w.jsxs("div",{className:"flex items-center justify-center gap-3",children:[w.jsx("button",{onClick:()=>$(B.id,"PRESENT"),className:`flex h-12 w-20 items-center justify-center rounded-2xl transition-all shadow-sm border-2 ${B.status==="PRESENT"?"bg-emerald-500 border-emerald-500 text-white shadow-xl shadow-emerald-100 scale-105":"bg-white border-slate-100 text-slate-300 hover:border-emerald-200 hover:text-emerald-500 hover:bg-emerald-50/30"}`,children:B.status==="PRESENT"?w.jsx(wq,{size:22,strokeWidth:4}):w.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"PR"})}),w.jsx("button",{onClick:()=>$(B.id,"ABSENT"),className:`flex h-12 w-20 items-center justify-center rounded-2xl transition-all shadow-sm border-2 ${B.status==="ABSENT"?"bg-red-500 border-red-500 text-white shadow-xl shadow-red-100 scale-105":"bg-white border-slate-100 text-slate-300 hover:border-red-200 hover:text-red-500 hover:bg-red-50/30"}`,children:B.status==="ABSENT"?w.jsx(AM,{size:22,strokeWidth:4}):w.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"AB"})})]})})]},B.id))})]})}),z.length===0&&!v&&w.jsxs("div",{className:"p-20 text-center",children:[w.jsx(uo,{size:64,className:"mx-auto mb-6 text-slate-100"}),w.jsx("p",{className:"font-black text-slate-400 uppercase tracking-widest text-sm italic",children:"No students identified in this registry"})]})]}),w.jsxs("div",{className:"p-8 bg-slate-900 flex flex-col sm:flex-row items-center justify-between gap-6 border-t border-slate-800",children:[w.jsxs("div",{className:"flex flex-wrap justify-center gap-6",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"h-3 w-3 rounded-full bg-emerald-500 shadow-lg shadow-emerald-500/50"}),w.jsxs("span",{className:"text-[10px] font-black text-emerald-100 uppercase tracking-widest",children:[l.filter(B=>B.status==="PRESENT").length," Present"]})]}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"h-3 w-3 rounded-full bg-red-500 shadow-lg shadow-red-500/50"}),w.jsxs("span",{className:"text-[10px] font-black text-red-100 uppercase tracking-widest",children:[l.filter(B=>B.status==="ABSENT").length," Absent"]})]})]}),w.jsxs("button",{onClick:q,disabled:b||l.length===0,className:"w-full sm:w-auto flex items-center justify-center gap-3 bg-white text-slate-900 px-10 py-4 rounded-2xl text-xs font-black uppercase tracking-widest shadow-2xl hover:bg-primary-50 hover:text-primary-700 active:scale-95 transition-all disabled:opacity-20 group",children:[b?w.jsx("div",{className:"h-4 w-4 animate-spin border-4 border-slate-900/20 border-t-slate-900 rounded-full"}):w.jsx(r8,{size:18,className:"group-hover:scale-110 transition-transform"}),b?"Transmitting...":"Commit Records"]})]})]}),!s&&!d&&w.jsxs("div",{className:"text-center py-24 animate-in fade-in zoom-in duration-500",children:[w.jsx("div",{className:"inline-flex h-20 w-20 items-center justify-center rounded-3xl bg-slate-100 text-slate-400 mb-6 border-b-4 border-slate-200",children:w.jsx(Lc,{size:32})}),w.jsx("h2",{className:"text-xl font-black text-slate-900 mb-2 tracking-tight uppercase",children:"Ready to Ledger"}),w.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest max-w-xs mx-auto mb-8",children:"Select a teaching hour from the grid above to begin recording"})]}),k&&w.jsx(Npe,{classId:s?.class_id,onClose:()=>A(!1),students:l,onMatch:B=>$(B,"PRESENT"),onScanComplete:(B,G)=>{f(L=>L.map(K=>G.includes(K.id)?B.includes(K.id)?{...K,status:"PRESENT"}:{...K,status:"ABSENT"}:K)),A(!1)}})]})}function Npe({classId:t,onClose:e,students:r,onMatch:n,onScanComplete:a}){const[i,o]=V.useState(!0),[s,u]=V.useState([]),l=Z.useRef(null),[f,d]=V.useState(""),p=Z.useRef(new Set);V.useEffect(()=>{(async()=>{const b="https://justadudewhohacks.github.io/face-api.js/models";await Promise.all([lr.tinyFaceDetector.loadFromUri(b),lr.faceLandmark68Net.loadFromUri(b),lr.faceRecognitionNet.loadFromUri(b),lr.ssdMobilenetv1.loadFromUri(b)]);const y=await fetch(`http://localhost:5000/api/admin/class-embeddings?classId=${t}`),{embeddings:x}=await y.json();if(x.length>0){const S=x.map(E=>new Dc(E.student_id,[new Float32Array(E.embedding)]));u(S)}o(!1)})()},[t]),V.useEffect(()=>{if(i||s.length===0)return;let g;return g=setInterval(async()=>{if(l.current?.video?.readyState===4){const y=l.current.video,x=await upe(y,new pE).withFaceLandmarks().withFaceDescriptors();if(x.length>0){const S=new cpe(s,.6);x.forEach(E=>{const C=S.findBestMatch(E.descriptor);if(C.label!=="unknown"){const k=r.find(A=>A.id===C.label);k&&(d(k.name),p.current.has(C.label)||(p.current.add(C.label),n(C.label)),setTimeout(()=>d(""),2e3))}})}}},1e3),()=>clearInterval(g)},[i,s,r,n]);const v=()=>{const g=s.map(y=>y.label),b=Array.from(p.current);a(b,g)};return w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-300",children:w.jsxs("div",{className:"bg-white p-6 rounded-3xl max-w-2xl w-full mx-4 shadow-2xl",children:[w.jsxs("div",{className:"flex items-center justify-between mb-6",children:[w.jsx("h3",{className:"text-xl font-black text-slate-900",children:"AI Attendance Scanner"}),w.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:w.jsx(AM,{size:24})})]}),w.jsx("div",{className:"relative rounded-2xl overflow-hidden bg-black aspect-video mb-6",children:i?w.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-white/20 border-t-white mx-auto mb-4"}),w.jsx("p",{className:"font-bold",children:"Loading Models & Data..."})]})}):w.jsxs(w.Fragment,{children:[w.jsx(zF,{audio:!1,ref:l,screenshotFormat:"image/jpeg",className:"w-full h-full object-cover",videoConstraints:{facingMode:"environment"}}),f&&w.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-emerald-500 text-white px-6 py-2 rounded-full font-bold shadow-lg animate-in fade-in slide-in-from-bottom-2",children:["Marked: ",f]}),w.jsx("div",{className:"absolute top-4 right-4 bg-black/50 text-white px-3 py-1 rounded-full text-xs font-bold backdrop-blur-sm",children:"Live Scanning"})]})}),w.jsx("div",{className:"flex justify-end",children:w.jsxs("button",{onClick:v,className:"flex items-center gap-2 bg-slate-900 text-white px-6 py-3 rounded-xl font-bold hover:bg-slate-800 transition-colors",children:[w.jsx(Oq,{size:18}),"Finish Scanning"]})})]})})}function Rpe(){return w.jsx(Qz,{children:w.jsx(v6,{children:w.jsxs(o6,{children:[w.jsx(zt,{path:"/login",element:w.jsx(g8,{})}),w.jsx(zt,{path:"/unauthorized",element:w.jsx(Epe,{})}),w.jsx(zt,{element:w.jsx(Zz,{}),children:w.jsxs(zt,{element:w.jsx(m8,{}),children:[w.jsx(zt,{index:!0,element:w.jsx(Yc,{to:"/dashboard",replace:!0})}),w.jsx(zt,{path:"/dashboard",element:w.jsx(ype,{})}),w.jsx(zt,{path:"/attendance",element:w.jsx(bpe,{})}),w.jsx(zt,{path:"/students/:id",element:w.jsx(xpe,{})}),w.jsx(zt,{path:"/staff/:id",element:w.jsx(wpe,{})}),w.jsx(zt,{path:"/reports",element:w.jsx(Spe,{})}),w.jsx(zt,{path:"/my-courses",element:w.jsx(Cpe,{})}),w.jsx(zt,{path:"/schedule",element:w.jsx(kpe,{})}),w.jsx(zt,{path:"/survey",element:w.jsx(Ape,{})}),w.jsx(zt,{path:"/forms",element:w.jsx(Ope,{})}),w.jsx(zt,{path:"/leave",element:w.jsx(Tpe,{})}),w.jsx(zt,{element:w.jsx(JA,{allowedRoles:["STAFF","LECTURER","HOD","PRINCIPAL"]}),children:w.jsx(zt,{path:"/mark-attendance",element:w.jsx(Ppe,{})})}),w.jsxs(zt,{element:w.jsx(JA,{allowedRoles:["SUPER_ADMIN","IT_ADMIN"]}),children:[w.jsx(zt,{path:"/admin",element:w.jsx(WF,{})}),w.jsx(zt,{path:"/devices",element:w.jsx(_pe,{})})]})]})}),w.jsx(zt,{path:"*",element:w.jsx(Yc,{to:"/dashboard",replace:!0})})]})})})}pU.createRoot(document.getElementById("root")).render(w.jsx(Z.StrictMode,{children:w.jsx(Rpe,{})}))});export default Ipe();
